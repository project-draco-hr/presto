{
  if (state != State.HAS_OUTPUT) {
    return null;
  }
  if (currentPosition >= pageIndex.getPositionCount()) {
    state=State.FINISHED;
    return null;
  }
  pageBuilder.reset();
  while (!pageBuilder.isFull() && currentPosition < pageIndex.getPositionCount()) {
    for (int i=0; i < outputChannels.length; i++) {
      pageIndex.appendTupleTo(outputChannels[i],currentPosition,pageBuilder.getBlockBuilder(i));
    }
    currentPosition++;
  }
  if (pageBuilder.isEmpty()) {
    state=State.FINISHED;
    return null;
  }
  Page page=pageBuilder.build();
  return page;
}
