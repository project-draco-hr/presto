{
  while (true) {
    StageState stageState=this.stageState.get();
    if (stageState.isDone()) {
      return;
    }
    if (this.stageState.compareAndSet(stageState,StageState.CANCELED)) {
      break;
    }
  }
  cancelAll();
}
