{
  Preconditions.checkState(!Thread.holdsLock(this),"Can not cancel while holding a lock on this");
  for (  RemoteTask task : tasks.values()) {
    task.cancel();
  }
  for (  StageExecutionNode subStage : subStages.values()) {
    subStage.cancel();
  }
}
