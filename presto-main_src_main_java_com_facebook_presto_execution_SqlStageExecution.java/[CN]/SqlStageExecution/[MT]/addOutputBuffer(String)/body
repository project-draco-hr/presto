{
  Preconditions.checkNotNull(outputId,"outputId is null");
  Preconditions.checkArgument(!outputBuffers.contains(outputId),"Stage already has an output %s",outputId);
  try (SetThreadName setThreadName=new SetThreadName("Stage-%s",stageId)){
    outputBuffers.add(outputId);
    this.notifyAll();
  }
 }
