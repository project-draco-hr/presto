{
  Preconditions.checkNotNull(outputId,"outputId is null");
  Preconditions.checkArgument(!currentOutputBuffers.contains(outputId) && !newOutputBuffers.contains(outputId),"Stage already has an output %s",outputId);
  try (SetThreadName setThreadName=new SetThreadName("Stage-%s",stageId)){
    newOutputBuffers.add(outputId);
    this.notifyAll();
  }
 }
