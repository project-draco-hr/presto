{
  if (!fragment.getRemoteSourceNodes().isEmpty()) {
    nodeSelector.lockDownNodes();
    for (    Node node : Sets.difference(new HashSet<>(nodeSelector.allNodes()),localNodeTaskMap.keySet())) {
      scheduleTask(nextTaskId.getAndIncrement(),node);
    }
    stateMachine.transitionToSchedulingSplits();
  }
synchronized (this) {
    try {
      TimeUnit.MILLISECONDS.timedWait(this,100);
    }
 catch (    InterruptedException e) {
      Thread.currentThread().interrupt();
      throw Throwables.propagate(e);
    }
  }
  addNewExchangesAndBuffers();
}
