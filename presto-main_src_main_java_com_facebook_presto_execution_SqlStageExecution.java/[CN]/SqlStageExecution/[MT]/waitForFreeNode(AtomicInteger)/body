{
  if (!subStages.isEmpty()) {
    nodeSelector.lockDownNodes();
    for (    Node node : Sets.difference(new HashSet<>(nodeSelector.allNodes()),localNodeTaskMap.keySet())) {
      scheduleTask(nextTaskId.getAndIncrement(),node);
    }
    setNoMoreStageNodes();
  }
synchronized (this) {
    try {
      TimeUnit.SECONDS.timedWait(this,1);
    }
 catch (    InterruptedException e) {
      Thread.currentThread().interrupt();
      throw Throwables.propagate(e);
    }
  }
  updateNewExchangesAndBuffers(false);
}
