{
  for (  RemoteSourceNode remoteSourceNode : fragment.getRemoteSourceNodes()) {
    if (!completeSources.contains(remoteSourceNode.getId())) {
      boolean exchangeFinished=true;
      for (      PlanFragmentId planFragmentId : remoteSourceNode.getSourceFragmentIds()) {
        SqlStageExecution subStage=subStages.get(planFragmentId);
switch (subStage.getState()) {
case PLANNED:
case SCHEDULING:
          exchangeFinished=false;
        break;
    }
  }
  if (exchangeFinished) {
    completeSources.add(remoteSourceNode.getId());
  }
}
}
return completeSources;
}
