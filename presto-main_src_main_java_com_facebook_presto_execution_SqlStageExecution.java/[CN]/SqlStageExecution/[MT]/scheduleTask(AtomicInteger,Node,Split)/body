{
  String nodeIdentifier=node.getNodeIdentifier();
  TaskId taskId=new TaskId(stageId,String.valueOf(nextTaskId.getAndIncrement()));
  RemoteTask task=remoteTaskFactory.createRemoteTask(session,taskId,node,fragment,initialSplit,outputReceivers,getExchangeLocations(),getOutputBuffers());
  task.addStateChangeListener(new StateChangeListener<TaskInfo>(){
    @Override public void stateChanged(    TaskInfo taskInfo){
      doUpdateState();
    }
  }
);
  task.start();
  tasks.put(node,task);
  doUpdateState();
  if (getState().isDone()) {
    return task;
  }
  for (  StageExecutionNode subStage : subStages.values()) {
    subStage.addOutputBuffer(nodeIdentifier);
  }
  return task;
}
