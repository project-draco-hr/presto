{
  CompactionSetCreator compactionSetCreator=new FileCompactionSetCreator(new DataSize(100,BYTE),MAX_SHARD_ROWS);
  long tableId=1L;
  List<ShardMetadata> inputShards=ImmutableList.of(shardWithSize(70),shardWithSize(20),shardWithSize(30),shardWithSize(120));
  Set<OrganizationSet> compactionSets=compactionSetCreator.createCompactionSets(tableId,ImmutableSet.copyOf(inputShards));
  assertEquals(compactionSets.size(),2);
  Set<OrganizationSet> expected=ImmutableSet.of(new OrganizationSet(tableId,ImmutableSet.of(inputShards.get(0),inputShards.get(2))),new OrganizationSet(tableId,ImmutableSet.of(inputShards.get(1))));
  assertEquals(compactionSets,expected);
}
