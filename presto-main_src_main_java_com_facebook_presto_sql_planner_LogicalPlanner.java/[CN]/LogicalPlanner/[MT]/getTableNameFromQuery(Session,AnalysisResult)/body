{
  Query q=queryAnalysis.getRewrittenQuery();
  List<Relation> relations=q.getFrom();
  checkState(relations.size() == 1,"query uses more than one table");
  Relation r=Iterables.getOnlyElement(relations);
  checkState(r instanceof Table,"query does not select from a table");
  return MetadataUtil.createQualifiedTableName(session,((Table)r).getName());
}
