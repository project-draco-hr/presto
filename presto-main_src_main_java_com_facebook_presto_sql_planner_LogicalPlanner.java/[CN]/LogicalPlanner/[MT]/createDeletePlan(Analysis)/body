{
  QueryPlanner planner=new QueryPlanner(analysis,symbolAllocator,idAllocator,metadata,session);
  DeleteNode deleteNode=planner.planDelete(analysis.getDelete().get());
  List<Symbol> outputs=ImmutableList.of(symbolAllocator.newSymbol("rows",BIGINT));
  TableFinishNode commitNode=new TableFinishNode(idAllocator.getNextId(),deleteNode,deleteNode.getTarget(),outputs);
  return new RelationPlan(commitNode,analysis.getOutputDescriptor(),commitNode.getOutputSymbols(),Optional.empty());
}
