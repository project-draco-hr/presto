{
  Relation relation=Iterables.getOnlyElement(relations);
  if (relation instanceof Table) {
    return createScanNode((Table)relation,analysis);
  }
 else   if (relation instanceof AliasedRelation) {
    return createRelationPlan(ImmutableList.of(((AliasedRelation)relation).getRelation()),analysis);
  }
 else   if (relation instanceof Subquery) {
    AnalysisResult subqueryAnalysis=analysis.getAnalysis((Subquery)relation);
    return createQueryPlan(subqueryAnalysis);
  }
 else   if (relation instanceof Join) {
    return createJoinPlan((Join)relation,analysis);
  }
  throw new UnsupportedOperationException("not yet implemented");
}
