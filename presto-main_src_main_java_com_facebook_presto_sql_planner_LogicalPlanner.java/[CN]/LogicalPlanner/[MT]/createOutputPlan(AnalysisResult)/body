{
  PlanNode result;
  if (!analysis.getDestinations().isEmpty()) {
    result=createTableWriterPlan(analysis);
  }
 else {
    result=createQueryPlan(analysis);
  }
  List<String> names=new ArrayList<>();
  ImmutableMap.Builder<String,Symbol> assignments=ImmutableMap.builder();
  int i=0;
  for (  Field field : analysis.getOutputDescriptor().getFields()) {
    String name=field.getAttribute().orNull();
    while (name == null || names.contains(name)) {
      i++;
      name="_col" + i;
    }
    names.add(name);
    assignments.put(name,field.getSymbol());
  }
  return new OutputNode(idAllocator.getNextId(),result,names,assignments.build());
}
