{
  int i=0;
  List<String> names=new ArrayList<>();
  ImmutableMap.Builder<String,Symbol> assignments=ImmutableMap.builder();
  for (  Field field : analysis.getOutputDescriptor().getFields()) {
    String name=field.getName().orNull();
    while (name == null || names.contains(name)) {
      i++;
      name="_col" + i;
    }
    names.add(name);
    assignments.put(name,plan.getSymbol(field));
  }
  return new OutputNode(idAllocator.getNextId(),plan.getRoot(),names,assignments.build());
}
