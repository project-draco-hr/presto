{
  PlanNode root=createOutputPlan(analysis);
  PlanSanityChecker.validate(root);
  Map<Symbol,Type> types=analysis.getTypes();
  for (  PlanOptimizer optimizer : planOptimizers) {
    root=optimizer.optimize(root,session,types);
  }
  return root;
}
