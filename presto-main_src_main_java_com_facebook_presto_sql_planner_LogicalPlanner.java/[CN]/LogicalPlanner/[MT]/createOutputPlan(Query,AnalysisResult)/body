{
  PlanNode result=createQueryPlan(query,analysis);
  int i=0;
  List<String> names=new ArrayList<>();
  ImmutableMap.Builder<String,Symbol> assignments=ImmutableMap.builder();
  for (  Field field : analysis.getOutputDescriptor().getFields()) {
    String name=field.getAttribute().orNull();
    while (name == null || names.contains(name)) {
      i++;
      name="_col" + i;
    }
    names.add(name);
    assignments.put(name,field.getSymbol());
  }
  return new OutputNode(result,names,assignments.build());
}
