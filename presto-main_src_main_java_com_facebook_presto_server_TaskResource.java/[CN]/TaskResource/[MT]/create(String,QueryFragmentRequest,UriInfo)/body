{
  try {
    checkNotNull(queryFragmentRequest,"queryFragmentRequest is null");
    TaskInfo taskInfo=taskManager.createTask(taskId,queryFragmentRequest.getFragment(),queryFragmentRequest.getSplits(),queryFragmentRequest.getExchangeSources(),queryFragmentRequest.getOutputIds());
    URI pagesUri=uriBuilderFrom(uriInfo.getRequestUri()).appendPath(taskInfo.getTaskId()).build();
    return Response.created(pagesUri).entity(taskInfo).build();
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
}
