{
  assertFunction("SLICE(ARRAY [1, 2, 3, 4, 5], 1, 4)",new ArrayType(BIGINT),ImmutableList.of(1L,2L,3L,4L));
  assertFunction("SLICE(ARRAY [1, 2], 1, 4)",new ArrayType(BIGINT),ImmutableList.of(1L,2L));
  assertFunction("SLICE(ARRAY [1, 2, 3, 4, 5], 3, 2)",new ArrayType(BIGINT),ImmutableList.of(3L,4L));
  assertFunction("SLICE(ARRAY ['1', '2', '3', '4'], 2, 1)",new ArrayType(createVarcharType(1)),ImmutableList.of("2"));
  assertFunction("SLICE(ARRAY [1, 2, 3, 4], 3, 3)",new ArrayType(BIGINT),ImmutableList.of(3L,4L));
  assertFunction("SLICE(ARRAY [1, 2, 3, 4], -3, 3)",new ArrayType(BIGINT),ImmutableList.of(2L,3L,4L));
  assertFunction("SLICE(ARRAY [1, 2, 3, 4], -3, 5)",new ArrayType(BIGINT),ImmutableList.of(2L,3L,4L));
  assertFunction("SLICE(ARRAY [1, 2, 3, 4], 1, 0)",new ArrayType(BIGINT),ImmutableList.of());
  assertFunction("SLICE(ARRAY [1, 2, 3, 4], -2, 0)",new ArrayType(BIGINT),ImmutableList.of());
  assertFunction("SLICE(ARRAY [ARRAY [1], ARRAY [2, 3], ARRAY [4, 5, 6]], 1, 2)",new ArrayType(new ArrayType(BIGINT)),ImmutableList.of(ImmutableList.of(1L),ImmutableList.of(2L,3L)));
  assertInvalidFunction("SLICE(ARRAY [1, 2, 3, 4], 1, -1)",INVALID_FUNCTION_ARGUMENT);
  assertInvalidFunction("SLICE(ARRAY [1, 2, 3, 4], 0, 1)",INVALID_FUNCTION_ARGUMENT);
}
