{
  this.operatorContext=checkNotNull(operatorContext,"operatorContext is null");
  this.lookupSourceSupplier=checkNotNull(lookupSourceSupplier,"lookupSourceSupplier is null");
  lookupSourceSupplier.retain();
  checkNotNull(probeTypes,"probeTypes is null");
  this.lookupSourceFuture=lookupSourceSupplier.getLookupSource(operatorContext);
  this.joinProbeFactory=joinProbeFactory;
  this.joinType=joinType;
  probeOnOuterSide=joinType == PROBE_OUTER || joinType == FULL_OUTER;
  lookupOnOuterSide=joinType == LOOKUP_OUTER || joinType == FULL_OUTER;
  this.types=ImmutableList.<Type>builder().addAll(probeTypes).addAll(lookupSourceSupplier.getTypes()).build();
  this.probeTypes=probeTypes;
  this.pageBuilder=new PageBuilder(types);
}
