{
  boolean finished=finishing && probe == null && pageBuilder.isEmpty() && (joinType != FULL_OUTER || (unvisitedJoinPositions != null && !unvisitedJoinPositions.hasNext()));
  if (finished) {
    if (lookupSource != null) {
      lookupSource.close();
      lookupSource=null;
    }
    probe=null;
    pageBuilder.reset();
  }
  return finished;
}
