{
  ImmutableMap.Builder<List<String>,TableMetadata> map=ImmutableMap.builder();
  for (  TableMetadata table : tables) {
    List<String> key=tableKey(table.getCatalogName(),table.getSchemaName(),table.getTableName());
    map.put(key,table);
  }
  return map.build();
}
