{
  BlockCursor values=block.cursor();
  for (int position=0; position < block.getPositionCount(); position++) {
    checkState(values.advanceNextPosition());
    if (!values.isNull()) {
      Slice slice=values.getSlice();
      long inputCount=slice.getLong(COUNT_OFFSET);
      long inputSamples=slice.getLong(SAMPLES_OFFSET);
      double inputMean=slice.getDouble(MEAN_OFFSET);
      double inputM2=slice.getDouble(M2_OFFSET);
      if (inputCount > 0) {
        long newCount=currentCount + inputCount;
        double newMean=((currentCount * currentMean) + (inputCount * inputMean)) / newCount;
        double delta=inputMean - currentMean;
        double newM2=currentM2 + inputM2 + ((delta * delta) * (currentCount * inputCount)) / newCount;
        currentCount=newCount;
        currentMean=newMean;
        currentM2=newM2;
        currentSamples+=inputSamples;
      }
    }
  }
  checkState(!values.advanceNextPosition());
}
