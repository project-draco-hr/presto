{
  this.operatorContext=checkNotNull(operatorContext,"operatorContext is null");
  checkNotNull(types,"types is null");
  checkArgument(markDistinctChannels.length >= 0,"markDistinctChannels is empty");
  this.sampleWeightChannel=sampleWeightChannel;
  this.markerChannel=types.size() - 1;
  ImmutableList.Builder<Type> markDistinctTypes=ImmutableList.builder();
  for (  int channel : markDistinctChannels) {
    markDistinctTypes.add(types.get(channel));
  }
  this.markDistinctHash=new MarkDistinctHash(markDistinctTypes.build(),markDistinctChannels);
  this.types=ImmutableList.copyOf(types);
  this.pageBuilder=new PageBuilder(types);
}
