{
  this.operatorContext=checkNotNull(operatorContext,"operatorContext is null");
  checkNotNull(tupleInfos,"tupleInfos is null");
  checkArgument(markDistinctChannels.length >= 0,"markDistinctChannels is empty");
  this.sampleWeightChannel=sampleWeightChannel;
  this.markerChannel=tupleInfos.size() - 1;
  ImmutableList.Builder<TupleInfo.Type> types=ImmutableList.builder();
  for (  int channel : markDistinctChannels) {
    types.add(tupleInfos.get(channel).getType());
  }
  this.markDistinctHash=new MarkDistinctHash(types.build(),markDistinctChannels,new HashMemoryManager(operatorContext));
  this.tupleInfos=tupleInfos;
  this.pageBuilder=new PageBuilder(tupleInfos);
}
