{
  checkState(!closed,"Factory is already closed");
  OperatorContext operatorContext=driverContext.addOperatorContext(operatorId,MarkDistinctOperator.class.getSimpleName());
  if (sampleWeightChannel.isPresent()) {
    return new MarkDistinctSampledOperator(operatorContext,types,markDistinctChannels,sampleWeightChannel.get());
  }
 else {
    return new MarkDistinctOperator(operatorContext,types,markDistinctChannels);
  }
}
