{
  Operator source=createOperator(new Page(BlockAssertions.createStringSequenceBlock(0,100),BlockAssertions.createLongSequenceBlock(0,100),BlockAssertions.createStringSequenceBlock(300,400)));
  AggregationOperator actual=new AggregationOperator(source,Step.SINGLE,ImmutableList.of(aggregation(COUNT,0),aggregation(LONG_SUM,1),aggregation(LONG_AVERAGE,1),aggregation(VAR_BINARY_MAX,2),aggregation(COUNT_COLUMN,0)));
  Page expectedPage=new Page(new BlockBuilder(SINGLE_LONG).append(100L).build(),new BlockBuilder(SINGLE_LONG).append(4950L).build(),new BlockBuilder(SINGLE_DOUBLE).append(49.5).build(),new BlockBuilder(SINGLE_VARBINARY).append("399").build(),new BlockBuilder(SINGLE_LONG).append(100L).build());
  PageIterator pages=actual.iterator(new OperatorStats());
  Page actualPage=pages.next();
  assertEquals(actualPage.getChannelCount(),5);
  PageAssertions.assertPageEquals(actualPage,expectedPage);
  assertFalse(pages.hasNext());
}
