{
  List<Page> input=rowPagesBuilder(VARCHAR,BIGINT,VARCHAR,BIGINT,DOUBLE,VARCHAR).addSequencePage(100,0,0,300,500,500,500).build();
  OperatorFactory operatorFactory=new AggregationOperatorFactory(0,Step.SINGLE,ImmutableList.of(aggregation(COUNT,ImmutableList.of(new Input(0)),Optional.<Input>absent(),Optional.<Input>absent(),1.0),aggregation(LONG_SUM,ImmutableList.of(new Input(1)),Optional.<Input>absent(),Optional.<Input>absent(),1.0),aggregation(LONG_AVERAGE,ImmutableList.of(new Input(1)),Optional.<Input>absent(),Optional.<Input>absent(),1.0),aggregation(VAR_BINARY_MAX,ImmutableList.of(new Input(2)),Optional.<Input>absent(),Optional.<Input>absent(),1.0),aggregation(COUNT_STRING_COLUMN,ImmutableList.of(new Input(0)),Optional.<Input>absent(),Optional.<Input>absent(),1.0),aggregation(LONG_SUM,ImmutableList.of(new Input(3)),Optional.<Input>absent(),Optional.<Input>absent(),1.0),aggregation(DOUBLE_SUM,ImmutableList.of(new Input(4)),Optional.<Input>absent(),Optional.<Input>absent(),1.0),aggregation(VAR_BINARY_MAX,ImmutableList.of(new Input(5)),Optional.<Input>absent(),Optional.<Input>absent(),1.0)));
  Operator operator=operatorFactory.createOperator(driverContext);
  MaterializedResult expected=resultBuilder(BIGINT,BIGINT,DOUBLE,VARCHAR,BIGINT,BIGINT,DOUBLE,VARCHAR).row(100,4950,49.5,"399",100,54950,54950.0,"599").build();
  assertOperatorEquals(operator,input,expected);
}
