{
  this.maxMemory=checkNotNull(maxMemory,"maxMemory is null");
  List<NewOperatorFactory> operators=newArrayList(operatorFactories);
  inMemoryExchange=new InMemoryExchange(Iterables.getLast(operators).getTupleInfos());
  operators.add(inMemoryExchange.createSinkFactory(99));
  inMemoryExchange.noMoreSinkFactories();
  driverFactories=ImmutableList.of(new DriverFactory(operators));
}
