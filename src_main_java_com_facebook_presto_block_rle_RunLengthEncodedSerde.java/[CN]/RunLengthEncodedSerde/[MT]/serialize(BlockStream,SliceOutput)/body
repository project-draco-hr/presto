{
  checkNotNull(blockStream,"blockStream is null");
  checkNotNull(sliceOutput,"sliceOutput is null");
  UncompressedTupleInfoSerde.serialize(blockStream.getTupleInfo(),sliceOutput);
  Cursor cursor=blockStream.cursor();
  if (!cursor.advanceNextValue()) {
    return;
  }
  long startPosition=cursor.getPosition();
  long endPosition=cursor.getCurrentValueEndPosition();
  Tuple lastTuple=cursor.getTuple();
  while (cursor.advanceNextValue()) {
    if (cursor.getPosition() != endPosition + 1 || !cursor.currentValueEquals(lastTuple)) {
      sliceOutput.writeLong(startPosition);
      sliceOutput.writeLong(endPosition);
      sliceOutput.writeBytes(lastTuple.getTupleSlice());
      lastTuple=cursor.getTuple();
      startPosition=cursor.getPosition();
    }
    endPosition=cursor.getCurrentValueEndPosition();
  }
  sliceOutput.writeLong(startPosition);
  sliceOutput.writeLong(endPosition);
  sliceOutput.writeBytes(lastTuple.getTupleSlice());
}
