{
  checkArgument(source.getChannelCount() == columnIds.size(),"channel count does not match columnId list");
  checkState(!shardExists(shardId),"shard %s has already been imported",shardId);
  List<File> files=stagingImport(shardId,columnIds,source);
  List<File> finalOutputFiles=optimizeEncodings(shardId,columnIds,files);
  commitShardColumns(shardId,columnIds,finalOutputFiles);
  deleteStagingDirectory(shardId);
}
