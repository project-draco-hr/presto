{
  ImmutableList.Builder<File> outputFilesBuilder=ImmutableList.builder();
  ImmutableList.Builder<BlockWriterFactory> writersBuilder=ImmutableList.builder();
  for (int channel=0; channel < source.getChannelCount(); channel++) {
    File outputFile=new File(createNewFileName(baseStagingDir,databaseName,tableName,shardId,channel,BlockSerdes.Encoding.RAW));
    Files.createParentDirs(outputFile);
    outputFilesBuilder.add(outputFile);
    writersBuilder.add(new SerdeBlockWriterFactory(UncompressedBlockSerde.INSTANCE,Files.newOutputStreamSupplier(outputFile)));
  }
  List<File> outputFiles=outputFilesBuilder.build();
  List<BlockWriterFactory> writers=writersBuilder.build();
  long rowCount=ImportingOperator.importData(source,writers);
  return new FilesAndRowCount(outputFiles,rowCount);
}
