{
  ImmutableList.Builder<File> outputFilesBuilder=ImmutableList.builder();
  ImmutableList.Builder<BlocksFileWriter> writersBuilder=ImmutableList.builder();
  for (int channel=0; channel < source.getChannelCount(); channel++) {
    File outputFile=new File(createNewFileName(baseStagingDir,databaseName,tableName,shardId,channel,BlocksFileEncoding.RAW));
    Files.createParentDirs(outputFile);
    outputFilesBuilder.add(outputFile);
    writersBuilder.add(new BlocksFileWriter(BlocksFileEncoding.RAW,Files.newOutputStreamSupplier(outputFile)));
  }
  List<File> outputFiles=outputFilesBuilder.build();
  List<BlocksFileWriter> writers=writersBuilder.build();
  long rowCount=ImportingOperator.importData(source,writers);
  return new FilesAndRowCount(outputFiles,rowCount);
}
