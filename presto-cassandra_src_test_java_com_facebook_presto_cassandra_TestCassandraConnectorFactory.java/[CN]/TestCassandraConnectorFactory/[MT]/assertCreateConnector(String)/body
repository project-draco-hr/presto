{
  String connectorId="cassandra-test-simulate";
  CassandraConnectorFactory connectorFactory=new CassandraConnectorFactory(connectorId,ImmutableMap.<String,String>builder().put("node.environment","test").put("cassandra.contact-points",contactPoints).build(),CassandraConnector.class.getClassLoader());
  Connector connector=connectorFactory.create(connectorId,ImmutableMap.<String,String>of());
  assertInstanceOf(connector.getService(ConnectorMetadata.class),ClassLoaderSafeConnectorMetadata.class);
  assertInstanceOf(connector.getService(ConnectorSplitManager.class),ClassLoaderSafeConnectorSplitManager.class);
  assertInstanceOf(connector.getService(ConnectorRecordSetProvider.class),ClassLoaderSafeConnectorRecordSetProvider.class);
  assertInstanceOf(connector.getService(ConnectorHandleResolver.class),ClassLoaderSafeConnectorHandleResolver.class);
}
