{
  checkArgument(name.getParts().size() <= 3,"too many dots in name: %s",name);
  List<String> parts=Lists.reverse(name.getParts());
  String tableName=parts.get(0);
  String schemaName=(parts.size() > 1) ? parts.get(1) : DEFAULT_SCHEMA;
  String catalogName=(parts.size() > 2) ? parts.get(2) : DEFAULT_CATALOG;
  TableMetadata table=metadata.getTable(catalogName,schemaName,tableName);
  checkArgument(table != null,"Table '%s.%s.%s' not defined",catalogName,schemaName,tableName);
  return table;
}
