{
  checkNotNull(tuples,"tuples is null");
  checkState(!finished,"already finished");
  for (  Tuple tuple : tuples) {
    if (encoding == null) {
      encoding=new RunLengthBlockEncoding(tuple.getTupleInfo());
      startPosition=0;
      tupleCount=1;
      lastTuple=tuple;
    }
 else {
      if (!tuple.equals(lastTuple)) {
        writeBlock();
        lastTuple=tuple;
      }
      tupleCount++;
    }
  }
  return this;
}
