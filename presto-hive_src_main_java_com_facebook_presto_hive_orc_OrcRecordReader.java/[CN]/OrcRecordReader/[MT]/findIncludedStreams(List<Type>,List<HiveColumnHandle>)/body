{
  boolean[] includes=new boolean[types.size()];
  Type root=types.get(0);
  List<Integer> included=Lists.transform(columns,HiveColumnHandle.hiveColumnIndexGetter());
  for (int i=0; i < root.getSubtypesCount(); ++i) {
    if (included.contains(i)) {
      includeStreamRecursive(types,includes,root.getSubtypes(i));
    }
  }
  return includes;
}
