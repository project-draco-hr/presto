{
  ImmutableMap.Builder<HiveColumnHandle,Integer> builder=ImmutableMap.builder();
  Type root=types.get(0);
  for (  HiveColumnHandle column : columns) {
    if (!column.isPartitionKey() && column.getHiveColumnIndex() < root.getSubtypesCount()) {
      builder.put(column,root.getSubtypes(column.getHiveColumnIndex()));
    }
  }
  return builder.build();
}
