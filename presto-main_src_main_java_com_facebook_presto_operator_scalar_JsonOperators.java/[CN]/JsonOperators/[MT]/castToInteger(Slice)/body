{
  try (JsonParser parser=JSON_FACTORY.createParser(json.getInput())){
    parser.nextToken();
    Long result;
switch (parser.getCurrentToken()) {
case VALUE_NULL:
      result=null;
    break;
case VALUE_STRING:
  result=VarcharOperators.castToInteger(Slices.utf8Slice(parser.getText()));
break;
case VALUE_NUMBER_FLOAT:
result=DoubleOperators.castToInteger(parser.getDoubleValue());
break;
case VALUE_NUMBER_INT:
result=(long)Math.toIntExact(parser.getLongValue());
break;
case VALUE_TRUE:
result=BooleanOperators.castToInteger(true);
break;
case VALUE_FALSE:
result=BooleanOperators.castToInteger(false);
break;
default :
throw new PrestoException(INVALID_CAST_ARGUMENT,format("Cannot cast '%s' to %s",json.toStringUtf8(),INTEGER));
}
checkCondition(parser.nextToken() == null,INVALID_CAST_ARGUMENT,"Cannot cast input json to INTEGER");
return result;
}
 catch (ArithmeticException|IOException e) {
throw new PrestoException(INVALID_CAST_ARGUMENT,format("Cannot cast '%s' to %s",json.toStringUtf8(),INTEGER));
}
}
