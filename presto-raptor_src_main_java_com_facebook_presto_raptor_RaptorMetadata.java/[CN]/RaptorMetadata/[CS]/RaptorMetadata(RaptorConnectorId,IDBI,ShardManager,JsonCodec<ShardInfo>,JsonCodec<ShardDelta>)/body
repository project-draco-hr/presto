{
  checkNotNull(connectorId,"connectorId is null");
  this.connectorId=connectorId.toString();
  this.dbi=checkNotNull(dbi,"dbi is null");
  this.dao=dbi.onDemand(MetadataDao.class);
  this.shardManager=checkNotNull(shardManager,"shardManager is null");
  this.shardInfoCodec=checkNotNull(shardInfoCodec,"shardInfoCodec is null");
  this.shardDeltaCodec=checkNotNull(shardDeltaCodec,"shardDeltaCodec is null");
  createMetadataTablesWithRetry(dao);
}
