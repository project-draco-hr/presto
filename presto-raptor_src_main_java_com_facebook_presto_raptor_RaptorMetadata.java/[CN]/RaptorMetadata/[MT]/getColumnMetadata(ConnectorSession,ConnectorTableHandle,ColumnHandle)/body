{
  long tableId=checkType(tableHandle,RaptorTableHandle.class,"tableHandle").getTableId();
  RaptorColumnHandle column=checkType(columnHandle,RaptorColumnHandle.class,"columnHandle");
  if (column.isShardRowId()) {
    return new ColumnMetadata(column.getColumnName(),column.getColumnType(),false,null,true);
  }
  long columnId=column.getColumnId();
  TableColumn tableColumn=dao.getTableColumn(tableId,columnId);
  if (tableColumn == null) {
    throw new PrestoException(NOT_FOUND,format("Column ID %s does not exist for table ID %s",columnId,tableId));
  }
  return tableColumn.toColumnMetadata();
}
