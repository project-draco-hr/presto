{
  ImmutableList.Builder<RaptorColumnHandle> columnHandles=ImmutableList.builder();
  ImmutableList.Builder<Type> columnTypes=ImmutableList.builder();
  long maxColumnId=0;
  for (  ColumnMetadata column : tableMetadata.getColumns()) {
    long columnId=column.getOrdinalPosition() + 1;
    maxColumnId=Math.max(maxColumnId,columnId);
    columnHandles.add(new RaptorColumnHandle(connectorId,column.getName(),columnId));
    columnTypes.add(column.getType());
  }
  RaptorColumnHandle sampleWeightColumnHandle=null;
  if (tableMetadata.isSampled()) {
    sampleWeightColumnHandle=new RaptorColumnHandle(connectorId,SAMPLE_WEIGHT_COLUMN_NAME,maxColumnId + 1);
    columnHandles.add(sampleWeightColumnHandle);
    columnTypes.add(BIGINT);
  }
  return new RaptorOutputTableHandle(tableMetadata.getTable().getSchemaName(),tableMetadata.getTable().getTableName(),columnHandles.build(),columnTypes.build(),sampleWeightColumnHandle);
}
