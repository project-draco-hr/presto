{
  ImmutableList.Builder<RaptorColumnHandle> columnHandles=ImmutableList.builder();
  ImmutableList.Builder<Type> columnTypes=ImmutableList.builder();
  long columnId=1;
  for (  ColumnMetadata column : tableMetadata.getColumns()) {
    columnHandles.add(new RaptorColumnHandle(connectorId,column.getName(),columnId,column.getType()));
    columnTypes.add(column.getType());
    columnId++;
  }
  RaptorColumnHandle sampleWeightColumnHandle=null;
  if (tableMetadata.isSampled()) {
    sampleWeightColumnHandle=new RaptorColumnHandle(connectorId,SAMPLE_WEIGHT_COLUMN_NAME,columnId,BIGINT);
    columnHandles.add(sampleWeightColumnHandle);
    columnTypes.add(BIGINT);
  }
  return new RaptorOutputTableHandle(tableMetadata.getTable().getSchemaName(),tableMetadata.getTable().getTableName(),columnHandles.build(),columnTypes.build(),sampleWeightColumnHandle,ImmutableList.of(),ImmutableList.of());
}
