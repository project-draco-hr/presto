{
  long tableId=checkType(tableHandle,RaptorTableHandle.class,"tableHandle").getTableId();
  ImmutableList.Builder<RaptorColumnHandle> columnHandles=ImmutableList.builder();
  ImmutableList.Builder<Type> columnTypes=ImmutableList.builder();
  for (  TableColumn column : dao.getTableColumns(tableId)) {
    columnHandles.add(new RaptorColumnHandle(connectorId,column.getColumnName(),column.getColumnId(),column.getDataType()));
    columnTypes.add(column.getDataType());
  }
  Optional<String> externalBatchId=getExternalBatchId(session);
  List<RaptorColumnHandle> sortColumnHandles=getSortColumnHandles(tableId);
  return new RaptorInsertTableHandle(connectorId,tableId,columnHandles.build(),columnTypes.build(),externalBatchId,sortColumnHandles,nCopies(sortColumnHandles.size(),ASC_NULLS_FIRST));
}
