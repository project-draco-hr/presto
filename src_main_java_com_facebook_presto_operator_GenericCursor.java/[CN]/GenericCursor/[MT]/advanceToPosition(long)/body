{
  Preconditions.checkArgument(!hasAdvanced || newPosition >= getPosition(),"Can't advance backwards");
  if (blockCursor == null) {
    return FINISHED;
  }
  if (hasAdvanced && newPosition == getPosition()) {
    return SUCCESS;
  }
  hasAdvanced=true;
  while (newPosition > blockCursor.getRange().getEnd() && iterator.canAdvance()) {
    blockCursor=iterator.next().cursor();
  }
  if (iterator.mustYield()) {
    return MUST_YIELD;
  }
  if (newPosition > blockCursor.getRange().getEnd()) {
    blockCursor=null;
    return FINISHED;
  }
  AdvanceResult result=blockCursor.advanceToPosition(newPosition);
  if (result == FINISHED) {
    throw new IllegalStateException("Internal error: position not found");
  }
  return result;
}
