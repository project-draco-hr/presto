{
  this.queryClient=checkNotNull(queryClient,"queryClient is null");
  QueryInfo queryInfo=waitForResults();
  Operator operator=queryClient.getResultsOperator();
  results=new ResultsIterator(operator);
  List<String> fieldNames=ImmutableList.copyOf(queryInfo.getFieldNames());
  List<TupleInfo.Type> fieldTypes=getFieldTypes(operator.getTupleInfos());
  fieldMap=getFieldMap(fieldNames);
  resultSetMetaData=new JdbcResultSetMetaData(getColumnInfo(fieldNames,fieldTypes));
}
