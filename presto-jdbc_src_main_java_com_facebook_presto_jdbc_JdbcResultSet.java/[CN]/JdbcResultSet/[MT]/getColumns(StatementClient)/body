{
  while (true) {
    List<Column> columns=client.current().getColumns();
    if (columns != null) {
      return columns;
    }
    if (!client.hasNext()) {
      QueryResults results=client.current();
      if (results.getError() == null) {
        throw new SQLException(format("Query has no columns (#%s)",results.getQueryId()));
      }
      throw resultsException(results);
    }
    client.next();
  }
}
