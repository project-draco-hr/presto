{
  checkOpenTransaction();
  ConnectorTransactionMetadata transactionMetadata=connectorIdToMetadata.get(connectorId);
  if (transactionMetadata == null) {
    transactionMetadata=new ConnectorTransactionMetadata(connectorId,connector,connector.beginTransaction(isolationLevel,readOnly));
    checkState(connectorIdToMetadata.put(connectorId,transactionMetadata) == null);
  }
  return transactionMetadata;
}
