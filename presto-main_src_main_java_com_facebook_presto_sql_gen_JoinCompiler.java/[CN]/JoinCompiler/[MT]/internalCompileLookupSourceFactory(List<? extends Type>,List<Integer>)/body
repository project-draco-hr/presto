{
  DynamicClassLoader classLoader=new DynamicClassLoader(getClass().getClassLoader());
  Class<? extends PagesHashStrategy> pagesHashStrategyClass=compilePagesHashStrategy(types.size(),joinChannels,classLoader);
  Class<? extends LookupSource> lookupSourceClass=IsolatedClass.isolateClass(classLoader,LookupSource.class,InMemoryJoinHash.class);
  return new LookupSourceFactory(lookupSourceClass,new PagesHashStrategyFactory(pagesHashStrategyClass));
}
