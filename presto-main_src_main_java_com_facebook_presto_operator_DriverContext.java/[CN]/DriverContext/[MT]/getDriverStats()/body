{
  long totalScheduledTime=processWallNanos.get();
  long totalCpuTime=processCpuNanos.get();
  long totalUserTime=processUserNanos.get();
  long totalBlockedTime=blockedWallNanos.get();
  BlockedMonitor blockedMonitor=this.blockedMonitor.get();
  if (blockedMonitor != null) {
    totalBlockedTime+=blockedMonitor.getBlockedTime();
  }
  List<OperatorStats> operators=ImmutableList.copyOf(transform(operatorContexts,operatorStatsGetter()));
  OperatorStats inputOperator=getFirst(operators,null);
  DataSize rawInputDataSize;
  long rawInputPositions;
  Duration rawInputReadTime;
  DataSize processedInputDataSize;
  long processedInputPositions;
  DataSize outputDataSize;
  long outputPositions;
  if (inputOperator != null) {
    rawInputDataSize=inputOperator.getInputDataSize();
    rawInputPositions=inputOperator.getInputPositions();
    rawInputReadTime=inputOperator.getAddInputWall();
    processedInputDataSize=inputOperator.getOutputDataSize();
    processedInputPositions=inputOperator.getOutputPositions();
    OperatorStats outputOperator=checkNotNull(getLast(operators,null));
    outputDataSize=outputOperator.getOutputDataSize();
    outputPositions=outputOperator.getOutputPositions();
  }
 else {
    rawInputDataSize=new DataSize(0,BYTE);
    rawInputPositions=0;
    rawInputReadTime=new Duration(0,MILLISECONDS);
    processedInputDataSize=new DataSize(0,BYTE);
    processedInputPositions=0;
    outputDataSize=new DataSize(0,BYTE);
    outputPositions=0;
  }
  long startNanos=this.startNanos.get();
  if (startNanos < createNanos) {
    startNanos=System.nanoTime();
  }
  Duration queuedTime=new Duration(startNanos - createNanos,NANOSECONDS);
  long endNanos=this.endNanos.get();
  Duration elapsedTime;
  if (endNanos >= startNanos) {
    elapsedTime=new Duration(endNanos - createNanos,NANOSECONDS);
  }
 else {
    elapsedTime=new Duration(0,NANOSECONDS);
  }
  return new DriverStats(createdTime,executionStartTime.get(),executionEndTime.get(),queuedTime.convertToMostSuccinctTimeUnit(),elapsedTime.convertToMostSuccinctTimeUnit(),new DataSize(memoryReservation.get(),BYTE).convertToMostSuccinctDataSize(),new Duration(totalScheduledTime,NANOSECONDS).convertToMostSuccinctTimeUnit(),new Duration(totalCpuTime,NANOSECONDS).convertToMostSuccinctTimeUnit(),new Duration(totalUserTime,NANOSECONDS).convertToMostSuccinctTimeUnit(),new Duration(totalBlockedTime,NANOSECONDS).convertToMostSuccinctTimeUnit(),rawInputDataSize.convertToMostSuccinctDataSize(),rawInputPositions,rawInputReadTime,processedInputDataSize.convertToMostSuccinctDataSize(),processedInputPositions,outputDataSize.convertToMostSuccinctDataSize(),outputPositions,ImmutableList.copyOf(transform(operatorContexts,operatorStatsGetter())));
}
