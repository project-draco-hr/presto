{
  this.addresses=checkNotNull(addresses,"addresses is null");
  this.pagesHashStrategy=checkNotNull(pagesHashStrategy,"pagesHashStrategy is null");
  this.channelCount=pagesHashStrategy.getChannelCount();
  checkNotNull(operatorContext,"operatorContext is null");
  int hashSize=HashCommon.arraySize(addresses.size(),0.75f);
  operatorContext.reserveMemory(sizeOfIntArray(hashSize) + sizeOfIntArray(addresses.size()));
  mask=hashSize - 1;
  key=new int[hashSize];
  Arrays.fill(key,-1);
  this.positionLinks=new int[addresses.size()];
  Arrays.fill(positionLinks,-1);
  for (int position=0; position < addresses.size(); position++) {
    int pos=(murmurHash3(hashPosition(position) ^ mask)) & mask;
    while (key[pos] != -1) {
      int currentKey=key[pos];
      if (positionEqualsPosition(currentKey,position)) {
        positionLinks[position]=currentKey;
        break;
      }
      pos=(pos + 1) & mask;
    }
    key[pos]=position;
  }
}
