{
  List<Page> input=rowPagesBuilder(BIGINT,VARCHAR,BIGINT,VARCHAR).pageBreak().row(1,"a",100,"A").pageBreak().row(2,"a",100,"A").pageBreak().row(2,"b",102,"A").row(2,"b",101,"A").row(2,"b",100,"B").row(1,"b",101,"A").pageBreak().row(1,"b",100,"A").row(3,"c",100,"A").build();
  WindowOperatorFactory operatorFactory=createFactoryUnbounded(ImmutableList.of(BIGINT,VARCHAR,BIGINT,VARCHAR),Ints.asList(0,1,2,3),ROW_NUMBER,Ints.asList(1,0),Ints.asList(0,1),Ints.asList(3,2),ImmutableList.of(SortOrder.ASC_NULLS_LAST,SortOrder.ASC_NULLS_LAST),1);
  Operator operator=operatorFactory.createOperator(driverContext);
  MaterializedResult expected=resultBuilder(driverContext.getSession(),BIGINT,VARCHAR,BIGINT,VARCHAR,BIGINT).row(1,"a",100,"A",1).row(2,"a",100,"A",1).row(2,"b",101,"A",1).row(2,"b",102,"A",2).row(2,"b",100,"B",3).row(1,"b",100,"A",1).row(1,"b",101,"A",2).row(3,"c",100,"A",1).build();
  assertOperatorEqualsIgnoreOrder(operator,input,expected);
}
