{
  PrePartitionedWindowOperatorFactory operatorFactory=new PrePartitionedWindowOperatorFactory(0,ImmutableList.of(VARCHAR,BIGINT,DOUBLE,BOOLEAN),Ints.asList(0,1,2,3),ROW_NUMBER,Ints.asList(0),Ints.asList(1),ImmutableList.copyOf(new SortOrder[]{SortOrder.ASC_NULLS_LAST}),new FrameInfo(RANGE,UNBOUNDED_PRECEDING,Optional.empty(),UNBOUNDED_FOLLOWING,Optional.empty()),10);
  Operator operator=operatorFactory.createOperator(driverContext);
  MaterializedResult expected=resultBuilder(driverContext.getSession(),VARCHAR,BIGINT,DOUBLE,BOOLEAN,BIGINT).row("a",2,0.3,false,1).row("a",4,0.2,true,2).row("a",6,0.1,true,3).row("b",-1,-0.1,true,1).row("b",5,0.4,false,2).row("c",12,0.3,false,1).row("c",14,0.2,true,2).row("c",16,0.1,true,3).row("d",-11,-0.1,true,1).row("d",15,0.4,false,2).build();
  assertOperatorEquals(operator,input,expected);
}
