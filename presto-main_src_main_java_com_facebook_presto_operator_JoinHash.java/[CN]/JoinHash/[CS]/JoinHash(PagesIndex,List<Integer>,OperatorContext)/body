{
  this.pagesIndex=pagesIndex;
  this.hashStrategy=new PagesHashStrategy(pagesIndex,hashChannels);
  this.addressToPositionMap=new AddressToPositionMap(pagesIndex.getPositionCount(),hashStrategy);
  this.positionLinks=new IntArrayList(new int[pagesIndex.getPositionCount()]);
  Arrays.fill(positionLinks.elements(),-1);
  for (int position=0; position < pagesIndex.getPositionCount(); position++) {
    operatorContext.setMemoryReservation(getEstimatedSize());
    int oldPosition=addressToPositionMap.put(position,position);
    if (oldPosition >= 0) {
      positionLinks.set(position,oldPosition);
    }
  }
}
