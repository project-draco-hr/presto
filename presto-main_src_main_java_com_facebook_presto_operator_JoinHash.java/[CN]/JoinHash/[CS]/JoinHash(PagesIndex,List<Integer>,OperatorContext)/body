{
  this.pagesIndex=pagesIndex;
  this.hashChannels=Ints.toArray(hashChannels);
  int positionCount=pagesIndex.getPositionCount();
  int hashSize=HashCommon.arraySize(positionCount,0.75f);
  operatorContext.reserveMemory(sizeOfIntArray(hashSize) + sizeOfIntArray(positionCount));
  mask=hashSize - 1;
  key=new int[hashSize];
  Arrays.fill(key,-1);
  this.positionLinks=new int[positionCount];
  Arrays.fill(positionLinks,-1);
  for (int position=0; position < positionCount; position++) {
    add(position);
  }
}
