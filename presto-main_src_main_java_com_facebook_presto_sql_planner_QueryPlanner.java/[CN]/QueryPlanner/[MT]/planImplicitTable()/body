{
  QualifiedTableName name=MetadataUtil.createQualifiedTableName(session,QualifiedName.of("dual"));
  Optional<TableHandle> optionalHandle=metadata.getTableHandle(name);
  checkState(optionalHandle.isPresent(),"Dual table provider not installed");
  TableHandle table=optionalHandle.get();
  TableMetadata tableMetadata=metadata.getTableMetadata(table);
  Map<String,ColumnHandle> columnHandles=metadata.getColumnHandles(table);
  checkState(!metadata.getSampleWeightColumnHandle(table).isPresent(),"dual table should not have a sample weight");
  ImmutableMap.Builder<Symbol,ColumnHandle> columns=ImmutableMap.builder();
  for (  ColumnMetadata column : tableMetadata.getColumns()) {
    Symbol symbol=symbolAllocator.newSymbol(column.getName(),Type.fromRaw(column.getType()));
    columns.put(symbol,columnHandles.get(column.getName()));
  }
  ImmutableMap<Symbol,ColumnHandle> assignments=columns.build();
  PlanNode node=new TableScanNode(idAllocator.getNextId(),table,ImmutableList.copyOf(assignments.keySet()),assignments,null,Optional.<GeneratedPartitions>absent());
  return new RelationPlan(node,new TupleDescriptor(),ImmutableList.<Symbol>of());
}
