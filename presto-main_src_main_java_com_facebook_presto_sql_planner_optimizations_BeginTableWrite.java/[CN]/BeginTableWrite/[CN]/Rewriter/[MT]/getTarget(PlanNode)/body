{
  if (node instanceof TableWriterNode) {
    return ((TableWriterNode)node).getTarget();
  }
  if (node instanceof DeleteNode) {
    return ((DeleteNode)node).getTarget();
  }
  if (node instanceof ExchangeNode) {
    PlanNode source=Iterables.getOnlyElement(node.getSources());
    return getTarget(source);
  }
  throw new IllegalArgumentException("Invalid child for TableCommitNode: " + node.getClass().getSimpleName());
}
