{
  if (node instanceof TableScanNode) {
    TableScanNode scan=(TableScanNode)node;
    return new TableScanNode(scan.getId(),handle,scan.getOutputSymbols(),scan.getAssignments(),scan.getLayout(),scan.getCurrentConstraint(),scan.getOriginalConstraint());
  }
  if (node instanceof FilterNode) {
    PlanNode source=rewriteDeleteTableScan(((FilterNode)node).getSource(),handle,context);
    return context.replaceChildren(node,ImmutableList.of(source));
  }
  if (node instanceof ProjectNode) {
    PlanNode source=rewriteDeleteTableScan(((ProjectNode)node).getSource(),handle,context);
    return context.replaceChildren(node,ImmutableList.of(source));
  }
  if (node instanceof SemiJoinNode) {
    PlanNode source=rewriteDeleteTableScan(((SemiJoinNode)node).getSource(),handle,context);
    return context.replaceChildren(node,ImmutableList.of(source,((SemiJoinNode)node).getFilteringSource()));
  }
  throw new IllegalArgumentException("Invalid descendant for DeleteNode: " + node.getClass().getName());
}
