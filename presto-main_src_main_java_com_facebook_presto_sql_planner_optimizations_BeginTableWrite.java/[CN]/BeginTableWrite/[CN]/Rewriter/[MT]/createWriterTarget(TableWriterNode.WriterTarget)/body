{
  if (target instanceof TableWriterNode.CreateName) {
    TableWriterNode.CreateName create=(TableWriterNode.CreateName)target;
    return new TableWriterNode.CreateHandle(metadata.beginCreateTable(session,create.getCatalog(),create.getTableMetadata()));
  }
  if (target instanceof TableWriterNode.InsertReference) {
    TableWriterNode.InsertReference insert=(TableWriterNode.InsertReference)target;
    return new TableWriterNode.InsertHandle(metadata.beginInsert(session,insert.getHandle()));
  }
  throw new IllegalArgumentException("Unhandled target type: " + target.getClass().getSimpleName());
}
