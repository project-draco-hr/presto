{
  PlanNode child=node.getSource().accept(this,context);
  TableWriterNode.WriterTarget target;
  if (child instanceof TableWriterNode) {
    target=((TableWriterNode)child).getTarget();
  }
 else   if (child instanceof DeleteNode) {
    target=((DeleteNode)child).getTarget();
  }
 else {
    throw new IllegalArgumentException("Invalid child for TableCommitNode: " + child.getClass().getSimpleName());
  }
  return new TableCommitNode(node.getId(),child,target,node.getOutputSymbols());
}
