{
  Slice[] expectedValues=createExpectedValues(3);
  int[] ids=new int[]{0,2,1,0,0,0,1,1,1,0,1,2};
  boolean[] isNull=new boolean[ids.length];
  isNull[2]=true;
  LazyBlockLoader<LazySliceArrayBlock> loader=new TestDictionaryLazySliceArrayBlockLoader(expectedValues,ids,isNull);
  LazySliceArrayBlock block=new LazySliceArrayBlock(ids.length,loader);
  Block region=block.getRegion(0,3);
  assertFalse(region.isNull(0));
  assertFalse(region.isNull(1));
  assertTrue(region.isNull(2));
  assertTrue(region instanceof DictionaryBlock);
  DictionaryBlock dictionaryBlock=(DictionaryBlock)region;
  assertEquals(((SliceArrayBlock)dictionaryBlock.getDictionary()).getValues(),new Slice[]{expectedValues[0],expectedValues[2],null});
  assertEquals(dictionaryBlock.getIds(),Slices.wrappedIntArray(0,1,2));
}
