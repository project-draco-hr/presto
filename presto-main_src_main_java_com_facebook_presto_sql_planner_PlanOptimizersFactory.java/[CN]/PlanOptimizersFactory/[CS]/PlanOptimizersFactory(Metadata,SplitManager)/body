{
  this.metadata=checkNotNull(metadata,"metadata is null");
  ImmutableList.Builder<PlanOptimizer> builder=ImmutableList.builder();
  builder.add(new ImplementSampleAsFilter(),new SimplifyExpressions(metadata),new UnaliasSymbolReferences(),new PruneRedundantProjections(),new SetFlatteningOptimizer(),new LimitPushDown(),new PredicatePushDown(metadata,splitManager),new PredicatePushDown(metadata,splitManager),new MergeProjections(),new SimplifyExpressions(metadata),new UnaliasSymbolReferences(),new PruneRedundantProjections(),new PruneUnreferencedOutputs());
  this.optimizers=builder.build();
}
