{
  ByteCodeNode first=process(node.getFirst(),context);
  Type firstType=expressionTypes.get(node.getFirst());
  ByteCodeNode second=process(node.getSecond(),context);
  LabelNode notMatch=new LabelNode("notMatch");
  Block block=new Block(context).comment(node.toString()).append(first).append(ifWasNullPopAndGoto(context,notMatch,void.class));
  FunctionBinding functionBinding=bootstrapFunctionBinder.bindOperator(OperatorType.EQUAL,getSessionByteCode,ImmutableList.of(new Block(context).dup(firstType.getJavaType()),second),types(node.getFirst(),node.getSecond()));
  ByteCodeNode equalsCall=visitFunctionBinding(context,functionBinding,"equal");
  Block conditionBlock=new Block(context).append(equalsCall).append(ifWasNullClearPopAndGoto(context,notMatch,void.class,boolean.class));
  Block trueBlock=new Block(context).putVariable("wasNull",true).pop(firstType.getJavaType()).pushJavaDefault(firstType.getJavaType());
  block.append(new IfStatement(context,conditionBlock,trueBlock,notMatch));
  return block;
}
