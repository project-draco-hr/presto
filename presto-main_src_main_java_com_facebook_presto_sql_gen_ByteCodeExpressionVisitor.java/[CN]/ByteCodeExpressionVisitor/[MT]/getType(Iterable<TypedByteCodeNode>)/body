{
  Set<Class<?>> types=IterableTransformer.on(nodes).transform(nodeTypeGetter()).select(not(Predicates.<Class<?>>equalTo(void.class))).set();
  if (types.isEmpty()) {
    return void.class;
  }
  if (types.equals(ImmutableSet.of(double.class,long.class))) {
    return double.class;
  }
  checkState(types.size() == 1,"Expected only one type but found %s",types);
  return Iterables.getOnlyElement(types);
}
