{
  Set<Split> splits=new HashSet<>();
  for (int i=0; i < 3; i++) {
    splits.add(new Split("foo",TestingTransactionHandle.create("foo"),new TestSplitRemote()));
  }
  Multimap<Node,Split> assignments=nodeSelector.computeAssignments(splits,ImmutableList.copyOf(taskMap.values()));
  assertEquals(assignments.entries().size(),3);
  for (  Node node : nodeManager.getActiveDatasourceNodes("foo")) {
    assertTrue(assignments.keySet().contains(node));
  }
}
