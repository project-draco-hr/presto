{
  NodeScheduler.NodeSelector nodeSelector=nodeScheduler.createNodeSelector(datasource);
  Multimap<Node,Split> splitAssignment=nodeSelector.computeAssignments(ImmutableSet.copyOf(getSplits(15)));
  assertEquals(splitAssignment.asMap().size(),3);
  for (  Map.Entry<Node,Collection<Split>> entry : splitAssignment.asMap().entrySet()) {
    assertEquals(entry.getValue().size(),5);
  }
}
