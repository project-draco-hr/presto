{
  MockRemoteTaskFactory remoteTaskFactory=new MockRemoteTaskFactory(remoteTaskExecutor);
  Node chosenNode=Iterables.get(nodeManager.getActiveDatasourceNodes("foo"),0);
  RemoteTask remoteTask=remoteTaskFactory.createTableScanTask(chosenNode,ImmutableList.of(new Split("foo",new TestSplitRemote()),new Split("bar",new TestSplitRemote())),nodeTaskMap.getSplitCountChangeListener(chosenNode));
  RemoteTask remoteTask2=remoteTaskFactory.createTableScanTask(chosenNode,ImmutableList.of(new Split("foo2",new TestSplitRemote())),nodeTaskMap.getSplitCountChangeListener(chosenNode));
  nodeTaskMap.addTask(chosenNode,remoteTask);
  nodeTaskMap.addTask(chosenNode,remoteTask2);
  assertEquals(nodeTaskMap.getPartitionedSplitsOnNode(chosenNode),3);
  remoteTask.abort();
  assertEquals(nodeTaskMap.getPartitionedSplitsOnNode(chosenNode),1);
  remoteTask2.abort();
  assertEquals(nodeTaskMap.getPartitionedSplitsOnNode(chosenNode),0);
}
