{
  MockRemoteTaskFactory remoteTaskFactory=new MockRemoteTaskFactory(remoteTaskExecutor);
  Node chosenNode=Iterables.get(nodeManager.getActiveDatasourceNodes("foo"),0);
  TaskId taskId=new TaskId(new StageId("test","1"),"1");
  RemoteTask remoteTask=remoteTaskFactory.createTableScanTask(taskId,chosenNode,ImmutableList.of(new Split("foo",TestingTransactionHandle.create("foo"),new TestSplitRemote())),nodeTaskMap.createPartitionedSplitCountTracker(chosenNode,taskId));
  nodeTaskMap.addTask(chosenNode,remoteTask);
  assertEquals(nodeTaskMap.getPartitionedSplitsOnNode(chosenNode),1);
  remoteTask.abort();
  TimeUnit.MILLISECONDS.sleep(100);
  assertEquals(nodeTaskMap.getPartitionedSplitsOnNode(chosenNode),0);
  remoteTask.abort();
  assertEquals(nodeTaskMap.getPartitionedSplitsOnNode(chosenNode),0);
}
