{
  ImmutableList.Builder<Node> nodeBuilder=ImmutableList.builder();
  nodeBuilder.add(new PrestoNode("other1",URI.create("http://127.0.0.1:11"),NodeVersion.UNKNOWN));
  nodeBuilder.add(new PrestoNode("other2",URI.create("http://127.0.0.1:12"),NodeVersion.UNKNOWN));
  nodeBuilder.add(new PrestoNode("other3",URI.create("http://127.0.0.1:13"),NodeVersion.UNKNOWN));
  ImmutableList<Node> nodes=nodeBuilder.build();
  this.nodeManager=new InMemoryNodeManager();
  nodeManager.addNode(datasource,nodes);
  this.nodeTaskMap=new NodeTaskMap();
  NodeSchedulerConfig nodeSchedulerConfig=new NodeSchedulerConfig().setMaxSplitsPerNode(30);
  this.nodeScheduler=new NodeScheduler(nodeManager,nodeSchedulerConfig,nodeTaskMap);
  metadata=new MetadataManager();
  metadata.addInternalSchemaMetadata(MetadataManager.INTERNAL_CONNECTOR_ID,new DualMetadata());
}
