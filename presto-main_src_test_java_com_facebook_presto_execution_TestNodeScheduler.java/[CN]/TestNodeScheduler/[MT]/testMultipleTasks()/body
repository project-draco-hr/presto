{
  ExecutorService remoteTaskExecutor=Executors.newCachedThreadPool(Threads.daemonThreadsNamed("remoteTaskExecutor"));
  MockRemoteTaskFactory taskFactory=new MockRemoteTaskFactory(remoteTaskExecutor);
  Node additionalNode=new PrestoNode("other4",URI.create("http://127.0.0.1:14"),NodeVersion.UNKNOWN);
  nodeManager.addNode(datasource,additionalNode);
  StageExecutionPlan tableScanPlan=TestSqlStageExecution.createTableScanPlan("test",datasource,metadata,0);
  RemoteTask task1=createRemoteTask(taskFactory,tableScanPlan,"query_1",additionalNode,5);
  nodeTaskMap.addTask(additionalNode,task1);
  RemoteTask task2=createRemoteTask(taskFactory,tableScanPlan,"query_2",additionalNode,10);
  nodeTaskMap.addTask(additionalNode,task2);
  assertEquals(nodeTaskMap.getPartitionedSplitsOnNode(additionalNode),15);
}
