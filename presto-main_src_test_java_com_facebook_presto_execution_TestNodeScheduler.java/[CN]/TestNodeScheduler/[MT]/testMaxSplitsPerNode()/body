{
  Node newNode=new PrestoNode("other4",URI.create("http://127.0.0.1:14"),NodeVersion.UNKNOWN);
  nodeManager.addNode("foo",newNode);
  ImmutableList.Builder<Split> initialSplits=ImmutableList.builder();
  for (int i=0; i < 10; i++) {
    initialSplits.add(new Split("foo",new TestSplitRemote()));
  }
  MockRemoteTaskFactory remoteTaskFactory=new MockRemoteTaskFactory(remoteTaskExecutor);
  RemoteTask remoteTask1=remoteTaskFactory.createTableScanTask(newNode,initialSplits.build(),nodeTaskMap.getSplitCountChangeListener(newNode));
  nodeTaskMap.addTask(newNode,remoteTask1);
  RemoteTask remoteTask2=remoteTaskFactory.createTableScanTask(newNode,initialSplits.build(),nodeTaskMap.getSplitCountChangeListener(newNode));
  nodeTaskMap.addTask(newNode,remoteTask2);
  Set<Split> splits=new HashSet<>();
  for (int i=0; i < 5; i++) {
    splits.add(new Split("foo",new TestSplitRemote()));
  }
  Multimap<Node,Split> assignments=nodeSelector.computeAssignments(splits,taskMap.values());
  assertFalse(assignments.keySet().contains(newNode));
}
