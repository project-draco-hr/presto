{
  Preconditions.checkNotNull(tuples,"tuples is null");
  Preconditions.checkState(!finished,"already finished");
  for (  Tuple tuple : tuples) {
    if (lastTuple == null) {
      lastTuple=tuple;
      if (set.size() < MAX_UNIQUE_COUNT) {
        set.add(lastTuple);
      }
    }
 else     if (!tuple.equals(lastTuple)) {
      runsCount++;
      lastTuple=tuple;
      if (set.size() < MAX_UNIQUE_COUNT) {
        set.add(lastTuple);
      }
    }
    rowCount++;
  }
}
