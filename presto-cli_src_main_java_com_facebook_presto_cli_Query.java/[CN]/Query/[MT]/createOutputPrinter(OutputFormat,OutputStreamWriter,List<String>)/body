{
switch (outputFormat) {
case CSV:
    return new CsvPrinter(fieldNames,writer,',',false);
case CSV_HEADER:
  return new CsvPrinter(fieldNames,writer,',',true);
case TSV:
return new CsvPrinter(fieldNames,writer,'\t',false);
case TSV_HEADER:
return new CsvPrinter(fieldNames,writer,'\t',true);
}
throw new RuntimeException(outputFormat + " not supported");
}
