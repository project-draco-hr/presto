{
switch (format) {
case ALIGNED:
    return new AlignedTuplePrinter(fieldNames,writer);
case VERTICAL:
  return new VerticalTuplePrinter(fieldNames,writer);
case CSV:
return new CsvPrinter(fieldNames,writer,',',false);
case CSV_HEADER:
return new CsvPrinter(fieldNames,writer,',',true);
case TSV:
return new CsvPrinter(fieldNames,writer,'\t',false);
case TSV_HEADER:
return new CsvPrinter(fieldNames,writer,'\t',true);
}
throw new RuntimeException(format + " not supported");
}
