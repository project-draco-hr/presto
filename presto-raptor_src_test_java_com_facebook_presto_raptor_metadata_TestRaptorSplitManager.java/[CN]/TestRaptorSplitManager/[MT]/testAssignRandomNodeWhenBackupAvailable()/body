{
  InMemoryNodeManager nodeManager=new InMemoryNodeManager();
  PrestoNode node=new PrestoNode(UUID.randomUUID().toString(),new URI("http://127.0.0.1/"),NodeVersion.UNKNOWN);
  nodeManager.addNode("fbraptor",node);
  RaptorSplitManager raptorSplitManagerWithBackup=new RaptorSplitManager(new RaptorConnectorId("fbraptor"),nodeManager,shardManager,storageManagerWithBackup);
  dummyHandle.execute("DELETE FROM shard_nodes");
  ConnectorPartitionResult result=raptorSplitManagerWithBackup.getPartitions(tableHandle,TupleDomain.<ConnectorColumnHandle>all());
  ConnectorSplitSource partitionSplit=raptorSplitManagerWithBackup.getPartitionSplits(tableHandle,result.getPartitions());
  assertEquals(Iterables.getOnlyElement(Iterables.getOnlyElement(partitionSplit.getNextBatch(1)).getAddresses()),node.getHostAndPort());
}
