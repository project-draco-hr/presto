{
  InMemoryNodeManager nodeManager=new InMemoryNodeManager();
  PrestoNode node=new PrestoNode(UUID.randomUUID().toString(),new URI("http://127.0.0.1/"),NodeVersion.UNKNOWN);
  nodeManager.addNode("fbraptor",node);
  RaptorSplitManager raptorSplitManagerWithBackup=new RaptorSplitManager(new RaptorConnectorId("fbraptor"),nodeManager,shardManager,storageManagerWithBackup);
  deleteShardNodes();
  ConnectorPartitionResult result=raptorSplitManagerWithBackup.getPartitions(tableHandle,TupleDomain.<ColumnHandle>all());
  ConnectorSplitSource partitionSplit=raptorSplitManagerWithBackup.getPartitionSplits(tableHandle,result.getPartitions());
  List<ConnectorSplit> batch=getFutureValue(partitionSplit.getNextBatch(1),PrestoException.class);
  assertEquals(getOnlyElement(getOnlyElement(batch).getAddresses()),node.getHostAndPort());
}
