{
  InMemoryNodeManager nodeManager=new InMemoryNodeManager();
  PrestoNode node=new PrestoNode(UUID.randomUUID().toString(),new URI("http://127.0.0.1/"),NodeVersion.UNKNOWN);
  nodeManager.addNode("fbraptor",node);
  RaptorSplitManager raptorSplitManagerWithBackup=new RaptorSplitManager(new RaptorConnectorId("fbraptor"),nodeManager,shardManager,true);
  deleteShardNodes();
  ConnectorTableLayoutResult layout=getOnlyElement(metadata.getTableLayouts(SESSION,tableHandle,Constraint.alwaysTrue(),Optional.empty()));
  ConnectorSplitSource partitionSplit=raptorSplitManagerWithBackup.getSplits(SESSION,layout.getTableLayout().getHandle());
  List<ConnectorSplit> batch=getFutureValue(partitionSplit.getNextBatch(1),PrestoException.class);
  assertEquals(getOnlyElement(getOnlyElement(batch).getAddresses()),node.getHostAndPort());
}
