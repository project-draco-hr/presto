{
  ConnectorPartitionResult partitionResult=raptorSplitManager.getPartitions(tableHandle,TupleDomain.<ConnectorColumnHandle>all());
  assertEquals(partitionResult.getPartitions().size(),1);
  assertTrue(partitionResult.getUndeterminedTupleDomain().isAll());
  List<ConnectorPartition> partitions=partitionResult.getPartitions();
  ConnectorPartition partition=Iterables.getOnlyElement(partitions);
  TupleDomain<ConnectorColumnHandle> columnUnionedTupleDomain=TupleDomain.columnWiseUnion(partition.getTupleDomain(),partition.getTupleDomain());
  assertEquals(columnUnionedTupleDomain,TupleDomain.<ConnectorColumnHandle>all());
  ConnectorSplitSource splitSource=raptorSplitManager.getPartitionSplits(tableHandle,partitions);
  int splitCount=0;
  while (!splitSource.isFinished()) {
    splitCount+=splitSource.getNextBatch(1000).size();
  }
  assertEquals(splitCount,4);
}
