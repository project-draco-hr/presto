{
  String scheme=Strings.nullToEmpty(path.toUri().getScheme()).toLowerCase();
  String authority=Strings.nullToEmpty(path.toUri().getAuthority()).toLowerCase();
  String fsType=scheme.isEmpty() ? null : conf.get("fs." + scheme + ".impl");
  return new FileSystemKey(fsType,scheme,authority);
}
