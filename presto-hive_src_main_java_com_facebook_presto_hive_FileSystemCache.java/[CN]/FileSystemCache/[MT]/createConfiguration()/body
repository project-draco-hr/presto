{
  Configuration config=new Configuration();
  config.setClass("topology.node.switch.mapping.impl",NoOpDNSwitchMapping.class,DNSToSwitchMapping.class);
  if (socksProxy != null) {
    config.setClass("hadoop.rpc.socket.factory.class.default",SocksSocketFactory.class,SocketFactory.class);
    config.set("hadoop.socks.server",socksProxy.toString());
  }
  return config;
}
