{
  Configuration config=new Configuration();
  config.setClass("topology.node.switch.mapping.impl",NoOpDNSwitchMapping.class,DNSToSwitchMapping.class);
  if (socksProxy != null) {
    config.setClass("hadoop.rpc.socket.factory.class.default",SocksSocketFactory.class,SocketFactory.class);
    config.set("hadoop.socks.server",socksProxy.toString());
  }
  config.setBoolean("dfs.read.shortcircuit",true);
  config.setBoolean("dfs.read.shortcircuit.fallbackwhenfail",true);
  config.setInt("dfs.socket.timeout",Ints.saturatedCast((long)dfsTimeout.toMillis()));
  config.setInt("ipc.ping.interval",Ints.saturatedCast((long)dfsTimeout.toMillis()));
  return config;
}
