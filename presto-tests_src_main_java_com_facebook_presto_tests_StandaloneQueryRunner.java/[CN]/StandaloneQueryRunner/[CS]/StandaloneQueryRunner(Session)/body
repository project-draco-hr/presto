{
  checkNotNull(defaultSession,"defaultSession is null");
  try {
    server=createTestingPrestoServer();
  }
 catch (  Exception e) {
    close();
    throw e;
  }
  this.prestoClient=new TestingPrestoClient(server,defaultSession);
  refreshNodes();
  server.getMetadata().addFunctions(AbstractTestQueries.CUSTOM_FUNCTIONS);
}
