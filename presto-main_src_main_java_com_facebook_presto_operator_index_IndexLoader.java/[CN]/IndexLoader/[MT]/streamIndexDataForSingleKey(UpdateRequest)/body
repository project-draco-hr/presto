{
  Page indexKeyTuple=new Page(sliceBlocks(updateRequest.getBlocks(),0,1));
  PageBuffer pageBuffer=new PageBuffer(100);
  DriverFactory driverFactory=indexBuildDriverFactoryProvider.createStreaming(pageBuffer,indexKeyTuple);
  Driver driver=driverFactory.createDriver(pipelineContext.addDriverContext());
  PageRecordSet pageRecordSet=new PageRecordSet(keyTypes,indexKeyTuple);
  PlanNodeId planNodeId=Iterables.getOnlyElement(driverFactory.getSourceIds());
  driver.updateSource(new TaskSource(planNodeId,ImmutableSet.of(new ScheduledSplit(0,new Split("index",new TransactionHandle("index",new ConnectorTransactionHandle(){
  }
),new IndexSplit(pageRecordSet)))),true));
  return new StreamingIndexedData(outputTypes,keyTypes,indexKeyTuple,pageBuffer,driver);
}
