{
  this.driverFactory=driverFactory;
  this.pipelineContext=pipelineContext;
  this.sourcePlanNodeId=sourcePlanNodeId;
  this.indexChannels=indexChannels;
  OperatorContext snapshotOperatorContext=pipelineContext.addDriverContext().addOperatorContext(snapshotOperatorId,IndexLoader.class.getSimpleName());
  this.pagesIndex=new PagesIndex(pagesIndexOutput.getTypes(),expectedPositions,snapshotOperatorContext);
  pagesIndexOutput.setPagesIndex(pagesIndex);
  ImmutableList.Builder<Type> missingKeysTypes=ImmutableList.builder();
  ImmutableList.Builder<Integer> missingKeysChannels=ImmutableList.builder();
  for (int i=0; i < indexChannels.size(); i++) {
    Integer outputIndexChannel=indexChannels.get(i);
    missingKeysTypes.add(pagesIndexOutput.getTypes().get(outputIndexChannel));
    missingKeysChannels.add(i);
  }
  this.missingKeysIndex=new PagesIndex(missingKeysTypes.build(),expectedPositions,snapshotOperatorContext);
  this.missingKeysChannels=missingKeysChannels.build();
  this.missingKeys=new EmptyLookupSource(indexChannels.size());
}
