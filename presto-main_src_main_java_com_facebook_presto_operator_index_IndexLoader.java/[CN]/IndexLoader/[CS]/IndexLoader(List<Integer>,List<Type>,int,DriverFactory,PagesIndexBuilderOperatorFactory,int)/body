{
  checkArgument(!indexChannels.isEmpty(),"indexChannels must not be empty");
  this.indexChannels=ImmutableList.copyOf(checkNotNull(indexChannels,"indexChannels is null"));
  this.outputTypes=ImmutableList.copyOf(checkNotNull(types,"types is null"));
  this.snapshotOperatorId=snapshotOperatorId;
  this.driverFactory=checkNotNull(driverFactory,"driverFactory is null");
  this.sourcePlanNodeId=Iterables.getOnlyElement(driverFactory.getSourceIds());
  this.pagesIndexOutput=checkNotNull(pagesIndexOutput,"pagesIndexOutput is null");
  this.expectedPositions=checkNotNull(expectedPositions,"expectedPositions is null");
  ImmutableList.Builder<Type> typeBuilder=ImmutableList.builder();
  for (  Integer outputIndexChannel : indexChannels) {
    typeBuilder.add(types.get(outputIndexChannel));
  }
  indexTypes=typeBuilder.build();
  indexSnapshot=new IndexSnapshot(new EmptyLookupSource(types.size()),new EmptyLookupSource(indexChannels.size()));
}
