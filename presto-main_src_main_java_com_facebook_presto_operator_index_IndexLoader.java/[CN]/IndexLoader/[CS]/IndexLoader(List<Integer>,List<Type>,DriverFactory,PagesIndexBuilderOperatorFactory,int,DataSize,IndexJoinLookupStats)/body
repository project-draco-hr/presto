{
  checkArgument(!indexChannels.isEmpty(),"indexChannels must not be empty");
  this.indexChannels=ImmutableList.copyOf(checkNotNull(indexChannels,"indexChannels is null"));
  this.outputTypes=ImmutableList.copyOf(checkNotNull(types,"types is null"));
  this.driverFactory=checkNotNull(driverFactory,"driverFactory is null");
  this.sourcePlanNodeId=Iterables.getOnlyElement(driverFactory.getSourceIds());
  this.pagesIndexOutput=checkNotNull(pagesIndexOutput,"pagesIndexOutput is null");
  this.expectedPositions=checkNotNull(expectedPositions,"expectedPositions is null");
  this.maxIndexMemorySize=checkNotNull(maxIndexMemorySize,"maxIndexMemorySize is null");
  this.stats=checkNotNull(stats,"stats is null");
  indexSnapshotReference=new AtomicReference<>(new IndexSnapshot(new EmptyLookupSource(types.size()),new EmptyLookupSource(indexChannels.size())));
}
