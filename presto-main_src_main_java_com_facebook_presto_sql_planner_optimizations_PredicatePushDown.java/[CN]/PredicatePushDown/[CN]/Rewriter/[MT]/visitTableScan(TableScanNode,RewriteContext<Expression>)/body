{
  Expression predicate=simplifyExpression(context.get());
  if (BooleanLiteral.FALSE_LITERAL.equals(predicate) || predicate instanceof NullLiteral) {
    return new ValuesNode(idAllocator.getNextId(),node.getOutputSymbols(),ImmutableList.of());
  }
 else   if (!BooleanLiteral.TRUE_LITERAL.equals(predicate)) {
    return new FilterNode(idAllocator.getNextId(),node,predicate);
  }
  return node;
}
