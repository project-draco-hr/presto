{
  requireNonNull(plan,"plan is null");
  requireNonNull(session,"session is null");
  requireNonNull(types,"types is null");
  requireNonNull(idAllocator,"idAllocator is null");
  return PlanRewriter.rewriteWith(new Rewriter(symbolAllocator,idAllocator,metadata,sqlParser,session),plan,BooleanLiteral.TRUE_LITERAL);
}
