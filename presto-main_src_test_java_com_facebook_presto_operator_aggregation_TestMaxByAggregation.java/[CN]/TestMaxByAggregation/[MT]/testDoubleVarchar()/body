{
  InternalAggregationFunction doubleVarchar=metadata.getExactFunction(new Signature("max_by",VARCHAR,VARCHAR,DOUBLE)).getAggregationFunction();
  assertAggregation(doubleVarchar,1.0,"a",createPage(new String[]{"z","a"},new Double[]{1.0,2.0}),createPage(new String[]{null},new Double[]{null}));
  assertAggregation(doubleVarchar,1.0,"hi",createPage(new String[]{"zz","hi"},new Double[]{0.0,1.0}),createPage(new String[]{null,"a"},new Double[]{null,-1.0}));
}
