{
  InternalAggregationFunction doubleDouble=metadata.getExactFunction(new Signature("max_by",DOUBLE,DOUBLE,DOUBLE)).getAggregationFunction();
  assertAggregation(doubleDouble,1.0,null,createPage(new Double[]{null},new Double[]{null}),createPage(new Double[]{null},new Double[]{null}));
  assertAggregation(doubleDouble,1.0,2.0,createPage(new Double[]{3.0,2.0},new Double[]{1.0,1.5}),createPage(new Double[]{null},new Double[]{null}));
}
