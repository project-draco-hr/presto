{
  Set<String> conflicts=new TreeSet<>(newClasses.keySet());
  conflicts.retainAll(pendingClasses.keySet());
  if (!conflicts.isEmpty()) {
    throw new IllegalArgumentException(String.valueOf("The classes " + conflicts + " have already been defined"));
  }
  pendingClasses.putAll(newClasses);
  try {
    Map<String,Class<?>> classes=new HashMap<>();
    for (    String className : newClasses.keySet()) {
      try {
        Class<?> clazz=loadClass(className);
        classes.put(className,clazz);
      }
 catch (      ClassNotFoundException e) {
        throw new RuntimeException(e);
      }
    }
    return classes;
  }
  finally {
    pendingClasses.keySet().removeAll(newClasses.keySet());
  }
}
