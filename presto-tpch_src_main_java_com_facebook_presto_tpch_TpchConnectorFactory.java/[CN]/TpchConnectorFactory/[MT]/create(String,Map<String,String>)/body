{
  checkNotNull(properties,"properties is null");
  int splitsPerNode=getSplitsPerNode(properties);
  ImmutableClassToInstanceMap.Builder<Object> builder=ImmutableClassToInstanceMap.builder();
  builder.put(ConnectorMetadata.class,new TpchMetadata());
  builder.put(ConnectorSplitManager.class,new TpchSplitManager(connectorId,nodeManager,splitsPerNode));
  builder.put(ConnectorRecordSetProvider.class,new TpchRecordSetProvider());
  builder.put(ConnectorHandleResolver.class,HANDLE_RESOLVER);
  return new TpchConnector(builder.build());
}
