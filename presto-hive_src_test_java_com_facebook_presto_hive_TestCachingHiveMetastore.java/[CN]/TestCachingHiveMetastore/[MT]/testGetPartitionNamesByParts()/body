{
  ImmutableList<String> parts=ImmutableList.of();
  ImmutableList<String> expectedPartitions=ImmutableList.of(TEST_PARTITION1,TEST_PARTITION2);
  Assert.assertEquals(mockClient.getAccessCount(),0);
  Assert.assertEquals(metastore.getPartitionNamesByParts(TEST_DATABASE,TEST_TABLE,parts),expectedPartitions);
  Assert.assertEquals(mockClient.getAccessCount(),1);
  Assert.assertEquals(metastore.getPartitionNamesByParts(TEST_DATABASE,TEST_TABLE,parts),expectedPartitions);
  Assert.assertEquals(mockClient.getAccessCount(),1);
  metastore.flushCache();
  Assert.assertEquals(metastore.getPartitionNamesByParts(TEST_DATABASE,TEST_TABLE,parts),expectedPartitions);
  Assert.assertEquals(mockClient.getAccessCount(),2);
}
