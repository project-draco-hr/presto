{
  Assert.assertEquals(mockClient.getAccessCount(),0);
  Assert.assertNotNull(metastore.getPartitionByName(TEST_DATABASE,TEST_TABLE,TEST_PARTITION1));
  Assert.assertEquals(mockClient.getAccessCount(),1);
  Assert.assertNotNull(metastore.getPartitionByName(TEST_DATABASE,TEST_TABLE,TEST_PARTITION2));
  Assert.assertEquals(mockClient.getAccessCount(),2);
  Assert.assertNotNull(metastore.getPartitionByName(TEST_DATABASE,TEST_TABLE,TEST_PARTITION1));
  Assert.assertEquals(mockClient.getAccessCount(),2);
  Assert.assertNotNull(metastore.getPartitionByName(TEST_DATABASE,TEST_TABLE,TEST_PARTITION2));
  Assert.assertEquals(mockClient.getAccessCount(),2);
  metastore.flushCache();
  Assert.assertNotNull(metastore.getPartitionByName(TEST_DATABASE,TEST_TABLE,TEST_PARTITION1));
  Assert.assertEquals(mockClient.getAccessCount(),3);
  Assert.assertNotNull(metastore.getPartitionByName(TEST_DATABASE,TEST_TABLE,TEST_PARTITION2));
  Assert.assertEquals(mockClient.getAccessCount(),4);
}
