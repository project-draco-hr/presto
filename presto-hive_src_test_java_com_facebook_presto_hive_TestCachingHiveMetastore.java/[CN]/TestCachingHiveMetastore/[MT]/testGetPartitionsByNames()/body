{
  Assert.assertEquals(mockClient.getAccessCount(),0);
  metastore.getTable(TEST_DATABASE,TEST_TABLE);
  Assert.assertEquals(mockClient.getAccessCount(),1);
  Assert.assertEquals(metastore.getPartitionsByNames(TEST_DATABASE,TEST_TABLE,ImmutableList.of(TEST_PARTITION1)).size(),1);
  Assert.assertEquals(mockClient.getAccessCount(),2);
  Assert.assertEquals(metastore.getPartitionsByNames(TEST_DATABASE,TEST_TABLE,ImmutableList.of(TEST_PARTITION1,TEST_PARTITION2)).size(),2);
  Assert.assertEquals(mockClient.getAccessCount(),3);
  Assert.assertEquals(metastore.getPartitionsByNames(TEST_DATABASE,TEST_TABLE,ImmutableList.of(TEST_PARTITION1)).size(),1);
  Assert.assertEquals(metastore.getPartitionsByNames(TEST_DATABASE,TEST_TABLE,ImmutableList.of(TEST_PARTITION2)).size(),1);
  Assert.assertEquals(metastore.getPartitionsByNames(TEST_DATABASE,TEST_TABLE,ImmutableList.of(TEST_PARTITION1,TEST_PARTITION2)).size(),2);
  Assert.assertEquals(mockClient.getAccessCount(),3);
  metastore.flushCache();
  Assert.assertEquals(metastore.getPartitionsByNames(TEST_DATABASE,TEST_TABLE,ImmutableList.of(TEST_PARTITION1,TEST_PARTITION2)).size(),2);
  Assert.assertEquals(mockClient.getAccessCount(),4);
}
