{
  Preconditions.checkNotNull(query,"query is null");
  Preconditions.checkNotNull(httpClient,"httpClient is null");
  this.query=query;
  this.httpClient=httpClient;
  Request request=preparePost().setUri(uri).setBodyGenerator(StaticBodyGenerator.createStaticBodyGenerator(query,Charsets.UTF_8)).build();
  try {
    JsonResponse<QueryInfo> response=httpClient.execute(request,createFullJsonResponseHandler(jsonCodec(QueryInfo.class))).get();
    Preconditions.checkState(response.getStatusCode() == 201);
    String location=response.getHeader("Location");
    Preconditions.checkState(location != null);
    this.location=URI.create(location);
    this.tupleInfos=response.getValue().getTupleInfos();
  }
 catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
    throw Throwables.propagate(e);
  }
catch (  ExecutionException e) {
    throw Throwables.propagate(e);
  }
}
