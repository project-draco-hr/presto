{
  Session session=new Session("user","test","local",TpchMetadata.TINY_SCHEMA_NAME,TimeZone.getTimeZone("UTC"),Locale.ENGLISH,null,null);
  localQueryRunner=new LocalQueryRunner(session,getExecutor());
  localSampledQueryRunner=new LocalQueryRunner(session,getExecutor());
  localQueryRunner.createCatalog(session.getCatalog(),new TpchConnectorFactory(localQueryRunner.getNodeManager(),1),ImmutableMap.<String,String>of());
  localSampledQueryRunner.createCatalog(session.getCatalog(),new SampledTpchConnectorFactory(localSampledQueryRunner.getNodeManager(),1,2),ImmutableMap.<String,String>of());
  localQueryRunner.getMetadata().addFunctions(CUSTOM_FUNCTIONS);
  return session;
}
