{
  SharedBuffer sharedBuffer=new SharedBuffer(TASK_ID,stateNotificationExecutor,sizeOfPages(10));
  assertFalse(sharedBuffer.isFinished());
  sharedBuffer.destroy();
  assertFinished(sharedBuffer);
  sharedBuffer.setOutputBuffers(INITIAL_EMPTY_OUTPUT_BUFFERS.withNoMoreBufferIds());
  assertFinished(sharedBuffer);
  sharedBuffer.setOutputBuffers(INITIAL_EMPTY_OUTPUT_BUFFERS.withNoMoreBufferIds());
  assertFinished(sharedBuffer);
  sharedBuffer.setOutputBuffers(INITIAL_EMPTY_OUTPUT_BUFFERS.withBuffer("foo",new UnpartitionedPagePartitionFunction()).withNoMoreBufferIds());
}
