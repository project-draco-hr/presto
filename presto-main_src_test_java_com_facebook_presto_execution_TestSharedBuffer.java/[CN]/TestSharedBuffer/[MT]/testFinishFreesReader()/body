{
  SharedBuffer<Integer> sharedBuffer=new SharedBuffer<>(5);
  sharedBuffer.addQueue("queue");
  assertFalse(sharedBuffer.isFinished());
  ExecutorService executor=Executors.newCachedThreadPool();
  GetPagesJob<Integer> getPagesJob=new GetPagesJob<>(sharedBuffer,2,1);
  executor.submit(getPagesJob);
  getPagesJob.waitForStarted();
  getPagesJob.assertBlockedWithCount(0);
  assertTrue(sharedBuffer.offer(0));
  getPagesJob.assertBlockedWithCount(1);
  sharedBuffer.finish();
  assertQueueClosed(sharedBuffer,"queue");
  getPagesJob.waitForFinished();
  assertEquals(getPagesJob.getElements().size(),1);
}
