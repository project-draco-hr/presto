{
  process(relation.getRelation());
  Schema relationSchema=types.get(relation.getRelation());
  ImmutableList.Builder<Field> builder=ImmutableList.builder();
  int count=0;
  for (  Field field : relationSchema.getFields()) {
    QualifiedName name;
    if (field.getName() == null) {
      name=QualifiedName.of(relation.getAlias(),"$" + count);
    }
 else {
      name=QualifiedName.of(relation.getAlias(),Iterables.getLast(field.getName().getParts()));
    }
    builder.add(new Field(name,field.getType()));
    count++;
  }
  types.put(relation,new Schema(builder.build()));
  return null;
}
