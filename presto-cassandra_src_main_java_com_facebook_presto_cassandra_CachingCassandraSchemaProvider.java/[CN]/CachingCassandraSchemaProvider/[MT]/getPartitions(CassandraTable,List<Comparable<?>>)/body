{
  LoadingCache<PartitionListKey,List<CassandraPartition>> cache;
  if (filterPrefix.size() == table.getPartitionKeyColumns().size()) {
    cache=partitionsCacheFull;
  }
 else {
    cache=partitionsCache;
  }
  PartitionListKey key=new PartitionListKey(table,filterPrefix);
  return getCacheValue(cache,key,RuntimeException.class);
}
