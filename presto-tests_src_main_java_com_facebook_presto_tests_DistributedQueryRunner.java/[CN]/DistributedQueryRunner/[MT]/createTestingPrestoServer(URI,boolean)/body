{
  long start=System.nanoTime();
  ImmutableMap.Builder<String,String> properties=ImmutableMap.<String,String>builder().put("query.client.timeout","10m").put("exchange.http-client.read-timeout","1h").put("compiler.interpreter-enabled","false").put("task.max-index-memory","16kB").put("datasources","system").put("distributed-index-joins-enabled","true");
  if (coordinator) {
    properties.put("node-scheduler.include-coordinator","false");
    properties.put("distributed-joins-enabled","true");
    properties.put("node-scheduler.multiple-tasks-per-node-enabled","true");
  }
  TestingPrestoServer server=new TestingPrestoServer(coordinator,properties.build(),ENVIRONMENT,discoveryUri,ImmutableList.<Module>of());
  log.info("Created TestingPrestoServer in %s",nanosSince(start).convertToMostSuccinctTimeUnit());
  return server;
}
