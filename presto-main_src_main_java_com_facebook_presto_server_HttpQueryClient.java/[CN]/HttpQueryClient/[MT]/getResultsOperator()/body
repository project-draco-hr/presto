{
  QueryInfo queryInfo=getQueryInfo();
  if (queryInfo == null || queryInfo.getOutputStage() == null) {
    return new Operator(){
      @Override public int getChannelCount(){
        return 0;
      }
      @Override public List<TupleInfo> getTupleInfos(){
        return ImmutableList.of();
      }
      @Override public PageIterator iterator(){
        return PageIterators.emptyIterator(tupleInfos);
      }
    }
;
  }
  List<QueryTaskInfo> outputStage=queryInfo.getStages().get(queryInfo.getOutputStage());
  return new QueryDriversOperator(10,Iterables.transform(outputStage,new Function<QueryTaskInfo,QueryDriverProvider>(){
    @Override public QueryDriverProvider apply(    QueryTaskInfo taskInfo){
      Preconditions.checkState(taskInfo.getOutputBufferStates().size() == 1,"Expected a single output buffer for task %s, but found %s",taskInfo.getTaskId(),taskInfo.getOutputBufferStates());
      URI taskUri=uriBuilderFrom(taskInfo.getSelf()).replacePath("/v1/presto/task").appendPath(taskInfo.getTaskId()).build();
      return new HttpTaskClient(taskInfo.getTaskId(),taskUri,Iterables.getOnlyElement(taskInfo.getOutputBufferStates().keySet()),taskInfo.getTupleInfos(),httpClient,executor,queryTaskInfoCodec);
    }
  }
));
}
