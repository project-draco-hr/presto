{
  QueryInfo queryInfo=getQueryInfo();
  List<QueryTaskInfo> outputStage=queryInfo.getStages().get("out");
  if (outputStage == null) {
    return new Operator(){
      @Override public int getChannelCount(){
        return 0;
      }
      @Override public List<TupleInfo> getTupleInfos(){
        return ImmutableList.of();
      }
      @Override public Iterator<Page> iterator(){
        return Iterators.emptyIterator();
      }
    }
;
  }
  return new QueryDriversOperator(10,Iterables.transform(outputStage,new Function<QueryTaskInfo,QueryDriverProvider>(){
    @Override public QueryDriverProvider apply(    QueryTaskInfo taskInfo){
      return new HttpTaskClient(taskInfo.getTaskId(),uriBuilderFrom(queryLocation).replacePath("/v1/presto/task").appendPath(taskInfo.getTaskId()).build(),"out",taskInfo.getTupleInfos(),httpClient,executor,queryTaskInfoCodec);
    }
  }
));
}
