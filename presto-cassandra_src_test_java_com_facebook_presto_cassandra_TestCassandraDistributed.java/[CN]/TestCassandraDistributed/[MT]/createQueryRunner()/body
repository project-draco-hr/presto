{
  EmbeddedCassandraServerHelper.startEmbeddedCassandra();
  EmbeddedCassandraServerHelper.cleanEmbeddedCassandra();
  TestCassandraConnector.createOrReplaceKeyspace("tpch");
  TestCassandraConnector.createOrReplaceKeyspace("tpch_sampled");
  DistributedQueryRunner queryRunner=new DistributedQueryRunner(createSession("tpch"),4);
  queryRunner.installPlugin(new TpchPlugin());
  queryRunner.createCatalog("tpch","tpch");
  queryRunner.installPlugin(new SampledTpchPlugin());
  queryRunner.createCatalog("tpch_sampled","tpch_sampled");
  queryRunner.installPlugin(new CassandraPlugin());
  queryRunner.createCatalog("cassandra","cassandra",ImmutableMap.of("cassandra.contact-points","localhost","cassandra.native-protocol-port","9142","cassandra.allow-drop-table","true"));
  log.info("Loading data...");
  long startTime=System.nanoTime();
  copyAllTables(queryRunner,"tpch",TpchMetadata.TINY_SCHEMA_NAME,createSession("tpch"));
  copyAllTables(queryRunner,"tpch_sampled",TpchMetadata.TINY_SCHEMA_NAME,createSession(TPCH_SAMPLED_SCHEMA));
  log.info("Loading complete in %s",nanosSince(startTime).toString(SECONDS));
  return queryRunner;
}
