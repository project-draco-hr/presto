{
  assertFunction("SPLIT_PART('abc-@-def-@-ghi', '-@-', 1)",VARCHAR,"abc");
  assertFunction("SPLIT_PART('abc-@-def-@-ghi', '-@-', 2)",VARCHAR,"def");
  assertFunction("SPLIT_PART('abc-@-def-@-ghi', '-@-', 3)",VARCHAR,"ghi");
  assertFunction("SPLIT_PART('abc-@-def-@-ghi', '-@-', 4)",VARCHAR,null);
  assertFunction("SPLIT_PART('abc-@-def-@-ghi', '-@-', 99)",VARCHAR,null);
  assertFunction("SPLIT_PART('abc', 'abc', 1)",VARCHAR,"");
  assertFunction("SPLIT_PART('abc', 'abc', 2)",VARCHAR,"");
  assertFunction("SPLIT_PART('abc', 'abc', 3)",VARCHAR,null);
  assertFunction("SPLIT_PART('abc', '-@-', 1)",VARCHAR,"abc");
  assertFunction("SPLIT_PART('abc', '-@-', 2)",VARCHAR,null);
  assertFunction("SPLIT_PART('', 'abc', 1)",VARCHAR,"");
  assertFunction("SPLIT_PART('', '', 1)",VARCHAR,null);
  assertFunction("SPLIT_PART('abc', '', 1)",VARCHAR,"a");
  assertFunction("SPLIT_PART('abc', '', 2)",VARCHAR,"b");
  assertFunction("SPLIT_PART('abc', '', 3)",VARCHAR,"c");
  assertFunction("SPLIT_PART('abc', '', 4)",VARCHAR,null);
  assertFunction("SPLIT_PART('abc', '', 99)",VARCHAR,null);
  assertFunction("SPLIT_PART('abc', 'abcd', 1)",VARCHAR,"abc");
  assertFunction("SPLIT_PART('abc', 'abcd', 2)",VARCHAR,null);
  assertFunction("SPLIT_PART('abc--@--def', '-@-', 1)",VARCHAR,"abc-");
  assertFunction("SPLIT_PART('abc--@--def', '-@-', 2)",VARCHAR,"-def");
  assertFunction("SPLIT_PART('abc-@-@-@-def', '-@-', 1)",VARCHAR,"abc");
  assertFunction("SPLIT_PART('abc-@-@-@-def', '-@-', 2)",VARCHAR,"@");
  assertFunction("SPLIT_PART('abc-@-@-@-def', '-@-', 3)",VARCHAR,"def");
  assertFunction("SPLIT_PART(' ', ' ', 1)",VARCHAR,"");
  assertFunction("SPLIT_PART('abcdddddef', 'dd', 1)",VARCHAR,"abc");
  assertFunction("SPLIT_PART('abcdddddef', 'dd', 2)",VARCHAR,"");
  assertFunction("SPLIT_PART('abcdddddef', 'dd', 3)",VARCHAR,"def");
  assertFunction("SPLIT_PART('a/b/c', '/', 4)",VARCHAR,null);
  assertFunction("SPLIT_PART('a/b/c/', '/', 4)",VARCHAR,"");
  assertFunction("SPLIT_PART('\u4FE1\u5FF5,\u7231,\u5E0C\u671B', ',', 1)",VARCHAR,"\u4FE1\u5FF5");
  assertFunction("SPLIT_PART('\u4FE1\u5FF5,\u7231,\u5E0C\u671B', ',', 2)",VARCHAR,"\u7231");
  assertFunction("SPLIT_PART('\u4FE1\u5FF5,\u7231,\u5E0C\u671B', ',', 3)",VARCHAR,"\u5E0C\u671B");
  assertFunction("SPLIT_PART('\u4FE1\u5FF5,\u7231,\u5E0C\u671B', ',', 4)",VARCHAR,null);
  assertFunction("SPLIT_PART('\u8B49\u8BC1\u8A3C', '\u8BC1', 1)",VARCHAR,"\u8B49");
  assertFunction("SPLIT_PART('\u8B49\u8BC1\u8A3C', '\u8BC1', 2)",VARCHAR,"\u8A3C");
  assertFunction("SPLIT_PART('\u8B49\u8BC1\u8A3C', '\u8BC1', 3)",VARCHAR,null);
  assertInvalidFunction("SPLIT_PART('abc', '', 0)","Index must be greater than zero");
  assertInvalidFunction("SPLIT_PART('abc', '', -1)","Index must be greater than zero");
  assertInvalidFunction("SPLIT_PART(utf8(from_hex('CE')), '', 1)","Invalid UTF-8 encoding");
}
