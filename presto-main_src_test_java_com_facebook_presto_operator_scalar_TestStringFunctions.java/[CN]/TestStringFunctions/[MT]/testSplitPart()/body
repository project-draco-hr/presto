{
  assertFunction("SPLIT_PART('abc-@-def-@-ghi', '-@-', 1)",createVarcharType(15),"abc");
  assertFunction("SPLIT_PART('abc-@-def-@-ghi', '-@-', 2)",createVarcharType(15),"def");
  assertFunction("SPLIT_PART('abc-@-def-@-ghi', '-@-', 3)",createVarcharType(15),"ghi");
  assertFunction("SPLIT_PART('abc-@-def-@-ghi', '-@-', 4)",createVarcharType(15),null);
  assertFunction("SPLIT_PART('abc-@-def-@-ghi', '-@-', 99)",createVarcharType(15),null);
  assertFunction("SPLIT_PART('abc', 'abc', 1)",createVarcharType(3),"");
  assertFunction("SPLIT_PART('abc', 'abc', 2)",createVarcharType(3),"");
  assertFunction("SPLIT_PART('abc', 'abc', 3)",createVarcharType(3),null);
  assertFunction("SPLIT_PART('abc', '-@-', 1)",createVarcharType(3),"abc");
  assertFunction("SPLIT_PART('abc', '-@-', 2)",createVarcharType(3),null);
  assertFunction("SPLIT_PART('', 'abc', 1)",createVarcharType(0),"");
  assertFunction("SPLIT_PART('', '', 1)",createVarcharType(0),null);
  assertFunction("SPLIT_PART('abc', '', 1)",createVarcharType(3),"a");
  assertFunction("SPLIT_PART('abc', '', 2)",createVarcharType(3),"b");
  assertFunction("SPLIT_PART('abc', '', 3)",createVarcharType(3),"c");
  assertFunction("SPLIT_PART('abc', '', 4)",createVarcharType(3),null);
  assertFunction("SPLIT_PART('abc', '', 99)",createVarcharType(3),null);
  assertFunction("SPLIT_PART('abc', 'abcd', 1)",createVarcharType(3),"abc");
  assertFunction("SPLIT_PART('abc', 'abcd', 2)",createVarcharType(3),null);
  assertFunction("SPLIT_PART('abc--@--def', '-@-', 1)",createVarcharType(11),"abc-");
  assertFunction("SPLIT_PART('abc--@--def', '-@-', 2)",createVarcharType(11),"-def");
  assertFunction("SPLIT_PART('abc-@-@-@-def', '-@-', 1)",createVarcharType(13),"abc");
  assertFunction("SPLIT_PART('abc-@-@-@-def', '-@-', 2)",createVarcharType(13),"@");
  assertFunction("SPLIT_PART('abc-@-@-@-def', '-@-', 3)",createVarcharType(13),"def");
  assertFunction("SPLIT_PART(' ', ' ', 1)",createVarcharType(1),"");
  assertFunction("SPLIT_PART('abcdddddef', 'dd', 1)",createVarcharType(10),"abc");
  assertFunction("SPLIT_PART('abcdddddef', 'dd', 2)",createVarcharType(10),"");
  assertFunction("SPLIT_PART('abcdddddef', 'dd', 3)",createVarcharType(10),"def");
  assertFunction("SPLIT_PART('a/b/c', '/', 4)",createVarcharType(5),null);
  assertFunction("SPLIT_PART('a/b/c/', '/', 4)",createVarcharType(6),"");
  assertFunction("SPLIT_PART('\u4FE1\u5FF5,\u7231,\u5E0C\u671B', ',', 1)",createVarcharType(7),"\u4FE1\u5FF5");
  assertFunction("SPLIT_PART('\u4FE1\u5FF5,\u7231,\u5E0C\u671B', ',', 2)",createVarcharType(7),"\u7231");
  assertFunction("SPLIT_PART('\u4FE1\u5FF5,\u7231,\u5E0C\u671B', ',', 3)",createVarcharType(7),"\u5E0C\u671B");
  assertFunction("SPLIT_PART('\u4FE1\u5FF5,\u7231,\u5E0C\u671B', ',', 4)",createVarcharType(7),null);
  assertFunction("SPLIT_PART('\u8B49\u8BC1\u8A3C', '\u8BC1', 1)",createVarcharType(3),"\u8B49");
  assertFunction("SPLIT_PART('\u8B49\u8BC1\u8A3C', '\u8BC1', 2)",createVarcharType(3),"\u8A3C");
  assertFunction("SPLIT_PART('\u8B49\u8BC1\u8A3C', '\u8BC1', 3)",createVarcharType(3),null);
  assertInvalidFunction("SPLIT_PART('abc', '', 0)","Index must be greater than zero");
  assertInvalidFunction("SPLIT_PART('abc', '', -1)","Index must be greater than zero");
  assertInvalidFunction("SPLIT_PART(utf8(from_hex('CE')), '', 1)","Invalid UTF-8 encoding");
}
