{
  ImmutableList.Builder<Long> list=ImmutableList.builder();
  for (long i=1; i <= columnTypes.size(); i++) {
    list.add(i);
  }
  List<Long> columnIds=list.build();
  OrcStorageManager manager=new OrcStorageManager(storageService,ORC_MERGE_DISTANCE,recoveryManager,SHARD_RECOVERY_TIMEOUT,ROWS_PER_SHARD,MAX_BUFFER_SIZE);
  StoragePageSink sink=manager.createStoragePageSink(columnIds,columnTypes);
  sink.appendPages(rowPagesBuilder(columnTypes).rows(rows).build());
  List<ShardInfo> shards=sink.commit();
  assertEquals(shards.size(),1);
  return Iterables.getOnlyElement(shards).getColumnStats();
}
