{
  List<Long> columnIds=ImmutableList.of(3L,7L);
  List<Type> columnTypes=ImmutableList.<Type>of(BIGINT,VARCHAR);
  List<Page> pages=rowPagesBuilder(columnTypes).row(123,"hello").row(456,"bye").build();
  OrcStorageManager manager=createOrcStorageManager(storageService,backupStore,recoveryManager,20,new DataSize(1,BYTE));
  StoragePageSink sink=createStoragePageSink(manager,columnIds,columnTypes);
  sink.appendPages(pages);
  assertTrue(sink.isFull());
}
