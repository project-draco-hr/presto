{
  RunLengthEncodedTupleStream left=new RunLengthEncodedTupleStream(TupleInfo.SINGLE_LONG,ImmutableList.of(new RunLengthEncodedBlock(Tuples.createTuple(3),Range.create(0,4))));
  RunLengthEncodedTupleStream right=new RunLengthEncodedTupleStream(TupleInfo.SINGLE_LONG,ImmutableList.of(new RunLengthEncodedBlock(Tuples.createTuple(1),Range.create(0,4))));
  RunLengthBinaryOperator operator=new RunLengthBinaryOperator(left,right,new SubtractionOperation());
  Cursor cursor=operator.cursor(new QuerySession());
  assertNextValue(cursor,0,2);
  assertEquals(cursor.getCurrentValueEndPosition(),4);
  assertAdvanceNextValue(cursor,FINISHED);
  assertTrue(cursor.isFinished());
}
