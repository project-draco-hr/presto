{
  DynamicSliceOutputSupplier sliceOutput=new DynamicSliceOutputSupplier(1024);
  writeBlocks(encoding,sliceOutput,expectedBlock,expectedBlock,expectedBlock);
  Slice slice=sliceOutput.getLastSlice();
  BlocksFileReader actualBlocks=readBlocks(slice,0);
  List<List<Object>> actualValues=toValues(actualBlocks);
  assertEquals(actualValues,expectedValues);
  BlocksFileStats stats=actualBlocks.getStats();
  assertEquals(stats.getAvgRunLength(),1);
  assertEquals(stats.getRowCount(),12);
  assertEquals(stats.getRunsCount(),12);
  assertEquals(stats.getUniqueCount(),4);
}
