{
  Preconditions.checkState(node.getRelations().size() >= 2);
  TupleAnalyzer analyzer=new TupleAnalyzer(analysis,session,metadata);
  TupleDescriptor outputDescriptor=null;
  for (  Relation relation : node.getRelations()) {
    TupleDescriptor descriptor=analyzer.process(relation,context);
    if (outputDescriptor == null) {
      outputDescriptor=descriptor;
    }
 else {
      if (!elementsEqual(transform(outputDescriptor.getFields(),typeGetter()),transform(descriptor.getFields(),typeGetter()))) {
        throw new SemanticException(MISMATCHED_SET_COLUMN_TYPES,node,"Union query terms have mismatched columns");
      }
    }
  }
  analysis.setOutputDescriptor(node,outputDescriptor);
  return outputDescriptor;
}
