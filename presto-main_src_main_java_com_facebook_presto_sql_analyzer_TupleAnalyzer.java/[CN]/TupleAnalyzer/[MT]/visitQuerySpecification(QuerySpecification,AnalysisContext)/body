{
  AnalysisContext context=new AnalysisContext(parentContext);
  TupleDescriptor tupleDescriptor=analyzeFrom(node,context);
  analyzeWhere(node,tupleDescriptor,context);
  List<FieldOrExpression> outputExpressions=analyzeSelect(node,tupleDescriptor,context);
  List<FieldOrExpression> groupByExpressions=analyzeGroupBy(node,tupleDescriptor,context,outputExpressions);
  List<FieldOrExpression> orderByExpressions=analyzeOrderBy(node,tupleDescriptor,context,outputExpressions);
  analyzeHaving(node,tupleDescriptor,context);
  analyzeAggregations(node,tupleDescriptor,groupByExpressions,outputExpressions,orderByExpressions,context);
  analyzeWindowFunctions(node,outputExpressions,orderByExpressions);
  TupleDescriptor descriptor=computeOutputDescriptor(node,tupleDescriptor);
  analysis.setOutputDescriptor(node,descriptor);
  return descriptor;
}
