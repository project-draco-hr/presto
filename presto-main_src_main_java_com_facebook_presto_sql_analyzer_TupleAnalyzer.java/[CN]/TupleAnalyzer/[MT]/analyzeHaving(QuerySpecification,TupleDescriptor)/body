{
  if (node.getHaving().isPresent()) {
    Expression predicate=node.getHaving().get();
    Type type=Analyzer.analyzeExpression(metadata,tupleDescriptor,analysis,predicate);
    if (type != Type.BOOLEAN && type != Type.NULL) {
      throw new SemanticException(TYPE_MISMATCH,predicate,"HAVING clause must evaluate to a boolean: actual type %s",type);
    }
    analysis.setHaving(node,predicate);
  }
}
