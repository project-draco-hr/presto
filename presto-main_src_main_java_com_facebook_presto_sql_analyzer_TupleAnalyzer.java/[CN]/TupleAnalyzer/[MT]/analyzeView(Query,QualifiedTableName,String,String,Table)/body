{
  try {
    Session viewSession=Session.builder().setUser(session.getUser()).setSource(session.getSource().orElse(null)).setCatalog(catalog).setSchema(schema).setTimeZoneKey(session.getTimeZoneKey()).setLocale(session.getLocale()).setRemoteUserAddress(session.getRemoteUserAddress().orElse(null)).setUserAgent(session.getUserAgent().orElse(null)).setStartTime(session.getStartTime()).build();
    StatementAnalyzer analyzer=new StatementAnalyzer(analysis,metadata,sqlParser,viewSession,experimentalSyntaxEnabled,Optional.empty());
    return analyzer.process(query,new AnalysisContext());
  }
 catch (  RuntimeException e) {
    throw new SemanticException(VIEW_ANALYSIS_ERROR,node,"Failed analyzing stored view '%s': %s",name,e.getMessage());
  }
}
