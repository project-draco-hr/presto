{
  assertFunction("CAST(CAST('{\"1\":2, \"3\": 4}' AS JSON) AS MAP<BIGINT, BIGINT>)",new MapType(BIGINT,BIGINT),ImmutableMap.of(1L,2L,3L,4L));
  assertFunction("CAST(CAST('{\"1\":2.0, \"3\": 4.0}' AS JSON) AS MAP<BIGINT, DOUBLE>)",new MapType(BIGINT,DOUBLE),ImmutableMap.of(1L,2.0,3L,4.0));
  assertFunction("CAST(CAST('{\"1\":[2, 3], \"4\": [5]}' AS JSON) AS MAP<BIGINT, ARRAY<BIGINT>>)",new MapType(BIGINT,new ArrayType(BIGINT)),ImmutableMap.of(1L,ImmutableList.of(2L,3L),4L,ImmutableList.of(5L)));
  assertFunction("CAST(CAST('{\"puppies\":\"kittens\"}' AS JSON) AS MAP<VARCHAR, VARCHAR>)",new MapType(VARCHAR,VARCHAR),ImmutableMap.of("puppies","kittens"));
  assertFunction("CAST(CAST('{\"true\":\"kittens\"}' AS JSON) AS MAP<BOOLEAN, VARCHAR>)",new MapType(BOOLEAN,VARCHAR),ImmutableMap.of(true,"kittens"));
  assertFunction("CAST(CAST('null' AS JSON) AS MAP<BOOLEAN, VARCHAR>)",new MapType(BOOLEAN,VARCHAR),null);
  assertInvalidCast("CAST(CAST('{\"true\":\"kittens\"}' AS JSON) AS MAP<BOOLEAN, VARBINARY>)");
  assertInvalidCast("CAST(CAST('{\"[1, 2]\": 1}' AS JSON) AS MAP<ARRAY<BIGINT>, BIGINT>)");
}
