{
  T oldValue=intermediateValues.get(position);
  T newValue;
  if (step == Step.FINAL) {
    newValue=function.addIntermediate(cursors[channel],oldValue);
  }
 else {
    newValue=function.addInput(cursors[channel],oldValue);
  }
  intermediateValues.set(position,newValue);
}
