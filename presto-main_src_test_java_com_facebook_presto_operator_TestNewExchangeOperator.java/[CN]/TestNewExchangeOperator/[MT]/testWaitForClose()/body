{
  NewExchangeOperatorFactory operatorFactory=new NewExchangeOperatorFactory(0,new PlanNodeId("test"),exchangeClientSupplier,TUPLE_INFOS);
  NewSourceOperator operator=operatorFactory.createOperator(driverContext);
  operator.addSplit(new RemoteSplit(URI.create("http://localhost/" + TASK_1_ID),TUPLE_INFOS));
  operator.addSplit(new RemoteSplit(URI.create("http://localhost/" + TASK_2_ID),TUPLE_INFOS));
  operator.addSplit(new RemoteSplit(URI.create("http://localhost/" + TASK_3_ID),TUPLE_INFOS));
  operator.noMoreSplits();
  taskBuffers.getUnchecked(TASK_1_ID).addPages(1,false);
  taskBuffers.getUnchecked(TASK_2_ID).addPages(1,false);
  taskBuffers.getUnchecked(TASK_3_ID).addPages(1,false);
  waitForPages(operator,3);
  assertEquals(operator.isFinished(),false);
  assertEquals(operator.needsInput(),false);
  assertEquals(operator.getOutput(),null);
  taskBuffers.getUnchecked(TASK_1_ID).addPages(2,true);
  taskBuffers.getUnchecked(TASK_2_ID).addPages(2,true);
  taskBuffers.getUnchecked(TASK_3_ID).addPages(2,true);
  waitForPages(operator,6);
  waitForFinished(operator);
}
