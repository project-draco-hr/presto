{
  scheduleRequestIfNecessary();
  Page page=pageBuffer.poll();
  if (page == null && !allClients.isEmpty()) {
    page=pageBuffer.poll((long)maxWaitTime.toMillis(),TimeUnit.MILLISECONDS);
  }
  if (page == NO_MORE_PAGES) {
    closed.set(true);
    pageBuffer.offer(NO_MORE_PAGES);
    page=null;
  }
  return page;
}
