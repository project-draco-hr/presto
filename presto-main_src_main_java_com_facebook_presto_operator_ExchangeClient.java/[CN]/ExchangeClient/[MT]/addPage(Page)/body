{
  if (isClosed() || isFailed()) {
    return;
  }
  pageBuffer.add(page);
  notifyBlockedCallers();
  bufferBytes+=page.getDataSize().toBytes();
  successfulRequests++;
  averageBytesPerRequest=(long)(1.0 * averageBytesPerRequest * (successfulRequests - 1) / successfulRequests + page.getDataSize().toBytes() / successfulRequests);
  scheduleRequestIfNecessary();
}
