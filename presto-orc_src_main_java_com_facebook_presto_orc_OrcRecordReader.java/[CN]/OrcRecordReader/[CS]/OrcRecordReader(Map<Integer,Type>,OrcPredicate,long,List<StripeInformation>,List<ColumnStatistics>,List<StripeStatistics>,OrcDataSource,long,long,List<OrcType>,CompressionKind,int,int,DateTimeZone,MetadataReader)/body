{
  checkNotNull(includedColumns,"includedColumns is null");
  checkNotNull(predicate,"predicate is null");
  checkNotNull(fileStripes,"fileStripes is null");
  checkNotNull(stripeStats,"stripeStats is null");
  checkNotNull(orcDataSource,"orcDataSource is null");
  checkNotNull(types,"types is null");
  checkNotNull(compressionKind,"compressionKind is null");
  checkNotNull(hiveStorageTimeZone,"hiveStorageTimeZone is null");
  ImmutableSet.Builder<Integer> presentColumns=ImmutableSet.builder();
  ImmutableMap.Builder<Integer,Type> presentColumnsAndTypes=ImmutableMap.builder();
  OrcType root=types.get(0);
  for (  Map.Entry<Integer,Type> entry : includedColumns.entrySet()) {
    if (entry.getKey() < root.getFieldCount()) {
      presentColumns.add(entry.getKey());
      presentColumnsAndTypes.put(entry.getKey(),entry.getValue());
    }
  }
  this.presentColumns=presentColumns.build();
  this.orcDataSource=orcDataSource;
  this.splitLength=splitLength;
  checkArgument(rowsInRowGroup > 0,"rowsInRowGroup must be greater than zero");
  long totalRowCount=0;
  ImmutableList.Builder<StripeInformation> stripes=ImmutableList.builder();
  if (predicate.matches(numberOfRows,getStatisticsByColumnOrdinal(root,fileStats))) {
    for (int stripeIndex=0; stripeIndex < fileStripes.size(); stripeIndex++) {
      StripeInformation stripe=fileStripes.get(stripeIndex);
      if (splitContainsStripe(splitOffset,splitLength,stripe) && isStripeIncluded(root,stripe,stripeStats,predicate,stripeIndex)) {
        stripes.add(stripe);
        totalRowCount+=stripe.getNumberOfRows();
      }
    }
  }
  this.totalRowCount=totalRowCount;
  this.stripes=stripes.build();
  stripeReader=new StripeReader(orcDataSource,compressionKind,types,bufferSize,this.presentColumns,rowsInRowGroup,predicate,metadataReader);
  streamReaders=createStreamReaders(orcDataSource,types,hiveStorageTimeZone,presentColumnsAndTypes.build());
}
