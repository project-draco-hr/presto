{
  this.user=checkNotNull(user,"user is null");
  this.database=checkNotNull(database,"database is null");
  server=EmbeddedPostgreSQL.builder().start();
  port=server.getPort();
  try (Connection connection=server.getPostgresDatabase().getConnection()){
    try (Statement statement=connection.createStatement()){
      execute(statement,format("CREATE ROLE %s WITH LOGIN",user));
      execute(statement,format("CREATE DATABASE %s OWNER %s ENCODING = 'utf8'",database,user));
    }
   }
 catch (  SQLException e) {
    close();
    throw e;
  }
  log.info("PostgreSQL server ready: %s",getJdbcUrl());
}
