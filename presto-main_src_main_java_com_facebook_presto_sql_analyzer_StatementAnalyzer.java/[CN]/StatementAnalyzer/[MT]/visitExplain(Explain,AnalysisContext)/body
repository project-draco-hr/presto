{
  checkState(queryExplainer.isPresent(),"query explainer not available");
  ExplainType.Type planType=LOGICAL;
  ExplainFormat.Type planFormat=TEXT;
  List<ExplainOption> options=node.getOptions();
  for (  ExplainOption option : options) {
    if (option instanceof ExplainType) {
      planType=((ExplainType)option).getType();
      break;
    }
  }
  for (  ExplainOption option : options) {
    if (option instanceof ExplainFormat) {
      planFormat=((ExplainFormat)option).getType();
      break;
    }
  }
  String queryPlan=getQueryPlan(node,planType,planFormat);
  Query query=new Query(Optional.<With>absent(),new QuerySpecification(selectList(new AllColumns()),ImmutableList.of(aliased(values(row(new StringLiteral((queryPlan)))),"plan",ImmutableList.of("Query Plan"))),Optional.<Expression>absent(),ImmutableList.<Expression>of(),Optional.<Expression>absent(),ImmutableList.<SortItem>of(),Optional.<String>absent()),ImmutableList.<SortItem>of(),Optional.<String>absent(),Optional.<Approximate>absent());
  return process(query,context);
}
