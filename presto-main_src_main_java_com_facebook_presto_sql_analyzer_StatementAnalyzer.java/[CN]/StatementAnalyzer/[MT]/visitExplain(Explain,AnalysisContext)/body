{
  checkState(queryExplainer.isPresent(),"query explainer not available");
  ExplainType.Type planType=LOGICAL;
  ExplainFormat.Type planFormat=TEXT;
  List<ExplainOption> options=node.getOptions();
  for (  ExplainOption option : options) {
    if (option instanceof ExplainType) {
      planType=((ExplainType)option).getType();
      break;
    }
  }
  for (  ExplainOption option : options) {
    if (option instanceof ExplainFormat) {
      planFormat=((ExplainFormat)option).getType();
      break;
    }
  }
  String queryPlan=getQueryPlan(node,planType,planFormat);
  Query query=simpleQuery(selectList(new AllColumns()),aliased(values(row(new StringLiteral((queryPlan)))),"plan",ImmutableList.of("Query Plan")));
  return process(query,context);
}
