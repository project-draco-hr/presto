{
  checkState(queryExplainer.isPresent(),"query explainer not available");
  ExplainType.Type planType=LOGICAL;
  ExplainFormat.Type planFormat=TEXT;
  List<ExplainOption> options=node.getOptions();
  for (  ExplainOption option : options) {
    if (option instanceof ExplainType) {
      planType=((ExplainType)option).getType();
      break;
    }
  }
  for (  ExplainOption option : options) {
    if (option instanceof ExplainFormat) {
      planFormat=((ExplainFormat)option).getType();
      break;
    }
  }
  String queryPlan=getQueryPlan(node,planType,planFormat);
  Query query=new Query(Optional.empty(),new QuerySpecification(selectList(new AllColumns()),Optional.of(aliased(values(row(new StringLiteral((queryPlan)))),"plan",ImmutableList.of("Query Plan"))),Optional.empty(),ImmutableList.<Expression>of(),Optional.empty(),ImmutableList.<SortItem>of(),Optional.empty()),ImmutableList.<SortItem>of(),Optional.empty(),Optional.empty());
  return process(query,context);
}
