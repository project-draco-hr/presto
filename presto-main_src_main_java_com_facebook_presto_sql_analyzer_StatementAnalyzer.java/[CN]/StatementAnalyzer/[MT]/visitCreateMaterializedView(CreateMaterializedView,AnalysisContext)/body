{
  QualifiedTableName targetTable=MetadataUtil.createQualifiedTableName(session,node.getName());
  analysis.setMaterializedViewDestination(targetTable);
  Optional<TableHandle> targetTableHandle=metadata.getTableHandle(targetTable);
  if (targetTableHandle.isPresent()) {
    throw new SemanticException(TABLE_ALREADY_EXISTS,node,"Destination table '%s' already exists",targetTable);
  }
  if (node.getRefresh().isPresent()) {
    int refreshInterval=Integer.parseInt(node.getRefresh().get());
    if (refreshInterval <= 0) {
      throw new SemanticException(INVALID_MATERIALIZED_VIEW_REFRESH_INTERVAL,node,"Refresh interval must be > 0 (was %s)",refreshInterval);
    }
    analysis.setRefreshInterval(Optional.of(refreshInterval));
  }
 else {
    analysis.setRefreshInterval(Optional.<Integer>absent());
  }
  process(node.getTableDefinition(),context);
  return new TupleDescriptor(Field.newUnqualified("imported_rows",Type.BIGINT));
}
