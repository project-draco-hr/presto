{
  AnalysisContext context=new AnalysisContext(parentContext);
  analyzeWith(node,context);
  TupleDescriptor tupleDescriptor=analyzeFrom(node,context);
  analyzeWhere(node,tupleDescriptor);
  List<FieldOrExpression> outputExpressions=analyzeSelect(node,tupleDescriptor);
  List<FieldOrExpression> groupByExpressions=analyzeGroupBy(node,tupleDescriptor,outputExpressions);
  List<FieldOrExpression> orderByExpressions=analyzeOrderBy(node,tupleDescriptor,outputExpressions);
  analyzeHaving(node,tupleDescriptor);
  analyzeAggregations(node,tupleDescriptor,groupByExpressions,outputExpressions,orderByExpressions);
  analyzeWindowFunctions(node,outputExpressions,orderByExpressions);
  analysis.setQuery(node);
  return computeOutputDescriptor(node,tupleDescriptor);
}
