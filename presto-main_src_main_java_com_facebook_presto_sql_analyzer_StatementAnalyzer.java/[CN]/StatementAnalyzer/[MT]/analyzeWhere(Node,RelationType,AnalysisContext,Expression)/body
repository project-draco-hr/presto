{
  Analyzer.verifyNoAggregatesOrWindowFunctions(metadata,predicate,"WHERE");
  ExpressionAnalysis expressionAnalysis=analyzeExpression(predicate,tupleDescriptor,context);
  analysis.addInPredicates(node,expressionAnalysis.getSubqueryInPredicates());
  Type predicateType=expressionAnalysis.getType(predicate);
  if (!predicateType.equals(BOOLEAN)) {
    if (!predicateType.equals(UNKNOWN)) {
      throw new SemanticException(TYPE_MISMATCH,predicate,"WHERE clause must evaluate to a boolean: actual type %s",predicateType);
    }
    analysis.addCoercion(predicate,BOOLEAN);
  }
  analysis.setWhere(node,predicate);
}
