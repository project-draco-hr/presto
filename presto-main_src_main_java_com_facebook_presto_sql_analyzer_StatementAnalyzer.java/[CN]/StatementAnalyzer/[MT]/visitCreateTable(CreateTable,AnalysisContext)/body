{
  QualifiedTableName targetTable=MetadataUtil.createQualifiedTableName(session,node.getName());
  analysis.setCreateTableDestination(targetTable);
  Optional<TableHandle> targetTableHandle=metadata.getTableHandle(session,targetTable);
  if (targetTableHandle.isPresent()) {
    throw new SemanticException(TABLE_ALREADY_EXISTS,node,"Destination table '%s' already exists",targetTable);
  }
  TupleDescriptor descriptor=process(node.getQuery(),context);
  validateColumnNames(node,descriptor);
  return new TupleDescriptor(Field.newUnqualified("rows",BIGINT));
}
