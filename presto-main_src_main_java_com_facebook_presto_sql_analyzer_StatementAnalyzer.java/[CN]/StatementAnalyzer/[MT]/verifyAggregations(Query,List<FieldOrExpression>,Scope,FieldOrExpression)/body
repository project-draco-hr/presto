{
  AggregationAnalyzer analyzer=new AggregationAnalyzer(groupByExpressions,metadata,scope);
  if (fieldOrExpression.getExpression().isPresent()) {
    analyzer.analyze(fieldOrExpression.getExpression().get());
  }
 else   if (!analyzer.analyze(fieldOrExpression.getField().get())) {
    Field field=fieldOrExpression.getField().get();
    if (field.getName().isPresent()) {
      throw new SemanticException(MUST_BE_AGGREGATE_OR_GROUP_BY,query,"Column '%s.%s' not in GROUP BY clause",field.getRelationAlias().get(),field.getName().get());
    }
 else {
      throw new SemanticException(MUST_BE_AGGREGATE_OR_GROUP_BY,query,"Column %s from '%s' not in GROUP BY clause",field.getIndex() + 1,field.getRelationAlias().get());
    }
  }
}
