{
  QualifiedTableName tableName=MetadataUtil.createQualifiedTableName(session,showColumns.getTable());
  if (!metadata.getView(session,tableName).isPresent() && !metadata.getTableHandle(session,tableName).isPresent()) {
    throw new SemanticException(MISSING_TABLE,showColumns,"Table '%s' does not exist",tableName);
  }
  Query query=new Query(Optional.<With>absent(),new QuerySpecification(selectList(aliasedName("column_name","Column"),aliasedName("data_type","Type"),aliasedYesNoToBoolean("is_nullable","Null"),aliasedYesNoToBoolean("is_partition_key","Partition Key")),table(QualifiedName.of(tableName.getCatalogName(),TABLE_COLUMNS.getSchemaName(),TABLE_COLUMNS.getTableName())),Optional.of(logicalAnd(equal(nameReference("table_schema"),new StringLiteral(tableName.getSchemaName())),equal(nameReference("table_name"),new StringLiteral(tableName.getTableName())))),ImmutableList.<Expression>of(),Optional.<Expression>absent(),ImmutableList.of(ascending("ordinal_position")),Optional.<String>absent()),ImmutableList.<SortItem>of(),Optional.<String>absent(),Optional.<Approximate>absent());
  return process(query,context);
}
