{
  this.types=unmodifiableList(new ArrayList<>(requireNonNull(types,"types is null")));
  int maxBlockSizeInBytes;
  if (!types.isEmpty()) {
    maxBlockSizeInBytes=(int)(1.0 * DEFAULT_MAX_PAGE_SIZE_IN_BYTES / types.size());
    maxBlockSizeInBytes=Math.min(DEFAULT_MAX_BLOCK_SIZE_IN_BYTES,maxBlockSizeInBytes);
  }
 else {
    maxBlockSizeInBytes=0;
  }
  blockBuilderStatus=new BlockBuilderStatus(DEFAULT_MAX_PAGE_SIZE_IN_BYTES,maxBlockSizeInBytes);
  blockBuilders=new BlockBuilder[types.size()];
  for (int i=0; i < blockBuilders.length; i++) {
    blockBuilders[i]=types.get(i).createBlockBuilder(blockBuilderStatus,1,blockBuilderStatus.getMaxBlockSizeInBytes());
  }
}
