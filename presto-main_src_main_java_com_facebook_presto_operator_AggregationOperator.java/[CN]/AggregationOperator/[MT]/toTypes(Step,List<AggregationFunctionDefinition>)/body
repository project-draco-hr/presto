{
  ImmutableList.Builder<Type> types=ImmutableList.builder();
  for (  AggregationFunctionDefinition functionDefinition : functionDefinitions) {
    if (step != Step.PARTIAL) {
      types.add(functionDefinition.getFunction().getFinalType());
    }
 else {
      types.add(functionDefinition.getFunction().getIntermediateType());
    }
  }
  return types.build();
}
