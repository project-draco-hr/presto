{
  ImmutableList.Builder<Aggregator> builder=ImmutableList.builder();
  for (  AggregationFunctionDefinition functionDefinition : functionDefinitions) {
    builder.add(createAggregator(functionDefinition,step));
  }
  List<Aggregator> aggregates=builder.build();
  PageIterator iterator=source.iterator(operatorStats);
  while (iterator.hasNext()) {
    Page page=iterator.next();
    for (    Aggregator aggregate : aggregates) {
      aggregate.addValue(page);
    }
  }
  Block[] blocks=new Block[aggregates.size()];
  for (int i=0; i < blocks.length; i++) {
    blocks[i]=aggregates.get(i).getResult();
  }
  return PageIterators.singletonIterator(new Page(blocks));
}
