{
  this.operatorContext=checkNotNull(operatorContext,"operatorContext is null");
  checkNotNull(step,"step is null");
  checkNotNull(functionDefinitions,"functionDefinitions is null");
  this.types=toTypes(step,functionDefinitions);
  MemoryManager memoryManager=new MemoryManager(operatorContext);
  ImmutableList.Builder<Aggregator> builder=ImmutableList.builder();
  for (  AggregationFunctionDefinition functionDefinition : functionDefinitions) {
    builder.add(new Aggregator(functionDefinition,step,memoryManager));
  }
  aggregates=builder.build();
}
