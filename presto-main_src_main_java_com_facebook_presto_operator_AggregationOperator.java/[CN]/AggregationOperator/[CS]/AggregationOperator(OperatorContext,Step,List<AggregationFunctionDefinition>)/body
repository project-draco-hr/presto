{
  this.operatorContext=checkNotNull(operatorContext,"operatorContext is null");
  checkNotNull(step,"step is null");
  checkNotNull(functionDefinitions,"functionDefinitions is null");
  this.tupleInfos=toTupleInfos(step,functionDefinitions);
  ImmutableList.Builder<Aggregator> builder=ImmutableList.builder();
  for (  AggregationFunctionDefinition functionDefinition : functionDefinitions) {
    builder.add(new Aggregator(functionDefinition,step));
  }
  aggregates=builder.build();
}
