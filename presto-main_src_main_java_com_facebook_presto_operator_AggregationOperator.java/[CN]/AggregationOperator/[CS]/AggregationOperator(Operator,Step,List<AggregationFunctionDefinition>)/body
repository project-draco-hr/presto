{
  Preconditions.checkNotNull(source,"source is null");
  Preconditions.checkNotNull(step,"step is null");
  Preconditions.checkNotNull(functionDefinitions,"functionDefinitions is null");
  this.source=source;
  this.step=step;
  this.functionDefinitions=ImmutableList.copyOf(functionDefinitions);
  ImmutableList.Builder<TupleInfo> tupleInfos=ImmutableList.builder();
  for (  AggregationFunctionDefinition functionDefinition : functionDefinitions) {
    if (step != Step.PARTIAL) {
      tupleInfos.add(functionDefinition.getFunction().getFinalTupleInfo());
    }
 else {
      tupleInfos.add(functionDefinition.getFunction().getIntermediateTupleInfo());
    }
  }
  this.tupleInfos=tupleInfos.build();
}
