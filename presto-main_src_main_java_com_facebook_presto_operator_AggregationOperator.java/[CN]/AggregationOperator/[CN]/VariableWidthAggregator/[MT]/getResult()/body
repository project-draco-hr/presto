{
  if (step == Step.PARTIAL) {
    BlockBuilder output=new BlockBuilder(function.getIntermediateTupleInfo());
    function.evaluateIntermediate(intermediateValue,output);
    return output.build();
  }
 else {
    BlockBuilder output=new BlockBuilder(function.getFinalTupleInfo());
    function.evaluateFinal(intermediateValue,output);
    return output.build();
  }
}
