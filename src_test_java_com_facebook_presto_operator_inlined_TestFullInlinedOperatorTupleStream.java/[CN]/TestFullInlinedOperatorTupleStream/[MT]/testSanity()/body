{
  MockInlinedOperatorReader mockInlinedOperatorReader=new MockInlinedOperatorReader();
  TupleStream tupleStream=new FullInlinedOperatorTupleStream(mockInlinedOperatorReader);
  Cursor cursor1=tupleStream.cursor(new QuerySession());
  Cursor cursor2=tupleStream.cursor(new QuerySession());
  Assert.assertTrue(cursor1.advanceNextPosition() == Cursor.AdvanceResult.MUST_YIELD);
  Assert.assertTrue(cursor2.advanceNextPosition() == Cursor.AdvanceResult.MUST_YIELD);
  Assert.assertFalse(cursor1.isValid());
  Assert.assertFalse(cursor2.isValid());
  Assert.assertFalse(cursor1.isFinished());
  Assert.assertFalse(cursor2.isFinished());
  Assert.assertTrue(cursor1.advanceNextPosition() == Cursor.AdvanceResult.MUST_YIELD);
  Assert.assertTrue(cursor2.advanceNextPosition() == Cursor.AdvanceResult.MUST_YIELD);
  mockInlinedOperatorReader.setFinished();
  Assert.assertTrue(cursor1.advanceNextPosition() == Cursor.AdvanceResult.SUCCESS);
  Assert.assertTrue(cursor2.advanceNextPosition() == Cursor.AdvanceResult.SUCCESS);
  Assert.assertTrue(cursor1.isValid());
  Assert.assertTrue(cursor2.isValid());
  Assert.assertFalse(cursor1.isFinished());
  Assert.assertFalse(cursor2.isFinished());
  Assert.assertEquals(cursor1.getLong(0),5L);
  Assert.assertEquals(cursor2.getLong(0),5L);
  Assert.assertTrue(cursor1.advanceNextPosition() == Cursor.AdvanceResult.FINISHED);
  Assert.assertTrue(cursor2.advanceNextPosition() == Cursor.AdvanceResult.FINISHED);
  Assert.assertTrue(cursor1.isFinished());
  Assert.assertTrue(cursor2.isFinished());
}
