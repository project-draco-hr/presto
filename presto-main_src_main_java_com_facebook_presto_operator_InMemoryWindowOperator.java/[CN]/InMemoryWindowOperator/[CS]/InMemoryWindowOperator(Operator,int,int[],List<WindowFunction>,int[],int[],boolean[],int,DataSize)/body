{
  this.source=checkNotNull(source,"source is null");
  this.orderingChannel=orderingChannel;
  this.outputChannels=outputChannels;
  this.windowFunctions=ImmutableList.copyOf(checkNotNull(windowFunctions,"windowFunctions is null"));
  this.partitionFields=partitionFields;
  this.sortFields=sortFields;
  this.sortOrder=sortOrder;
  this.expectedPositions=expectedPositions;
  this.maxSize=checkNotNull(maxSize,"maxSize is null");
  ImmutableList.Builder<TupleInfo> tupleInfosBuilder=ImmutableList.builder();
  for (  int channel : outputChannels) {
    tupleInfosBuilder.add(source.getTupleInfos().get(channel));
  }
  for (  WindowFunction function : windowFunctions) {
    tupleInfosBuilder.add(function.getTupleInfo());
  }
  this.tupleInfos=tupleInfosBuilder.build();
}
