{
  this.source=checkNotNull(source,"source is null");
  this.orderingChannel=orderingChannel;
  this.outputChannels=checkNotNull(outputChannels,"outputChannels is null").clone();
  this.windowFunctions=ImmutableList.copyOf(checkNotNull(windowFunctions,"windowFunctions is null"));
  this.partitionFields=checkNotNull(partitionFields,"partitionFields is null").clone();
  this.sortFields=checkNotNull(sortFields,"sortFields is null").clone();
  this.sortOrder=checkNotNull(sortOrder,"sortOrder is null").clone();
  this.expectedPositions=expectedPositions;
  this.maxSize=checkNotNull(maxSize,"maxSize is null");
  ImmutableList.Builder<TupleInfo> tupleInfosBuilder=ImmutableList.builder();
  for (  int channel : outputChannels) {
    tupleInfosBuilder.add(source.getTupleInfos().get(channel));
  }
  for (  WindowFunction function : windowFunctions) {
    tupleInfosBuilder.add(function.getTupleInfo());
  }
  this.tupleInfos=tupleInfosBuilder.build();
}
