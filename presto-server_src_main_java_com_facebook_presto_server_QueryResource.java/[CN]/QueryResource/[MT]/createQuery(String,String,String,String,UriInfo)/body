{
  checkNotNull(query,"query is null");
  checkArgument(!query.isEmpty(),"query is empty");
  checkNotNull(catalog,"catalog is null");
  checkNotNull(schema,"schema is null");
  QueryInfo queryInfo=queryManager.createQuery(new Session(user,catalog,schema),query);
  URI pagesUri=uriBuilderFrom(uriInfo.getRequestUri()).appendPath(queryInfo.getQueryId()).build();
  return Response.created(pagesUri).entity(queryInfo).build();
}
