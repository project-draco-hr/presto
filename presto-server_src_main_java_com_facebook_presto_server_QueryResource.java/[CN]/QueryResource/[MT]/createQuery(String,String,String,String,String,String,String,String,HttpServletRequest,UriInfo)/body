{
  checkNotNull(query,"query is null");
  checkArgument(!query.isEmpty(),"query is empty");
  checkNotNull(catalog,"catalog is null");
  checkNotNull(schema,"schema is null");
  if (timeZoneId == null) {
    timeZoneId=TimeZone.getDefault().getID();
  }
  Locale locale=Locale.getDefault();
  if (language != null) {
    locale=Locale.forLanguageTag(language);
  }
  String remoteUserAddress=requestContext.getRemoteAddr();
  Session session;
  try {
    session=new Session(user,source,catalog,schema,TimeZoneKey.getTimeZoneKey(timeZoneId),locale,remoteUserAddress,userAgent);
  }
 catch (  TimeZoneNotSupportedException e) {
    return Response.status(Status.BAD_REQUEST).entity(e.getMessage()).build();
  }
  QueryInfo queryInfo=queryManager.createQuery(session,query);
  URI pagesUri=uriBuilderFrom(uriInfo.getRequestUri()).appendPath(queryInfo.getQueryId().toString()).build();
  return Response.created(pagesUri).entity(queryInfo).build();
}
