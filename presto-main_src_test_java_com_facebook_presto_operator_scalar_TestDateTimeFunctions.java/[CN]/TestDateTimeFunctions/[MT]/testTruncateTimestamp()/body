{
  DateTime result=TIMESTAMP;
  result=result.withMillisOfSecond(0);
  assertFunction("date_trunc('second', " + TIMESTAMP_LITERAL + ")",TimestampType.TIMESTAMP,toTimestamp(result));
  result=result.withSecondOfMinute(0);
  assertFunction("date_trunc('minute', " + TIMESTAMP_LITERAL + ")",TimestampType.TIMESTAMP,toTimestamp(result));
  result=result.withMinuteOfHour(0);
  assertFunction("date_trunc('hour', " + TIMESTAMP_LITERAL + ")",TimestampType.TIMESTAMP,toTimestamp(result));
  result=result.withHourOfDay(0);
  assertFunction("date_trunc('day', " + TIMESTAMP_LITERAL + ")",TimestampType.TIMESTAMP,toTimestamp(result));
  result=result.withDayOfMonth(20);
  assertFunction("date_trunc('week', " + TIMESTAMP_LITERAL + ")",TimestampType.TIMESTAMP,toTimestamp(result));
  result=result.withDayOfMonth(1);
  assertFunction("date_trunc('month', " + TIMESTAMP_LITERAL + ")",TimestampType.TIMESTAMP,toTimestamp(result));
  result=result.withMonthOfYear(7);
  assertFunction("date_trunc('quarter', " + TIMESTAMP_LITERAL + ")",TimestampType.TIMESTAMP,toTimestamp(result));
  result=result.withMonthOfYear(1);
  assertFunction("date_trunc('year', " + TIMESTAMP_LITERAL + ")",TimestampType.TIMESTAMP,toTimestamp(result));
  result=WEIRD_TIMESTAMP;
  result=result.withMillisOfSecond(0);
  assertFunction("date_trunc('second', " + WEIRD_TIMESTAMP_LITERAL + ")",TIMESTAMP_WITH_TIME_ZONE,toTimestampWithTimeZone(result));
  result=result.withSecondOfMinute(0);
  assertFunction("date_trunc('minute', " + WEIRD_TIMESTAMP_LITERAL + ")",TIMESTAMP_WITH_TIME_ZONE,toTimestampWithTimeZone(result));
  result=result.withMinuteOfHour(0);
  assertFunction("date_trunc('hour', " + WEIRD_TIMESTAMP_LITERAL + ")",TIMESTAMP_WITH_TIME_ZONE,toTimestampWithTimeZone(result));
  result=result.withHourOfDay(0);
  assertFunction("date_trunc('day', " + WEIRD_TIMESTAMP_LITERAL + ")",TIMESTAMP_WITH_TIME_ZONE,toTimestampWithTimeZone(result));
  result=result.withDayOfMonth(20);
  assertFunction("date_trunc('week', " + WEIRD_TIMESTAMP_LITERAL + ")",TIMESTAMP_WITH_TIME_ZONE,toTimestampWithTimeZone(result));
  result=result.withDayOfMonth(1);
  assertFunction("date_trunc('month', " + WEIRD_TIMESTAMP_LITERAL + ")",TIMESTAMP_WITH_TIME_ZONE,toTimestampWithTimeZone(result));
  result=result.withMonthOfYear(7);
  assertFunction("date_trunc('quarter', " + WEIRD_TIMESTAMP_LITERAL + ")",TIMESTAMP_WITH_TIME_ZONE,toTimestampWithTimeZone(result));
  result=result.withMonthOfYear(1);
  assertFunction("date_trunc('year', " + WEIRD_TIMESTAMP_LITERAL + ")",TIMESTAMP_WITH_TIME_ZONE,toTimestampWithTimeZone(result));
}
