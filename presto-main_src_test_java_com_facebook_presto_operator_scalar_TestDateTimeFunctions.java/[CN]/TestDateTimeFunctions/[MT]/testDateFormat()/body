{
  String dateTimeLiteral="TIMESTAMP '2001-01-09 13:04:05.321'";
  assertFunction("date_format(" + dateTimeLiteral + ", '%a')",VARCHAR,"Tue");
  assertFunction("date_format(" + dateTimeLiteral + ", '%b')",VARCHAR,"Jan");
  assertFunction("date_format(" + dateTimeLiteral + ", '%c')",VARCHAR,"1");
  assertFunction("date_format(" + dateTimeLiteral + ", '%d')",VARCHAR,"09");
  assertFunction("date_format(" + dateTimeLiteral + ", '%e')",VARCHAR,"9");
  assertFunction("date_format(" + dateTimeLiteral + ", '%f')",VARCHAR,"321000");
  assertFunction("date_format(" + dateTimeLiteral + ", '%H')",VARCHAR,"13");
  assertFunction("date_format(" + dateTimeLiteral + ", '%h')",VARCHAR,"01");
  assertFunction("date_format(" + dateTimeLiteral + ", '%I')",VARCHAR,"01");
  assertFunction("date_format(" + dateTimeLiteral + ", '%i')",VARCHAR,"04");
  assertFunction("date_format(" + dateTimeLiteral + ", '%j')",VARCHAR,"009");
  assertFunction("date_format(" + dateTimeLiteral + ", '%k')",VARCHAR,"13");
  assertFunction("date_format(" + dateTimeLiteral + ", '%l')",VARCHAR,"1");
  assertFunction("date_format(" + dateTimeLiteral + ", '%M')",VARCHAR,"January");
  assertFunction("date_format(" + dateTimeLiteral + ", '%m')",VARCHAR,"01");
  assertFunction("date_format(" + dateTimeLiteral + ", '%p')",VARCHAR,"PM");
  assertFunction("date_format(" + dateTimeLiteral + ", '%r')",VARCHAR,"01:04:05 PM");
  assertFunction("date_format(" + dateTimeLiteral + ", '%S')",VARCHAR,"05");
  assertFunction("date_format(" + dateTimeLiteral + ", '%s')",VARCHAR,"05");
  assertFunction("date_format(" + dateTimeLiteral + ", '%T')",VARCHAR,"13:04:05");
  assertFunction("date_format(" + dateTimeLiteral + ", '%v')",VARCHAR,"02");
  assertFunction("date_format(" + dateTimeLiteral + ", '%W')",VARCHAR,"Tuesday");
  assertFunction("date_format(" + dateTimeLiteral + ", '%w')",VARCHAR,"2");
  assertFunction("date_format(" + dateTimeLiteral + ", '%Y')",VARCHAR,"2001");
  assertFunction("date_format(" + dateTimeLiteral + ", '%y')",VARCHAR,"01");
  assertFunction("date_format(" + dateTimeLiteral + ", '%%')",VARCHAR,"%");
  assertFunction("date_format(" + dateTimeLiteral + ", 'foo')",VARCHAR,"foo");
  assertFunction("date_format(" + dateTimeLiteral + ", '%g')",VARCHAR,"g");
  assertFunction("date_format(" + dateTimeLiteral + ", '%4')",VARCHAR,"4");
  assertFunction("date_format(" + dateTimeLiteral + ", '%x %v')",VARCHAR,"2001 02");
  String wierdDateTimeLiteral="TIMESTAMP '2001-01-09 13:04:05.321 +07:09'";
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%a')",VARCHAR,"Tue");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%b')",VARCHAR,"Jan");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%c')",VARCHAR,"1");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%d')",VARCHAR,"09");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%e')",VARCHAR,"9");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%f')",VARCHAR,"321000");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%H')",VARCHAR,"13");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%h')",VARCHAR,"01");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%I')",VARCHAR,"01");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%i')",VARCHAR,"04");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%j')",VARCHAR,"009");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%k')",VARCHAR,"13");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%l')",VARCHAR,"1");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%M')",VARCHAR,"January");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%m')",VARCHAR,"01");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%p')",VARCHAR,"PM");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%r')",VARCHAR,"01:04:05 PM");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%S')",VARCHAR,"05");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%s')",VARCHAR,"05");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%T')",VARCHAR,"13:04:05");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%v')",VARCHAR,"02");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%W')",VARCHAR,"Tuesday");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%w')",VARCHAR,"2");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%Y')",VARCHAR,"2001");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%y')",VARCHAR,"01");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%%')",VARCHAR,"%");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", 'foo')",VARCHAR,"foo");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%g')",VARCHAR,"g");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%4')",VARCHAR,"4");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%x %v')",VARCHAR,"2001 02");
  assertFunction("date_format(TIMESTAMP '2001-01-09 13:04:05.32', '%f')",VARCHAR,"320000");
  assertFunction("date_format(TIMESTAMP '2001-01-09 00:04:05.32', '%k')",VARCHAR,"0");
}
