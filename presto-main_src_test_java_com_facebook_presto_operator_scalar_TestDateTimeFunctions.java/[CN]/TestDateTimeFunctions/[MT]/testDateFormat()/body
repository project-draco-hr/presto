{
  String dateTimeLiteral="TIMESTAMP '2001-01-09 13:04:05.321'";
  assertFunction("date_format(" + dateTimeLiteral + ", '%a')","Tue");
  assertFunction("date_format(" + dateTimeLiteral + ", '%b')","Jan");
  assertFunction("date_format(" + dateTimeLiteral + ", '%c')","1");
  assertFunction("date_format(" + dateTimeLiteral + ", '%d')","09");
  assertFunction("date_format(" + dateTimeLiteral + ", '%e')","9");
  assertFunction("date_format(" + dateTimeLiteral + ", '%f')","321000");
  assertFunction("date_format(" + dateTimeLiteral + ", '%H')","13");
  assertFunction("date_format(" + dateTimeLiteral + ", '%h')","01");
  assertFunction("date_format(" + dateTimeLiteral + ", '%I')","01");
  assertFunction("date_format(" + dateTimeLiteral + ", '%i')","04");
  assertFunction("date_format(" + dateTimeLiteral + ", '%j')","009");
  assertFunction("date_format(" + dateTimeLiteral + ", '%k')","13");
  assertFunction("date_format(" + dateTimeLiteral + ", '%l')","1");
  assertFunction("date_format(" + dateTimeLiteral + ", '%M')","January");
  assertFunction("date_format(" + dateTimeLiteral + ", '%m')","01");
  assertFunction("date_format(" + dateTimeLiteral + ", '%p')","PM");
  assertFunction("date_format(" + dateTimeLiteral + ", '%r')","01:04:05 PM");
  assertFunction("date_format(" + dateTimeLiteral + ", '%S')","05");
  assertFunction("date_format(" + dateTimeLiteral + ", '%s')","05");
  assertFunction("date_format(" + dateTimeLiteral + ", '%T')","13:04:05");
  assertFunction("date_format(" + dateTimeLiteral + ", '%v')","02");
  assertFunction("date_format(" + dateTimeLiteral + ", '%W')","Tuesday");
  assertFunction("date_format(" + dateTimeLiteral + ", '%w')","2");
  assertFunction("date_format(" + dateTimeLiteral + ", '%Y')","2001");
  assertFunction("date_format(" + dateTimeLiteral + ", '%y')","01");
  assertFunction("date_format(" + dateTimeLiteral + ", '%%')","%");
  assertFunction("date_format(" + dateTimeLiteral + ", 'foo')","foo");
  assertFunction("date_format(" + dateTimeLiteral + ", '%g')","g");
  assertFunction("date_format(" + dateTimeLiteral + ", '%4')","4");
  assertFunction("date_format(" + dateTimeLiteral + ", '%x %v')","2001 02");
  String wierdDateTimeLiteral="TIMESTAMP '2001-01-09 13:04:05.321 +07:09'";
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%a')","Tue");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%b')","Jan");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%c')","1");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%d')","09");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%e')","9");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%f')","321000");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%H')","13");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%h')","01");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%I')","01");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%i')","04");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%j')","009");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%k')","13");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%l')","1");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%M')","January");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%m')","01");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%p')","PM");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%r')","01:04:05 PM");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%S')","05");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%s')","05");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%T')","13:04:05");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%v')","02");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%W')","Tuesday");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%w')","2");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%Y')","2001");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%y')","01");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%%')","%");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", 'foo')","foo");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%g')","g");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%4')","4");
  assertFunction("date_format(" + wierdDateTimeLiteral + ", '%x %v')","2001 02");
  assertFunction("date_format(TIMESTAMP '2001-01-09 13:04:05.32', '%f')","320000");
}
