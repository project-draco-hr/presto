{
synchronized (blockBuffer) {
    if (state != State.RUNNING) {
      return;
    }
    state=State.CANCELED;
    sourceCount=0;
    blockBuffer.clear();
    notEmpty.release();
    notFull.release(Integer.MAX_VALUE - notFull.availablePermits() - 1000);
  }
}
