{
  ImmutableList.Builder<DirectoryEntry> list=ImmutableList.builder();
  RemoteIterator<LocatedFileStatus> iter=fileSystem.listLocatedStatus(path);
  while (iter.hasNext()) {
    LocatedFileStatus status=iter.next();
    if (isDirectory(status)) {
      list.add(entryForDirectory(status));
    }
 else {
      list.add(entryForFile(status,status.getBlockLocations()));
    }
  }
  return list.build();
}
