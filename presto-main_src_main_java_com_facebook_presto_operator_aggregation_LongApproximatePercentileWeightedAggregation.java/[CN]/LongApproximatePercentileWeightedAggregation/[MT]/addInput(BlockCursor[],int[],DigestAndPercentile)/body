{
  if (!cursors[VALUE_INDEX].isNull(fields[VALUE_INDEX]) && !cursors[WEIGHT_INDEX].isNull(fields[WEIGHT_INDEX])) {
    long value=cursors[VALUE_INDEX].getLong(fields[VALUE_INDEX]);
    long weight=cursors[WEIGHT_INDEX].getLong(fields[WEIGHT_INDEX]);
    currentValue.digest.add(value,weight);
  }
  if (!cursors[PERCENTILE_INDEX].isNull(fields[PERCENTILE_INDEX])) {
    currentValue.percentile=cursors[PERCENTILE_INDEX].getDouble(fields[PERCENTILE_INDEX]);
  }
  return currentValue;
}
