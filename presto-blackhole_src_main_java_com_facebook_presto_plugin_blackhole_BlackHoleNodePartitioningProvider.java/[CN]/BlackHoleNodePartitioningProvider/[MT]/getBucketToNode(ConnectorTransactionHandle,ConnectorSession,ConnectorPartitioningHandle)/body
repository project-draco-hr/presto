{
  Set<Node> nodes=nodeManager.getActiveDatasourceNodes(connectorId);
  if (nodes.isEmpty()) {
    throw new PrestoException(NO_NODES_AVAILABLE,"No black hole nodes available");
  }
  ImmutableMap.Builder<Integer,Node> distribution=ImmutableMap.builder();
  int partNumber=0;
  for (  Node node : nodes) {
    distribution.put(partNumber,node);
    partNumber++;
  }
  return distribution.build();
}
