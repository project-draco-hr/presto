{
  Map<String,String> properties=new ImmutableMap.Builder<String,String>().put("query.client.timeout","10s").put("query.max-age","30s").put("query.max-history","10").put("query.schedule-split-batch-size","99").put("query.max-concurrent-queries","10").put("query.max-queued-queries","15").put("query.queue-config-file","/etc/presto/queues.json").put("query.initial-hash-partitions","16").put("query.manager-executor-pool-size","11").put("query.remote-task.max-consecutive-error-count","300").put("query.remote-task.min-error-duration","30s").put("query.remote-task.max-callback-threads","10").put("query.execution-policy","phased").build();
  QueryManagerConfig expected=new QueryManagerConfig().setMaxQueryAge(new Duration(30,TimeUnit.SECONDS)).setMaxQueryHistory(10).setClientTimeout(new Duration(10,TimeUnit.SECONDS)).setScheduleSplitBatchSize(99).setMaxConcurrentQueries(10).setMaxQueuedQueries(15).setQueueConfigFile("/etc/presto/queues.json").setInitialHashPartitions(16).setQueryManagerExecutorPoolSize(11).setRemoteTaskMaxConsecutiveErrorCount(300).setRemoteTaskMinErrorDuration(new Duration(30,TimeUnit.SECONDS)).setRemoteTaskMaxCallbackThreads(10).setQueryExecutionPolicy("phased");
  ConfigAssertions.assertFullMapping(properties,expected);
}
