{
  TableMetadata metadata=getTableMetadata(tableId);
  List<ShardInfo> newShards=performCompaction(shardUuids,metadata);
  shardManager.replaceShardUuids(transactionId,tableId,metadata.getColumns(),shardUuids,newShards);
}
