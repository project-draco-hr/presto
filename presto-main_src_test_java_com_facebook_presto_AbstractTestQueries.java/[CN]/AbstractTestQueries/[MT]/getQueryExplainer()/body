{
  MetadataManager metadata=new MetadataManager();
  metadata.addInternalSchemaMetadata(MetadataManager.INTERNAL_CONNECTOR_ID,new DualMetadata());
  SplitManager splitManager=new SplitManager(ImmutableSet.<ConnectorSplitManager>of(new DualSplitManager(new InMemoryNodeManager())));
  AnalyzerConfig analyzerConfig=new AnalyzerConfig().setApproximateQueriesEnabled(true);
  List<PlanOptimizer> optimizers=new PlanOptimizersFactory(metadata,splitManager,analyzerConfig).get();
  return new QueryExplainer(session,optimizers,metadata,analyzerConfig.isApproximateQueriesEnabled());
}
