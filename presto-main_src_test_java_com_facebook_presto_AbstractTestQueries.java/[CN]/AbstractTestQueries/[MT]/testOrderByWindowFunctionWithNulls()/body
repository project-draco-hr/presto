{
  MaterializedResult actual;
  MaterializedResult expected;
  actual=computeActual("" + "SELECT orderkey, row_number() OVER (ORDER BY nullif(orderkey, 3) NULLS FIRST)\n" + "FROM (SELECT * FROM orders ORDER BY orderkey LIMIT 10)\n"+ "ORDER BY 2 ASC\n"+ "LIMIT 5");
  expected=resultBuilder(session,BIGINT,BIGINT).row(3,1).row(1,2).row(2,3).row(4,4).row(5,5).build();
  assertEquals(actual,expected);
  actual=computeActual("" + "SELECT orderkey, row_number() OVER (ORDER BY nullif(orderkey, 3) NULLS LAST)\n" + "FROM (SELECT * FROM orders ORDER BY orderkey LIMIT 10)\n"+ "ORDER BY 2 DESC\n"+ "LIMIT 5");
  expected=resultBuilder(session,BIGINT,BIGINT).row(3,10).row(34,9).row(33,8).row(32,7).row(7,6).build();
  assertEquals(actual,expected);
  actual=computeActual("" + "SELECT orderkey, row_number() OVER (ORDER BY nullif(orderkey, 3))\n" + "FROM (SELECT * FROM orders ORDER BY orderkey LIMIT 10)\n"+ "ORDER BY 2 DESC\n"+ "LIMIT 5");
  assertEquals(actual,expected);
}
