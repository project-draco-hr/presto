{
  MaterializedResult materializedResult=computeActual("" + "SELECT COUNT(*)\n" + "FROM (\n"+ "  SELECT orderkey, COUNT(*)\n"+ "  FROM lineitem\n"+ "  GROUP BY orderkey\n"+ "  LIMIT 1000\n"+ ")\n"+ "WHERE rand() > 0.5");
  MaterializedTuple tuple=Iterables.getOnlyElement(materializedResult.getMaterializedTuples());
  Assert.assertEquals(tuple.getFieldCount(),1);
  long count=(Long)tuple.getField(0);
  Assert.assertTrue(count > 0 && count < 1000);
}
