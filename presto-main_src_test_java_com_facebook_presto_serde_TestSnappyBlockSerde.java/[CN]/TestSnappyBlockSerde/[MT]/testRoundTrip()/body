{
  ImmutableList<Tuple> tuples=ImmutableList.of(createTuple("alice"),createTuple("bob"),createTuple("charlie"),createTuple("dave"));
  DynamicSliceOutput blockSlice=new DynamicSliceOutput(1024);
  DynamicSliceOutput compressedOutput=new DynamicSliceOutput(1024);
  Encoder encoder=BlocksFileEncoding.SNAPPY.createBlocksWriter(compressedOutput);
  for (  Tuple tuple : tuples) {
    tuple.writeTo(blockSlice);
  }
  Block expectedBlock=new VariableWidthBlock(new VariableWidthTypeInfo(VARIABLE_BINARY),tuples.size(),blockSlice.slice());
  encoder.append(tuples);
  BlockEncoding snappyEncoding=encoder.finish();
  Block actualBlock=snappyEncoding.readBlock(compressedOutput.slice().getInput());
  BlockAssertions.assertBlockEquals(actualBlock,expectedBlock);
}
