{
  BlockBuilder blockBuilder=VARCHAR.createBlockBuilder(new BlockBuilderStatus());
  VARCHAR.writeString(blockBuilder,"alice");
  VARCHAR.writeString(blockBuilder,"bob");
  VARCHAR.writeString(blockBuilder,"charlie");
  VARCHAR.writeString(blockBuilder,"dave");
  Block block=blockBuilder.build();
  DynamicSliceOutput compressedOutput=new DynamicSliceOutput(1024);
  Encoder encoder=BlocksFileEncoding.SNAPPY.createBlocksWriter(VARCHAR,compressedOutput);
  encoder.append(block);
  BlockEncoding snappyEncoding=encoder.finish();
  Block actualBlock=snappyEncoding.readBlock(compressedOutput.slice().getInput());
  BlockAssertions.assertBlockEquals(VARCHAR,actualBlock,block);
}
