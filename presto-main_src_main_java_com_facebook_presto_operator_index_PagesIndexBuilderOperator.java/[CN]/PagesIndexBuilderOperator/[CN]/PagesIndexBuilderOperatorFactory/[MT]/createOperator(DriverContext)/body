{
  checkState(!closed,"Factory is already closed");
  IndexSnapshotBuilder indexSnapshotBuilder=indexSnapshotBuilderReference.get();
  checkState(indexSnapshotBuilder != null,"Index snapshot builder has not been set");
  OperatorContext operatorContext=driverContext.addOperatorContext(operatorId,PagesIndexBuilderOperator.class.getSimpleName());
  return new PagesIndexBuilderOperator(types,operatorContext,indexSnapshotBuilder);
}
