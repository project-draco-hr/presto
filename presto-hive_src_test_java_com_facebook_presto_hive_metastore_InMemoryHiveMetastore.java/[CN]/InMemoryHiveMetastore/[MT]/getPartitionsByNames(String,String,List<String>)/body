{
  ImmutableMap.Builder<String,Partition> builder=ImmutableMap.builder();
  for (  String name : partitionNames) {
    PartitionName partitionName=new PartitionName(databaseName,tableName,name);
    Partition partition=partitions.get(partitionName);
    if (partition == null) {
      return Optional.empty();
    }
    builder.put(name,partition.deepCopy());
  }
  return Optional.of(builder.build());
}
