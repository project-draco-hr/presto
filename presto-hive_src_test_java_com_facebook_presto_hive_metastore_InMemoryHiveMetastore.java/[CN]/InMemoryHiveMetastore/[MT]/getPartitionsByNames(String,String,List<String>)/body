{
  ImmutableList.Builder<Partition> builder=ImmutableList.builder();
  for (  String name : partitionNames) {
    PartitionName partitionName=new PartitionName(databaseName,tableName,name);
    Partition partition=partitions.get(partitionName);
    if (partition == null) {
      return ImmutableList.of();
    }
    builder.add(partition.deepCopy());
  }
  return builder.build();
}
