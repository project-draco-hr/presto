{
  SchemaTableName schemaTableName=new SchemaTableName(table.getDbName(),table.getTableName());
  Table tableCopy=table.deepCopy();
  if (tableCopy.getSd() == null) {
    tableCopy.setSd(new StorageDescriptor());
  }
 else   if (tableCopy.getSd().getLocation() != null) {
    File directory=new File(URI.create(tableCopy.getSd().getLocation()));
    checkArgument(directory.exists(),"Table directory does not exist");
  }
  if (relations.putIfAbsent(schemaTableName,tableCopy) != null) {
    throw new TableAlreadyExistsException(schemaTableName);
  }
  if (tableCopy.getTableType().equals(TableType.VIRTUAL_VIEW.name())) {
    views.put(schemaTableName,tableCopy);
  }
}
