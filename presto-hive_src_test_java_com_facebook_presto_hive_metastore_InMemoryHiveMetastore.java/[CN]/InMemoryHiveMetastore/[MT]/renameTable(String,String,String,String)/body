{
  SchemaTableName oldTable=new SchemaTableName(databaseName,tableName);
  Table table=relations.get(oldTable);
  if (table == null) {
    throw new TableNotFoundException(oldTable);
  }
  SchemaTableName newTable=new SchemaTableName(newDatabaseName,newTableName);
  if (relations.putIfAbsent(newTable,table) != null) {
    throw new TableAlreadyExistsException(newTable);
  }
  relations.remove(oldTable);
}
