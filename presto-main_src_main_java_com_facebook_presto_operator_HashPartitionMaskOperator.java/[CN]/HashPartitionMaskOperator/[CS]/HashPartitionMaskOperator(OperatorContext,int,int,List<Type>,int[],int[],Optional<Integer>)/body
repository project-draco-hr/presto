{
  this.partition=partition;
  this.partitionCount=partitionCount;
  this.operatorContext=checkNotNull(operatorContext,"operatorContext is null");
  this.types=ImmutableList.copyOf(checkNotNull(types,"types is null"));
  this.maskChannels=maskChannels;
  checkArgument(partitionChannels.length >= 0,"partitionChannels is empty");
  checkNotNull(hashChannel,"hashChannel is null");
  ImmutableList.Builder<Type> distinctTypes=ImmutableList.builder();
  for (  int channel : partitionChannels) {
    distinctTypes.add(types.get(channel));
  }
  ImmutableList.Builder<Type> partitionChannelTypes=ImmutableList.builder();
  for (  int channel : partitionChannels) {
    partitionChannelTypes.add(types.get(channel));
  }
  if (hashChannel.isPresent()) {
    this.hashGenerator=new PrecomputedHashGenerator(hashChannel.get());
  }
 else {
    this.hashGenerator=new InterpretedHashGenerator(partitionChannelTypes.build(),partitionChannels);
  }
}
