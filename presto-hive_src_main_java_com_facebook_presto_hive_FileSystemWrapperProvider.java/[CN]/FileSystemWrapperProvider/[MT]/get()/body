{
  Function<FileSystem,FileSystem> fileSystemWrapper=createThreadContextClassLoaderWrapper();
  if (slowDatanodeSwitcherEnabled && SlowDatanodeSwitcher.isSupported()) {
    fileSystemWrapper=Functions.compose(fileSystemWrapper,slowDatanodeSwitcher.createFileSystemWrapper());
  }
  return new FileSystemWrapper(fileSystemWrapper,fileSystemCache.createPathWrapper(),Functions.<FileStatus>identity());
}
