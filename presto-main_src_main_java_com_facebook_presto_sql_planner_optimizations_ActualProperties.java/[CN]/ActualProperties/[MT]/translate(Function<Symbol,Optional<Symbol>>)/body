{
  Map<Symbol,Object> translatedConstants=new HashMap<>();
  for (  Map.Entry<Symbol,Object> entry : constants.entrySet()) {
    Optional<Symbol> translatedKey=translator.apply(entry.getKey());
    if (translatedKey.isPresent()) {
      translatedConstants.put(translatedKey.get(),entry.getValue());
    }
  }
  return builder().global(global.translate(translator)).local(LocalProperties.translate(localProperties,translator)).constants(translatedConstants).build();
}
