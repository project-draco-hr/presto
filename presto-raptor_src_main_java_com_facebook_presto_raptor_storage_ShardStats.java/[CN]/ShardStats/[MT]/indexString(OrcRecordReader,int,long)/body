{
  boolean minSet=false;
  boolean maxSet=false;
  Slice min=null;
  Slice max=null;
  while (true) {
    int batchSize=reader.nextBatch();
    if (batchSize <= 0) {
      break;
    }
    SliceVector vector=new SliceVector(batchSize);
    reader.readVector(columnIndex,vector);
    for (int i=0; i < batchSize; i++) {
      Slice slice=vector.getSliceAtPosition(i);
      if (slice == null) {
        continue;
      }
      slice=truncateIndexValue(slice);
      if (!minSet || (slice.compareTo(min) < 0)) {
        minSet=true;
        min=slice;
      }
      if (!maxSet || (slice.compareTo(max) > 0)) {
        maxSet=true;
        max=slice;
      }
    }
  }
  return new ColumnStats(columnId,minSet ? min.toStringUtf8() : null,maxSet ? max.toStringUtf8() : null);
}
