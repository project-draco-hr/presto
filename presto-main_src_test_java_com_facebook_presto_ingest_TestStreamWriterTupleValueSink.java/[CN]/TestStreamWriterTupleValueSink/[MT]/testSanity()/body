{
  cursor.advanceNextValue();
  streamWriterTupleValueSink.process(Cursors.asTupleStreamPosition(cursor));
  cursor.advanceNextValue();
  streamWriterTupleValueSink.process(Cursors.asTupleStreamPosition(cursor));
  cursor.advanceNextValue();
  streamWriterTupleValueSink.finished();
  TupleStream resultStream=serde.createDeserializer().deserialize(Slices.wrappedBuffer(byteArrayOutputStream.toByteArray()));
  Blocks.assertTupleStreamEquals(resultStream,tupleStream);
}
