{
  checkNotNull(tableHandle,"tableHandle is null");
  NativeTableHandle nativeTableHandle=(NativeTableHandle)tableHandle;
  TableNamespace tableNamespace=dao.getTableNamespace(nativeTableHandle.getTableId());
  List<ColumnMetadata> columns=dao.getTableColumnMetaData(nativeTableHandle.getTableId());
  if (columns.isEmpty()) {
    return null;
  }
  return new TableMetadata(tableNamespace.getCatalogName(),tableNamespace.getDatabaseName(),tableNamespace.getTableName(),columns,tableHandle);
}
