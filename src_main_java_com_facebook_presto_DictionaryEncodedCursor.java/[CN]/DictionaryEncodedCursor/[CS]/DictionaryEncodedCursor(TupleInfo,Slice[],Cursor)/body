{
  checkNotNull(tupleInfo,"tupleInfo is null");
  checkNotNull(dictionary,"dictionary is null");
  checkNotNull(sourceCursor,"sourceCursor is null");
  checkArgument(tupleInfo.getFieldCount() == 1,"tupleInfo should only have one column");
  this.tupleInfo=tupleInfo;
  this.dictionary=dictionary;
  this.sourceCursor=sourceCursor;
  ImmutableMap.Builder<Slice,Tuple> builder=ImmutableMap.builder();
  for (int i=0; i < dictionary.length; i++) {
    builder.put(dictionary[i],new Tuple(Slices.allocate(SizeOf.SIZE_OF_LONG).output().appendLong(i).slice(),TupleInfo.SINGLE_LONG_TUPLEINFO));
  }
  reverseDictionary=builder.build();
}
