{
  List<String> parts=new ArrayList<>();
  if (!node.getPartitionBy().isEmpty()) {
    parts.add("PARTITION BY " + joinExpressions(node.getPartitionBy()));
  }
  if (!node.getOrderBy().isEmpty()) {
    parts.add("ORDER BY " + Joiner.on(", ").join(transform(node.getOrderBy(),orderByFormatterFunction())));
  }
  if (node.getFrame().isPresent()) {
    parts.add(process(node.getFrame().get(),null));
  }
  return '(' + Joiner.on(' ').join(parts) + ')';
}
