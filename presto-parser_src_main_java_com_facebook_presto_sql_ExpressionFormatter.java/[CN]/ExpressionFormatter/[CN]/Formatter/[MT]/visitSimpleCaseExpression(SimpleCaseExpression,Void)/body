{
  ImmutableList.Builder<String> parts=ImmutableList.builder();
  parts.add("CASE").add(process(node.getOperand(),context));
  for (  WhenClause whenClause : node.getWhenClauses()) {
    parts.add(process(whenClause,context));
  }
  if (node.getDefaultValue() != null) {
    parts.add("ELSE").add(process(node.getDefaultValue(),context));
  }
  parts.add("END");
  return "(" + Joiner.on(' ').join(parts.build()) + ")";
}
