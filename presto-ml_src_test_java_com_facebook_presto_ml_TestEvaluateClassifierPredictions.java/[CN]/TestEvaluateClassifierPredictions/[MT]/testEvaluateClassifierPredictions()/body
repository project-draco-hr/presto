{
  TypeRegistry typeRegistry=new TypeRegistry();
  typeRegistry.addParametricType(new ClassifierParametricType());
  typeRegistry.addType(RegressorType.REGRESSOR);
  typeRegistry.addType(ModelType.MODEL);
  metadata.addFunctions(new MLFunctionFactory(typeRegistry).listFunctions());
  InternalAggregationFunction aggregation=metadata.getExactFunction(new Signature("evaluate_classifier_predictions",AGGREGATE,StandardTypes.VARCHAR,StandardTypes.BIGINT,StandardTypes.BIGINT)).getAggregationFunction();
  Accumulator accumulator=aggregation.bind(ImmutableList.of(0,1),Optional.empty(),Optional.empty(),1.0).createAccumulator();
  accumulator.addInput(getPage());
  BlockBuilder finalOut=accumulator.getFinalType().createBlockBuilder(new BlockBuilderStatus(),1);
  accumulator.evaluateFinal(finalOut);
  Block block=finalOut.build();
  String output=VARCHAR.getSlice(block,0).toStringUtf8();
  List<String> parts=ImmutableList.copyOf(Splitter.on('\n').omitEmptyStrings().split(output));
  assertEquals(parts.size(),7,output);
  assertEquals(parts.get(0),"Accuracy: 1/2 (50.00%)");
}
