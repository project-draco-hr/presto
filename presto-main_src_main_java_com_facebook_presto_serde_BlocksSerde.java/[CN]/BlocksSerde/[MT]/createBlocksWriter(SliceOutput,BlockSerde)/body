{
  checkNotNull(sliceOutput,"sliceOutput is null");
  return new BlocksWriter(){
    private BlocksWriter blocksWriter;
    @Override public BlocksWriter append(    Tuple tuple){
      Preconditions.checkNotNull(tuple,"tuple is null");
      if (blocksWriter == null) {
        BlockSerde serde=blockSerde;
        if (blockSerde == null) {
          serde=UNCOMPRESSED_BLOCK_SERDE;
        }
        blocksWriter=serde.createBlockWriter(sliceOutput);
        BlockSerdeSerde.writeBlockSerde(sliceOutput,serde);
        TupleInfoSerde.writeTupleInfo(sliceOutput,tuple.getTupleInfo());
      }
      blocksWriter.append(tuple);
      return this;
    }
    @Override public BlocksWriter append(    Block block){
      Preconditions.checkNotNull(block,"block is null");
      if (blocksWriter == null) {
        BlockSerde serde=blockSerde;
        if (blockSerde == null) {
          serde=BlockSerdes.getSerdeForBlock(block);
        }
        blocksWriter=serde.createBlockWriter(sliceOutput);
        BlockSerdeSerde.writeBlockSerde(sliceOutput,serde);
        TupleInfoSerde.writeTupleInfo(sliceOutput,block.getTupleInfo());
      }
      blocksWriter.append(block);
      return this;
    }
    @Override public void finish(){
      if (blocksWriter != null) {
        blocksWriter.finish();
      }
    }
  }
;
}
