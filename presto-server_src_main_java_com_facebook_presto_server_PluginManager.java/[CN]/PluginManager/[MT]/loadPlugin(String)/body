{
  log.info("-- Loading plugin %s --",plugin);
  URLClassLoader pluginClassLoader=buildClassLoader(plugin);
  ClassLoader oldClassLoader=Thread.currentThread().getContextClassLoader();
  try {
    Thread.currentThread().setContextClassLoader(pluginClassLoader);
    ServiceLoader<ImportClientFactoryFactory> serviceLoader=ServiceLoader.load(ImportClientFactoryFactory.class,pluginClassLoader);
    List<ImportClientFactoryFactory> importClientFactoryFactories=ImmutableList.copyOf(serviceLoader);
    for (    ImportClientFactoryFactory importClientFactoryFactory : importClientFactoryFactories) {
      Map<String,String> requiredConfig=loadPluginConfig(importClientFactoryFactory.getConfigName());
      ImportClientFactory importClientFactory=importClientFactoryFactory.createImportClientFactory(requiredConfig,optionalConfig);
      importClientManager.addImportClientFactory(importClientFactory);
    }
  }
  finally {
    Thread.currentThread().setContextClassLoader(oldClassLoader);
  }
  log.info("-- Finished loading plugin %s --",plugin);
}
