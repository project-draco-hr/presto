{
  Preconditions.checkNotNull(nodeInfo,"nodeInfo is null");
  Preconditions.checkNotNull(config,"config is null");
  Preconditions.checkNotNull(importClientManager,"importClientManager is null");
  Preconditions.checkNotNull(configurationFactory,"configurationFactory is null");
  this.importClientManager=importClientManager;
  installedPluginsDir=config.getInstalledPluginsDir();
  if (config.getPlugins() == null) {
    this.plugins=ImmutableList.of();
  }
 else {
    this.plugins=ImmutableList.copyOf(config.getPlugins());
  }
  this.pluginConfigurationDir=config.getPluginConfigurationDir();
  this.resolver=new ArtifactResolver(config.getMavenLocalRepository(),config.getMavenRemoteRepository());
  Map<String,String> optionalConfig=new TreeMap<>(configurationFactory.getProperties());
  optionalConfig.put("node.id",nodeInfo.getNodeId());
  this.optionalConfig=ImmutableMap.copyOf(optionalConfig);
}
