{
  TpchTableHandle orders=tableHandle("lineitem");
  TpchColumnHandle orderStatus=columnHandle(orders,"orderkey");
  TpchColumnHandle totalPrice=columnHandle(orders,"extendedprice");
  BlockIterable orderStatusBlockIterable=blocksProvider.getBlocks(orders,orderStatus,BlocksFileEncoding.RAW);
  BlockIterable totalPriceBlockIterable=blocksProvider.getBlocks(orders,totalPrice,BlocksFileEncoding.RAW);
  AlignmentOperator alignmentOperator=new AlignmentOperator(orderStatusBlockIterable,totalPriceBlockIterable);
  return new NewHashAggregationOperator(alignmentOperator,0,Step.SINGLE,ImmutableList.of(aggregation(DOUBLE_SUM,1)));
}
