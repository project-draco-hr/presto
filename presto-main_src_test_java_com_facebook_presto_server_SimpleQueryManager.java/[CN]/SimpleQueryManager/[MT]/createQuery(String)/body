{
  Preconditions.checkNotNull(query,"query is null");
  String queryId=String.valueOf(nextQueryId.getAndIncrement());
  QueryTaskInfo outputTask=simpleQueryTaskManager.createQueryTask(null,ImmutableList.<String>of("out"),ImmutableMap.<String,List<PlanFragmentSource>>of());
  SimpleQuery simpleQuery=new SimpleQuery(queryId,outputTask.getTaskId(),simpleQueryTaskManager);
  queries.put(queryId,simpleQuery);
  return simpleQuery.getQueryInfo();
}
