{
  memorySize-=operatorContext.getOperatorPreAllocatedMemory().toBytes();
  long delta=memorySize - currentMemoryReservation;
  if (delta <= 0) {
    return true;
  }
  if (!operatorContext.reserveMemory(delta)) {
    return false;
  }
  currentMemoryReservation=Math.max(currentMemoryReservation,memorySize);
  return true;
}
