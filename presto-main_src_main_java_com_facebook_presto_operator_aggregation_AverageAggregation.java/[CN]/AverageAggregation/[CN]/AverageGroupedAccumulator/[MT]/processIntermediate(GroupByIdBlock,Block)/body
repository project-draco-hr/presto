{
  counts.ensureCapacity(groupIdsBlock.getGroupCount());
  sums.ensureCapacity(groupIdsBlock.getGroupCount());
  BlockCursor intermediateValues=block.cursor();
  for (int position=0; position < groupIdsBlock.getPositionCount(); position++) {
    checkState(intermediateValues.advanceNextPosition());
    long groupId=groupIdsBlock.getGroupId(position);
    Slice value=intermediateValues.getSlice();
    long count=value.getLong(0);
    counts.add(groupId,count);
    double sum=value.getDouble(SIZE_OF_LONG);
    sums.add(groupId,sum);
  }
  checkState(!intermediateValues.advanceNextPosition());
}
