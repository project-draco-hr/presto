{
  Statement actualTree=SqlParser.createStatement(actual);
  Statement expectedTree=SqlParser.createStatement(expected);
  NodeRewriter<?> rewriter=getRewriter(metadata,actualTree);
  assertValidQuery(actualTree,metadata);
  assertValidQuery(expectedTree,metadata);
  assertEqualsTree(TreeRewriter.rewriteWith(rewriter,actualTree),expectedTree);
}
