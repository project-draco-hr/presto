{
  int positionCount=page.getPositionCount();
  int maxPossibleGroupId=nextGroupId + positionCount;
  groupAddress.ensureCapacity(maxPossibleGroupId);
  if (maxPossibleGroupId > maxFill) {
    rehash(maxPossibleGroupId);
  }
  BlockBuilder blockBuilder=BIGINT.createFixedSizeBlockBuilder(positionCount);
  BlockCursor[] currentRow=new BlockCursor[channels.length];
  for (int i=0; i < channels.length; i++) {
    currentRow[i]=page.getBlock(channels[i]).cursor();
  }
  for (int position=0; position < page.getPositionCount(); position++) {
    for (    BlockCursor cursor : currentRow) {
      checkState(cursor.advanceNextPosition());
    }
    int groupId=putIfAbsentInternal(currentRow);
    blockBuilder.append(groupId);
  }
  RandomAccessBlock block=blockBuilder.build();
  return new GroupByIdBlock(nextGroupId,block);
}
