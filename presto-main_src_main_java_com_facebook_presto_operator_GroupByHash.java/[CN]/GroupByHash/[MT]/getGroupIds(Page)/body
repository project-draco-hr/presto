{
  int positionCount=page.getPositionCount();
  BlockBuilder blockBuilder=BIGINT.createFixedSizeBlockBuilder(positionCount);
  Block[] hashBlocks=new Block[channels.length];
  for (int i=0; i < channels.length; i++) {
    hashBlocks[i]=page.getBlock(channels[i]);
  }
  for (int position=0; position < positionCount; position++) {
    int groupId=putIfAbsent(position,page,hashBlocks);
    BIGINT.writeLong(blockBuilder,groupId);
  }
  return new GroupByIdBlock(nextGroupId,blockBuilder.build());
}
