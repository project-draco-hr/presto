{
  int positionCount=page.getPositionCount();
  BlockBuilder blockBuilder=BIGINT.createFixedSizeBlockBuilder(positionCount);
  Block[] blocks=page.getBlocks();
  for (int position=0; position < page.getPositionCount(); position++) {
    int groupId=putIfAbsent(position,blocks);
    blockBuilder.appendLong(groupId);
  }
  Block block=blockBuilder.build();
  return new GroupByIdBlock(nextGroupId,block);
}
