{
  int pageIndex=pages.size() - 1;
  PageBuilder pageBuilder=pages.get(pageIndex);
  pageBuilder.append(row);
  int groupId=nextGroupId++;
  long address=encodeSyntheticAddress(pageIndex,pageBuilder.getPositionCount() - 1);
  pagePositionToGroupId.put(address,groupId);
  if (pageBuilder.isFull()) {
    completedPagesMemorySize+=pageBuilder.getMemorySize();
    pageBuilder=new PageBuilder(types);
    pages.add(pageBuilder);
  }
  return groupId;
}
