{
  int pageIndex=allPages.size() - 1;
  if (!activePage.append(row)) {
    completedPagesMemorySize+=activePage.getMemorySize();
    activePage=new GroupByPageBuilder(types);
    allPages.add(activePage);
    pageIndex++;
    checkState(activePage.append(row),"Could not add row to empty page builder");
  }
  int groupId=nextGroupId++;
  long address=encodeSyntheticAddress(pageIndex,activePage.getPositionCount() - 1);
  pagePositionToGroupId.put(address,groupId);
  return groupId;
}
