{
  int writableBytes=sliceOutput.writableBytes() - SIZE_OF_BYTE;
  if (writableBytes == 0) {
    return false;
  }
  boolean isNull=cursor.isNull();
  Slice slice=cursor.getRawSlice();
  int offset=cursor.getRawOffset();
  if (type.isFixedSize()) {
    FixedWidthTypeInfo typeInfo=(FixedWidthTypeInfo)type.getTypeInfo();
    if (writableBytes < typeInfo.getSize() + SIZE_OF_BYTE) {
      return false;
    }
    positionOffsets.add(sliceOutput.size());
    if (isNull) {
      sliceOutput.writeByte(1);
      sliceOutput.writeZero(typeInfo.getSize());
    }
 else {
      sliceOutput.writeByte(0);
      type.getTypeInfo().appendTo(slice,offset + SIZE_OF_BYTE,sliceOutput);
    }
  }
 else   if (isNull) {
    positionOffsets.add(sliceOutput.size());
    sliceOutput.writeByte(1);
  }
 else {
    VariableWidthTypeInfo typeInfo=(VariableWidthTypeInfo)type.getTypeInfo();
    if (writableBytes < typeInfo.getLength(slice,offset + SIZE_OF_BYTE) + SIZE_OF_BYTE) {
      return false;
    }
    positionOffsets.add(sliceOutput.size());
    sliceOutput.writeByte(0);
    type.getTypeInfo().appendTo(slice,offset + SIZE_OF_BYTE,sliceOutput);
  }
  return true;
}
