{
  ImmutableList.Builder<ConnectorSplit> splits=ImmutableList.builder();
  while (!source.isFinished()) {
    splits.addAll(getFutureValue(source.getNextBatch(1000)));
  }
  return splits.build();
}
