{
  ConnectorTableHandle table=getTableHandle(tableS3);
  List<ConnectorColumnHandle> columnHandles=ImmutableList.copyOf(client.getColumnHandles(table).values());
  Map<String,Integer> columnIndex=indexColumns(columnHandles);
  ConnectorPartitionResult partitionResult=client.getPartitions(table,TupleDomain.<ConnectorColumnHandle>all());
  assertEquals(partitionResult.getPartitions().size(),1);
  ConnectorSplitSource splitSource=client.getPartitionSplits(table,partitionResult.getPartitions());
  long sum=0;
  for (  ConnectorSplit split : getAllSplits(splitSource)) {
    try (RecordCursor cursor=client.getRecordSet(split,columnHandles).cursor()){
      while (cursor.advanceNextPosition()) {
        sum+=cursor.getLong(columnIndex.get("t_bigint"));
      }
    }
   }
  assertEquals(sum,78300);
}
