{
  checkState(!finished,"already finished");
  finished=true;
  PageBuilder pageBuilder=new PageBuilder(ImmutableList.of(type));
  for (int groupId=0; groupId < dictionaryBuilder.getGroupCount(); groupId++) {
    dictionaryBuilder.appendValuesTo(groupId,pageBuilder,0);
  }
  return new DictionaryBlockEncoding(pageBuilder.build().getBlock(0),idWriter.finish());
}
