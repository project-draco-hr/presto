{
  checkNotNull(block,"block is null");
  checkState(!finished,"already finished");
  BlockBuilder idBlockBuilder=BIGINT.createBlockBuilder(new BlockBuilderStatus());
  for (int position=0; position < block.getPositionCount(); position++) {
    int key=dictionaryBuilder.putIfAbsent(position,block);
    BIGINT.writeLong(idBlockBuilder,key);
  }
  idWriter.append(idBlockBuilder.build());
  return this;
}
