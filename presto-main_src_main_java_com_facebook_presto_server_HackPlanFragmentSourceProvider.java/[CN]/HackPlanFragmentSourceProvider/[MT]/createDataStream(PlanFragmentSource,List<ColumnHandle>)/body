{
  checkNotNull(source,"source is null");
  if (source instanceof ExchangePlanFragmentSource) {
    final HttpClient httpClient;
synchronized (this) {
      if (this.httpClient == null) {
        this.httpClient=new ApacheHttpClient(new HttpClientConfig().setMaxConnections(1000).setMaxConnectionsPerServer(1000).setConnectTimeout(new Duration(5,TimeUnit.SECONDS)).setReadTimeout(new Duration(5,TimeUnit.SECONDS)));
      }
      httpClient=this.httpClient;
    }
    final ExchangePlanFragmentSource exchangeSource=(ExchangePlanFragmentSource)source;
    return new QueryDriversOperator(pageBufferMax,transform(exchangeSource.getSources().entrySet(),new Function<Entry<String,URI>,QueryDriverProvider>(){
      @Override public QueryDriverProvider apply(      Entry<String,URI> source){
        return new HttpTaskClient(source.getKey(),source.getValue(),exchangeSource.getOutputId(),exchangeSource.getTupleInfos(),httpClient,executor,queryTaskInfoCodec);
      }
    }
));
  }
 else   if (source instanceof TableScanPlanFragmentSource) {
    TableScanPlanFragmentSource tableScanSource=(TableScanPlanFragmentSource)source;
    return dataStreamProvider.createDataStream(tableScanSource.getSplit(),columns);
  }
  throw new IllegalArgumentException("Unsupported source type " + source.getClass().getName());
}
