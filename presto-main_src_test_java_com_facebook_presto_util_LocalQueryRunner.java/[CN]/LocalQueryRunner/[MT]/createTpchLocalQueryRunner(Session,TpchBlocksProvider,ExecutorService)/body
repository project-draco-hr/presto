{
  InMemoryNodeManager nodeManager=new InMemoryNodeManager();
  MetadataManager metadataManager=new MetadataManager();
  SplitManager splitManager=new SplitManager(ImmutableSet.<ConnectorSplitManager>of());
  DataStreamManager dataStreamManager=new DataStreamManager();
  RecordSinkManager recordSinkManager=new RecordSinkManager();
  addDual(nodeManager,metadataManager,splitManager,dataStreamManager);
  addSystem(nodeManager,metadataManager,splitManager,dataStreamManager);
  addInformationSchema(nodeManager,metadataManager,splitManager,dataStreamManager);
  addTpch(nodeManager,metadataManager,splitManager,dataStreamManager,tpchBlocksProvider);
  return new LocalQueryRunner(metadataManager,splitManager,dataStreamManager,createMockLocalStorageManager(),recordSinkManager,session,executor);
}
