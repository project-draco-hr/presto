{
  InMemoryNodeManager nodeManager=new InMemoryNodeManager();
  MetadataManager metadataManager=new MetadataManager();
  SplitManager splitManager=new SplitManager(metadataManager,ImmutableSet.<ConnectorSplitManager>of());
  DataStreamManager dataStreamManager=new DataStreamManager();
  addDual(nodeManager,metadataManager,splitManager,dataStreamManager);
  addSystem(nodeManager,metadataManager,splitManager,dataStreamManager);
  addInformationSchema(nodeManager,metadataManager,splitManager,dataStreamManager);
  addTpch(nodeManager,metadataManager,splitManager,dataStreamManager,tpchBlocksProvider);
  return new LocalQueryRunner(metadataManager,splitManager,dataStreamManager,MockLocalStorageManager.createMockLocalStorageManager(),session,executor);
}
