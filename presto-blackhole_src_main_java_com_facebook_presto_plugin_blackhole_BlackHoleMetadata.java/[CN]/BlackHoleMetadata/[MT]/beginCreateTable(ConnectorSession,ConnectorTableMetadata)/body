{
  int splitCount=(Integer)tableMetadata.getProperties().get(SPLIT_COUNT_PROPERTY);
  int pagesPerSplit=(Integer)tableMetadata.getProperties().get(PAGES_PER_SPLIT_PROPERTY);
  int rowsPerPage=(Integer)tableMetadata.getProperties().get(ROWS_PER_PAGE_PROPERTY);
  checkArgument((splitCount > 0 && pagesPerSplit > 0 && rowsPerPage > 0) || (splitCount == 0 && pagesPerSplit == 0 && rowsPerPage == 0),"You have to set all of the properties [%s, %s and %s] or none",SPLIT_COUNT_PROPERTY,PAGES_PER_SPLIT_PROPERTY,ROWS_PER_PAGE_PROPERTY);
  return new BlackHoleOutputTableHandle(new BlackHoleTableHandle(tableMetadata,splitCount,pagesPerSplit,rowsPerPage));
}
