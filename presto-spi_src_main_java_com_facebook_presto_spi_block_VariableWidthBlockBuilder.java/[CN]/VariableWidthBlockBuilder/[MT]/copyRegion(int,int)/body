{
  int positionCount=getPositionCount();
  if (positionOffset < 0 || length < 0 || positionOffset + length > positionCount) {
    throw new IndexOutOfBoundsException("Invalid position " + positionOffset + " in block with "+ positionCount+ " positions");
  }
  Slice newOffsets=Slices.copyOf(offsets.getUnderlyingSlice(),positionOffset * SIZE_OF_INT,(length + 1) * SIZE_OF_INT);
  Slice newValueIsNull=Slices.copyOf(valueIsNull.getUnderlyingSlice(),positionOffset,length);
  return new VariableWidthBlock(length,sliceOutput.slice(),newOffsets,newValueIsNull);
}
