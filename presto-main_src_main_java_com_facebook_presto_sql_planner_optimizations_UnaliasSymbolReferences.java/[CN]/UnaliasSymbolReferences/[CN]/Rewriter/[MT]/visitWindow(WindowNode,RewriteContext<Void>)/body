{
  PlanNode source=context.rewrite(node.getSource());
  ImmutableMap.Builder<Symbol,Signature> functionInfos=ImmutableMap.builder();
  ImmutableMap.Builder<Symbol,FunctionCall> functionCalls=ImmutableMap.builder();
  for (  Map.Entry<Symbol,FunctionCall> entry : node.getWindowFunctions().entrySet()) {
    Symbol symbol=entry.getKey();
    Symbol canonical=canonicalize(symbol);
    functionCalls.put(canonical,(FunctionCall)canonicalize(entry.getValue()));
    functionInfos.put(canonical,node.getSignatures().get(symbol));
  }
  ImmutableMap.Builder<Symbol,SortOrder> orderings=ImmutableMap.builder();
  for (  Map.Entry<Symbol,SortOrder> entry : node.getOrderings().entrySet()) {
    orderings.put(canonicalize(entry.getKey()),entry.getValue());
  }
  WindowNode.Frame frame=node.getFrame();
  frame=new WindowNode.Frame(frame.getType(),frame.getStartType(),canonicalize(frame.getStartValue()),frame.getEndType(),canonicalize(frame.getEndValue()));
  return new WindowNode(node.getId(),source,new WindowNode.Specification(canonicalizeAndDistinct(node.getPartitionBy()),canonicalizeAndDistinct(node.getOrderBy()),orderings.build(),frame),functionCalls.build(),functionInfos.build(),canonicalize(node.getHashSymbol()),canonicalize(node.getPrePartitionedInputs()),node.getPreSortedOrderPrefix());
}
