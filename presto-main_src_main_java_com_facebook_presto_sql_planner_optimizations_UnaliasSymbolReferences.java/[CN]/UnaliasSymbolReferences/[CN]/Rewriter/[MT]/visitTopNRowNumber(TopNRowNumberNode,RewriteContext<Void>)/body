{
  Map<Symbol,SortOrder> orderings=new HashMap<>();
  for (  Symbol symbol : node.getOrderings().keySet()) {
    orderings.put(canonicalize(symbol),node.getOrderings().get(symbol));
  }
  return new TopNRowNumberNode(node.getId(),context.rewrite(node.getSource()),canonicalizeAndDistinct(node.getPartitionBy()),canonicalizeAndDistinct(node.getOrderBy()),orderings,canonicalize(node.getRowNumberSymbol()),node.getMaxRowCountPerPartition(),node.isPartial(),canonicalize(node.getHashSymbol()));
}
