{
  ImmutableMap.Builder<Symbol,ColumnHandle> builder=ImmutableMap.builder();
  for (  Map.Entry<Symbol,ColumnHandle> entry : node.getAssignments().entrySet()) {
    builder.put(canonicalize(entry.getKey()),entry.getValue());
  }
  Expression originalConstraint=null;
  if (node.getOriginalConstraint() != null) {
    originalConstraint=canonicalize(node.getOriginalConstraint());
  }
  return new TableScanNode(node.getId(),node.getTable(),canonicalize(node.getOutputSymbols()),builder.build(),originalConstraint,node.getGeneratedPartitions());
}
