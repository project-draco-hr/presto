{
  Accumulator singleStep=factory.createAccumulator();
  singleStep.addInput(input);
  Block singleStepResult=singleStep.evaluateFinal();
  Accumulator partialStep=factory.createAccumulator();
  partialStep.addInput(input);
  Accumulator finalStep=factory.createAccumulator();
  Block intermediate=partialStep.evaluateIntermediate();
  finalStep.addIntermediate(intermediate);
  finalStep.addIntermediate(intermediate);
  Block actual=finalStep.evaluateFinal();
  Map<String,Double> expected=Maps.transformValues(extractSingleValue(singleStepResult),new Function<Double,Double>(){
    @Override public Double apply(    Double input){
      return input * 2;
    }
  }
);
  assertEquals(extractSingleValue(actual),expected);
}
