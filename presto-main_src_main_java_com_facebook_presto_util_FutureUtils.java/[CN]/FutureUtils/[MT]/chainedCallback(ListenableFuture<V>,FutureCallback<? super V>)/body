{
  final SettableFuture<?> done=SettableFuture.create();
  Futures.addCallback(future,new FutureCallback<V>(){
    @Override public void onSuccess(    V result){
      try {
        callback.onSuccess(result);
        done.set(null);
      }
 catch (      Throwable e) {
        done.setException(e);
      }
    }
    @Override public void onFailure(    Throwable t){
      try {
        callback.onFailure(t);
        done.set(null);
      }
 catch (      Throwable e) {
        done.setException(e);
      }
    }
  }
);
  return done;
}
