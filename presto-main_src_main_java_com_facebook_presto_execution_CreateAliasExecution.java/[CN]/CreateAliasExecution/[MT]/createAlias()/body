{
  QualifiedTableName aliasTableName=createQualifiedTableName(stateMachine.getSession(),statement.getAlias());
  Optional<TableHandle> aliasTableHandle=metadataManager.getTableHandle(aliasTableName);
  checkState(!aliasTableHandle.isPresent(),"Table %s does not exists",aliasTableHandle);
  Preconditions.checkState(aliasTableHandle.get() instanceof NativeTableHandle,"Can only use a native table as alias");
  QualifiedTableName remoteTableName=createQualifiedTableName(stateMachine.getSession(),statement.getRemote());
  Optional<TableHandle> remoteTableHandle=metadataManager.getTableHandle(remoteTableName);
  checkState(!remoteTableHandle.isPresent(),"Table %s does not exists",remoteTableName);
  TableAlias tableAlias=TableAlias.createTableAlias(remoteTableName,aliasTableName);
  aliasDao.insertAlias(tableAlias);
  stateMachine.finished();
}
