{
  QualifiedTableName aliasTableName=createQualifiedTableName(stateMachine.getSession(),statement.getAlias());
  Optional<TableHandle> aliasTableHandle=metadataManager.getTableHandle(aliasTableName);
  checkState(aliasTableHandle.isPresent(),"Table %s does not exist",aliasTableHandle);
  checkState(aliasTableHandle.get() instanceof NativeTableHandle,"Can only use a native table as alias");
  String aliasConnectorId=metadataManager.getConnectorId(aliasTableHandle.get());
  QualifiedTableName remoteTableName=createQualifiedTableName(stateMachine.getSession(),statement.getRemote());
  Optional<TableHandle> remoteTableHandle=metadataManager.getTableHandle(remoteTableName);
  checkState(remoteTableHandle.isPresent(),"Table %s does not exist",remoteTableName);
  String remoteConnectorId=metadataManager.getConnectorId(remoteTableHandle.get());
  TableAlias tableAlias=new TableAlias(remoteConnectorId,remoteTableName.getSchemaName(),remoteTableName.getTableName(),aliasConnectorId,aliasTableName.getSchemaName(),aliasTableName.getTableName());
  aliasDao.insertAlias(tableAlias);
  stateMachine.finished();
}
