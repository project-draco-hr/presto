{
  checkNotNull(block,"block is null");
  checkState(!finished,"already finished");
  if (!initialized) {
    initialized=true;
  }
  BlockCursor cursor=block.cursor();
  while (cursor.advanceNextPosition()) {
    if (lastTuple == null) {
      startPosition=0;
      tupleCount=1;
      lastTuple=cursor.getTuple();
    }
 else {
      if (!cursor.currentTupleEquals(lastTuple)) {
        writeRunLengthEncodedBlock(sliceOutput,startPosition,tupleCount,lastTuple);
        lastTuple=cursor.getTuple();
        startPosition+=tupleCount;
        tupleCount=0;
      }
      tupleCount++;
    }
  }
  return this;
}
