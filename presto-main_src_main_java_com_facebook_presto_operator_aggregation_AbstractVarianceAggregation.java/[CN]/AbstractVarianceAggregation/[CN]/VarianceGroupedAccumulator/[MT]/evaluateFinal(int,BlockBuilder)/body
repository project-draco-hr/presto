{
  long count=counts.get((long)groupId);
  if (population) {
    if (count == 0) {
      output.appendNull();
    }
 else {
      double m2=m2s.get((long)groupId);
      double result=m2 / count;
      if (standardDeviation) {
        result=Math.sqrt(result);
      }
      output.append(result);
    }
  }
 else {
    if (count < 2) {
      output.appendNull();
    }
 else {
      double m2=m2s.get((long)groupId);
      double result=m2 / (count - 1);
      if (standardDeviation) {
        result=Math.sqrt(result);
      }
      output.append(result);
    }
  }
}
