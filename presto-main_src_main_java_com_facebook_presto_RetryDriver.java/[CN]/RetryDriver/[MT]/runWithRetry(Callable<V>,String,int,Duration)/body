{
  checkNotNull(callable,"callable is null");
  checkNotNull(callableName,"callableName is null");
  checkArgument(maxRetryAttempts > 0,"maxRetryAttempts must be greater than zero");
  checkNotNull(duration,"duration is null");
  int attempt=0;
  while (true) {
    attempt++;
    try {
      return callable.call();
    }
 catch (    Exception e) {
      if (attempt == maxRetryAttempts) {
        throw e;
      }
 else {
        log.debug("Failed on executing %s with attempt %d, will retry. Exception: %s",callableName,attempt,e.getMessage());
      }
      TimeUnit.MILLISECONDS.sleep((long)duration.toMillis());
    }
  }
}
