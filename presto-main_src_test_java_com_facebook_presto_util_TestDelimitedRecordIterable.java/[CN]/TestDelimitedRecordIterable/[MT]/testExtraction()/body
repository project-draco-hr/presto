{
  DelimitedRecordSet recordIterable=new DelimitedRecordSet(newReaderSupplier("apple,fuu,123\nbanana,bar,456"),Splitter.on(','),new ColumnMetadata("fruit",VARCHAR,0,false),new ColumnMetadata("foo",VARCHAR,1,false),new ColumnMetadata("value",VARCHAR,2,false));
  RecordCursor cursor=recordIterable.cursor();
  assertTrue(cursor.advanceNextPosition());
  assertEquals(cursor.getSlice(0),Slices.utf8Slice("apple"));
  assertEquals(cursor.getSlice(1),Slices.utf8Slice("fuu"));
  assertEquals(cursor.getSlice(2),Slices.utf8Slice("123"));
  assertEquals(cursor.getLong(2),123L);
  assertEquals(cursor.getDouble(2),123.0);
  assertTrue(cursor.advanceNextPosition());
  assertEquals(cursor.getSlice(0),Slices.utf8Slice("banana"));
  assertEquals(cursor.getSlice(1),Slices.utf8Slice("bar"));
  assertEquals(cursor.getSlice(2),Slices.utf8Slice("456"));
  assertEquals(cursor.getLong(2),456L);
  assertEquals(cursor.getDouble(2),456.0);
  assertFalse(cursor.advanceNextPosition());
}
