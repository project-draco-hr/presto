{
  if (finished) {
    return;
  }
  PagesIndex pagesIndex=Futures.getUnchecked(pagesIndexFuture);
  operatorContext.setMemoryReservation(0);
  SharedLookupSource sharedLookupSource=new SharedLookupSource(pagesIndex.createLookupSource(hashChannels,hashChannel),operatorContext.getDriverContext().getPipelineContext().getTaskContext());
  if (!lookupSourceFuture.set(sharedLookupSource)) {
    sharedLookupSource.freeMemory();
    sharedLookupSource.close();
  }
  finished=true;
}
