{
  TTransport transport;
  if (socksProxy == null) {
    transport=new TTransportWrapper(new TSocket(host,port,timeoutMillis),host);
    transport.open();
  }
 else {
    Socket socks=createSocksSocket(socksProxy);
    try {
      socks.connect(InetSocketAddress.createUnresolved(host,port),timeoutMillis);
      socks.setSoTimeout(timeoutMillis);
    }
 catch (    IOException e) {
      throw rewriteException(new TTransportException(e),host);
    }
    try {
      transport=new TTransportWrapper(new TSocket(socks),host);
    }
 catch (    TTransportException e) {
      throw rewriteException(e,host);
    }
  }
  return new HiveMetastoreClient(transport);
}
