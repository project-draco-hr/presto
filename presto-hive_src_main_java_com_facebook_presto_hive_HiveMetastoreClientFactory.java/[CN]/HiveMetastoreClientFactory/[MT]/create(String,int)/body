{
  TTransport transport;
  if (socksProxy == null) {
    transport=new TSocket(host,port,(int)timeout.toMillis());
    transport.open();
  }
 else {
    SocketAddress address=InetSocketAddress.createUnresolved(socksProxy.getHostText(),socksProxy.getPort());
    Socket socks=new Socket(new Proxy(Proxy.Type.SOCKS,address));
    try {
      socks.connect(InetSocketAddress.createUnresolved(host,port),(int)timeout.toMillis());
      socks.setSoTimeout(Ints.checkedCast(timeout.toMillis()));
    }
 catch (    IOException e) {
      throw new TTransportException(e);
    }
    transport=new TSocket(socks);
  }
  return new HiveMetastoreClient(transport);
}
