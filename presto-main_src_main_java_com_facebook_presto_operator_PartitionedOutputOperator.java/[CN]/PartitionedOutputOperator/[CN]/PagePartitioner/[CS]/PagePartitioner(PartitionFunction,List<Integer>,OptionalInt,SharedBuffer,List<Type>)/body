{
  this.partitionFunction=requireNonNull(partitionFunction,"partitionFunction is null");
  this.partitionChannels=requireNonNull(partitionChannels,"partitionChannels is null");
  this.nullChannel=requireNonNull(nullChannel,"nullChannel is null");
  this.sharedBuffer=requireNonNull(sharedBuffer,"sharedBuffer is null");
  this.sourceTypes=requireNonNull(sourceTypes,"sourceTypes is null");
  ImmutableList.Builder<PageBuilder> pageBuilders=ImmutableList.builder();
  for (int i=0; i < partitionFunction.getPartitionCount(); i++) {
    pageBuilders.add(new PageBuilder(sourceTypes));
  }
  this.pageBuilders=pageBuilders.build();
}
