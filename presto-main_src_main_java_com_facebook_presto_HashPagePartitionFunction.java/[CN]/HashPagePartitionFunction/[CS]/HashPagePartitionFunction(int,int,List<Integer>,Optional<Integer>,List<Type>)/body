{
  super(partition,partitionCount);
  checkNotNull(partitioningChannels,"partitioningChannels is null");
  checkArgument(!partitioningChannels.isEmpty(),"partitioningChannels is empty");
  this.hashChannel=checkNotNull(hashChannel,"hashChannel is null");
  checkArgument(!hashChannel.isPresent() || hashChannel.get() < types.size(),"invalid hashChannel");
  this.partitioningChannels=ImmutableList.copyOf(partitioningChannels);
  this.types=ImmutableList.copyOf(types);
}
