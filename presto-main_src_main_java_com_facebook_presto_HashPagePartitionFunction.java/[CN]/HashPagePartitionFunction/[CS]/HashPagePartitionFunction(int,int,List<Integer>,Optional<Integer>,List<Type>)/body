{
  checkNotNull(partitioningChannels,"partitioningChannels is null");
  checkArgument(!partitioningChannels.isEmpty(),"partitioningChannels is empty");
  this.hashChannel=checkNotNull(hashChannel,"hashChannel is null");
  checkArgument(!hashChannel.isPresent() || hashChannel.get() < types.size(),"invalid hashChannel");
  this.partition=partition;
  this.partitionCount=partitionCount;
  this.partitioningChannels=ImmutableList.copyOf(partitioningChannels);
  this.hashGenerator=createHashGenerator(hashChannel,partitioningChannels,types);
  this.types=ImmutableList.copyOf(types);
}
