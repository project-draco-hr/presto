{
  super(partition,partitionCount);
  requireNonNull(partitioningChannels,"partitioningChannels is null");
  checkArgument(!partitioningChannels.isEmpty(),"partitioningChannels is empty");
  this.hashChannel=requireNonNull(hashChannel,"hashChannel is null");
  checkArgument(!hashChannel.isPresent() || hashChannel.get() < types.size(),"invalid hashChannel");
  checkArgument(nullPartitioning == NullPartitioning.HASH || partitioningChannels.size() == 1,"size of partitioningChannels is not 1 when nullPartition is REPLICATE.");
  this.partitioningChannels=ImmutableList.copyOf(partitioningChannels);
  this.types=ImmutableList.copyOf(types);
  this.nullPartitioning=nullPartitioning;
}
