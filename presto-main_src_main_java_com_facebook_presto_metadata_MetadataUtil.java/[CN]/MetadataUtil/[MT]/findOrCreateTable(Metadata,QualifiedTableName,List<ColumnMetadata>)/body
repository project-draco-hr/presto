{
  TableMetadata tableMetadata=metadata.getTable(table);
  if (tableMetadata == null || !tableMetadata.getTableHandle().isPresent()) {
    tableMetadata=new TableMetadata(table,columns);
    metadata.createTable(tableMetadata);
    tableMetadata=metadata.getTable(table);
  }
  return tableMetadata;
}
