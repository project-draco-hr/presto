{
  Preconditions.checkNotNull(session,"session is null");
  Preconditions.checkNotNull(name,"name is null");
  Preconditions.checkArgument(name.getParts().size() <= 3,"Too many dots in table name: %s",name);
  List<String> parts=Lists.reverse(name.getParts());
  String tableName=parts.get(0);
  String schemaName=(parts.size() > 1) ? parts.get(1) : session.getSchema();
  String catalogName=(parts.size() > 2) ? parts.get(2) : session.getCatalog();
  return new QualifiedTableName(catalogName,schemaName,tableName);
}
