{
  checkNotNull(metadata,"metadata is null");
  checkNotNull(table,"table is null");
  checkNotNull(columns,"columns is null");
  TableMetadata tableMetadata=metadata.getTable(table);
  checkState(tableMetadata == null || !tableMetadata.getTableHandle().isPresent(),"table %s already exists",table);
  tableMetadata=new TableMetadata(table,columns);
  metadata.createTable(tableMetadata);
  tableMetadata=metadata.getTable(table);
  checkState(tableMetadata != null && tableMetadata.getTableHandle().isPresent(),"Could not create table %s",table);
  return tableMetadata;
}
