{
  ConnectorSession defaultSession=new ConnectorSession("user","test","local",TpchMetadata.TINY_SCHEMA_NAME,UTC_KEY,Locale.ENGLISH,null,null);
  LocalQueryRunner localQueryRunner=new LocalQueryRunner(defaultSession,newCachedThreadPool(daemonThreadsNamed("test")));
  localQueryRunner.createCatalog(defaultSession.getCatalog(),new TpchConnectorFactory(localQueryRunner.getNodeManager(),1),ImmutableMap.<String,String>of());
  localQueryRunner.getMetadata().addFunctions(CUSTOM_FUNCTIONS);
  return localQueryRunner;
}
