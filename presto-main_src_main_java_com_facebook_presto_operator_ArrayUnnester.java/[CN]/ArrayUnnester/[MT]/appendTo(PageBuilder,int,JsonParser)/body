{
  BlockBuilder blockBuilder=pageBuilder.getBlockBuilder(outputChannelOffset);
  try {
    if (jsonParser.getCurrentToken() == JsonToken.VALUE_NULL) {
      blockBuilder.appendNull();
    }
 else     if (elementType.getJavaType() == long.class) {
      elementType.writeLong(blockBuilder,jsonParser.getLongValue());
    }
 else     if (elementType.getJavaType() == double.class) {
      elementType.writeDouble(blockBuilder,jsonParser.getDoubleValue());
    }
 else     if (elementType.getJavaType() == boolean.class) {
      elementType.writeBoolean(blockBuilder,jsonParser.getBooleanValue());
    }
 else     if (elementType.getJavaType() == Slice.class) {
      elementType.writeSlice(blockBuilder,Slices.utf8Slice(jsonParser.getValueAsString()));
    }
 else {
      throw new IllegalArgumentException("Unsupported stack type: " + elementType.getJavaType());
    }
  }
 catch (  IOException e) {
    throw Throwables.propagate(e);
  }
}
