{
  Set<Symbol> dependencies=SymbolExtractor.extract(root);
  PlanFragment fragment=new PlanFragment(id,partitionedSource,Maps.filterKeys(allocator.getTypes(),in(dependencies)),root);
  return new SubPlan(fragment,children);
}
