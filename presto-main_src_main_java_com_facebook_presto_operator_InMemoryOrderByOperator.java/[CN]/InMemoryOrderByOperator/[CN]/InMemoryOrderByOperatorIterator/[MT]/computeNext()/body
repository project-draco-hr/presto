{
  if (pageIndex == null) {
    pageIndex=new PagesIndex(source,expectedPositions,maxSize);
    pageIndex.sort(orderByChannel,sortFields,sortOrder);
  }
  if (currentPosition >= pageIndex.getPositionCount()) {
    return endOfData();
  }
  pageBuilder.reset();
  while (!pageBuilder.isFull() && currentPosition < pageIndex.getPositionCount()) {
    for (int i=0; i < outputChannels.length; i++) {
      pageIndex.appendTupleTo(outputChannels[i],currentPosition,pageBuilder.getBlockBuilder(i));
    }
    currentPosition++;
  }
  if (pageBuilder.isEmpty()) {
    return endOfData();
  }
  Page page=pageBuilder.build();
  return page;
}
