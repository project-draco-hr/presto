{
  AggregationFunction function=functionDefinition.getFunction();
  if (function instanceof VariableWidthAggregationFunction) {
    return new VariableWidthAggregator((VariableWidthAggregationFunction)functionDefinition.getFunction(),functionDefinition.getInputs(),step,expectedGroups);
  }
 else {
    Input input=null;
    if (!functionDefinition.getInputs().isEmpty()) {
      input=Iterables.getOnlyElement(functionDefinition.getInputs());
    }
    return new FixedWidthAggregator((FixedWidthAggregationFunction)functionDefinition.getFunction(),input,step);
  }
}
