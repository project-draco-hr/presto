{
  int length=groupByTupleInfo.size(groupBySlice,rawOffset);
  if (blockBuilder.writableBytes() < length) {
    UncompressedBlock block=blockBuilder.build();
    groupByBlocks.add(block);
    Slice slice=Slices.allocate(Math.max((int)BlockBuilder.DEFAULT_MAX_BLOCK_SIZE.toBytes(),length));
    blockBuilder=new BlockBuilder(groupByTupleInfo,slice.length(),slice.getOutput());
    hashStrategy.addSlice(slice);
  }
  int groupByValueRawOffset=blockBuilder.size();
  blockBuilder.appendTuple(groupBySlice,rawOffset,length);
  int groupId=nextGroupId++;
  addressToGroupId.put(encodeSyntheticAddress(groupByBlocks.size(),groupByValueRawOffset),groupId);
  initializeRow(groupId);
  return groupId;
}
