{
  BlockCursor cursor;
  int field=-1;
  if (input != null) {
    cursor=cursors[input.getChannel()];
    field=input.getField();
  }
 else {
    cursor=null;
  }
  int globalOffset=position * fixedWidthSize;
  int sliceIndex=globalOffset / sliceSize;
  Slice slice=slices.get(sliceIndex);
  int sliceOffset=globalOffset - (sliceIndex * sliceSize);
  if (step == Step.FINAL) {
    function.addIntermediate(cursor,field,slice,sliceOffset);
  }
 else {
    function.addInput(cursor,field,slice,sliceOffset);
  }
}
