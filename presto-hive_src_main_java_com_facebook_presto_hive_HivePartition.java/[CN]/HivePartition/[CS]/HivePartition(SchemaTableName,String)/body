{
  this.tableName=checkNotNull(tableName,"tableName is null");
  this.partitionId=checkNotNull(partitionId,"partitionId is null");
  LinkedHashMap<String,String> keys;
  try {
    keys=Warehouse.makeSpecFromName(partitionId);
  }
 catch (  MetaException e) {
    throw Throwables.propagate(e);
  }
  ImmutableMap.Builder<ColumnHandle,String> builder=ImmutableMap.builder();
  for (  Entry<String,String> entry : keys.entrySet()) {
    ColumnHandle columnHandle=new HiveColumnHandle(entry.getKey());
    builder.put(columnHandle,entry.getValue());
  }
  this.keys=builder.build();
}
