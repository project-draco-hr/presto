{
  AverageBenchmarkResults averageBenchmarkResults=new AverageBenchmarkResults();
  setUp();
  try {
    for (int i=0; i < warmupIterations; i++) {
      runOnce();
    }
    for (int i=0; i < measuredIterations; i++) {
      Map<String,Long> results=runOnce();
      if (benchmarkResultHook != null) {
        benchmarkResultHook.addResults(results);
      }
      averageBenchmarkResults.addResults(results);
    }
  }
  finally {
    tearDown();
  }
  if (benchmarkResultHook != null) {
    benchmarkResultHook.finished();
  }
  Map<String,String> resultsAvg=averageBenchmarkResults.getAverageResultsStrings();
  String avg=Joiner.on(", ").withKeyValueSeparator(": ").join(resultsAvg);
  System.out.printf("%35s avg results :: %s%n",getBenchmarkName(),avg);
}
