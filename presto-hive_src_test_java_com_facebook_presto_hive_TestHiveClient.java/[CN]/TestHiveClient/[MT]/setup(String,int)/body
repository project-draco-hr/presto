{
  HiveClientConfig hiveClientConfig=new HiveClientConfig();
  String proxy=System.getProperty("hive.metastore.thrift.client.socks-proxy");
  if (proxy != null) {
    hiveClientConfig.setMetastoreSocksProxy(HostAndPort.fromString(proxy));
  }
  FileSystemWrapper fileSystemWrapper=new FileSystemWrapperProvider(new FileSystemCache(hiveClientConfig),new SlowDatanodeSwitcher(hiveClientConfig),hiveClientConfig).get();
  this.client=new HiveClient(1024 * 1024 * 1024,100,50,500,getHiveChunkEncoder(),new CachingHiveMetastore(new TestingHiveCluster(host,port),Duration.valueOf("1m")),new HdfsEnvironment(new HdfsConfiguration(),fileSystemWrapper),MoreExecutors.sameThreadExecutor());
}
