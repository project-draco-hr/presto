{
  AsyncScribeLogger asyncScribeLogger=new AsyncScribeLogger(2,provider,DataSize.valueOf("1MB"));
  AsyncScribeLogger.FlushTask flushTask=asyncScribeLogger.createFlushTask();
  asyncScribeLogger.log(createLogEntry("cat1","msg"));
  asyncScribeLogger.log(createLogEntry("cat2","msg"));
  asyncScribeLogger.log(createLogEntry("cat3","msg"));
  assertTrue(logRecorder.getLoggedMessages().isEmpty());
  assertEquals(logRecorder.getLogCallCount(),0);
  flushTask.process();
  assertEquals(logRecorder.getLoggedMessages().size(),2);
  assertEquals(new String(logRecorder.getLoggedMessages().get(0).getCategory(),Charsets.UTF_8),"cat2");
  assertEquals(new String(logRecorder.getLoggedMessages().get(1).getCategory(),Charsets.UTF_8),"cat3");
  assertEquals(logRecorder.getLogCallCount(),1);
}
