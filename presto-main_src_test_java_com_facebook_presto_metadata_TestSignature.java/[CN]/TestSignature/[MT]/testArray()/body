{
  TypeManager typeManager=new TypeRegistry();
  Signature signature=new Signature("get",SCALAR,ImmutableList.of(typeParameter("T")),"T",ImmutableList.of("array(T)"),false);
  assertNotNull(signature.bindTypeParameters(ImmutableList.of(typeManager.getType(parseTypeSignature("array(bigint)"))),true,typeManager));
  assertNull(signature.bindTypeParameters(ImmutableList.of(BIGINT),true,typeManager));
  signature=new Signature("contains",SCALAR,ImmutableList.of(comparableTypeParameter("T")),"T",ImmutableList.of("array(T)","T"),false);
  assertNotNull(signature.bindTypeParameters(ImmutableList.of(typeManager.getType(parseTypeSignature("array(bigint)")),BIGINT),true,typeManager));
  assertNull(signature.bindTypeParameters(ImmutableList.of(typeManager.getType(parseTypeSignature("array(bigint)")),VARCHAR),true,typeManager));
  assertNull(signature.bindTypeParameters(ImmutableList.of(typeManager.getType(parseTypeSignature("array(HyperLogLog)")),HYPER_LOG_LOG),true,typeManager));
  signature=new Signature("foo",SCALAR,ImmutableList.of(typeParameter("T")),"T",ImmutableList.of("array(T)","array(T)"),false);
  assertNotNull(signature.bindTypeParameters(ImmutableList.of(typeManager.getType(parseTypeSignature("array(bigint)")),typeManager.getType(parseTypeSignature("array(bigint)"))),true,typeManager));
  assertNull(signature.bindTypeParameters(ImmutableList.of(typeManager.getType(parseTypeSignature("array(bigint)")),typeManager.getType(parseTypeSignature("array(varchar)"))),true,typeManager));
}
