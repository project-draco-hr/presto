{
  if (!types[fieldId].equals(type)) {
    throw new IllegalArgumentException(format("Expected field to be %s, actual %s (field %s)",type,types[fieldId],fieldId));
  }
}
