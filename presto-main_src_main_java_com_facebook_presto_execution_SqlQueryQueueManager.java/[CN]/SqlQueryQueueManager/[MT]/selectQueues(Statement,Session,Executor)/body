{
  for (  ResourceGroupSelector selector : selectors) {
    Optional<List<QueryQueueDefinition>> queues=selector.match(statement,session.toSessionRepresentation());
    if (queues.isPresent()) {
      return getOrCreateQueues(session,executor,queues.get());
    }
  }
  throw new PrestoException(QUERY_REJECTED,"Query did not match any queuing rule");
}
