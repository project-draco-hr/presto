{
  Session session=queryExecution.getQueryInfo().getSession().toSession();
  List<QueryQueue> queues=selectQueues(session,executor);
  for (  QueryQueue queue : queues) {
    if (!queue.reserve(queryExecution)) {
      return false;
    }
  }
  return queues.get(0).enqueue(createQueuedExecution(queryExecution,queues.subList(1,queues.size()),executor,stats));
}
