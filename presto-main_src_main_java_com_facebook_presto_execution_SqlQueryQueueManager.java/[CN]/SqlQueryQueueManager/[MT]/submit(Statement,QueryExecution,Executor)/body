{
  List<QueryQueue> queues;
  try {
    queues=selectQueues(queryExecution.getSession(),executor);
  }
 catch (  PrestoException e) {
    queryExecution.fail(e);
    return false;
  }
  for (  QueryQueue queue : queues) {
    if (!queue.reserve(queryExecution)) {
      return false;
    }
  }
  queues.get(0).enqueue(createQueuedExecution(queryExecution,queues.subList(1,queues.size()),executor));
  return true;
}
