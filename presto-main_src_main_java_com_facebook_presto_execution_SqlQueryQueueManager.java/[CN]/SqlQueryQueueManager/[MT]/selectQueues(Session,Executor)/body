{
  for (  QueryQueueRule rule : rules) {
    List<QueryQueueDefinition> definitions=rule.match(session);
    if (definitions != null) {
      return getOrCreateQueues(session,executor,definitions);
    }
  }
  throw new PrestoException(USER_ERROR,"Query did not match any queuing rule");
}
