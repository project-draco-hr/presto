{
  String tableNameInDatabase=tablesState.get(TABLE_NAME).getNameInDatabase();
  String selectFromAllPartitionsSql="SELECT * FROM " + tableNameInDatabase;
  QueryResult allPartitionsQueryResult=query(selectFromAllPartitionsSql);
  assertThat(allPartitionsQueryResult).containsOnly(row(42,1),row(42,2));
  assertProcessedLinesCountEquals(selectFromAllPartitionsSql,allPartitionsQueryResult,2);
  String selectFromOnePartitionsSql="SELECT * FROM " + tableNameInDatabase + " WHERE part_col = 2";
  QueryResult onePartitionQueryResult=query(selectFromOnePartitionsSql);
  assertThat(onePartitionQueryResult).containsOnly(row(42,2));
  assertProcessedLinesCountEquals(selectFromOnePartitionsSql,onePartitionQueryResult,1);
}
