{
  fieldCount=handle.getColumnNames().size();
  sampleWeightField=handle.getColumnNames().indexOf(SAMPLE_WEIGHT_COLUMN_NAME);
  columnTypes=ImmutableList.copyOf(handle.getColumnTypes());
  connectorSession=handle.getConnectorSession();
  Iterable<String> hiveTypeNames=transform(transform(handle.getColumnTypes(),columnTypeToHiveType()),hiveTypeNameGetter());
  Properties properties=new Properties();
  properties.setProperty(META_TABLE_COLUMNS,Joiner.on(',').join(handle.getColumnNames()));
  properties.setProperty(META_TABLE_COLUMN_TYPES,Joiner.on(':').join(hiveTypeNames));
  serializer=initializeSerializer(conf,properties,handle.getHiveStorageFormat().getSerDe());
  recordWriter=createRecordWriter(target,conf,properties,handle.getHiveStorageFormat().getOutputFormat());
  tableInspector=getStandardStructObjectInspector(handle.getColumnNames(),getJavaObjectInspectors(columnTypes));
  structFields=ImmutableList.copyOf(tableInspector.getAllStructFieldRefs());
  row=tableInspector.create();
}
