{
  assertWindowQuery("first_value(orderdate) OVER (PARTITION BY orderstatus ORDER BY orderkey)",resultBuilder(TEST_SESSION,BIGINT,VARCHAR,VARCHAR).row(3,"F","1993-10-14").row(5,"F","1993-10-14").row(6,"F","1993-10-14").row(33,"F","1993-10-14").row(1,"O","1996-01-02").row(2,"O","1996-01-02").row(4,"O","1996-01-02").row(7,"O","1996-01-02").row(32,"O","1996-01-02").row(34,"O","1996-01-02").build());
  assertWindowQueryWithNulls("first_value(orderdate) OVER (PARTITION BY orderstatus ORDER BY orderkey)",resultBuilder(TEST_SESSION,BIGINT,VARCHAR,VARCHAR).row(3,"F","1993-10-14").row(5,"F","1993-10-14").row(null,"F","1993-10-14").row(null,"F","1993-10-14").row(34,"O","1998-07-21").row(null,"O","1998-07-21").row(1,null,null).row(7,null,null).row(null,null,null).row(null,null,null).build());
  assertWindowQuery("first_value(orderkey) OVER (PARTITION BY orderstatus ORDER BY orderkey)",resultBuilder(TEST_SESSION,BIGINT,VARCHAR,BIGINT).row(3,"F",3).row(5,"F",3).row(6,"F",3).row(33,"F",3).row(1,"O",1).row(2,"O",1).row(4,"O",1).row(7,"O",1).row(32,"O",1).row(34,"O",1).build());
  assertWindowQueryWithNulls("first_value(orderkey) OVER (PARTITION BY orderstatus ORDER BY orderkey)",resultBuilder(TEST_SESSION,BIGINT,VARCHAR,BIGINT).row(3,"F",3).row(5,"F",3).row(null,"F",3).row(null,"F",3).row(34,"O",34).row(null,"O",34).row(1,null,1).row(7,null,1).row(null,null,1).row(null,null,1).build());
  assertWindowQuery("date_format(first_value(cast(orderdate as TIMESTAMP)) OVER (PARTITION BY orderstatus ORDER BY orderkey), '%Y-%m-%d')",resultBuilder(TEST_SESSION,BIGINT,VARCHAR,VARCHAR).row(3,"F","1993-10-14").row(5,"F","1993-10-14").row(6,"F","1993-10-14").row(33,"F","1993-10-14").row(1,"O","1996-01-02").row(2,"O","1996-01-02").row(4,"O","1996-01-02").row(7,"O","1996-01-02").row(32,"O","1996-01-02").row(34,"O","1996-01-02").build());
}
