{
  String queryId=String.valueOf(nextQueryId++);
  QueryState queryState=new QueryState(1,pageBufferMax);
  QueryTask queryTask;
switch (planFragment.getQuery()) {
case "sum-frag-worker":
    queryTask=new SumFragmentWorker(queryState,sourceSplits,planFragment.getColumnHandles(),dataStreamProvider,shardExecutor);
  break;
default :
throw new IllegalArgumentException("Unsupported fragment query: " + planFragment.getQuery());
}
queries.put(queryId,queryState);
queryExecutor.submit(queryTask);
return new QueryInfo(queryId,queryTask.getTupleInfos());
}
