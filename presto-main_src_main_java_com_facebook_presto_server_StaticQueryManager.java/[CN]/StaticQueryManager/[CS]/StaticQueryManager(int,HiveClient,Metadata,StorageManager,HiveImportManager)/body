{
  Preconditions.checkArgument(blockBufferMax > 0,"blockBufferMax must be at least 1");
  this.blockBufferMax=blockBufferMax;
  executor=Executors.newCachedThreadPool(new ThreadFactoryBuilder().setNameFormat("http-query-processor-%d").build());
  this.hiveClient=hiveClient;
  this.metadata=metadata;
  this.storageManager=storageManager;
  this.hiveImportManager=hiveImportManager;
}
