{
  MapType mapType=new MapType(DOUBLE,VARCHAR);
  InternalAggregationFunction aggFunc=metadata.getExactFunction(new Signature(NAME,mapType.getTypeSignature().toString(),StandardTypes.DOUBLE,StandardTypes.VARCHAR)).getAggregationFunction();
  assertAggregation(aggFunc,1.0,ImmutableMap.of(1.0,"a",2.0,"b",3.0,"c"),new Page(createDoublesBlock(1.0,2.0,3.0),createStringsBlock("a","b","c")));
  mapType=new MapType(DOUBLE,BIGINT);
  aggFunc=metadata.getExactFunction(new Signature(NAME,mapType.getTypeSignature().toString(),StandardTypes.DOUBLE,StandardTypes.BIGINT)).getAggregationFunction();
  assertAggregation(aggFunc,1.0,ImmutableMap.of(1.0,3L,2.0,2L,3.0,1L),new Page(createDoublesBlock(1.0,2.0,3.0),createLongsBlock(3L,2L,1L)));
  mapType=new MapType(DOUBLE,BOOLEAN);
  aggFunc=metadata.getExactFunction(new Signature(NAME,mapType.getTypeSignature().toString(),StandardTypes.DOUBLE,StandardTypes.BOOLEAN)).getAggregationFunction();
  assertAggregation(aggFunc,1.0,ImmutableMap.of(1.0,true,2.0,false,3.0,false),new Page(createDoublesBlock(1.0,2.0,3.0),createBooleansBlock(true,false,false)));
}
