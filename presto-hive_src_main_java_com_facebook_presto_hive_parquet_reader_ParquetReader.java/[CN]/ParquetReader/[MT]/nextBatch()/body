{
  if (nextRowInGroup >= currentGroupRowCount) {
    if (!advanceToNextRowGroup()) {
      return -1;
    }
  }
  int batchSize=Ints.checkedCast(Math.min(MAX_VECTOR_LENGTH,currentGroupRowCount - nextRowInGroup));
  nextRowInGroup+=batchSize;
  currentPosition+=batchSize;
  return batchSize;
}
