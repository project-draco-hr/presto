{
  ImmutableMap.Builder<Symbol,Type> symbolTypes=ImmutableMap.builder();
  for (  Entry<Symbol,Input> entry : symbolToInputMappings.entrySet()) {
    symbolTypes.put(entry.getKey(),channels[entry.getValue().getChannel()].getType());
  }
  MetadataManager metadata=new MetadataManager();
  InterpretedProjectionFunction projectionFunction=new InterpretedProjectionFunction(createExpression(expression,metadata,symbolTypes.build()),symbolTypes.build(),symbolToInputMappings,metadata,new ConnectorSession("user","test","catalog","schema",UTC_KEY,Locale.ENGLISH,null,null));
  BlockBuilder builder=projectionFunction.getType().createBlockBuilder(new BlockBuilderStatus());
  projectionFunction.project(channels,builder);
  Object actualValue=BlockAssertions.getOnlyValue(builder.build());
  assertEquals(actualValue,expectedValue);
}
