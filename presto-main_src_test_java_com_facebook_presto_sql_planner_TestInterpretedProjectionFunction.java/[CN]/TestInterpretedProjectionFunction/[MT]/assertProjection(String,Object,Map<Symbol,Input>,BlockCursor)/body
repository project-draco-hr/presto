{
  ImmutableMap.Builder<Symbol,Type> symbolTypes=ImmutableMap.builder();
  for (  Entry<Symbol,Input> entry : symbolToInputMappings.entrySet()) {
    symbolTypes.put(entry.getKey(),channels[entry.getValue().getChannel()].getType());
  }
  InterpretedProjectionFunction projectionFunction=new InterpretedProjectionFunction(createExpression(expression,DUAL_METADATA_MANAGER,symbolTypes.build()),symbolTypes.build(),symbolToInputMappings,DUAL_METADATA_MANAGER,new Session("user","test",Session.DEFAULT_CATALOG,Session.DEFAULT_SCHEMA,TimeZone.getTimeZone("UTC"),Locale.ENGLISH,null,null));
  BlockBuilder builder=projectionFunction.getType().createBlockBuilder(new BlockBuilderStatus());
  projectionFunction.project(channels,builder);
  Object actualValue=BlockAssertions.getOnlyValue(builder.build());
  assertEquals(actualValue,expectedValue);
}
