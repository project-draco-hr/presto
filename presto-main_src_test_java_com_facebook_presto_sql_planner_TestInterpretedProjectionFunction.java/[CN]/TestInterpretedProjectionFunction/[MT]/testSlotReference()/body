{
  Slot longSlot=new Slot(0,LONG);
  assertProjection(LONG,toExpression("slot",LONG),42L,ImmutableMap.of(longSlot,0),createTuple(42L));
  assertProjection(LONG,toExpression("slot",LONG),null,ImmutableMap.of(longSlot,0),NULL_LONG_TUPLE);
  Slot doubleSlot=new Slot(0,DOUBLE);
  assertProjection(DOUBLE,toExpression("slot",DOUBLE),11.1,ImmutableMap.of(doubleSlot,0),createTuple(11.1));
  assertProjection(DOUBLE,toExpression("slot",DOUBLE),null,ImmutableMap.of(doubleSlot,0),NULL_DOUBLE_TUPLE);
  Slot stringSlot=new Slot(0,STRING);
  assertProjection(STRING,toExpression("slot",STRING),"foo",ImmutableMap.of(stringSlot,0),createTuple("foo"));
  assertProjection(STRING,toExpression("slot",STRING),null,ImmutableMap.of(stringSlot,0),NULL_STRING_TUPLE);
}
