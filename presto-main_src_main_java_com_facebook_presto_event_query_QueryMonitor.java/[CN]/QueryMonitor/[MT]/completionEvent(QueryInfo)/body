{
  ExecutionStats globalExecutionStats=globalExecutionStats(queryInfo.getOutputStage());
  eventClient.post(new QueryCompletionEvent(queryInfo.getQueryId(),queryInfo.getState(),queryInfo.getSelf(),queryInfo.getFieldNames(),queryInfo.getQuery(),queryInfo.getQueryStats().getCreateTime(),queryInfo.getQueryStats().getExecutionStartTime(),queryInfo.getQueryStats().getEndTime(),queryInfo.getQueryStats().getQueuedTime(),queryInfo.getQueryStats().getAnalysisTime(),queryInfo.getQueryStats().getDistributedPlanningTime(),globalExecutionStats.getSplitWallTime(),globalExecutionStats.getSplitCpuTime(),globalExecutionStats.getCompletedDataSize(),globalExecutionStats.getCompletedPositionCount(),queryInfo.getQueryStats().getSplits(),stageInfoJsonCodec.toJson(queryInfo.getOutputStage()),failureInfoJsonCodec.toJson(queryInfo.getFailures())));
}
