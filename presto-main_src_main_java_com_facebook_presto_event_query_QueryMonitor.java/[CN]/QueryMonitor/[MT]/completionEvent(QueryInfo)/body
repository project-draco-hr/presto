{
  ExecutionStats globalExecutionStats=globalExecutionStats(queryInfo.getOutputStage());
  eventClient.post(new QueryCompletionEvent(queryInfo.getQueryId(),queryInfo.getSession().getUser(),queryInfo.getSession().getCatalog(),queryInfo.getSession().getSchema(),queryInfo.getState(),queryInfo.getSelf(),queryInfo.getFieldNames(),queryInfo.getQuery(),queryInfo.getQueryStats().getCreateTime(),queryInfo.getQueryStats().getExecutionStartTime(),queryInfo.getQueryStats().getEndTime(),queryInfo.getQueryStats().getQueuedTime(),queryInfo.getQueryStats().getAnalysisTime(),queryInfo.getQueryStats().getDistributedPlanningTime(),globalExecutionStats.getSplitWallTime(),globalExecutionStats.getSplitCpuTime(),globalExecutionStats.getCompletedDataSize(),globalExecutionStats.getCompletedPositionCount(),globalExecutionStats.getSplits(),stageInfoCodec.toJson(queryInfo.getOutputStage()),failureInfoCodec.toJson(queryInfo.getFailureInfo())));
}
