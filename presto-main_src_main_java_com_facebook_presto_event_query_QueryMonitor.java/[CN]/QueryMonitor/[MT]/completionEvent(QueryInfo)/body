{
  try {
    QueryStats queryStats=queryInfo.getQueryStats();
    eventClient.post(new QueryCompletionEvent(queryInfo.getQueryId(),queryInfo.getSession().getUser(),queryInfo.getSession().getSource(),environment,queryInfo.getSession().getCatalog(),queryInfo.getSession().getSchema(),queryInfo.getSession().getRemoteUserAddress(),queryInfo.getSession().getUserAgent(),queryInfo.getState(),queryInfo.getSelf(),queryInfo.getFieldNames(),queryInfo.getQuery(),queryStats.getCreateTime(),queryStats.getExecutionStartTime(),queryStats.getEndTime(),queryStats.getQueuedTime(),queryStats.getAnalysisTime(),queryStats.getDistributedPlanningTime(),queryStats.getTotalScheduledTime(),queryStats.getTotalCpuTime(),queryStats.getInputDataSize(),queryStats.getInputPositions(),queryStats.getTotalDrivers(),objectMapper.writeValueAsString(queryInfo.getOutputStage()),objectMapper.writeValueAsString(queryInfo.getFailureInfo())));
  }
 catch (  JsonProcessingException e) {
    throw Throwables.propagate(e);
  }
}
