{
  Duration timeToStart=null;
  if (driverStats.getStartTime() != null) {
    timeToStart=new Duration(driverStats.getStartTime().getMillis() - driverStats.getCreateTime().getMillis(),MILLISECONDS);
  }
  Duration timeToEnd=null;
  if (driverStats.getEndTime() != null) {
    timeToEnd=new Duration(driverStats.getEndTime().getMillis() - driverStats.getCreateTime().getMillis(),MILLISECONDS);
  }
  try {
    eventClient.post(new SplitCompletionEvent(taskId.getQueryId(),taskId.getStageId(),taskId,environment,driverStats.getQueuedTime(),driverStats.getStartTime(),timeToStart,timeToEnd,driverStats.getInputDataSize(),driverStats.getInputPositions(),driverStats.getElapsedTime(),driverStats.getTotalCpuTime(),driverStats.getTotalUserTime(),objectMapper.writeValueAsString(driverStats)));
  }
 catch (  JsonProcessingException e) {
    log.error(e,"Error posting split completion event for task %s",taskId);
  }
}
