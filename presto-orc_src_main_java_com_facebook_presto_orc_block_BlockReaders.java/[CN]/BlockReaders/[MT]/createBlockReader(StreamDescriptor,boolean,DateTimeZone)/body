{
switch (streamDescriptor.getStreamType()) {
case BOOLEAN:
    return new BooleanBlockReader(streamDescriptor);
case BYTE:
  return new ByteBlockReader(streamDescriptor);
case SHORT:
case INT:
case LONG:
return new LongBlockReader(streamDescriptor);
case FLOAT:
return new FloatBlockReader(streamDescriptor);
case DOUBLE:
return new DoubleBlockReader(streamDescriptor);
case BINARY:
case STRING:
return new SliceBlockReader(streamDescriptor);
case TIMESTAMP:
return new TimestampBlockReader(streamDescriptor,hiveStorageTimeZone);
case DATE:
return new DateBlockReader(streamDescriptor);
case STRUCT:
return new StructBlockReader(streamDescriptor,checkForNulls,hiveStorageTimeZone);
case LIST:
return new ListBlockReader(streamDescriptor,checkForNulls,hiveStorageTimeZone);
case MAP:
return new MapBlockReader(streamDescriptor,checkForNulls,hiveStorageTimeZone);
case UNION:
case DECIMAL:
case VARCHAR:
case CHAR:
default :
throw new IllegalArgumentException("Unsupported type: " + streamDescriptor.getStreamType());
}
}
