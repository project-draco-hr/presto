{
  this.catalog=catalog;
  this.schema=schema;
  this.dataStreamProvider=dataStreamProvider;
  this.metadata=metadata;
  try {
    discoveryServer=new DiscoveryTestingServer();
    coordinator=new PrestoTestingServer(discoveryServer.getBaseUrl());
    servers=ImmutableList.<PrestoTestingServer>builder().add(coordinator).add(new PrestoTestingServer(discoveryServer.getBaseUrl())).add(new PrestoTestingServer(discoveryServer.getBaseUrl())).build();
  }
 catch (  Exception e) {
    tearDownQueryFramework();
    throw e;
  }
  this.httpClient=new ApacheAsyncHttpClient(new HttpClientConfig().setConnectTimeout(new Duration(1,TimeUnit.DAYS)).setReadTimeout(new Duration(10,TimeUnit.DAYS)));
  for (  PrestoTestingServer server : servers) {
    server.refreshServiceSelectors();
  }
  loadedTableNames=distributeData();
}
