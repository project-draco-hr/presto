{
  AtomicInteger queueSize;
  int maxQueueSize;
  AsyncSemaphore<QueryExecution> asyncSemaphore;
  if (isBigQueryEnabled(queryExecution.getQueryInfo().getSession(),false)) {
    queueSize=bigQueryQueueSize;
    maxQueueSize=maxQueuedBigQueries;
    asyncSemaphore=bigQueryAsyncSemaphore;
  }
 else {
    queueSize=queryQueueSize;
    maxQueueSize=maxQueuedQueries;
    asyncSemaphore=queryAsyncSemaphore;
  }
  if (queueSize.incrementAndGet() > maxQueueSize) {
    queueSize.decrementAndGet();
    return false;
  }
  asyncSemaphore.submit(queryExecution);
  return true;
}
