{
  Preconditions.checkNotNull(queryId,"queryId is null");
  Preconditions.checkNotNull(maxWait,"maxWait is null");
  QueryExecution query=queries.get(queryId);
  if (query == null) {
    return maxWait;
  }
  query.getQueryInfo().getQueryStats().recordHeartbeat();
  return query.waitForStateChange(currentState,maxWait);
}
