{
  DateTime oldestAllowedQuery=DateTime.now().minus(maxQueryAge.toMillis());
  for (  QueryExecution queryExecution : queries.values()) {
    try {
      QueryInfo queryInfo=queryExecution.getQueryInfo();
      DateTime endTime=queryInfo.getQueryStats().getEndTime();
      if (endTime != null && endTime.isBefore(oldestAllowedQuery)) {
        removeQuery(queryExecution.getQueryInfo().getQueryId());
      }
    }
 catch (    Exception e) {
      log.warn(e,"Error while inspecting age of query %s",queryExecution.getQueryInfo().getQueryId());
    }
  }
}
