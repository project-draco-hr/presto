{
  DateTime timeHorizon=DateTime.now().minus(maxQueryAge.toMillis());
  while (expirationQueue.size() > maxQueryHistory) {
    QueryInfo info=expirationQueue.peek().getQueryInfo();
    if (info.getQueryStats().getEndTime().isAfter(timeHorizon)) {
      return;
    }
    removeQuery(info.getQueryId());
    expirationQueue.remove();
  }
}
