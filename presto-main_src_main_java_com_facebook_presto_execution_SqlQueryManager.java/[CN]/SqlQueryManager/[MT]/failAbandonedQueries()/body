{
  for (  QueryExecution queryExecution : queries.values()) {
    try {
      QueryInfo queryInfo=queryExecution.getQueryInfo();
      if (queryInfo.getState().isDone()) {
        continue;
      }
      if (isAbandoned(queryExecution)) {
        log.info("Failing abandoned query %s",queryExecution.getQueryInfo().getQueryId());
        queryExecution.fail(new AbandonedException("Query " + queryInfo.getQueryId(),queryInfo.getQueryStats().getLastHeartbeat(),DateTime.now()));
      }
    }
 catch (    Exception e) {
      log.warn(e,"Error while inspecting age of query %s",queryExecution.getQueryInfo().getQueryId());
    }
  }
}
