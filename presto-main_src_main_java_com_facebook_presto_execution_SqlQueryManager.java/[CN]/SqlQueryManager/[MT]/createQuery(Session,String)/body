{
  checkNotNull(query,"query is null");
  Preconditions.checkArgument(query.length() > 0,"query must not be empty string");
  String queryId=String.valueOf(nextQueryId.getAndIncrement());
  QueryExecution queryExecution;
  if (query.startsWith("import-table:")) {
    Preconditions.checkState(importsEnabled,"Imports are currently disabled");
    ImmutableList<String> strings=ImmutableList.copyOf(Splitter.on(":").split(query));
    queryExecution=new ImportTableExecution(queryId,session,locationFactory.createQueryLocation(queryId),importClientManager,importManager,metadata,strings.get(1),strings.get(2),strings.get(3),query);
  }
 else {
    queryExecution=new SqlQueryExecution(queryId,query,session,metadata,splitManager,nodeManager,remoteTaskFactory,locationFactory,queryMonitor,maxPendingSplitsPerNode);
    queryMonitor.createdEvent(queryExecution.getQueryInfo());
  }
  queries.put(queryExecution.getQueryId(),queryExecution);
  queryExecutor.submit(new QueryStarter(queryExecution));
  return queryExecution.getQueryInfo();
}
