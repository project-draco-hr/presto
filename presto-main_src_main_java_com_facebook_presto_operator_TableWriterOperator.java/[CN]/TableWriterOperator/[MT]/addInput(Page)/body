{
  checkNotNull(page,"page is null");
  checkState(state == State.RUNNING,"Operator is %s",state);
  Block sampleWeightBlock=null;
  if (sampleWeightChannel.isPresent()) {
    sampleWeightBlock=page.getBlock(sampleWeightChannel.get());
  }
  Block[] blocks=new Block[inputChannels.size()];
  for (int outputChannel=0; outputChannel < inputChannels.size(); outputChannel++) {
    blocks[outputChannel]=page.getBlock(inputChannels.get(outputChannel));
  }
  for (int position=0; position < page.getPositionCount(); position++) {
    long sampleWeight=1;
    if (sampleWeightBlock != null) {
      sampleWeight=BIGINT.getLong(sampleWeightBlock,position);
    }
    recordSink.beginRecord(sampleWeight);
    for (int i=0; i < blocks.length; i++) {
      writeField(position,blocks[i],recordTypes.get(i));
    }
    recordSink.finishRecord();
  }
  rowCount+=page.getPositionCount();
}
