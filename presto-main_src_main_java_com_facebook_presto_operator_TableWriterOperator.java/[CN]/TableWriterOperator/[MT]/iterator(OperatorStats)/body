{
  checkState(!used.getAndSet(true),"TableWriteOperator can be used only once");
  checkState(input.get() != null,"No shard id was set!");
  try {
    ColumnFileHandle columnFileHandle=storageManager.createStagingFileHandles(input.get().getShardId(),columnHandles);
    return new TableWriteIterator(sourceOperator.iterator(operatorStats),columnFileHandle);
  }
 catch (  IOException e) {
    throw Throwables.propagate(e);
  }
}
