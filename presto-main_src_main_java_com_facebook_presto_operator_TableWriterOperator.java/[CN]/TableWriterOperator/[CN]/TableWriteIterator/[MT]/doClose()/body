{
  if (!closed.getAndSet(true)) {
    checkState(operatorStats.isDone() || !sourceIterator.hasNext(),"Writer was closed while source iterator still has data and the operator is not done!");
    commitFileHandle(fileHandle);
    sourceIterator.close();
    output.set(ImmutableSet.of(new TableWriterResult(input.get().getShardId(),nodeIdentifier)));
  }
}
