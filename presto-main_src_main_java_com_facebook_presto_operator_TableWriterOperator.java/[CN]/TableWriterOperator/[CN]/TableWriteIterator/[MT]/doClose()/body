{
  if (!closed.getAndSet(true)) {
    checkState(!sourceIterator.hasNext(),"writer closed with source iterator still having data!");
    commitFileHandle(fileHandle);
    sourceIterator.close();
    output.set(ImmutableSet.of(new TableWriterResult(input.get().getShardId(),nodeIdentifier)));
  }
}
