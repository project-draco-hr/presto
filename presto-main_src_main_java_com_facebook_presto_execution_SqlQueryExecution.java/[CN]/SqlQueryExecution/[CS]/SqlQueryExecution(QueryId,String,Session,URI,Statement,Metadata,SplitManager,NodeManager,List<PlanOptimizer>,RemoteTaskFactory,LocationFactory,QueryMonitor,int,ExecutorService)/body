{
  this.statement=checkNotNull(statement,"statement is null");
  this.metadata=checkNotNull(metadata,"metadata is null");
  this.splitManager=checkNotNull(splitManager,"splitManager is null");
  this.nodeManager=checkNotNull(nodeManager,"nodeManager is null");
  this.planOptimizers=checkNotNull(planOptimizers,"planOptimizers is null");
  this.remoteTaskFactory=checkNotNull(remoteTaskFactory,"remoteTaskFactory is null");
  this.locationFactory=checkNotNull(locationFactory,"locationFactory is null");
  this.queryExecutor=checkNotNull(queryExecutor,"queryExecutor is null");
  checkArgument(maxPendingSplitsPerNode > 0,"maxPendingSplitsPerNode must be greater than 0");
  this.maxPendingSplitsPerNode=maxPendingSplitsPerNode;
  checkNotNull(queryId,"queryId is null");
  checkNotNull(query,"query is null");
  checkNotNull(session,"session is null");
  checkNotNull(self,"self is null");
  checkNotNull(queryMonitor,"queryMonitor is null");
  this.stateMachine=new QueryStateMachine(queryId,query,session,self,queryMonitor);
}
