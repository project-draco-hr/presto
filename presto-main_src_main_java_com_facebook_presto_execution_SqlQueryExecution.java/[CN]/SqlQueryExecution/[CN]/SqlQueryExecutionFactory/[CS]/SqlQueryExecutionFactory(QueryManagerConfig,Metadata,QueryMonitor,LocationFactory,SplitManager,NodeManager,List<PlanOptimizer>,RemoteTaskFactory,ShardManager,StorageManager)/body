{
  Preconditions.checkNotNull(config,"config is null");
  this.maxPendingSplitsPerNode=config.getMaxPendingSplitsPerNode();
  this.metadata=checkNotNull(metadata,"metadata is null");
  this.queryMonitor=checkNotNull(queryMonitor,"queryMonitor is null");
  this.locationFactory=checkNotNull(locationFactory,"locationFactory is null");
  this.splitManager=checkNotNull(splitManager,"splitManager is null");
  this.nodeManager=checkNotNull(nodeManager,"nodeManager is null");
  this.planOptimizers=checkNotNull(planOptimizers,"planOptimizers is null");
  this.remoteTaskFactory=checkNotNull(remoteTaskFactory,"remoteTaskFactory is null");
  this.shardManager=checkNotNull(shardManager,"shardManager is null");
  this.storageManager=checkNotNull(storageManager,"storageManager is null");
  this.queryExecutor=Executors.newCachedThreadPool(threadsNamed("query-scheduler-%d"));
}
