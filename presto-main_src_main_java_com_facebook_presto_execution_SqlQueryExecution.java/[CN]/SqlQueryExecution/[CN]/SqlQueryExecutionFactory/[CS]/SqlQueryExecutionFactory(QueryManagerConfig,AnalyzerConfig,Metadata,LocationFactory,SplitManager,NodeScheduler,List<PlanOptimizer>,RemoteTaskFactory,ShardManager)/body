{
  checkNotNull(config,"config is null");
  this.scheduleSplitBatchSize=config.getScheduleSplitBatchSize();
  this.maxPendingSplitsPerNode=config.getMaxPendingSplitsPerNode();
  this.initialHashPartitions=config.getInitialHashPartitions();
  this.metadata=checkNotNull(metadata,"metadata is null");
  this.locationFactory=checkNotNull(locationFactory,"locationFactory is null");
  this.splitManager=checkNotNull(splitManager,"splitManager is null");
  this.nodeScheduler=checkNotNull(nodeScheduler,"nodeScheduler is null");
  this.planOptimizers=checkNotNull(planOptimizers,"planOptimizers is null");
  this.remoteTaskFactory=checkNotNull(remoteTaskFactory,"remoteTaskFactory is null");
  this.shardManager=checkNotNull(shardManager,"shardManager is null");
  this.approximateQueriesEnabled=checkNotNull(analyzerConfig,"analyzerConfig is null").isApproximateQueriesEnabled();
  this.executor=Executors.newCachedThreadPool(threadsNamed("query-scheduler-%d"));
  this.executorMBean=new ThreadPoolExecutorMBean((ThreadPoolExecutor)executor);
}
