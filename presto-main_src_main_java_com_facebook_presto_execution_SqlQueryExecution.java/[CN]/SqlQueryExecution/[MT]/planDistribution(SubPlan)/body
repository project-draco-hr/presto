{
  long distributedPlanningStart=System.nanoTime();
  DistributedExecutionPlanner distributedPlanner=new DistributedExecutionPlanner(nodeManager,splitManager);
  StageExecutionPlan outputStageExecutionPlan=distributedPlanner.plan(subplan);
  fieldNames=outputStageExecutionPlan.getFieldNames();
  tupleInfos=outputStageExecutionPlan.getTupleInfos();
  StageExecution outputStage=createStage(new AtomicInteger(),outputStageExecutionPlan,ImmutableList.of(ROOT_OUTPUT_BUFFER_NAME));
  this.outputStage.set(outputStage);
  queryStats.recordDistributedPlanningTime(distributedPlanningStart);
}
