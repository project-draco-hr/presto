{
  SqlStageExecution outputStage=this.outputStage.get();
  StageInfo stageInfo=null;
  if (outputStage != null) {
    stageInfo=outputStage.getStageInfo();
  }
  return new QueryInfo(queryId,session,queryState.get(),locationFactory.createQueryLocation(queryId),fieldNames.get(),sql,queryStats,stageInfo,toFailures(failureCauses));
}
