{
  Optional<StageInfo> stageInfo=Optional.empty();
  if (scheduler != null) {
    stageInfo=Optional.ofNullable(scheduler.getStageInfo());
  }
  QueryInfo queryInfo=stateMachine.getQueryInfo(stageInfo);
  if (queryInfo.isFinalQueryInfo()) {
    finalQueryInfo.compareAndSet(null,queryInfo);
    queryScheduler.set(null);
  }
  return queryInfo;
}
