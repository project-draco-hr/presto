{
  try {
    if (!stateMachine.beginPlanning()) {
      return;
    }
    SubPlan subplan=analyzeQuery();
    planDistribution(subplan);
    if (!stateMachine.starting()) {
      return;
    }
    SqlStageExecution stage=outputStage.get();
    if (!stateMachine.isDone()) {
      stage.addOutputBuffer(ROOT_OUTPUT_BUFFER_NAME);
      stage.noMoreOutputBuffers();
      stage.start();
    }
 else {
      stage.cancel();
    }
  }
 catch (  Exception e) {
    fail(e);
  }
}
