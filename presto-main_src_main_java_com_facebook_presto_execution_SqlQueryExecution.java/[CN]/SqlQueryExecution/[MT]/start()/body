{
  try {
    queryExecutionState.transitionToPlanningState();
    getQueryStats(queryInfo).recordAnalysisStart();
    SubPlan subplan=analyzeQuery();
    planDistribution(subplan);
    queryExecutionState.transitionToStartingState();
    SqlStageExecution stage=outputStage.get();
    if (!queryExecutionState.isDone()) {
      stage.addOutputBuffer(ROOT_OUTPUT_BUFFER_NAME);
      stage.noMoreOutputBuffers();
      stage.start();
    }
 else {
      stage.cancel();
    }
  }
 catch (  Exception e) {
    fail(e);
  }
}
