{
  if (!queryExecutionState.isDone()) {
    log.debug("Failing query %s",getQueryId(queryInfo));
    queryExecutionState.toState(QueryState.FAILED);
    addFailure(queryInfo,cause);
    getQueryStats(queryInfo).recordEnd();
    queryMonitor.completionEvent(getQueryInfo());
  }
  cancelOutputStage();
}
