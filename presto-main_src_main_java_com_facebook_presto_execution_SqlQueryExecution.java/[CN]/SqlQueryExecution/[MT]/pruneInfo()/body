{
  QueryInfo queryInfo=finalQueryInfo.get();
  if (queryInfo == null || queryInfo.getOutputStage() == null) {
    return;
  }
  StageInfo prunedOutputStage=new StageInfo(queryInfo.getOutputStage().getStageId(),queryInfo.getOutputStage().getState(),queryInfo.getOutputStage().getSelf(),null,queryInfo.getOutputStage().getTypes(),queryInfo.getOutputStage().getStageStats(),ImmutableList.of(),ImmutableList.of(),queryInfo.getOutputStage().getFailureCause());
  QueryInfo prunedQueryInfo=new QueryInfo(queryInfo.getQueryId(),queryInfo.getSession(),queryInfo.getState(),getMemoryPool().getId(),queryInfo.isScheduled(),queryInfo.getSelf(),queryInfo.getFieldNames(),queryInfo.getQuery(),queryInfo.getQueryStats(),queryInfo.getSetSessionProperties(),queryInfo.getResetSessionProperties(),queryInfo.getUpdateType(),prunedOutputStage,queryInfo.getFailureInfo(),queryInfo.getErrorCode(),queryInfo.getInputs());
  finalQueryInfo.compareAndSet(queryInfo,prunedQueryInfo);
}
