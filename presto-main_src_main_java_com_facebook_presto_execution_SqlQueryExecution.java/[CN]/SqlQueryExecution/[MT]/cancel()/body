{
  if (!queryExecutionState.isDone()) {
    log.debug("Cancelling query %s",getQueryId(queryInfo));
    queryExecutionState.toState(QueryState.CANCELED);
    getQueryStats(queryInfo).recordEnd();
    queryMonitor.completionEvent(getQueryInfo());
  }
  cancelOutputStage();
}
