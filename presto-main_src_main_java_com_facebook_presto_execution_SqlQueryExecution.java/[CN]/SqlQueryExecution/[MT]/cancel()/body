{
  Preconditions.checkState(!Thread.holdsLock(this),"Can not cancel while holding a lock on this");
synchronized (this) {
    if (queryState.get().isDone()) {
      return;
    }
    queryState.set(QueryState.CANCELED);
  }
  StageExecution stageExecution=outputStage.get();
  if (stageExecution != null) {
    stageExecution.cancel();
  }
}
