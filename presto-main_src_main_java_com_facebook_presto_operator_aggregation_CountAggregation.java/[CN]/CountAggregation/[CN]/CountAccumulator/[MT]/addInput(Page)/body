{
  if (!maskChannel.isPresent()) {
    count+=page.getPositionCount();
  }
 else {
    BlockCursor masks=page.getBlock(maskChannel.get()).cursor();
    for (int i=0; i < page.getPositionCount(); i++) {
      checkState(masks == null || masks.advanceNextPosition());
      if (masks == null || masks.getBoolean()) {
        count++;
      }
    }
  }
}
