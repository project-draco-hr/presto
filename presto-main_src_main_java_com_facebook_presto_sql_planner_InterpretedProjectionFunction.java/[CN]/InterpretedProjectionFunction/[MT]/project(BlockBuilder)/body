{
  Object value=evaluator.process(expression,null);
  if (value == null) {
    output.appendNull();
  }
 else {
switch (type) {
case BOOLEAN:
      output.append((Boolean)value);
    break;
case BIGINT:
  output.append((Long)value);
break;
case DOUBLE:
output.append((Double)value);
break;
case VARCHAR:
output.append((Slice)value);
break;
default :
throw new UnsupportedOperationException("not yet implemented: " + type);
}
}
}
