{
  IdentityHashMap<Expression,Type> expressionTypes=getExpressionTypes(session,metadata,symbolTypes,expression);
  this.type=checkNotNull(expressionTypes.get(expression),"type is null");
  Expression rewritten=ExpressionTreeRewriter.rewriteWith(new SymbolToInputRewriter(symbolToInputMapping),expression);
  evaluator=ExpressionInterpreter.expressionInterpreter(rewritten,metadata,session,expressionTypes);
}
