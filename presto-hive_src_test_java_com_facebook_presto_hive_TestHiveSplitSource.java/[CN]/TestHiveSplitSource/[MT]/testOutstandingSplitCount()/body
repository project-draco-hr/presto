{
  SuspendingExecutor suspendingExecutor=createSuspendingExecutor();
  HiveSplitSource hiveSplitSource=new HiveSplitSource("test",10,suspendingExecutor);
  for (int i=0; i < 10; i++) {
    hiveSplitSource.addToQueue(new TestSplit(i));
    assertEquals(hiveSplitSource.getOutstandingSplitCount(),i + 1);
  }
  assertEquals(hiveSplitSource.getNextBatch(1).size(),1);
  assertEquals(hiveSplitSource.getOutstandingSplitCount(),9);
  assertEquals(hiveSplitSource.getNextBatch(4).size(),4);
  assertEquals(hiveSplitSource.getOutstandingSplitCount(),5);
  assertEquals(hiveSplitSource.getNextBatch(20).size(),5);
  assertEquals(hiveSplitSource.getOutstandingSplitCount(),0);
}
