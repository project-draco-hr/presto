{
  TestingHiveSplitLoader splitLoader=new TestingHiveSplitLoader();
  HiveSplitSource hiveSplitSource=new HiveSplitSource("test",10,splitLoader);
  for (int i=0; i < 9; i++) {
    hiveSplitSource.addToQueue(new TestSplit(i));
    assertEquals(hiveSplitSource.getOutstandingSplitCount(),i + 1);
    assertFalse(splitLoader.isResumed());
  }
  hiveSplitSource.addToQueue(new TestSplit(10));
  assertEquals(hiveSplitSource.getOutstandingSplitCount(),10);
  assertFalse(splitLoader.isResumed());
  assertEquals(getFutureValue(hiveSplitSource.getNextBatch(1)).size(),1);
  assertEquals(hiveSplitSource.getOutstandingSplitCount(),9);
  assertTrue(splitLoader.isResumed());
}
