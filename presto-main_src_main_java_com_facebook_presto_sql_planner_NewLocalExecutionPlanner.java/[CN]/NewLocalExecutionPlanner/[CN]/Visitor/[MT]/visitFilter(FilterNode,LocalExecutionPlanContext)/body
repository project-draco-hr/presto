{
  PhysicalOperation source=node.getSource().accept(this,context);
  Map<Input,Type> inputTypes=getInputTypes(source.getLayout(),source.getTupleInfos());
  FilterFunction filter=new InterpretedFilterFunction(node.getPredicate(),convertLayoutToInputMap(source.getLayout()),metadata,context.getSession(),inputTypes);
  IdentityProjectionInfo mappings=computeIdentityMapping(node.getOutputSymbols(),source.getLayout(),context.getTypes());
  NewOperatorFactory operatorFactory=new NewFilterAndProjectOperatorFactory(context.getNextOperatorId(),filter,mappings.getProjections());
  return new PhysicalOperation(operatorFactory,mappings.getOutputLayout(),source);
}
