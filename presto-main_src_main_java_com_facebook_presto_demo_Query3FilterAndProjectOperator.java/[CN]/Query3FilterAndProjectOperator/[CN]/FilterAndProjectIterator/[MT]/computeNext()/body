{
  BlockBuilder blockBuilder=new BlockBuilder(outputPosition,TupleInfo.SINGLE_LONG);
  while (!blockBuilder.isFull() && iterator.hasNext()) {
    Page page=iterator.next();
    filterAndProjectRowOriented(page.getBlock(0),page.getBlock(1),page.getBlock(2),page.getBlock(3),blockBuilder);
  }
  if (blockBuilder.isEmpty()) {
    return endOfData();
  }
  UncompressedBlock block=blockBuilder.build();
  outputPosition+=block.getPositionCount();
  return new Page(block);
}
