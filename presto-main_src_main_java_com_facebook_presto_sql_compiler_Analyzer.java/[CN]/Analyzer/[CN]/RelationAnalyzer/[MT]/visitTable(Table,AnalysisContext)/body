{
  TableMetadata tableMetadata=metadata.getTable(table.getName());
  if (tableMetadata == null) {
    throw new SemanticException(table,"Cannot resolve table '%s'",table.getName());
  }
  ImmutableList.Builder<NamedSlot> slots=ImmutableList.builder();
  for (  ColumnMetadata column : tableMetadata.getColumns()) {
    Slot slot=context.getSlotAllocator().newSlot(Type.fromRaw(column.getType()));
    QualifiedName prefix=QualifiedName.of(tableMetadata.getCatalogName(),tableMetadata.getSchemaName(),tableMetadata.getTableName());
    slots.add(new NamedSlot(Optional.of(prefix),Optional.of(column.getName()),slot));
  }
  TupleDescriptor descriptor=new TupleDescriptor(slots.build());
  context.registerTable(table,descriptor);
  return descriptor;
}
