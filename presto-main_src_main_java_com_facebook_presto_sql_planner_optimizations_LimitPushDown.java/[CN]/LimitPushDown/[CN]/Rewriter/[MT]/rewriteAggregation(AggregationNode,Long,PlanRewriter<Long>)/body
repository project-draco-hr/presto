{
  if (limit != Long.MAX_VALUE && node.getAggregations().isEmpty() && node.getOutputSymbols().size() == node.getGroupBy().size() && node.getOutputSymbols().containsAll(node.getGroupBy())) {
    PlanNode rewrittenSource=planRewriter.rewrite(node.getSource(),Long.MAX_VALUE);
    return new DistinctLimitNode(idAllocator.getNextId(),rewrittenSource,limit);
  }
  PlanNode rewrittenNode=planRewriter.defaultRewrite(node,Long.MAX_VALUE);
  if (limit != Long.MAX_VALUE) {
    rewrittenNode=new LimitNode(idAllocator.getNextId(),rewrittenNode,limit);
  }
  return rewrittenNode;
}
