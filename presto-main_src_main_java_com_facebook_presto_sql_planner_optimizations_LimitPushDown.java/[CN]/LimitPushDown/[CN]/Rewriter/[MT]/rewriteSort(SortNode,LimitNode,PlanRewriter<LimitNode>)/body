{
  PlanNode rewrittenSource=planRewriter.rewrite(node.getSource(),null);
  if (limit != null) {
    return new TopNNode(node.getId(),rewrittenSource,limit.getCount(),node.getOrderBy(),node.getOrderings(),false,limit.getSampleWeight());
  }
 else   if (rewrittenSource != node.getSource()) {
    return new SortNode(node.getId(),rewrittenSource,node.getOrderBy(),node.getOrderings());
  }
  return node;
}
