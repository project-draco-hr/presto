{
  LimitContext limit=context.get();
  List<PlanNode> sources=new ArrayList<>();
  for (int i=0; i < node.getSources().size(); i++) {
    sources.add(context.rewrite(node.getSources().get(i),limit));
  }
  PlanNode output=new UnionNode(node.getId(),sources,node.getSymbolMapping(),node.getOutputSymbols());
  if (limit != null) {
    output=new LimitNode(idAllocator.getNextId(),output,limit.getCount());
  }
  return output;
}
