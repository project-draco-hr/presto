{
  if (node.getCount() == 0) {
    return new ValuesNode(idAllocator.getNextId(),node.getOutputSymbols(),ImmutableList.of());
  }
  LimitContext limit=context.get();
  if (limit != null && limit.getCount() < node.getCount()) {
    return context.rewrite(node.getSource(),limit);
  }
 else {
    return context.rewrite(node.getSource(),new LimitContext(node.getCount()));
  }
}
