{
  if (context != null && context.getCount() < node.getCount()) {
    if (context.getSampleWeight().isPresent()) {
      checkState(node.getSampleWeight().isPresent() && node.getSampleWeight().equals(context.getSampleWeight()),"sample weight symbols don't match");
    }
    return planRewriter.rewrite(node.getSource(),context);
  }
 else {
    return planRewriter.rewrite(node.getSource(),new LimitContext(node.getCount(),node.getSampleWeight()));
  }
}
