{
  List<PlanNode> sources=new ArrayList<>();
  for (int i=0; i < node.getSources().size(); i++) {
    sources.add(planRewriter.rewrite(node.getSources().get(i),context));
  }
  PlanNode output=new UnionNode(node.getId(),sources,node.getSymbolMapping());
  if (context != null) {
    output=new LimitNode(idAllocator.getNextId(),output,context.getCount());
  }
  return output;
}
