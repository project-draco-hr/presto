{
  PlanNode rewrittenSource=planRewriter.rewrite(node.getSource(),Long.MAX_VALUE);
  if (limit != Long.MAX_VALUE || rewrittenSource != node.getSource()) {
    return new TopNNode(node.getId(),rewrittenSource,Math.min(node.getCount(),limit),node.getOrderBy(),node.getOrderings(),node.isPartial());
  }
  return node;
}
