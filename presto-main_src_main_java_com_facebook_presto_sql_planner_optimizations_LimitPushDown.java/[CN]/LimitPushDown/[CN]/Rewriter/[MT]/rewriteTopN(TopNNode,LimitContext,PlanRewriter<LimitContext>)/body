{
  PlanNode rewrittenSource=planRewriter.rewrite(node.getSource(),null);
  if (rewrittenSource == node.getSource() && context == null) {
    return node;
  }
  long count=node.getCount();
  if (context != null) {
    count=Math.min(count,context.getCount());
  }
  return new TopNNode(node.getId(),rewrittenSource,count,node.getOrderBy(),node.getOrderings(),node.isPartial());
}
