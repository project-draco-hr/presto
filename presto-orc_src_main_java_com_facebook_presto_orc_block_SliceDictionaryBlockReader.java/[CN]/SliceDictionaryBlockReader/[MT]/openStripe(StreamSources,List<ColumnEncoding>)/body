{
  int dictionarySize=encoding.get(streamDescriptor.getStreamId()).getDictionarySize();
  if (dictionarySize > 0) {
    if (dictionary.length < dictionarySize) {
      dictionary=new byte[dictionarySize][];
      dictionaryLength=new int[dictionarySize];
    }
    LongStream lengthStream=dictionaryStreamSources.getStreamSource(streamDescriptor,LENGTH,LongStream.class).openStream();
    if (lengthStream == null) {
      throw new OrcCorruptionException("Dictionary is not empty but length stream is not present");
    }
    lengthStream.nextIntVector(dictionarySize,dictionaryLength);
    ByteArrayStream dictionaryDataStream=dictionaryStreamSources.getStreamSource(streamDescriptor,DICTIONARY_DATA,ByteArrayStream.class).openStream();
    readDictionary(dictionaryDataStream,dictionarySize,dictionaryLength,dictionary);
  }
  presentStream=null;
  dataStream=null;
  inDictionaryStream=null;
}
