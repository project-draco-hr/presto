{
  HiveSplit split=createHiveSplit(fileSplit,partitionProperties);
  long count=0;
  for (int i=0; i < LOOPS; i++) {
    count=0;
    ConnectorPageSource pageSource=pageSourceFactory.createPageSource(new Configuration(),split.getSession(),new Path(split.getPath()),split.getStart(),split.getLength(),split.getSchema(),ImmutableList.<HiveColumnHandle>of(),split.getPartitionKeys(),TupleDomain.<HiveColumnHandle>all(),DateTimeZone.UTC).get();
    while (!pageSource.isFinished()) {
      Page page=pageSource.getNextPage();
      if (page == null) {
        continue;
      }
      count+=page.getPositionCount();
    }
    pageSource.close();
  }
  return count;
}
