{
  HiveSplit split=createHiveSplit(fileSplit,partitionProperties);
  double sum=0;
  for (int i=0; i < LOOPS; i++) {
    sum=0;
    ConnectorPageSource pageSource=pageSourceFactory.createPageSource(new Configuration(),SESSION,new Path(split.getPath()),split.getStart(),split.getLength(),split.getSchema(),TPCH_6_COLUMNS,split.getPartitionKeys(),TupleDomain.<HiveColumnHandle>all(),DateTimeZone.UTC).get();
    while (!pageSource.isFinished()) {
      Page page=pageSource.getNextPage();
      if (page == null) {
        continue;
      }
      Block block0=page.getBlock(0);
      Block block1=page.getBlock(1);
      Block block2=page.getBlock(2);
      Block block3=page.getBlock(3);
      for (int position=0; position < page.getPositionCount(); position++) {
        if (!block0.isNull(position)) {
          sum+=BIGINT.getLong(block0,position);
        }
        if (!block1.isNull(position)) {
          sum+=DOUBLE.getDouble(block1,position);
        }
        if (!block2.isNull(position)) {
          sum+=DOUBLE.getDouble(block2,position);
        }
        if (!block3.isNull(position)) {
          sum+=VARCHAR.getSlice(block3,position).length();
        }
      }
    }
    pageSource.close();
  }
  return sum;
}
