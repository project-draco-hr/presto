{
  HiveSplit split=createHiveSplit(fileSplit,partitionProperties);
  double sum=0;
  for (int i=0; i < LOOPS; i++) {
    sum=0;
    ConnectorPageSource pageSource=pageSourceFactory.createPageSource(new Configuration(),SESSION,new Path(split.getPath()),split.getStart(),split.getLength(),split.getSchema(),ALL_COLUMNS,split.getPartitionKeys(),TupleDomain.<HiveColumnHandle>all(),DateTimeZone.UTC).get();
    while (!pageSource.isFinished()) {
      Page page=pageSource.getNextPage();
      if (page == null) {
        continue;
      }
      Block block=page.getBlock(0);
      for (int position=0; position < block.getPositionCount(); position++) {
        if (!block.isNull(position)) {
          sum+=BIGINT.getLong(block,position);
        }
      }
    }
    pageSource.close();
  }
  return sum;
}
