{
  HiveSplit split=createHiveSplit(fileSplit,partitionProperties);
  double sum=0;
  for (int i=0; i < LOOPS; i++) {
    sum=0;
    HiveRecordCursor recordCursor=hiveRecordCursorProvider.createHiveRecordCursor(split.getClientId(),new Configuration(),SESSION,new Path(split.getPath()),split.getStart(),split.getLength(),split.getSchema(),DOUBLE_COLUMN,split.getPartitionKeys(),TupleDomain.<HiveColumnHandle>all(),DateTimeZone.UTC,TYPE_MANAGER).get();
    while (recordCursor.advanceNextPosition()) {
      if (!recordCursor.isNull(0)) {
        sum+=recordCursor.getDouble(0);
      }
    }
    recordCursor.close();
  }
  return sum;
}
