{
  HiveSplit split=createHiveSplit(fileSplit,partitionProperties);
  long sum=0;
  for (int i=0; i < LOOPS; i++) {
    sum=0;
    ConnectorPageSource pageSource=pageSourceFactory.createPageSource(new Configuration(),split.getSession(),new Path(split.getPath()),split.getStart(),split.getLength(),split.getSchema(),VARCHAR_COLUMN,split.getPartitionKeys(),TupleDomain.<HiveColumnHandle>all(),DateTimeZone.UTC).get();
    while (!pageSource.isFinished()) {
      Page page=pageSource.getNextPage();
      if (page == null) {
        continue;
      }
      Block block=page.getBlock(0);
      for (int position=0; position < block.getPositionCount(); position++) {
        if (!block.isNull(position)) {
          sum+=VARCHAR.getSlice(block,position).length();
        }
      }
    }
    pageSource.close();
  }
  return sum;
}
