{
  HiveSplit split=createHiveSplit(fileSplit,partitionProperties);
  long count=0;
  for (int i=0; i < LOOPS; i++) {
    count=0;
    HiveRecordCursor recordCursor=hiveRecordCursorProvider.createHiveRecordCursor(split.getClientId(),new Configuration(),SESSION,new Path(split.getPath()),split.getStart(),split.getLength(),split.getSchema(),ImmutableList.<HiveColumnHandle>of(),split.getPartitionKeys(),TupleDomain.<HiveColumnHandle>all(),DateTimeZone.UTC,TYPE_MANAGER).get();
    while (recordCursor.advanceNextPosition()) {
      count++;
    }
    recordCursor.close();
  }
  return count;
}
