{
  Slice leftSlice=getSlice(leftBlock,leftPosition);
  Slice rightSlice=getSlice(rightBlock,rightPosition);
  Block leftArray=readStructuralBlock(leftSlice);
  Block rightArray=readStructuralBlock(rightSlice);
  for (int i=0; i < leftArray.getPositionCount(); i++) {
    checkElementNotNull(leftArray.isNull(i));
    checkElementNotNull(rightArray.isNull(i));
    Type fieldType=fields.get(i).getType();
    if (!fieldType.equalTo(leftArray,i,rightArray,i)) {
      return false;
    }
  }
  return true;
}
