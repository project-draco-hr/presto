{
  List<Object> leftRow=extractElements(leftBlock,leftPosition);
  List<Object> rightRow=extractElements(rightBlock,rightPosition);
  int nFields=leftRow.size();
  for (int i=0; i < nFields; i++) {
    Object leftElement=leftRow.get(i);
    Object rightElement=rightRow.get(i);
    checkElementNotNull(leftElement);
    checkElementNotNull(rightElement);
    Type fieldType=fields.get(i).getType();
    if (!fieldType.equalTo(createBlock(fieldType,leftElement),0,createBlock(fieldType,rightElement),0)) {
      return false;
    }
  }
  return true;
}
