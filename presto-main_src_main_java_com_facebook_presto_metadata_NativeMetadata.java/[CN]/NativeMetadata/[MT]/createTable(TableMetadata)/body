{
  dbi.inTransaction(new VoidTransactionCallback(){
    @Override protected void execute(    final Handle handle,    TransactionStatus status) throws Exception {
      runIgnoringConstraintViolation(new Runnable(){
        @Override public void run(){
          MetadataDao dao=handle.attach(MetadataDao.class);
          long tableId=dao.insertTable(table);
          int position=1;
          for (          ColumnMetadata column : table.getColumns()) {
            dao.insertColumn(tableId,column.getName(),position,column.getType().getName());
            position++;
          }
        }
      }
);
    }
  }
);
}
