{
  final NativeTableHandle nativeHandle=checkType(tableHandle,NativeTableHandle.class,"tableHandle");
  dbi.inTransaction(new VoidTransactionCallback(){
    @Override protected void execute(    Handle handle,    TransactionStatus status) throws Exception {
      Set<TablePartition> partitions=shardManager.getPartitions(nativeHandle);
      for (      TablePartition partition : partitions) {
        shardManager.dropPartition(nativeHandle,partition.getPartitionName());
      }
      MetadataDaoUtils.dropTable(dao,nativeHandle.getTableId());
    }
  }
);
}
