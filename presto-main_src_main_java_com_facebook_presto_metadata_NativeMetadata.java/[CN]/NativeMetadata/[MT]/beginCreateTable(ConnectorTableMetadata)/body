{
  ImmutableList.Builder<NativeColumnHandle> columnHandles=ImmutableList.builder();
  ImmutableList.Builder<ColumnType> columnTypes=ImmutableList.builder();
  long maxColumnId=0;
  for (  ColumnMetadata column : tableMetadata.getColumns()) {
    long columnId=column.getOrdinalPosition() + 1;
    maxColumnId=Math.max(maxColumnId,columnId);
    columnHandles.add(new NativeColumnHandle(column.getName(),columnId));
    columnTypes.add(column.getType());
  }
  NativeColumnHandle sampleWeightColumnHandle=null;
  if (tableMetadata.isSampled()) {
    sampleWeightColumnHandle=new NativeColumnHandle(NativeColumnHandle.SAMPLE_WEIGHT_COLUMN_NAME,maxColumnId + 1);
    columnHandles.add(sampleWeightColumnHandle);
    columnTypes.add(ColumnType.LONG);
  }
  return new NativeOutputTableHandle(tableMetadata.getTable().getSchemaName(),tableMetadata.getTable().getTableName(),columnHandles.build(),columnTypes.build(),sampleWeightColumnHandle);
}
