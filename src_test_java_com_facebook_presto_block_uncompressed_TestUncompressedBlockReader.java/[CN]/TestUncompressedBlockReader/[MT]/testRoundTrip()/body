{
  UncompressedBlock block=new BlockBuilder(0,TupleInfo.SINGLE_VARBINARY).append("alice".getBytes(UTF_8)).append("bob".getBytes(UTF_8)).append("charlie".getBytes(UTF_8)).append("dave".getBytes(UTF_8)).build();
  UncompressedTupleStream tupleStream=new UncompressedTupleStream(TupleInfo.SINGLE_VARBINARY,ImmutableList.of(block));
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  new UncompressedSerde().serialize(tupleStream,new OutputStreamSliceOutput(out));
  ImmutableList<UncompressedBlock> copiedBlocks=ImmutableList.copyOf(UncompressedSerde.read(Slices.wrappedBuffer(out.toByteArray())));
  assertEquals(copiedBlocks.size(),1);
  TupleStream copiedBlock=copiedBlocks.get(0);
  assertEquals(copiedBlock.getRange(),block.getRange());
  assertTupleStreamEquals(new UncompressedTupleStream(TupleInfo.SINGLE_VARBINARY,copiedBlocks),tupleStream);
}
