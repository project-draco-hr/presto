{
  DynamicClassLoader classLoader=createClassLoader();
  Class<? extends Accumulator> accumulatorClass=generateAccumulatorClass(aggregationDefinitionClass,stateClass,classLoader);
  Class<? extends GroupedAccumulator> groupedAccumulatorClass=generateGroupedAccumulatorClass(aggregationDefinitionClass,stateClass,classLoader);
  return new GenericAccumulatorFactory(finalType,intermediateType,stateSerializer,stateFactory,accumulatorClass,groupedAccumulatorClass,approximateSupported);
}
