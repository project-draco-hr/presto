{
  OrcRecordReader recordReader=createCustomOrcRecordReader(tempFile,metadataReader,createOrcPredicate(objectInspector,expectedValues),type);
  assertEquals(recordReader.getReaderPosition(),0);
  assertEquals(recordReader.getFilePosition(),0);
  Object resultObject=createResultsVector(objectInspector);
  boolean isFirst=true;
  int rowsProcessed=0;
  Iterator<?> iterator=expectedValues.iterator();
  for (int batchSize=Ints.checkedCast(recordReader.nextBatch()); batchSize >= 0; batchSize=Ints.checkedCast(recordReader.nextBatch())) {
    if (skipStripe && rowsProcessed < 10000) {
      assertEquals(advance(iterator,batchSize),batchSize);
    }
 else     if (skipFirstBatch && isFirst) {
      assertEquals(advance(iterator,batchSize),batchSize);
      isFirst=false;
    }
 else {
      recordReader.readVector(type,0,resultObject);
      if (objectInspector instanceof PrimitiveObjectInspector) {
        Vector vector=(Vector)resultObject;
        ObjectVector objectVector=vector.toObjectVector(batchSize);
        for (int i=0; i < batchSize; i++) {
          assertTrue(iterator.hasNext());
          Object expected=iterator.next();
          Object actual=objectVector.vector[i];
          if (actual instanceof Slice) {
            actual=decodeObject(type,actual);
          }
          assertEquals(actual,expected);
        }
      }
 else {
        Block block=(Block)((SingleObjectVector)resultObject).object;
        for (int i=0; i < batchSize; i++) {
          assertTrue(iterator.hasNext());
          Object expected=iterator.next();
          Object actual;
          if (block.isNull(i)) {
            actual=null;
          }
 else {
            actual=decodeObject(type,type.getObject(block,i));
          }
          assertEquals(actual,expected);
        }
      }
    }
    assertEquals(recordReader.getReaderPosition(),rowsProcessed);
    assertEquals(recordReader.getFilePosition(),rowsProcessed);
    rowsProcessed+=batchSize;
  }
  assertFalse(iterator.hasNext());
  assertEquals(recordReader.getReaderPosition(),rowsProcessed);
  assertEquals(recordReader.getFilePosition(),rowsProcessed);
  recordReader.close();
}
