{
  OrcRecordReader recordReader=createCustomOrcRecordReader(tempFile,metadataReader);
  Vector vector=createResultsVector(objectInspector);
  boolean isFirst=true;
  int rowsProcessed=0;
  Iterator<?> iterator=expectedValues.iterator();
  for (int batchSize=Ints.checkedCast(recordReader.nextBatch()); batchSize >= 0; batchSize=Ints.checkedCast(recordReader.nextBatch())) {
    if (skipStripe && rowsProcessed < 10000) {
      assertEquals(advance(iterator,batchSize),batchSize);
    }
 else     if (skipFirstBatch && isFirst) {
      assertEquals(advance(iterator,batchSize),batchSize);
      isFirst=false;
    }
 else {
      recordReader.readVector(0,vector);
      ObjectVector objectVector=vector.toObjectVector(batchSize);
      for (int i=0; i < batchSize; i++) {
        assertTrue(iterator.hasNext());
        Object expected=iterator.next();
        if (!Objects.equals(objectVector.vector[i],expected)) {
          assertEquals(objectVector.vector[i],expected);
        }
      }
    }
  }
  assertFalse(iterator.hasNext());
  recordReader.close();
}
