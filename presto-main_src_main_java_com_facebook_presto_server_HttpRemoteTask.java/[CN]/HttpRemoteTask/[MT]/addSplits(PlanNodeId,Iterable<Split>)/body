{
  try (SetThreadName ignored=new SetThreadName("HttpRemoteTask-%s",taskId)){
    requireNonNull(sourceId,"sourceId is null");
    requireNonNull(splits,"splits is null");
    checkState(!noMoreSplits.contains(sourceId),"noMoreSplits has already been set for %s",sourceId);
    if (!getTaskInfo().getState().isDone()) {
      int added=0;
      for (      Split split : splits) {
        if (pendingSplits.put(sourceId,new ScheduledSplit(nextSplitId.getAndIncrement(),split))) {
          added++;
        }
      }
      if (sourceId.equals(planFragment.getPartitionedSource())) {
        pendingSourceSplitCount+=added;
        fireSplitCountChanged(added);
      }
      needsUpdate.set(true);
    }
    scheduleUpdate();
  }
 }
