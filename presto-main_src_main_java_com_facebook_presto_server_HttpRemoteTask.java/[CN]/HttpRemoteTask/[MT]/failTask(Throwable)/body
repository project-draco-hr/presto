{
  TaskInfo taskInfo=getTaskInfo();
  if (!taskInfo.getState().isDone()) {
    log.debug(cause,"Remote task failed: %s",taskInfo.getSelf());
  }
  updateTaskInfo(new TaskInfo(taskInfo.getTaskId(),taskInfo.getTaskInstanceId(),TaskInfo.MAX_VERSION,TaskState.FAILED,taskInfo.getSelf(),taskInfo.getLastHeartbeat(),taskInfo.getOutputBuffers(),taskInfo.getNoMoreSplits(),taskInfo.getStats(),ImmutableList.of(toFailure(cause)),taskInfo.isNeedsPlan()));
}
