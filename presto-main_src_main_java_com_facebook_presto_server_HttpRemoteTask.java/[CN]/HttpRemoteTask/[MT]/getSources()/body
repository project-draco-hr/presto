{
  ImmutableList.Builder<TaskSource> sources=ImmutableList.builder();
  for (  PlanNodeId planNodeId : planFragment.getSourceIds()) {
    Set<ScheduledSplit> splits=pendingSplits.get(planNodeId);
    boolean noMoreSplits=this.noMoreSplits.contains(planNodeId);
    if (!splits.isEmpty() || noMoreSplits) {
      sources.add(new TaskSource(planNodeId,splits,noMoreSplits));
    }
  }
  return sources.build();
}
