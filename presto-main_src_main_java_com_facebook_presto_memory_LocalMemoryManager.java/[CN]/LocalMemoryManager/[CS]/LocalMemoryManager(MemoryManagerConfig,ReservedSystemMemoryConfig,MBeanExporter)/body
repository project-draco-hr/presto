{
  this.exporter=requireNonNull(exporter,"exporter is null");
  requireNonNull(config,"config is null");
  requireNonNull(systemMemoryConfig,"systemMemoryConfig is null");
  maxMemory=new DataSize(Runtime.getRuntime().maxMemory() - systemMemoryConfig.getReservedSystemMemory().toBytes(),BYTE);
  ImmutableMap.Builder<MemoryPoolId,MemoryPool> builder=ImmutableMap.builder();
  builder.put(RESERVED_POOL,createPool(RESERVED_POOL,config.getMaxQueryMemoryPerNode(),exporter,config.isClusterMemoryManagerEnabled()));
  DataSize generalPoolSize=new DataSize(maxMemory.toBytes() - config.getMaxQueryMemoryPerNode().toBytes(),BYTE);
  builder.put(GENERAL_POOL,createPool(GENERAL_POOL,generalPoolSize,exporter,config.isClusterMemoryManagerEnabled()));
  this.pools=builder.build();
}
