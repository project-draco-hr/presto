{
  this.exporter=requireNonNull(exporter,"exporter is null");
  maxMemory=new DataSize(Runtime.getRuntime().maxMemory() - config.getReservedSystemMemory().toBytes(),BYTE);
  ImmutableMap.Builder<MemoryPoolId,MemoryPool> builder=ImmutableMap.builder();
  builder.put(RESERVED_POOL,createPool(RESERVED_POOL,config.getMaxQueryMemoryPerNode(),exporter));
  DataSize generalPoolSize=new DataSize(maxMemory.toBytes() - config.getMaxQueryMemoryPerNode().toBytes(),BYTE);
  builder.put(GENERAL_POOL,createPool(GENERAL_POOL,generalPoolSize,exporter));
  this.pools=builder.build();
}
