{
  Duration elapsedTime=Duration.nanosSince(start);
  ExecutionStats executionStats=new ExecutionStats();
  sumTaskStats(stage,executionStats);
  String id=stage.getStageId().substring(stage.getQueryId().length() + 1);
  StringBuilder nameBuilder=new StringBuilder();
  nameBuilder.append(indent).append(id);
  while (nameBuilder.length() < 10) {
    nameBuilder.append('.');
  }
  String stageSummary=String.format("%10s%1s  %5s  %5s  %5s  %5s  %5s  %5s %5s",nameBuilder.toString(),stage.getState().toString().charAt(0),formatCount(executionStats.getInputPositionCount()),formatCountRate(executionStats.getInputPositionCount(),elapsedTime,false),formatDataSize(executionStats.getInputDataSize()),formatDataRate(executionStats.getCompletedDataSize(),elapsedTime,false),max(0,executionStats.getSplits() - executionStats.getStartedSplits()),max(0,executionStats.getStartedSplits() - executionStats.getCompletedSplits()),executionStats.getCompletedSplits());
  reprintLine(stageSummary);
  for (  StageInfo subStage : stage.getSubStages()) {
    printStageTree(subStage,indent + "  ");
  }
}
