{
  Duration wallTime=Duration.nanosSince(start);
  QueryInfo queryInfo=queryClient.getQueryInfo(true);
  StageInfo outputStage=queryInfo.getOutputStage();
  ExecutionStats inputExecutionStats=leafExecutionStats(outputStage);
  ExecutionStats globalExecutionStats=globalExecutionStats(outputStage);
  int nodes=uniqueNodes(outputStage).size();
  out.println();
  String querySummary=String.format("Query %s, %s, %,d %s",queryInfo.getQueryId(),queryInfo.getState(),nodes,pluralize("node",nodes));
  out.println(querySummary);
  String splitsSummary=String.format("Splits: %,d total, %,d done (%.2f%%)",globalExecutionStats.getSplits(),globalExecutionStats.getCompletedSplits(),Math.min(100,globalExecutionStats.getCompletedSplits() * 100.0 / globalExecutionStats.getSplits()));
  out.println(splitsSummary);
  if (queryClient.isDebug()) {
    Duration cpuTime=new Duration(globalExecutionStats.getSplitCpuTime(),MILLISECONDS);
    String cpuTimeSummary=String.format("CPU Time: %.1fs total, %5s rows/s, %8s, %d%% active",cpuTime.convertTo(SECONDS),formatCountRate(inputExecutionStats.getCompletedPositionCount(),cpuTime,false),formatDataRate(inputExecutionStats.getCompletedDataSize(),cpuTime,true),(int)(globalExecutionStats.getSplitCpuTime() * 100.0 / globalExecutionStats.getSplitWallTime()));
    out.println(cpuTimeSummary);
    out.println(String.format("Parallelism: %.1f",cpuTime.toMillis() / wallTime.toMillis()));
  }
  String statsLine=String.format("%s [%s rows, %s] [%s rows/s, %s]",formatTime(wallTime),formatCount(inputExecutionStats.getCompletedPositionCount()),formatDataSize(inputExecutionStats.getCompletedDataSize(),true),formatCountRate(inputExecutionStats.getInputPositionCount(),wallTime,false),formatDataRate(inputExecutionStats.getCompletedDataSize(),wallTime,true));
  out.println(statsLine);
  out.println();
}
