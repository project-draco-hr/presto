{
  SessionBuilder sessionBuilder=Session.builder().setUser("user").setSource("test").setCatalog("tpch").setSchema(TINY_SCHEMA_NAME).setTimeZoneKey(UTC_KEY).setLocale(ENGLISH);
  if (hashingEnabled) {
    sessionBuilder.setSystemProperties(ImmutableMap.of("optimizer.optimize_hash_generation","true"));
  }
  Session session=sessionBuilder.build();
  LocalQueryRunner localQueryRunner=new LocalQueryRunner(session);
  InMemoryNodeManager nodeManager=localQueryRunner.getNodeManager();
  localQueryRunner.createCatalog("tpch",new TpchConnectorFactory(nodeManager,1),ImmutableMap.<String,String>of());
  return localQueryRunner;
}
