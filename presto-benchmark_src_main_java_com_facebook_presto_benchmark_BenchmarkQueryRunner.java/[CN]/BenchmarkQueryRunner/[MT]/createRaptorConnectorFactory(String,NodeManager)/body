{
  try {
    File dataDir=new File(cacheDir);
    File databaseDir=new File(dataDir,"db");
    Map<String,String> config=ImmutableMap.<String,String>builder().put("metadata.db.type","h2").put("metadata.db.filename",databaseDir.getAbsolutePath()).put("storage.data-directory",dataDir.getAbsolutePath()).build();
    BlockEncodingSerde blockEncodingSerde=createTestingBlockEncodingManager();
    TypeManager typeManager=new TypeRegistry();
    return new RaptorConnectorFactory(config,nodeManager,blockEncodingSerde,typeManager);
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
}
