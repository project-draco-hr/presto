{
  URI statusUri=uriBuilderFrom(location).build();
  JsonResponse<QueryInfo> response=client.execute(prepareGet().setUri(statusUri).build(),createFullJsonResponseHandler(jsonCodec(QueryInfo.class)));
  if (expectedState == State.FINISHED && response.getStatusCode() == Status.GONE.getStatusCode()) {
    return;
  }
  QueryInfo queryInfo=response.getValue();
  assertEquals(queryInfo.getState(),expectedState);
}
