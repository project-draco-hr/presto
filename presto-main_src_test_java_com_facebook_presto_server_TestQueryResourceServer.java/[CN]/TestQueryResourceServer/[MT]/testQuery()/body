{
  URI location=client.execute(preparePost().setUri(uriFor("/v1/presto/query")).build(),new CreatedResponseHandler());
  assertQueryStatus(location,State.RUNNING);
  QueryInfo queryInfo=client.execute(prepareGet().setUri(location).build(),createJsonResponseHandler(jsonCodec(QueryInfo.class)));
  QueryTaskInfo outQueryTask=queryInfo.getStages().get("out").get(0);
  URI outputLocation=uriFor("/v1/presto/task/" + outQueryTask.getTaskId() + "/results/out");
  assertEquals(loadData(outputLocation),220);
  assertQueryStatus(location,State.RUNNING);
  assertEquals(loadData(outputLocation),44 + 48);
  assertQueryStatus(location,State.FINISHED);
  StatusResponse response=client.execute(prepareDelete().setUri(location).build(),createStatusResponseHandler());
  assertQueryStatus(location,State.FINISHED);
  assertEquals(response.getStatusCode(),Status.NO_CONTENT.getStatusCode());
}
