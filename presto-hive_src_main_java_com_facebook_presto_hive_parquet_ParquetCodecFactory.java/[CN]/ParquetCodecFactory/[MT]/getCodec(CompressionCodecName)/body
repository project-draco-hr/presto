{
  String codecClassName=codecName.getHadoopCompressionCodecClassName();
  if (codecClassName == null) {
    return null;
  }
  CompressionCodec codec=codecByName.get(codecClassName);
  if (codec != null) {
    return codec;
  }
  try {
    Class<?> codecClass=Class.forName(codecClassName);
    codec=(CompressionCodec)ReflectionUtils.newInstance(codecClass,configuration);
    codecByName.put(codecClassName,codec);
    return codec;
  }
 catch (  ClassNotFoundException e) {
    throw new RuntimeException("Class " + codecClassName + " was not found",e);
  }
}
