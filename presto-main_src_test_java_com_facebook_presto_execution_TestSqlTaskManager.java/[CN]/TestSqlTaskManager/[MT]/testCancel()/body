{
  TaskInfo taskInfo=sqlTaskManager.updateTask(session,taskId,testFragment,ImmutableList.<TaskSource>of(),new OutputBuffers(ImmutableSet.<String>of(),false));
  assertEquals(taskInfo.getState(),TaskState.RUNNING);
  assertNull(taskInfo.getStats().getEndTime());
  taskInfo=sqlTaskManager.getTaskInfo(taskInfo.getTaskId(),false);
  assertEquals(taskInfo.getState(),TaskState.RUNNING);
  assertNull(taskInfo.getStats().getEndTime());
  taskInfo=sqlTaskManager.cancelTask(taskInfo.getTaskId());
  assertEquals(taskInfo.getState(),TaskState.CANCELED);
  assertNotNull(taskInfo.getStats().getEndTime());
  taskInfo=sqlTaskManager.getTaskInfo(taskInfo.getTaskId(),false);
  assertEquals(taskInfo.getState(),TaskState.CANCELED);
  assertNotNull(taskInfo.getStats().getEndTime());
}
