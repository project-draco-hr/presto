{
  try (SqlTaskManager sqlTaskManager=createSqlTaskManager(new TaskManagerConfig())){
    TaskId taskId=TASK_ID;
    TaskInfo taskInfo=sqlTaskManager.updateTask(TEST_SESSION,taskId,PLAN_FRAGMENT,ImmutableList.<TaskSource>of(),INITIAL_EMPTY_OUTPUT_BUFFERS);
    assertEquals(taskInfo.getState(),TaskState.RUNNING);
    assertNull(taskInfo.getStats().getEndTime());
    taskInfo=sqlTaskManager.getTaskInfo(taskId);
    assertEquals(taskInfo.getState(),TaskState.RUNNING);
    assertNull(taskInfo.getStats().getEndTime());
    taskInfo=sqlTaskManager.cancelTask(taskId);
    assertEquals(taskInfo.getState(),TaskState.CANCELED);
    assertNotNull(taskInfo.getStats().getEndTime());
    taskInfo=sqlTaskManager.getTaskInfo(taskId);
    assertEquals(taskInfo.getState(),TaskState.CANCELED);
    assertNotNull(taskInfo.getStats().getEndTime());
  }
 }
