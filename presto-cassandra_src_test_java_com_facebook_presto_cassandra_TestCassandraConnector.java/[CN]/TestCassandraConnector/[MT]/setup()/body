{
  EmbeddedCassandraServerHelper.startEmbeddedCassandra();
  initializeTestData(DATE);
  String connectorId="cassandra-test";
  CassandraConnectorFactory connectorFactory=new CassandraConnectorFactory(connectorId);
  Connector connector=connectorFactory.create(connectorId,ImmutableMap.of("cassandra.contact-points",HOSTNAME,"cassandra.native-protocol-port",Integer.toString(PORT)),new ConnectorContext(){
  }
);
  metadata=connector.getMetadata(CassandraTransactionHandle.INSTANCE);
  assertInstanceOf(metadata,CassandraMetadata.class);
  splitManager=connector.getSplitManager();
  assertInstanceOf(splitManager,CassandraSplitManager.class);
  recordSetProvider=connector.getRecordSetProvider();
  assertInstanceOf(recordSetProvider,CassandraRecordSetProvider.class);
  database=KEYSPACE_NAME.toLowerCase();
  table=new SchemaTableName(database,TABLE_NAME.toLowerCase());
  tableUnpartitioned=new SchemaTableName(database,"presto_test_unpartitioned");
  invalidTable=new SchemaTableName(database,"totally_invalid_table_name");
}
