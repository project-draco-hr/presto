{
  TaskInfo outputTask=mockTaskManager.getTaskInfo(outputTaskId,false);
  QueryState state;
switch (outputTask.getState()) {
case PLANNED:
case RUNNING:
    state=QueryState.RUNNING;
  break;
case FINISHED:
state=QueryState.FINISHED;
break;
case CANCELED:
state=QueryState.CANCELED;
break;
case FAILED:
state=QueryState.FAILED;
break;
default :
throw new IllegalStateException("Unknown task state " + outputTask.getState());
}
return new QueryInfo(outputTaskId.getQueryId(),new Session("user","test","test_catalog","test_schema",null,null),state,self,ImmutableList.of("out"),"query",new QueryStats(),new StageInfo(outputTaskId.getStageId(),StageState.FINISHED,locationFactory.createStageLocation(outputTaskId.getStageId()),null,TUPLE_INFOS,new StageStats().snapshot(),ImmutableList.<TaskInfo>of(outputTask),ImmutableList.<StageInfo>of(),ImmutableList.<FailureInfo>of()),null);
}
