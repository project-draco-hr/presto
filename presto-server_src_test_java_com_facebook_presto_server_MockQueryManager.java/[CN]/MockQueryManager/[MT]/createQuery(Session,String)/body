{
  Preconditions.checkNotNull(query,"query is null");
  String queryId=String.valueOf(nextQueryId.getAndIncrement());
  TaskInfo outputTask=mockTaskManager.createTask(session,"queryId","stageId","queryId",null,ImmutableMap.<PlanNodeId,Set<Split>>of(),ImmutableList.<String>of("out"));
  SimpleQuery simpleQuery=new SimpleQuery(queryId,locationFactory.createQueryLocation(queryId),outputTask.getTaskId(),mockTaskManager,locationFactory);
  queries.put(queryId,simpleQuery);
  return simpleQuery.getQueryInfo();
}
