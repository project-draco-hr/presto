{
  Preconditions.checkNotNull(query,"query is null");
  String queryId=String.valueOf(nextQueryId.getAndIncrement());
  TaskInfo outputTask=mockTaskManager.updateTask(session,"queryId","stageId","queryId",null,ImmutableList.<TaskSource>of(),new OutputBuffers(ImmutableSet.<String>of("out"),true));
  SimpleQuery simpleQuery=new SimpleQuery(queryId,locationFactory.createQueryLocation(queryId),outputTask.getTaskId(),mockTaskManager,locationFactory);
  queries.put(queryId,simpleQuery);
  return simpleQuery.getQueryInfo();
}
