{
  this.taskStateMachine=checkNotNull(taskStateMachine,"taskStateMachine is null");
  this.queryContext=requireNonNull(queryContext,"queryContext is null");
  this.executor=checkNotNull(executor,"executor is null");
  this.session=session;
  this.maxMemory=checkNotNull(maxMemory,"maxMemory is null").toBytes();
  this.operatorPreAllocatedMemory=checkNotNull(operatorPreAllocatedMemory,"operatorPreAllocatedMemory is null");
  taskStateMachine.addStateChangeListener(new StateChangeListener<TaskState>(){
    @Override public void stateChanged(    TaskState newValue){
      if (newValue.isDone()) {
        executionEndTime.set(DateTime.now());
        endNanos.set(System.nanoTime());
      }
    }
  }
);
  this.verboseStats=verboseStats;
  this.cpuTimerEnabled=cpuTimerEnabled;
}
