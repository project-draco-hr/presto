{
  checkArgument(bytes >= 0,"bytes is negative");
  if (memoryReservation.get() + bytes > maxMemory) {
    throw new ExceededMemoryLimitException(new DataSize(maxMemory,BYTE).convertToMostSuccinctDataSize());
  }
  ListenableFuture<?> future=queryContext.reserveMemory(bytes);
  memoryReservation.getAndAdd(bytes);
  return future;
}
