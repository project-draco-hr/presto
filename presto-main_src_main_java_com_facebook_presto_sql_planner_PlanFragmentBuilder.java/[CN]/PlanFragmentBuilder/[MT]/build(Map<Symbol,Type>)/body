{
  Set<Symbol> dependencies=SymbolExtractor.extract(root);
  return new PlanFragment(id,isPartitioned,Maps.filterKeys(symbols,in(dependencies)),root);
}
