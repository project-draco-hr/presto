{
  ExchangeClient exchangeClient=new ExchangeClient(new DataSize(32,MEGABYTE),new DataSize(10,MEGABYTE),3,httpClient,executor);
  NewSourceOperator operator=new NewExchangeOperator(new PlanNodeId("test"),exchangeClient,TUPLE_INFOS);
  operator.addSplit(new RemoteSplit(URI.create("http://localhost/" + TASK_1_ID),TUPLE_INFOS));
  operator.addSplit(new RemoteSplit(URI.create("http://localhost/" + TASK_2_ID),TUPLE_INFOS));
  operator.addSplit(new RemoteSplit(URI.create("http://localhost/" + TASK_3_ID),TUPLE_INFOS));
  operator.noMoreSplits();
  taskBuffers.getUnchecked(TASK_1_ID).addPages(10,true);
  taskBuffers.getUnchecked(TASK_2_ID).addPages(10,true);
  taskBuffers.getUnchecked(TASK_3_ID).addPages(10,true);
  waitForPages(operator,30);
  waitForFinished(operator);
}
