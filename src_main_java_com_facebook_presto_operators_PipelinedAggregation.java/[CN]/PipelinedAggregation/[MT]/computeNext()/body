{
  if (!groupBySource.hasNext()) {
    endOfData();
    return null;
  }
  BlockBuilder builder=new BlockBuilder(position,tupleInfo);
  do {
    RunLengthEncodedBlock group=groupBySource.next();
    AggregationFunction aggregationFunction=functionProvider.get();
    AggregationUtil.processGroup(aggregationSource,aggregationFunction,group.getRange());
    Tuple value=aggregationFunction.evaluate();
    builder.append(group.getValue());
    builder.append(value);
  }
 while (!builder.isFull() && groupBySource.hasNext());
  ValueBlock block=builder.build();
  position+=block.getCount();
  return block;
}
