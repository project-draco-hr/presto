{
  DelimitedRecordSet recordIterable=new DelimitedRecordSet(newReaderSupplier("apple,fuu,123\nbanana,bar,456"),Splitter.on(','));
  RecordCursor cursor=recordIterable.cursor();
  assertTrue(cursor.advanceNextPosition());
  assertEquals(cursor.getString(0),"apple".getBytes(UTF_8));
  assertEquals(cursor.getString(1),"fuu".getBytes(UTF_8));
  assertEquals(cursor.getString(2),"123".getBytes(UTF_8));
  assertEquals(cursor.getLong(2),123L);
  assertEquals(cursor.getDouble(2),123.0);
  assertTrue(cursor.advanceNextPosition());
  assertEquals(cursor.getString(0),"banana".getBytes(UTF_8));
  assertEquals(cursor.getString(1),"bar".getBytes(UTF_8));
  assertEquals(cursor.getString(2),"456".getBytes(UTF_8));
  assertEquals(cursor.getLong(2),456L);
  assertEquals(cursor.getDouble(2),456.0);
  assertFalse(cursor.advanceNextPosition());
}
