double[] values
double[] weights
int nextIndex
