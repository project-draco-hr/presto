{
  Duration delay=new Duration(10,TimeUnit.SECONDS);
  while (true) {
    try {
      createShardTables(dao);
      return;
    }
 catch (    UnableToObtainConnectionException e) {
      log.warn("Failed to connect to database. Will retry again in %s. Exception: %s",delay,e.getMessage());
      Thread.sleep(delay.toMillis());
    }
  }
}
