{
  while (true) {
    QueryState currentState=this.queryState.get();
    if (currentState.isDone()) {
      return currentState == targetState;
    }
    if (this.queryState.compareAndSet(currentState,targetState)) {
      return true;
    }
  }
}
