{
  checkNotNull(otherStreamLayout,"otherStreamLayout is null");
  if (otherStreamLayout.getGroupId() < groupId) {
    return otherStreamLayout.mergeWith(this);
  }
  checkArgument(streamId.equals(otherStreamLayout.getStreamId()),"Streams must have the same name");
  checkArgument(type == otherStreamLayout.getType(),"Streams must have the same type");
  checkArgument(encoding == otherStreamLayout.getEncoding(),"Streams must have the same encoding");
  checkArgument(compressionKind == otherStreamLayout.getCompressionKind(),"Streams must have the same compression kind");
  return new StreamLayout(streamId,groupId,type,encoding,usesVInt,compressionKind,diskRange.span(otherStreamLayout.getDiskRange()),offsetPositions);
}
