{
  Preconditions.checkNotNull(planFragment,"planFragment is null");
  Preconditions.checkNotNull(fragmentSources,"fragmentSources is null");
  String taskId=String.valueOf(nextTaskId.getAndIncrement());
  SqlQueryTask queryTask=new SqlQueryTask(taskId,planFragment,outputIds,fragmentSources,sourceProvider,metadata,shardExecutor,pageBufferMax);
  queryTasks.put(taskId,queryTask);
  taskExecutor.submit(queryTask);
  return queryTask;
}
