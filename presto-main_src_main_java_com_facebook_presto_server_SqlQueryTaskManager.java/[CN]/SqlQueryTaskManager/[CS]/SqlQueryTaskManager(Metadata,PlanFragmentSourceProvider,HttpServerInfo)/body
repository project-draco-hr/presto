{
  Preconditions.checkNotNull(metadata,"metadata is null");
  Preconditions.checkNotNull(sourceProvider,"sourceProvider is null");
  Preconditions.checkNotNull(httpServerInfo,"httpServerInfo is null");
  this.metadata=metadata;
  this.sourceProvider=sourceProvider;
  this.httpServerInfo=httpServerInfo;
  this.pageBufferMax=20;
  int processors=Runtime.getRuntime().availableProcessors();
  taskExecutor=new ThreadPoolExecutor(1000,1000,1,TimeUnit.MINUTES,new LinkedBlockingQueue<Runnable>(),threadsNamed("task-processor-%d"));
  shardExecutor=new ThreadPoolExecutor(8 * processors,processors,1,TimeUnit.MINUTES,new SynchronousQueue<Runnable>(),threadsNamed("shard-processor-%d"),new ThreadPoolExecutor.CallerRunsPolicy());
}
