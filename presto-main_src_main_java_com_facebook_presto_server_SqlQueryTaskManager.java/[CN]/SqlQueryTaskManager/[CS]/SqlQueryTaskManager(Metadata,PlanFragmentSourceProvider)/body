{
  this.pageBufferMax=20;
  int processors=Runtime.getRuntime().availableProcessors();
  taskExecutor=new ThreadPoolExecutor(1000,1000,1,TimeUnit.MINUTES,new LinkedBlockingQueue<Runnable>(),threadsNamed("task-processor-%d"));
  shardExecutor=new ThreadPoolExecutor(processors,processors,1,TimeUnit.MINUTES,new SynchronousQueue<Runnable>(),threadsNamed("shard-processor-%d"),new ThreadPoolExecutor.CallerRunsPolicy());
  this.metadata=metadata;
  this.sourceProvider=sourceProvider;
}
