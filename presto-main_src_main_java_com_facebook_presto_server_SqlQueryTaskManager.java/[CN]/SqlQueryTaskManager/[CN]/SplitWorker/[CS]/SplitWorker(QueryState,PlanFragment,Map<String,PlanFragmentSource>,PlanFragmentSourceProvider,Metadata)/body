{
  this.queryState=queryState;
  ExecutionPlanner planner=new ExecutionPlanner(new SessionMetadata(metadata),sourceProvider,fragment.getSymbols(),fragmentSources);
  operator=planner.plan(fragment.getRoot());
  inputDataSize=planner.getInputDataSize();
  if (inputDataSize.isPresent()) {
    queryState.addInputDataSize(inputDataSize.get());
  }
  inputPositionCount=planner.getInputPositionCount();
  if (inputPositionCount.isPresent()) {
    queryState.addInputPositions(inputPositionCount.get());
  }
}
