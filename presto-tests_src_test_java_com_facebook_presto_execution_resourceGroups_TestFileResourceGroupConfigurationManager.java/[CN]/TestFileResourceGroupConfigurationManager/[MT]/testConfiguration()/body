{
  ResourceGroupConfigurationManager manager=parse("resource_groups_config.json");
  ResourceGroup global=new RootResourceGroup("global",directExecutor());
  manager.configure(global,testSessionBuilder().build().toSessionRepresentation());
  assertEquals(global.getSoftMemoryLimit(),new DataSize(1,MEGABYTE));
  assertEquals(global.getMaxQueuedQueries(),1000);
  assertEquals(global.getMaxRunningQueries(),100);
  assertEquals(global.getSchedulingPolicy(),WEIGHTED);
  assertEquals(global.getSchedulingWeight(),DEFAULT_WEIGHT);
  ResourceGroup sub=global.getOrCreateSubGroup("sub");
  manager.configure(sub,testSessionBuilder().build().toSessionRepresentation());
  assertEquals(sub.getSoftMemoryLimit(),new DataSize(2,MEGABYTE));
  assertEquals(sub.getMaxRunningQueries(),3);
  assertEquals(sub.getMaxQueuedQueries(),4);
  assertEquals(sub.getSchedulingPolicy(),FAIR);
  assertEquals(sub.getSchedulingWeight(),5);
}
