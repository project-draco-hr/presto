{
  ImmutableMap.Builder<String,String> builder=ImmutableMap.builder();
  builder.put("experimental.resource-groups-enabled","true");
  builder.put("resource-groups.config-file",getResourceFilePath("resource_groups_memory_percentage.json"));
  Map<String,String> properties=builder.build();
  try (DistributedQueryRunner queryRunner=createQueryRunner(ImmutableMap.of(),properties)){
    queryRunner.execute("SELECT COUNT(*), clerk FROM orders GROUP BY clerk");
    while (true) {
      TimeUnit.SECONDS.sleep(1);
      ResourceGroupInfo global=queryRunner.getCoordinator().getResourceGroupManager().get().getResourceGroupInfo(ResourceGroupId.fromString("global"));
      if (global.getSoftMemoryLimit().toBytes() > 0) {
        break;
      }
    }
  }
 }
