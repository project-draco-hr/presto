{
  long shard1Hours=Duration.ofMillis(shard1.getRangeStart().getAsLong()).toHours();
  long shard2Hours=Duration.ofMillis(shard2.getRangeStart().getAsLong()).toHours();
  long shard1Range=shard1.getRangeEnd().getAsLong() - shard1.getRangeStart().getAsLong();
  long shard2Range=shard2.getRangeEnd().getAsLong() - shard2.getRangeStart().getAsLong();
  return ComparisonChain.start().compare(shard1Hours,shard2Hours).compare(shard1Range,shard2Range).result();
}
