{
  if (loaded) {
    return;
  }
  try {
    BytesRefArrayWritable columnBatch=batch.getColumn(fieldId);
    int positionInBatch=batch.getPositionInBatch();
    int batchSize=block.getPositionCount();
    Slice[] vector=new Slice[batchSize];
    for (int i=0; i < batchSize; i++) {
      BytesRefWritable writable=columnBatch.unCheckedGet(i + positionInBatch);
      int length=writable.getLength();
      if (length > 0) {
        byte[] bytes=writable.getData();
        int start=writable.getStart();
        Slice value;
        if ((length == 1) && bytes[start] == HIVE_EMPTY_STRING_BYTE) {
          value=Slices.EMPTY_SLICE;
        }
 else {
          value=Slices.wrappedBuffer(Arrays.copyOfRange(bytes,start,start + length));
        }
        if (isVarcharType(type)) {
          value=truncateToLength(value,type);
        }
        vector[i]=value;
      }
    }
    block.setValues(vector);
    loaded=true;
  }
 catch (  IOException e) {
    throw Throwables.propagate(e);
  }
}
