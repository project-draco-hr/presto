{
  ExpressionAnalyzer analyzer=new ExpressionAnalyzer(metadata);
  Type type=analyzer.analyze(expression,tupleDescriptor);
  analysis.addFunctionInfos(analyzer.getResolvedFunctions());
  IdentityHashMap<Expression,Type> subExpressions=analyzer.getSubExpressionTypes();
  analysis.addTypes(subExpressions);
  for (  Expression subExpression : subExpressions.keySet()) {
    analysis.addResolvedNames(subExpression,analyzer.getResolvedNames());
  }
  return type;
}
