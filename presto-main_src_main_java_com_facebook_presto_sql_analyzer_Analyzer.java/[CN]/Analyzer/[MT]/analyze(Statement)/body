{
  Statement rewrittenStatement=StatementRewrite.rewrite(session,metadata,sqlParser,queryExplainer,statement);
  Analysis analysis=new Analysis(rewrittenStatement);
  StatementAnalyzer analyzer=new StatementAnalyzer(analysis,metadata,sqlParser,accessControl,session,experimentalSyntaxEnabled);
  RelationType outputDescriptor=analyzer.process(rewrittenStatement,new AnalysisContext());
  analysis.setOutputDescriptor(outputDescriptor);
  return analysis;
}
