{
  QualifiedTableName dstTableName=MetadataUtil.createQualifiedTableName(session,statement.getName());
  TableMetadata dstTableMetadata=metadata.getTable(dstTableName);
  if (dstTableMetadata != null) {
    checkState(dstTableMetadata.getTableHandle().isPresent(),"no table handle for %s",dstTableName);
    DataSourceType dataSourceType=dstTableMetadata.getTableHandle().get().getDataSourceType();
    checkState(DataSourceType.NATIVE == dataSourceType,"%s is not a native table, can only create native tables",dstTableName);
  }
  Field resultField=Field.getField("imported_rows",context.getSymbolAllocator().newSymbol("imported_rows",Type.LONG),Type.LONG);
  AnalyzedExpression resultFieldExpression=new AnalyzedExpression(resultField.getType(),QueryUtil.nameReference(resultField.getAttribute().get()));
  AnalyzedOutput output=new AnalyzedOutput(new TupleDescriptor(ImmutableList.<Field>of(resultField)),ImmutableMap.of(resultField.getSymbol(),resultFieldExpression));
  AnalyzedDestination destination=new AnalyzedDestination(dstTableName);
  AnalysisResult analysis=new Analyzer(context.getSession(),metadata).analyze(statement.getTableDefinition(),new AnalysisContext(context.getSession(),context.getSymbolAllocator()));
  context.addDestination(destination,analysis);
  return AnalysisResult.newInstance(context,false,output,null,ImmutableList.<AnalyzedExpression>of(),ImmutableSet.<AnalyzedFunction>of(),ImmutableSet.<AnalyzedFunction>of(),null,ImmutableList.<AnalyzedOrdering>of(),null);
}
