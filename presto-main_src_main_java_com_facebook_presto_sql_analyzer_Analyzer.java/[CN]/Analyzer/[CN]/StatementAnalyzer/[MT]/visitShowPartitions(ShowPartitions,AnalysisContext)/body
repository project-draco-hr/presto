{
  QualifiedName table=showPartitions.getTable();
  List<String> parts=Lists.reverse(table.getParts());
  if (parts.size() > 3) {
    throw new SemanticException(showPartitions,"too many parts in table name: %s",table);
  }
  String catalogName=(parts.size() > 2) ? parts.get(2) : context.getSession().getCatalog();
  String schemaName=(parts.size() > 1) ? parts.get(1) : context.getSession().getSchema();
  String tableName=parts.get(0);
  Query query=new Query(selectList(aliasedName("partition","Partition")),table(QualifiedName.of(catalogName,INFORMATION_SCHEMA,TABLE_INTERNAL_PARTITIONS)),logicalAnd(equal(nameReference("table_schema"),new StringLiteral(schemaName)),equal(nameReference("table_name"),new StringLiteral(tableName))),ImmutableList.<Expression>of(),null,ImmutableList.<SortItem>of(),null);
  return visitQuery(query,context);
}
