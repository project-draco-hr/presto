{
  ImmutableSet.Builder<AnalyzedFunction> builder=ImmutableSet.builder();
  for (  Expression term : concat(transform(select.getSelectItems(),unaliasFunction()),transform(orderBy,sortKeyGetter()))) {
    builder.addAll(new WindowAnalyzer(metadata,descriptor).analyze(term));
  }
  return builder.build();
}
