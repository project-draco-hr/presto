{
  ImmutableList.Builder<AnalyzedOrdering> builder=ImmutableList.builder();
  for (  SortItem sortItem : orderBy) {
    if (sortItem.getNullOrdering() != SortItem.NullOrdering.UNDEFINED) {
      throw new SemanticException(sortItem,"Custom null ordering not yet supported");
    }
    AnalyzedExpression expression=new ExpressionAnalyzer(metadata,descriptor.getSymbols()).analyze(sortItem.getSortKey(),descriptor);
    builder.add(new AnalyzedOrdering(expression,sortItem.getOrdering(),sortItem));
  }
  return builder.build();
}
