{
  AnalyzedExpression analyzedExpression=new ExpressionAnalyzer(metadata,sourceDescriptor.getSymbols()).analyze(predicate,sourceDescriptor);
  Type expressionType=analyzedExpression.getType();
  if (expressionType != Type.BOOLEAN && expressionType != Type.NULL) {
    throw new SemanticException(predicate,"WHERE clause must evaluate to a boolean: actual type %s",expressionType);
  }
  return analyzedExpression;
}
