{
  checkNotNull(partitions,"partitions is null");
  Preconditions.checkArgument(!partitions.isEmpty(),"partitions is empty");
  Partition partition=Iterables.getOnlyElement(partitions);
  checkArgument(partition instanceof JmxPartition,"Partition must be an jmx partition");
  JmxPartition jmxPartition=(JmxPartition)partition;
  ImmutableList.Builder<Split> splits=ImmutableList.builder();
  for (  Node node : nodeManager.getActiveNodes()) {
    splits.add(new JmxSplit(jmxPartition.tableHandle,ImmutableList.of(node.getHostAndPort())));
  }
  return splits.build();
}
