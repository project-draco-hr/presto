{
  Preconditions.checkNotNull(queryId,"queryId is null");
  Preconditions.checkNotNull(stageId,"stageId is null");
  Preconditions.checkNotNull(taskId,"taskId is null");
  Preconditions.checkNotNull(location,"location is null");
  Preconditions.checkNotNull(outputIds,"outputIds is null");
  Preconditions.checkArgument(!outputIds.isEmpty(),"outputIds is empty");
  Preconditions.checkArgument(pageBufferMax > 0,"pageBufferMax must be at least 1");
  Preconditions.checkArgument(splits >= 0,"splits is negative");
  this.queryId=queryId;
  this.stageId=stageId;
  this.taskId=taskId;
  this.location=location;
  stats.addSplits(splits);
  ImmutableMap.Builder<String,PageBuffer> builder=ImmutableMap.builder();
  for (  String outputId : outputIds) {
    builder.put(outputId,new PageBuffer(outputId,1,pageBufferMax));
  }
  outputBuffers=builder.build();
}
