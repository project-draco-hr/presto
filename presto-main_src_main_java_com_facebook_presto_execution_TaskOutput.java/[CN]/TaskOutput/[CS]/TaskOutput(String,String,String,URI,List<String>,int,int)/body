{
  Preconditions.checkNotNull(queryId,"queryId is null");
  Preconditions.checkNotNull(stageId,"stageId is null");
  Preconditions.checkNotNull(taskId,"taskId is null");
  Preconditions.checkNotNull(location,"location is null");
  Preconditions.checkNotNull(outputIds,"outputIds is null");
  Preconditions.checkArgument(!outputIds.isEmpty(),"outputIds is empty");
  Preconditions.checkArgument(pageBufferMax > 0,"pageBufferMax must be at least 1");
  Preconditions.checkArgument(splits >= 0,"splits is negative");
  this.queryId=queryId;
  this.stageId=stageId;
  this.taskId=taskId;
  this.location=location;
  sharedBuffer=new SharedBuffer<>(pageBufferMax);
  for (  String outputId : outputIds) {
    sharedBuffer.addQueue(outputId);
  }
  sharedBuffer.noMoreQueues();
  stats.addSplits(splits);
}
