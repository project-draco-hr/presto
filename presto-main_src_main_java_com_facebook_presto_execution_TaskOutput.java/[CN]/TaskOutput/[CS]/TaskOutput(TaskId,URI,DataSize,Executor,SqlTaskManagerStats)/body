{
  Preconditions.checkNotNull(taskId,"taskId is null");
  Preconditions.checkNotNull(location,"location is null");
  Preconditions.checkArgument(maxBufferSize.toBytes() > 0,"maxBufferSize must be at least 1");
  Preconditions.checkNotNull(executor,"executor is null");
  this.taskId=taskId;
  this.location=location;
  sharedBuffer=new SharedBuffer(maxBufferSize);
  taskState=new StateMachine<>("task " + taskId,executor,TaskState.RUNNING);
  taskState.addStateChangeListener(new StateChangeListener<TaskState>(){
    @Override public void stateChanged(    TaskState newValue){
      log.debug("Task %s is %s",TaskOutput.this.taskId,newValue);
    }
  }
);
  taskContext=new TaskContext(taskId,executor,null);
}
