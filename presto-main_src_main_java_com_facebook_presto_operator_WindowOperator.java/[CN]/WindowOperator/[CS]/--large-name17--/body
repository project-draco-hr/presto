{
  this.operatorContext=checkNotNull(operatorContext,"operatorContext is null");
  this.outputChannels=Ints.toArray(checkNotNull(outputChannels,"outputChannels is null"));
  this.windowFunctions=toWindowFunctions(checkNotNull(windowFunctionDefinitions,"windowFunctionDefinitions is null"));
  this.partitionTypes=ImmutableList.copyOf(checkNotNull(partitionTypes,"partitionTypes is null"));
  this.partitionChannels=ImmutableList.copyOf(checkNotNull(partitionChannels,"partitionChannels is null"));
  this.sortTypes=ImmutableList.copyOf(checkNotNull(sortTypes,"sortTypes is null"));
  this.sortChannels=ImmutableList.copyOf(checkNotNull(sortChannels,"sortChannels is null"));
  this.sortOrder=ImmutableList.copyOf(checkNotNull(sortOrder,"sortOrder is null"));
  this.frameRange=(checkNotNull(frameType,"frameType is null") == WindowFrame.Type.RANGE);
  this.frameStartType=checkNotNull(frameStartType,"frameStartType is null");
  this.frameStartChannel=checkNotNull(frameStartChannel,"frameStartChannel is null").orElse(-1);
  this.frameEndType=checkNotNull(frameEndType,"frameEndType is null");
  this.frameEndChannel=checkNotNull(frameEndChannel,"frameEndChannel is null").orElse(-1);
  this.types=toTypes(sourceTypes,outputChannels,windowFunctions);
  this.pagesIndex=new PagesIndex(sourceTypes,expectedPositions);
  this.pageBuilder=new PageBuilder(this.types);
}
