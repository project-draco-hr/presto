{
  if (state == State.NEEDS_INPUT) {
    state=State.HAS_OUTPUT;
    List<SortOrder> partitionOrder=Collections.nCopies(partitionChannels.size(),ASC_NULLS_LAST);
    List<Integer> orderChannels=ImmutableList.copyOf(Iterables.concat(partitionChannels,sortChannels));
    List<SortOrder> ordering=ImmutableList.copyOf(Iterables.concat(partitionOrder,sortOrder));
    pagesIndex.sort(orderChannels,ordering);
    partitionComparator=pagesIndex.createComparator(partitionChannels,partitionOrder);
    orderComparator=pagesIndex.createComparator(sortChannels,sortOrder);
  }
}
