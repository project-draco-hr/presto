{
  if (state == State.NEEDS_INPUT) {
    state=State.HAS_OUTPUT;
    List<SortOrder> partitionOrder=Collections.nCopies(partitionChannels.size(),ASC_NULLS_LAST);
    List<Integer> orderChannels=ImmutableList.copyOf(concat(partitionChannels,sortChannels));
    List<SortOrder> ordering=ImmutableList.copyOf(concat(partitionOrder,sortOrder));
    List<Type> orderingTypes=ImmutableList.copyOf(concat(partitionTypes,sortTypes));
    pagesIndex.sort(orderingTypes,orderChannels,ordering);
    partitionComparator=pagesIndex.createComparator(orderingTypes,partitionChannels,partitionOrder);
    orderComparator=pagesIndex.createComparator(orderingTypes,sortChannels,sortOrder);
  }
}
