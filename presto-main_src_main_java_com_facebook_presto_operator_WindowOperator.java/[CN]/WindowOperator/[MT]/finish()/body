{
  if (state == State.NEEDS_INPUT) {
    state=State.HAS_OUTPUT;
    SortOrder[] partitionOrder=new SortOrder[partitionChannels.length];
    Arrays.fill(partitionOrder,ASC_NULLS_LAST);
    int[] orderChannels=Ints.concat(partitionChannels,sortChannels);
    SortOrder[] ordering=ObjectArrays.concat(partitionOrder,sortOrder,SortOrder.class);
    pageIndex.sort(orderChannels,ordering);
    partitionComparator=new MultiSliceFieldOrderedTupleComparator(pageIndex,partitionChannels,partitionOrder);
    orderComparator=new MultiSliceFieldOrderedTupleComparator(pageIndex,sortChannels,sortOrder);
  }
}
