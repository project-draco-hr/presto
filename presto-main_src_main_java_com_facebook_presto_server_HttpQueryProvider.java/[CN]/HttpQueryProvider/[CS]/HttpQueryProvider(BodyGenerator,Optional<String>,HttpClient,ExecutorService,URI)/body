{
  checkNotNull(bodyGenerator,"bodyGenerator is null");
  checkNotNull(mediaType,"mediaType is null");
  checkNotNull(httpClient,"httpClient is null");
  checkNotNull(executor,"executor is null");
  this.httpClient=httpClient;
  this.executor=executor;
  Request.Builder requestBuilder=preparePost().setUri(uri).setBodyGenerator(bodyGenerator);
  if (mediaType.isPresent()) {
    requestBuilder.setHeader(HttpHeaders.CONTENT_TYPE,mediaType.get());
  }
  Request request=requestBuilder.build();
  JsonResponse<QueryInfo> response=httpClient.execute(request,createFullJsonResponseHandler(jsonCodec(QueryInfo.class)));
  Preconditions.checkState(response.getStatusCode() == 201,"Expected response code to be 201, but was %d: %s",response.getStatusCode(),response.getStatusMessage());
  String location=response.getHeader("Location");
  Preconditions.checkState(location != null);
  this.location=URI.create(location);
  this.tupleInfos=response.getValue().getTupleInfos();
}
