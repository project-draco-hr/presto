{
  ImmutableMap.Builder<String,List<QueryInfo>> map=ImmutableMap.builder();
  for (  Entry<String,List<HttpQueryProvider>> stage : stages.entrySet()) {
    map.put(stage.getKey(),ImmutableList.copyOf(Iterables.transform(stage.getValue(),new Function<HttpQueryProvider,QueryInfo>(){
      @Override public QueryInfo apply(      HttpQueryProvider queryProvider){
        QueryInfo queryInfo=queryProvider.getQueryInfo();
        return new QueryInfo(queryProvider.getLocation().toString(),queryProvider.getTupleInfos(),queryInfo.getState(),queryInfo.getBufferedPages(),queryInfo.getSplits(),queryInfo.getCompletedSplits());
      }
    }
)));
  }
  return new QueryInfo(queryId,outputQueryState.getTupleInfos(),outputQueryState.getState(),outputQueryState.getBufferedPageCount(),outputQueryState.getSplits(),outputQueryState.getCompletedSplits(),map.build());
}
