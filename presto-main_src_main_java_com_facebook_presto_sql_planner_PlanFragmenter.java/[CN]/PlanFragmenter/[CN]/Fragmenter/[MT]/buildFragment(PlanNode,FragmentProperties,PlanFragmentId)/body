{
  Set<Symbol> dependencies=SymbolExtractor.extract(root);
  PlanFragment fragment=new PlanFragment(fragmentId,root,Maps.filterKeys(types,in(dependencies)),properties.getOutputLayout(),properties.getDistribution(),properties.getDistributeBy(),properties.getPartitionFunction());
  return new SubPlan(fragment,properties.getChildren());
}
