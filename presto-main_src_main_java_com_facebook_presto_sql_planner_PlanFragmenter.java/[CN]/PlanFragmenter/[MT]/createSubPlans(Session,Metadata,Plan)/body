{
  Fragmenter fragmenter=new Fragmenter(session,metadata,plan.getSymbolAllocator().getTypes());
  FragmentProperties properties=new FragmentProperties(new PartitionFunctionBinding(SINGLE_DISTRIBUTION,plan.getRoot().getOutputSymbols(),ImmutableList.of())).setSingleNodeDistribution();
  PlanNode root=SimplePlanRewriter.rewriteWith(fragmenter,plan.getRoot(),properties);
  SubPlan result=fragmenter.buildRootFragment(root,properties);
  result.sanityCheck();
  return result;
}
