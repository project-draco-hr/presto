{
  checkState(!committed,"already committed");
  committed=true;
  flush();
  for (  UUID uuid : shardUuids) {
    writeShard(uuid);
  }
  return ImmutableList.copyOf(shardUuids);
}
