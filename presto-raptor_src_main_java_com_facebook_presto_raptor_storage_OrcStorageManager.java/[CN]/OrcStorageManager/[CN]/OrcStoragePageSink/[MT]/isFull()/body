{
  if (writer == null) {
    return false;
  }
  return (writer.getRowCount() >= rowsPerShard) || (writer.getUncompressedSize() >= maxShardSize.toBytes());
}
