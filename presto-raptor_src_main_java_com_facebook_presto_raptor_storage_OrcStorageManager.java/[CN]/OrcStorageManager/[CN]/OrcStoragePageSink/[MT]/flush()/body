{
  if (writer != null) {
    writer.close();
    File stagingFile=storageService.getStagingFile(shardUuid);
    List<ColumnStats> columns=computeShardStats(stagingFile,columnIds,columnTypes);
    shards.add(new ShardInfo(shardUuid,ImmutableSet.of(nodeId),columns));
    writer=null;
    shardUuid=null;
  }
}
