{
  File backupFile=getBackupFile(shardUuid);
  File stagingFile=temporarySuffix(getStagingFile(shardUuid));
  createParents(stagingFile);
  log.info("Copying shard %s from backup...",shardUuid);
  long start=System.nanoTime();
  try {
    Files.copy(backupFile.toPath(),stagingFile.toPath());
  }
 catch (  IOException e) {
    throw new PrestoException(RAPTOR_ERROR,"Failed to copy backup shard file: " + backupFile,e);
  }
  Duration duration=nanosSince(start);
  DataSize size=new DataSize(stagingFile.length(),BYTE);
  DataSize rate=dataRate(size,duration);
  log.info("Copied shard %s from backup in %s (%s at %s/s)",shardUuid,duration,size,rate);
  createParents(file);
  try {
    Files.move(stagingFile.toPath(),file.toPath(),ATOMIC_MOVE);
  }
 catch (  FileAlreadyExistsException e) {
  }
catch (  IOException e) {
    throw new PrestoException(RAPTOR_ERROR,"Failed to move shard file",e);
  }
}
