{
  File file=storageService.getStorageFile(shardUuid).getAbsoluteFile();
  if (!file.exists() && storageService.isBackupAvailable(shardUuid)) {
    restoreFromBackup(shardUuid,file);
  }
  try {
    return new FileOrcDataSource(file,orcMaxMergeDistance);
  }
 catch (  IOException e) {
    throw new PrestoException(RAPTOR_ERROR,"Failed to open shard file: " + file,e);
  }
}
