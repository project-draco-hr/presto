{
  checkNotNull(prefix,"prefix is null");
  Map<QualifiedTableName,List<ColumnMetadata>> tableColumns=new LinkedHashMap<>();
  for (  ConnectorMetadataEntry connectorMetadata : allConnectorsFor(prefix.getCatalogName())) {
    for (    Entry<SchemaTableName,List<ColumnMetadata>> entry : connectorMetadata.getMetadata().listTableColumns(session,prefix.asSchemaTablePrefix()).entrySet()) {
      QualifiedTableName tableName=new QualifiedTableName(prefix.getCatalogName(),entry.getKey().getSchemaName(),entry.getKey().getTableName());
      if (!tableColumns.containsKey(tableName)) {
        tableColumns.put(tableName,entry.getValue());
      }
    }
  }
  return ImmutableMap.copyOf(tableColumns);
}
