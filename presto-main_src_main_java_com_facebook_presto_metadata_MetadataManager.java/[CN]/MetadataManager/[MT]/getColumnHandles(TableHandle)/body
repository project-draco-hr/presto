{
  checkNotNull(tableHandle,"tableHandle is null");
  for (  InternalSchemaMetadata internalSchemaMetadata : internalSchemas) {
    Optional<Map<String,ColumnHandle>> columnHandles=internalSchemaMetadata.getColumnHandles(tableHandle);
    if (columnHandles.isPresent()) {
      return columnHandles.get();
    }
  }
  return lookupDataSource(tableHandle).getColumnHandles(tableHandle);
}
