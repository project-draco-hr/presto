{
  checkNotNull(prefix,"prefix is null");
  ImmutableList.Builder<QualifiedTableName> tables=ImmutableList.builder();
  ConnectorMetadata connectorMetadata=connectors.get(prefix.getCatalogName());
  if (connectorMetadata != null) {
    tables.addAll(transform(connectorMetadata.listTables(prefix.getSchemaName().orNull()),convertFromSchemaTableName(prefix.getCatalogName())));
  }
  for (  InternalSchemaMetadata internalSchemaMetadata : internalSchemas) {
    tables.addAll(internalSchemaMetadata.listTables(prefix));
  }
  return tables.build();
}
