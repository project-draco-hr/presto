{
  checkNotNull(prefix,"prefix is null");
  ImmutableMap.Builder<QualifiedTableName,List<ColumnMetadata>> builder=ImmutableMap.builder();
  for (  ConnectorMetadata connectorMetadata : allConnectorsFor(prefix.getCatalogName())) {
    for (    Entry<SchemaTableName,List<ColumnMetadata>> entry : connectorMetadata.listTableColumns(prefix.asSchemaTablePrefix()).entrySet()) {
      QualifiedTableName tableName=new QualifiedTableName(prefix.getCatalogName(),entry.getKey().getSchemaName(),entry.getKey().getTableName());
      builder.put(tableName,entry.getValue());
    }
  }
  return builder.build();
}
