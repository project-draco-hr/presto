{
  checkNotNull(prefix,"prefix is null");
  ImmutableMap.Builder<QualifiedTableName,List<ColumnMetadata>> builder=ImmutableMap.builder();
  for (  InternalSchemaMetadata internalSchemaMetadata : internalSchemas) {
    builder.putAll(internalSchemaMetadata.listTableColumns(prefix));
  }
  ConnectorMetadata connector=connectors.get(prefix.getCatalogName());
  if (connector != null) {
    for (    Entry<SchemaTableName,List<ColumnMetadata>> entry : connector.listTableColumns(prefix.asSchemaTablePrefix()).entrySet()) {
      QualifiedTableName tableName=new QualifiedTableName(prefix.getCatalogName(),entry.getKey().getSchemaName(),entry.getKey().getTableName());
      builder.put(tableName,entry.getValue());
    }
  }
  return builder.build();
}
