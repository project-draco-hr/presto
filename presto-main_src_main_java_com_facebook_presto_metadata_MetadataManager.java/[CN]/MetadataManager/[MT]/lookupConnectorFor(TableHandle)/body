{
  checkNotNull(tableHandle,"tableHandle is null");
  String connectorId=tableHandle.getConnectorId();
  ConnectorMetadata result=internalSchemas.get(connectorId);
  if (result != null) {
    return result;
  }
  result=connectorsById.get(connectorId);
  checkArgument(result != null,"No connector for table handle: %s",tableHandle.getConnectorId());
  return result;
}
