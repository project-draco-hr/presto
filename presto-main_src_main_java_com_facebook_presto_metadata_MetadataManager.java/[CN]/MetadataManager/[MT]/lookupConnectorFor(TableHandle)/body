{
  checkNotNull(tableHandle,"tableHandle is null");
  for (  Entry<String,ConnectorMetadataEntry> entry : informationSchemas.entrySet()) {
    if (entry.getValue().getMetadata().canHandle(tableHandle)) {
      return entry.getValue();
    }
  }
  for (  ConnectorMetadataEntry entry : internalSchemas) {
    if (entry.getMetadata().canHandle(tableHandle)) {
      return entry;
    }
  }
  for (  Entry<String,ConnectorMetadataEntry> entry : connectors.entrySet()) {
    if (entry.getValue().getMetadata().canHandle(tableHandle)) {
      return entry.getValue();
    }
  }
  throw new IllegalArgumentException("Table %s does not exist: " + tableHandle);
}
