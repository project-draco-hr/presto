{
  checkNotNull(tableHandle,"tableHandle is null");
  for (  ConnectorMetadataEntry entry : internalSchemas) {
    if (entry.getMetadata().canHandle(tableHandle.getConnectorHandle())) {
      return entry.getMetadata();
    }
  }
  for (  Entry<String,ConnectorMetadataEntry> entry : connectors.entrySet()) {
    if (entry.getValue().getMetadata().canHandle(tableHandle.getConnectorHandle())) {
      return entry.getValue().getMetadata();
    }
  }
  throw new IllegalArgumentException("Table %s does not exist: " + tableHandle);
}
