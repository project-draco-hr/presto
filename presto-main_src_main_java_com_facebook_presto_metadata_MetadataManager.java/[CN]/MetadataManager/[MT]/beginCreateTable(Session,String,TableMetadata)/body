{
  ConnectorEntry entry=connectorsByCatalog.get(catalogName);
  checkArgument(entry != null,"Catalog %s does not exist",catalogName);
  ConnectorMetadata metadata=entry.getMetadataForWrite(session);
  TransactionHandle transactionHandle=entry.getTransactionHandle(session);
  ConnectorSession connectorSession=session.toConnectorSession(entry.getCatalog());
  ConnectorOutputTableHandle handle=metadata.beginCreateTable(connectorSession,tableMetadata.getMetadata());
  return new OutputTableHandle(entry.getConnectorId(),transactionHandle,handle);
}
