{
  ConnectorMetadataEntry connectorMetadata=connectorsByCatalog.get(catalogName);
  checkArgument(connectorMetadata != null,"Catalog %s does not exist",catalogName);
  ConnectorSession connectorSession=session.toConnectorSession(connectorMetadata.getCatalog());
  ConnectorOutputTableHandle handle=connectorMetadata.getMetadata().beginCreateTable(connectorSession,tableMetadata.getMetadata());
  return new OutputTableHandle(connectorMetadata.getConnectorId(),handle);
}
