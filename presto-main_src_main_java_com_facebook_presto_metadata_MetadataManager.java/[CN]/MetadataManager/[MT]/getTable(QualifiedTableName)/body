{
  checkTable(table);
  if (table.getTableName().equals(DualTable.NAME)) {
    return DualTable.getTable(table);
  }
  InternalSchemaMetadata internalSchemaMetadata=internalSchemas.get(table.getSchemaName());
  if (internalSchemaMetadata != null) {
    return internalSchemaMetadata.getTable(table);
  }
  return lookupDataSource(table).getTable(table);
}
