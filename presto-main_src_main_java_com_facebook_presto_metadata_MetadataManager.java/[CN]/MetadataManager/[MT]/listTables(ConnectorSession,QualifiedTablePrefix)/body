{
  checkNotNull(prefix,"prefix is null");
  String schemaNameOrNull=prefix.getSchemaName().orNull();
  LinkedHashSet<QualifiedTableName> tables=new LinkedHashSet<>();
  for (  ConnectorMetadataEntry entry : allConnectorsFor(prefix.getCatalogName())) {
    for (    QualifiedTableName tableName : transform(entry.getMetadata().listTables(session,schemaNameOrNull),convertFromSchemaTableName(prefix.getCatalogName()))) {
      tables.add(tableName);
    }
  }
  return ImmutableList.copyOf(tables);
}
