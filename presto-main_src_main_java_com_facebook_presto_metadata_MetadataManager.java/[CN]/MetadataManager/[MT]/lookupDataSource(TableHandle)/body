{
  for (  ConnectorMetadata metadata : connectors.values()) {
    if (metadata.canHandle(tableHandle)) {
      return metadata;
    }
  }
  throw new IllegalArgumentException("Table %s does not exist: " + tableHandle);
}
