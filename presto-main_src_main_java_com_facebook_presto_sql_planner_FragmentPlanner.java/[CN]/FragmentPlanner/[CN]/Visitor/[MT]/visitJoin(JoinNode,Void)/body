{
  PlanFragmentBuilder left=node.getLeft().accept(this,context);
  PlanFragmentBuilder right=node.getRight().accept(this,context);
  if (left.isPartitioned() || right.isPartitioned()) {
    ExchangeNode exchange=new ExchangeNode(right.getId(),right.getRoot().getOutputSymbols());
    JoinNode join=new JoinNode(left.getRoot(),exchange,node.getCriteria());
    left.setRoot(join);
    return left;
  }
 else {
    throw new UnsupportedOperationException("not yet implemented");
  }
}
