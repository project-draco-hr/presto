{
  ImmutableMap<String,List<PlanFragmentSource>> fragmentSources=ImmutableMap.of();
  PlanFragment planFragment=new PlanFragment(32,false,ImmutableMap.<Symbol,Type>of(),new ExchangeNode(22,ImmutableList.<Symbol>of()));
  QueryFragmentRequest fragmentRequest=new QueryFragmentRequest(planFragment,ImmutableList.<PlanFragmentSource>of(),ImmutableMap.<String,ExchangePlanFragmentSource>of(),ImmutableList.of("out"));
  Request request=preparePost().setUri(httpServer.getBaseUrl().resolve("/v1/presto/task")).setHeader(HttpHeaders.CONTENT_TYPE,MediaType.APPLICATION_JSON).setBodyGenerator(jsonBodyGenerator(jsonCodec(QueryFragmentRequest.class),fragmentRequest)).build();
  JsonResponse<QueryTaskInfo> response=httpClient.execute(request,createFullJsonResponseHandler(jsonCodec(QueryTaskInfo.class)));
  Preconditions.checkState(response.getStatusCode() == 201,"Expected response code from %s to be 201, but was %d: %s",request.getUri(),response.getStatusCode(),response.getStatusMessage());
  String location=response.getHeader("Location");
  Preconditions.checkState(location != null);
  QueryTaskInfo queryTaskInfo=response.getValue();
  return new HttpTaskClient(queryTaskInfo.getTaskId(),URI.create(location),"out",queryTaskInfo.getTupleInfos(),httpClient,executor,jsonCodec(QueryTaskInfo.class));
}
