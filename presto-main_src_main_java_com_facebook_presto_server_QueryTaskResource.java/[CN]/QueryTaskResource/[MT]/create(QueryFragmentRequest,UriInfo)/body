{
  try {
    checkNotNull(queryFragmentRequest,"queryFragmentRequest is null");
    QueryTaskInfo queryTaskInfo=queryTaskManager.createQueryTask(queryFragmentRequest.getFragment(),queryFragmentRequest.getSplits(),queryFragmentRequest.getExchangeSources(),queryFragmentRequest.getOutputIds());
    URI pagesUri=uriBuilderFrom(uriInfo.getRequestUri()).appendPath(queryTaskInfo.getTaskId()).build();
    return Response.created(pagesUri).entity(queryTaskInfo).build();
  }
 catch (  Exception e) {
    e.printStackTrace();
    throw Throwables.propagate(e);
  }
}
