{
  dbi.inTransaction(new VoidTransactionCallback(){
    @Override protected void execute(    Handle handle,    TransactionStatus status) throws Exception {
      StorageManagerDao dao=handle.attach(StorageManagerDao.class);
      for (      Map.Entry<ColumnHandle,File> entry : columnFileHandle.getFiles().entrySet()) {
        ColumnHandle columnHandle=entry.getKey();
        File file=entry.getValue();
        checkState(columnHandle.getDataSourceType() == DataSourceType.NATIVE,"Can only import in a native column");
        long columnId=((NativeColumnHandle)columnHandle).getColumnId();
        String filename=file.getName();
        dao.insertColumn(columnFileHandle.getShardId(),columnId,filename);
      }
    }
  }
);
}
