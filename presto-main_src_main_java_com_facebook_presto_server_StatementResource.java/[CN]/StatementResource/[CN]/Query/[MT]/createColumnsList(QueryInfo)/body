{
  requireNonNull(queryInfo,"queryInfo is null");
  StageInfo outputStage=queryInfo.getOutputStage();
  requireNonNull(outputStage,"outputStage is null");
  List<String> names=queryInfo.getFieldNames();
  List<Type> types=outputStage.getTypes();
  checkArgument(names.size() == types.size(),"names and types size mismatch");
  ImmutableList.Builder<Column> list=ImmutableList.builder();
  for (int i=0; i < names.size(); i++) {
    String name=names.get(i);
    TypeSignature typeSignature=types.get(i).getTypeSignature();
    String type=typeSignature.toString();
    list.add(new Column(name,type,new ClientTypeSignature(typeSignature)));
  }
  return list.build();
}
