{
  checkNotNull(queryInfo,"queryInfo is null");
  StageInfo outputStage=queryInfo.getOutputStage();
  checkNotNull(outputStage,"outputStage is null");
  List<String> names=queryInfo.getFieldNames();
  List<Type> types=outputStage.getTypes();
  checkArgument(names.size() == types.size(),"names and types size mismatch");
  ImmutableList.Builder<Column> list=ImmutableList.builder();
  for (int i=0; i < names.size(); i++) {
    String name=names.get(i);
    String type=types.get(i).getTypeSignature().toString();
    list.add(new Column(name,type));
  }
  return list.build();
}
