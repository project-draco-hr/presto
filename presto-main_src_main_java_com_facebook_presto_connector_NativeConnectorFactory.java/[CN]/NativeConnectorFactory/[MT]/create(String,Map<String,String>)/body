{
  ImmutableClassToInstanceMap.Builder<Object> builder=ImmutableClassToInstanceMap.builder();
  IDBI dbi=this.dbi.get();
  if (dbi != null) {
    builder.put(ConnectorMetadata.class,new NativeMetadata(connectorId,dbi));
  }
  NativeSplitManager splitManager=this.splitManager.get();
  if (splitManager != null) {
    builder.put(ConnectorSplitManager.class,splitManager);
  }
  builder.put(ConnectorDataStreamProvider.class,dataStreamProvider);
  builder.put(ConnectorHandleResolver.class,HANDLE_RESOLVER);
  return new StaticConnector(builder.build());
}
