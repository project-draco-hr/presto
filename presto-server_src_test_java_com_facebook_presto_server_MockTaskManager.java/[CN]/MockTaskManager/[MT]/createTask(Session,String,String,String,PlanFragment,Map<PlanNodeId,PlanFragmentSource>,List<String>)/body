{
  Preconditions.checkNotNull(taskId,"taskId is null");
  Preconditions.checkArgument(!taskId.isEmpty(),"taskId is empty");
  URI location=uriBuilderFrom(httpServerInfo.getHttpUri()).appendPath("v1/task").appendPath(taskId).build();
  TaskOutput taskOutput=new TaskOutput(queryId,stageId,taskId,location,ImmutableList.copyOf(outputIds),pageBufferMax,0);
  tasks.put(taskId,taskOutput);
  List<String> data=ImmutableList.of("apple","banana","cherry","date");
  for (int i=0; i < initialPages; i++) {
    try {
      taskOutput.addPage(new Page(createStringsBlock(Iterables.concat(Collections.nCopies(i + 1,data)))));
    }
 catch (    InterruptedException e) {
      Thread.currentThread().interrupt();
      throw Throwables.propagate(e);
    }
  }
  taskOutput.finish();
  return taskOutput.getTaskInfo();
}
