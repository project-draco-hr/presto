{
  Preconditions.checkNotNull(session,"session is null");
  Preconditions.checkNotNull(queryId,"queryId is null");
  Preconditions.checkNotNull(stageId,"stageId is null");
  Preconditions.checkNotNull(sources,"sources is null");
  Preconditions.checkNotNull(outputIds,"outputIds is null");
  TaskOutput taskOutput=tasks.get(taskId);
  if (taskOutput == null) {
    URI location=uriBuilderFrom(httpServerInfo.getHttpUri()).appendPath("v1/task").appendPath(taskId).build();
    taskOutput=new TaskOutput(queryId,stageId,taskId,location,pageBufferMax);
    tasks.put(taskId,taskOutput);
    List<String> data=ImmutableList.of("apple","banana","cherry","date");
    for (int i=0; i < initialPages; i++) {
      try {
        taskOutput.addPage(new Page(createStringsBlock(Iterables.concat(Collections.nCopies(i + 1,data)))));
      }
 catch (      InterruptedException e) {
        Thread.currentThread().interrupt();
        throw Throwables.propagate(e);
      }
    }
    taskOutput.finish();
  }
  for (  String outputId : outputIds.getBufferIds()) {
    taskOutput.addResultQueue(outputId);
  }
  if (outputIds.isNoMoreBufferIds()) {
    taskOutput.noMoreResultQueues();
  }
  return taskOutput.getTaskInfo(false);
}
