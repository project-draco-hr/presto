{
  try (TempFile tempFile=new TempFile("test","orc")){
    createMultiStripeFile(tempFile.getFile());
    OrcRecordReader reader=createCustomOrcRecordReader(tempFile,new OrcMetadataReader(),OrcPredicate.TRUE,BIGINT);
    assertEquals(reader.getFileRowCount(),100);
    assertEquals(reader.getTotalRowCount(),100);
    assertEquals(reader.getPosition(),0);
    for (int i=0; i < 5; i++) {
      assertEquals(reader.nextBatch(),20);
      assertEquals(reader.getPosition(),(i + 1) * 20L);
      assertEquals(reader.getFilePosition(),reader.getPosition());
      assertCurrentBatch(reader,i);
    }
    assertEquals(reader.nextBatch(),-1);
    assertEquals(reader.getPosition(),100);
    assertEquals(reader.getFilePosition(),reader.getPosition());
    reader.close();
  }
 }
