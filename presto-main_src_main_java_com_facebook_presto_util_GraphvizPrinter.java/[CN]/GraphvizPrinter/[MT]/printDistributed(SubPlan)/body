{
  List<PlanFragment> fragments=plan.getAllFragments();
  Map<PlanFragmentId,PlanFragment> fragmentsById=Maps.uniqueIndex(fragments,PlanFragment.idGetter());
  PlanNodeIdGenerator idGenerator=new PlanNodeIdGenerator();
  StringBuilder output=new StringBuilder();
  output.append("digraph distributed_plan {\n");
  printSubPlan(plan,fragmentsById,idGenerator,output);
  output.append("}\n");
  return output.toString();
}
