{
  Map<PlanFragmentId,PlanFragment> fragmentsById=Maps.uniqueIndex(fragments,new Function<PlanFragment,PlanFragmentId>(){
    @Override public PlanFragmentId apply(    PlanFragment input){
      return input.getId();
    }
  }
);
  PlanNodeIdGenerator idGenerator=new PlanNodeIdGenerator();
  StringBuilder output=new StringBuilder();
  output.append("digraph logical_plan {\n");
  for (  PlanFragment fragment : fragments) {
    printFragmentNodes(output,fragment,idGenerator);
  }
  for (  PlanFragment fragment : fragments) {
    fragment.getRoot().accept(new EdgePrinter(output,fragmentsById,idGenerator),null);
  }
  output.append("}\n");
  return output.toString();
}
