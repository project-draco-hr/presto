{
  try {
    Object writer=Class.forName(outputFormatName).getConstructor().newInstance();
    boolean isCompressed=HiveConf.getBoolVar(conf,COMPRESSRESULT);
    return ((HiveOutputFormat<?,?>)writer).getHiveRecordWriter(conf,target,Text.class,isCompressed,properties,Reporter.NULL);
  }
 catch (  IOException|ReflectiveOperationException e) {
    throw new PrestoException(HIVE_FILE_OPEN_ERROR,e);
  }
}
