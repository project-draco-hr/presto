{
  if (!node.getName().getPrefix().isPresent()) {
    Type type=symbols.get(Symbol.fromQualifiedName(node.getName()));
    if (type != null) {
      return type;
    }
  }
  List<Field> matches=descriptor.resolve(node.getName());
  if (matches.isEmpty()) {
    throw new SemanticException(node,"Attribute '%s' cannot be resolved",node.getName());
  }
 else   if (matches.size() > 1) {
    throw new SemanticException(node,"Attribute '%s' is ambiguous. Possible matches: %s",node.getName(),Iterables.transform(matches,nameGetter()));
  }
  return Iterables.getOnlyElement(matches).getType();
}
