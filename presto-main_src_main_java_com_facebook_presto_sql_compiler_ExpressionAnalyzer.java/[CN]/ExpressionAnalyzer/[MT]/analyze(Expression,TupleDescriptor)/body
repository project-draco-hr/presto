{
  Type type=new Visitor(metadata).process(expression,sourceDescriptor);
  Expression rewritten=TreeRewriter.rewriteWith(new NameToSlotRewriter(sourceDescriptor),expression);
  return new AnalyzedExpression(type,rewritten);
}
