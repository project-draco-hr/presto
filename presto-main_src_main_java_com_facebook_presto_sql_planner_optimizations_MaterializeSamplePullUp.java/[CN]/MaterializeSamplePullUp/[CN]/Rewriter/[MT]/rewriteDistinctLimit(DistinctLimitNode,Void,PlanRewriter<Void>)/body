{
  PlanNode source=planRewriter.rewrite(node.getSource(),null);
  if (source instanceof MaterializeSampleNode) {
    ImmutableMap.Builder<Symbol,Expression> projections=ImmutableMap.builder();
    for (    Symbol symbol : source.getOutputSymbols()) {
      Expression expression=new QualifiedNameReference(symbol.toQualifiedName());
      projections.put(symbol,expression);
    }
    source=new ProjectNode(idAllocator.getNextId(),((MaterializeSampleNode)source).getSource(),projections.build());
    return new DistinctLimitNode(node.getId(),source,node.getLimit());
  }
 else {
    return new DistinctLimitNode(node.getId(),source,node.getLimit());
  }
}
