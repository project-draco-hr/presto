{
  this.nodeManager=nodeManager;
  this.coordinatorNodeId=nodeManager.getCurrentNode().getNodeIdentifier();
  this.minCandidates=config.getMinCandidates();
  this.locationAwareScheduling=config.isLocationAwareSchedulingEnabled();
  this.includeCoordinator=config.isIncludeCoordinator();
  this.doubleScheduling=config.isMultipleTasksPerNodeEnabled();
  this.maxSplitsPerNode=config.getMaxSplitsPerNode();
  this.maxSplitsPerNodePerTaskWhenFull=config.getMaxPendingSplitsPerNodePerTask();
  this.nodeTaskMap=requireNonNull(nodeTaskMap,"nodeTaskMap is null");
  checkArgument(maxSplitsPerNode > maxSplitsPerNodePerTaskWhenFull,"maxSplitsPerNode must be > maxSplitsPerNodePerTaskWhenFull");
}
