{
  checkArgument(limit > 0,"limit must be at least 1");
  FluentIterable<Node> nodes=FluentIterable.from(lazyShuffle(nodeMap.get().get().getNodesByHostAndPort().values()));
  if (doubleScheduling) {
    nodes=nodes.cycle();
  }
  return nodes.limit(limit).toList();
}
