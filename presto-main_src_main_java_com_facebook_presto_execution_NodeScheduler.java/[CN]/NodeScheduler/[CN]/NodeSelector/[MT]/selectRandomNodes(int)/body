{
  Preconditions.checkArgument(limit > 0,"limit must be at least 1");
  List<Node> nodes=new ArrayList<>(nodeMap.get().get().getNodesByHostAndPort().values());
  if (nodes.size() > limit) {
    Collections.shuffle(nodes,ThreadLocalRandom.current());
    nodes=nodes.subList(0,limit);
  }
  return ImmutableList.copyOf(nodes);
}
