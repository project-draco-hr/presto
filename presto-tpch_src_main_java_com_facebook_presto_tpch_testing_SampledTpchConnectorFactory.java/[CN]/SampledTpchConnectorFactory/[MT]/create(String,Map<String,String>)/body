{
  checkNotNull(properties,"properties is null");
  final int splitsPerNode=getSplitsPerNode(properties);
  return new Connector(){
    @Override public ConnectorMetadata getMetadata(){
      return new SampledTpchMetadata(connectorId);
    }
    @Override public ConnectorSplitManager getSplitManager(){
      return new TpchSplitManager(connectorId,nodeManager,splitsPerNode);
    }
    @Override public ConnectorHandleResolver getHandleResolver(){
      return new TpchHandleResolver(connectorId);
    }
    @Override public ConnectorRecordSetProvider getRecordSetProvider(){
      return new SampledTpchRecordSetProvider(connectorId,sampleWeight);
    }
    @Override public ConnectorRecordSinkProvider getRecordSinkProvider(){
      throw new UnsupportedOperationException();
    }
    @Override public ConnectorIndexResolver getIndexResolver(){
      throw new UnsupportedOperationException();
    }
  }
;
}
