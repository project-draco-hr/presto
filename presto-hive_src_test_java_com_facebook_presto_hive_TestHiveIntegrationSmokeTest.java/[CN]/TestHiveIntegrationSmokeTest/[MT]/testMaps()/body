{
  assertQuery("CREATE TABLE tmp_map1 AS SELECT MAP(0, 2, 1, NULL) AS col","SELECT 1");
  assertQuery("SELECT col[0] FROM tmp_map1","SELECT 2");
  assertQuery("SELECT col[1] FROM tmp_map1","SELECT NULL");
  assertQuery("CREATE TABLE tmp_map2 AS SELECT MAP(1.0, 2.5) AS col","SELECT 1");
  assertQuery("SELECT col[1.0] FROM tmp_map2","SELECT 2.5");
  assertQuery("CREATE TABLE tmp_map3 AS SELECT MAP('puppies', 'kittens') AS col","SELECT 1");
  assertQuery("SELECT col['puppies'] FROM tmp_map3","SELECT 'kittens'");
  assertQuery("CREATE TABLE tmp_map4 AS SELECT MAP(TRUE, FALSE) AS col","SELECT 1");
  assertQuery("SELECT col[TRUE] FROM tmp_map4","SELECT FALSE");
  assertQuery("CREATE TABLE tmp_map5 AS SELECT MAP(1.0, ARRAY[1, 2]) AS col","SELECT 1");
  assertQuery("SELECT col[1.0][2] FROM tmp_map5","SELECT 2");
  assertQuery("CREATE TABLE tmp_map6 AS SELECT MAP(DATE '2014-09-30', DATE '2014-09-29') AS col","SELECT 1");
  assertOneNotNullResult("SELECT col[DATE '2014-09-30'] FROM tmp_map6");
  assertQuery("CREATE TABLE tmp_map7 AS SELECT MAP(TIMESTAMP '2001-08-22 03:04:05.321', TIMESTAMP '2001-08-22 03:04:05.321') AS col","SELECT 1");
  assertOneNotNullResult("SELECT col[TIMESTAMP '2001-08-22 03:04:05.321'] FROM tmp_map7");
}
