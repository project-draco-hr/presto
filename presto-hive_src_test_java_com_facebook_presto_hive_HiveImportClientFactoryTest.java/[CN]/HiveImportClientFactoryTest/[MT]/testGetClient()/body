{
  ServiceSelector selector=new StaticServiceSelector(serviceDescriptor("hive-metastore").addProperty("thrift","meta1.test:9083").addProperty("name","fuu").build(),serviceDescriptor("hive-metastore").addProperty("thrift","meta2.text:9083").addProperty("name","fuu").build(),serviceDescriptor("hive-metastore").addProperty("thrift","meta3.text:9083").addProperty("name","bar").build(),serviceDescriptor("hive-metastore").addProperty("thrift","missing-port").build(),serviceDescriptor("hive-metastore").build());
  HiveClientFactory hiveClientFactory=new HiveClientFactory(new HiveClientConfig(),new HiveChunkEncoder(getHivePartitionChunkCodec()));
  HiveImportClientFactory factory=new HiveImportClientFactory(selector,hiveClientFactory,testExporter);
  assertInstanceOf(factory.createClient("hive_fuu"),CachingHiveClient.class);
  assertInstanceOf(factory.createClient("hive_bar"),CachingHiveClient.class);
  assertNull(factory.createClient("unknown"));
}
