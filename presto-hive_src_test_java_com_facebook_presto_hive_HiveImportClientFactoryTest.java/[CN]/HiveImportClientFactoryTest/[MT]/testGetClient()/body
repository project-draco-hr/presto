{
  ServiceSelector selector=new StaticServiceSelector(serviceDescriptor("hive-metastore").addProperty("thrift","meta1.test:9083").addProperty("name","fuu").build(),serviceDescriptor("hive-metastore").addProperty("thrift","meta2.text:9083").addProperty("name","fuu").build(),serviceDescriptor("hive-metastore").addProperty("thrift","meta3.text:9083").addProperty("name","bar").build(),serviceDescriptor("hive-metastore").addProperty("thrift","missing-port").build(),serviceDescriptor("hive-metastore").build());
  HiveClientFactory hiveClientFactory=new HiveClientFactory(new HiveClientConfig(),new HiveChunkEncoder(getHivePartitionChunkCodec()));
  DiscoveryLocatedHiveCluster hiveCluster=new DiscoveryLocatedHiveCluster(selector,new HiveMetastoreClientFactory(new HiveClientConfig()));
  HiveImportClientFactory factory=new HiveImportClientFactory(hiveCluster,hiveClientFactory);
  assertInstanceOf(factory.createClient("hive"),HiveClient.class);
  assertNull(factory.createClient("hive_test"));
  assertNull(factory.createClient("unknown"));
}
