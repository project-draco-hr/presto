{
  Map<String,String> properties=new ImmutableMap.Builder<String,String>().put("hive.time-zone",nonDefaultTimeZone().getID()).put("hive.max-split-size","256MB").put("hive.max-outstanding-splits","10").put("hive.max-split-iterator-threads","10").put("hive.allow-add-column","true").put("hive.allow-drop-table","true").put("hive.allow-rename-table","true").put("hive.allow-corrupt-writes-for-testing","true").put("hive.metastore-cache-ttl","2h").put("hive.metastore-refresh-interval","30m").put("hive.metastore-refresh-max-threads","2500").put("hive.metastore.thrift.client.socks-proxy","localhost:1080").put("hive.metastore-timeout","20s").put("hive.metastore.partition-batch-size.min","1").put("hive.metastore.partition-batch-size.max","1000").put("hive.dfs-timeout","33s").put("hive.dfs.connect.timeout","20s").put("hive.dfs.connect.max-retries","10").put("hive.dfs.verify-checksum","false").put("hive.dfs.domain-socket-path","/foo").put("hive.config.resources","/foo.xml,/bar.xml").put("hive.max-initial-splits","10").put("hive.max-initial-split-size","16MB").put("hive.domain-compaction-threshold","42").put("hive.recursive-directories","true").put("hive.storage-format","SEQUENCEFILE").put("hive.force-local-scheduling","true").put("hive.assume-canonical-partition-keys","true").put("hive.parquet.use-column-names","true").put("hive.s3.aws-access-key","abc123").put("hive.s3.aws-secret-key","secret").put("hive.s3.use-instance-credentials","false").put("hive.s3.ssl.enabled","false").put("hive.s3.max-client-retries","9").put("hive.s3.max-error-retries","8").put("hive.s3.max-backoff-time","4m").put("hive.s3.max-retry-time","20m").put("hive.s3.connect-timeout","8s").put("hive.s3.socket-timeout","4m").put("hive.s3.multipart.min-file-size","32MB").put("hive.s3.multipart.min-part-size","15MB").put("hive.s3.max-connections","77").put("hive.s3.staging-directory","/s3-staging").put("hive.optimized-reader.enabled","false").put("hive.parquet-predicate-pushdown.enabled","true").put("hive.parquet-optimized-reader.enabled","true").put("hive.orc.max-merge-distance","22kB").put("hive.orc.max-buffer-size","44kB").put("hive.orc.stream-buffer-size","55kB").build();
  HiveClientConfig expected=new HiveClientConfig().setTimeZone(nonDefaultTimeZone().toTimeZone().getID()).setMaxSplitSize(new DataSize(256,Unit.MEGABYTE)).setMaxOutstandingSplits(10).setMaxSplitIteratorThreads(10).setAllowAddColumn(true).setAllowDropTable(true).setAllowRenameTable(true).setAllowCorruptWritesForTesting(true).setMetastoreCacheTtl(new Duration(2,TimeUnit.HOURS)).setMetastoreRefreshInterval(new Duration(30,TimeUnit.MINUTES)).setMaxMetastoreRefreshThreads(2500).setMetastoreSocksProxy(HostAndPort.fromParts("localhost",1080)).setMetastoreTimeout(new Duration(20,TimeUnit.SECONDS)).setMinPartitionBatchSize(1).setMaxPartitionBatchSize(1000).setMaxInitialSplits(10).setMaxInitialSplitSize(new DataSize(16,Unit.MEGABYTE)).setDomainCompactionThreshold(42).setForceLocalScheduling(true).setRecursiveDirWalkerEnabled(true).setDfsTimeout(new Duration(33,TimeUnit.SECONDS)).setDfsConnectTimeout(new Duration(20,TimeUnit.SECONDS)).setDfsConnectMaxRetries(10).setVerifyChecksum(false).setResourceConfigFiles(ImmutableList.of("/foo.xml","/bar.xml")).setHiveStorageFormat(HiveStorageFormat.SEQUENCEFILE).setDomainSocketPath("/foo").setUseParquetColumnNames(true).setS3AwsAccessKey("abc123").setS3AwsSecretKey("secret").setS3UseInstanceCredentials(false).setS3SslEnabled(false).setS3MaxClientRetries(9).setS3MaxErrorRetries(8).setS3MaxBackoffTime(new Duration(4,TimeUnit.MINUTES)).setS3MaxRetryTime(new Duration(20,TimeUnit.MINUTES)).setS3ConnectTimeout(new Duration(8,TimeUnit.SECONDS)).setS3SocketTimeout(new Duration(4,TimeUnit.MINUTES)).setS3MultipartMinFileSize(new DataSize(32,Unit.MEGABYTE)).setS3MultipartMinPartSize(new DataSize(15,Unit.MEGABYTE)).setS3MaxConnections(77).setS3StagingDirectory(new File("/s3-staging")).setOptimizedReaderEnabled(false).setParquetPredicatePushdownEnabled(true).setParquetOptimizedReaderEnabled(true).setAssumeCanonicalPartitionKeys(true).setOrcMaxMergeDistance(new DataSize(22,Unit.KILOBYTE)).setOrcMaxBufferSize(new DataSize(44,Unit.KILOBYTE)).setOrcStreamBufferSize(new DataSize(55,Unit.KILOBYTE));
  ConfigAssertions.assertFullMapping(properties,expected);
}
