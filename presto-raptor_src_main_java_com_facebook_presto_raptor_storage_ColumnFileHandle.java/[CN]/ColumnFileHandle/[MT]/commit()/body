{
  Throwable firstThrowable=null;
  checkState(!committed.getAndSet(true),"already committed: %s",shardUuid);
  for (  BlocksFileWriter writer : writers.values()) {
    try {
      writer.close();
    }
 catch (    Throwable t) {
      if (firstThrowable == null) {
        firstThrowable=t;
      }
    }
  }
  if (firstThrowable != null) {
    Throwables.propagateIfInstanceOf(firstThrowable,IOException.class);
    throw Throwables.propagate(firstThrowable);
  }
}
