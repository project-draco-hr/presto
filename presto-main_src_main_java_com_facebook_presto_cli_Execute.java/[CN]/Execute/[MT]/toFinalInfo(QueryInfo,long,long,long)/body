{
  Duration elapsedTime=Duration.nanosSince(start);
  int totalSplits=0;
  long splitCpuTime=0;
  long inputDataSize=0;
  long inputPositions=0;
  for (  QueryInfo info : concat(ImmutableList.of(queryInfo),concat(queryInfo.getStages().values()))) {
    totalSplits+=info.getSplits();
    splitCpuTime+=info.getSplitCpuTime();
    inputDataSize+=info.getInputDataSize();
    inputPositions+=info.getInputPositionCount();
  }
  Duration cpuTime=new Duration(splitCpuTime,TimeUnit.MILLISECONDS);
  return String.format("FINISHED QueryId %s: Splits %,d: In %,d rows %s: Out %,d rows %s: CPU Time %s %s: Elapsed %s %s",queryInfo.getQueryId(),totalSplits,inputPositions,formatDataSize(inputDataSize),outputPositions,formatDataSize(outputDataSize),cpuTime.toString(TimeUnit.SECONDS),formatDataRate(inputDataSize,cpuTime),elapsedTime.toString(TimeUnit.SECONDS),formatDataRate(inputDataSize,elapsedTime));
}
