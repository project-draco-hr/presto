{
  Main.initializeLogging(false);
  ExecutorService executor=Executors.newCachedThreadPool();
  HttpQueryClient queryClient=null;
  try {
    long start=System.nanoTime();
    ApacheHttpClient httpClient=new ApacheHttpClient(new HttpClientConfig().setConnectTimeout(new Duration(1,TimeUnit.DAYS)).setReadTimeout(new Duration(10,TimeUnit.DAYS)));
    queryClient=new HttpQueryClient(query,server,httpClient,executor,jsonCodec(QueryInfo.class),jsonCodec(QueryTaskInfo.class));
    printInitialStatusUpdates(queryClient,start);
    Operator operator=queryClient.getResultsOperator();
    OutputProcessor processor=new OutputProcessor(operator,new TuplePrinters.DelimitedTuplePrinter());
    OutputStats stats=processor.process();
    System.err.println(toFinalInfo(queryClient.getQueryInfo(),start,stats.getRows(),stats.getBytes()));
  }
  finally {
    if (queryClient != null) {
      queryClient.destroy();
    }
    executor.shutdownNow();
  }
}
