{
  long value;
  if (parameterType == BIGINT) {
    value=values.getLong(position);
  }
 else   if (parameterType == DOUBLE) {
    value=doubleToSortableLong(values.getDouble(position));
  }
 else {
    throw new IllegalArgumentException("Expected parameter type to be BIGINT or DOUBLE");
  }
  digest.add(value,weight);
}
