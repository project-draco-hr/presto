{
  if (!node.getProbeSource().getOutputSymbols().containsAll(context.getLookupSymbols())) {
    return node;
  }
  PlanNode rewrittenProbeSource=planRewriter.rewrite(node.getProbeSource(),new Context(context.getLookupSymbols(),context.getSuccess()));
  PlanNode source=node;
  if (rewrittenProbeSource != node.getProbeSource()) {
    source=new IndexJoinNode(node.getId(),node.getType(),rewrittenProbeSource,node.getIndexSource(),node.getCriteria());
  }
  return source;
}
