{
  Preconditions.checkArgument(values.length == weights.length,"values.length must match weights.length");
  Block valuesBlock;
  Block weightsBlock;
  Block percentilesBlock;
  if (values.length == 0) {
    valuesBlock=new UncompressedBlock(0,SINGLE_LONG,EMPTY_SLICE);
    weightsBlock=new UncompressedBlock(0,SINGLE_LONG,EMPTY_SLICE);
    percentilesBlock=new UncompressedBlock(0,SINGLE_DOUBLE,EMPTY_SLICE);
  }
 else {
    valuesBlock=createLongsBlock(values);
    weightsBlock=createLongsBlock(weights);
    percentilesBlock=new RunLengthEncodedBlock(createTuple(percentile),values.length);
  }
  return new Page(valuesBlock,weightsBlock,percentilesBlock);
}
