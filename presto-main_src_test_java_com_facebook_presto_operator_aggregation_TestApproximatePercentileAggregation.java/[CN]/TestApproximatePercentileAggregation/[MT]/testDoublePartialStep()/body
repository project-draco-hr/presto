{
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_AGGREGATION,1.0,null,createPage(new Double[]{null},0.5),createPage(new Double[]{null},0.5));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_AGGREGATION,1.0,1.0,createPage(new Double[]{null},0.5),createPage(new Double[]{1.0},0.5));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_AGGREGATION,1.0,2.0,createPage(new Double[]{null},0.5),createPage(new Double[]{1.0,2.0,3.0},0.5));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_AGGREGATION,1.0,2.0,createPage(new Double[]{1.0},0.5),createPage(new Double[]{2.0,3.0},0.5));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_AGGREGATION,1.0,3.0,createPage(new Double[]{1.0,null,2.0,2.0,null,2.0,2.0,null},0.5),createPage(new Double[]{2.0,2.0,null,3.0,3.0,null,3.0,null,3.0,4.0,5.0,6.0,7.0},0.5));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_WEIGHTED_AGGREGATION,1.0,null,createPage(new Double[]{null},new Long[]{1L},0.5),createPage(new Double[]{null},new Long[]{1L},0.5));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_WEIGHTED_AGGREGATION,1.0,1.0,createPage(new Double[]{null},new Long[]{1L},0.5),createPage(new Double[]{1.0},new Long[]{1L},0.5));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_WEIGHTED_AGGREGATION,1.0,2.0,createPage(new Double[]{null},new Long[]{1L},0.5),createPage(new Double[]{1.0,2.0,3.0},new Long[]{1L,1L,1L},0.5));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_WEIGHTED_AGGREGATION,1.0,2.0,createPage(new Double[]{1.0},new Long[]{1L},0.5),createPage(new Double[]{2.0,3.0},new Long[]{1L,1L},0.5));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_WEIGHTED_AGGREGATION,1.0,3.0,createPage(new Double[]{1.0,null,2.0,null,2.0,null},new Long[]{1L,1L,2L,1L,2L,1L},0.5),createPage(new Double[]{2.0,null,3.0,null,3.0,null,3.0,4.0,5.0,6.0,7.0},new Long[]{2L,1L,2L,1L,1L,1L,1L,1L,1L,1L,1L},0.5));
}
