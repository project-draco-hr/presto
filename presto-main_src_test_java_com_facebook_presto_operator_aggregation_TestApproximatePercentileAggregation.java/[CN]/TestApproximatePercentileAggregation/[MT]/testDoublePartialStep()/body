{
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_AGGREGATION,1.0,null,createDoublesBlock(null,null),createRLEBlock(0.5,2));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_AGGREGATION,1.0,1.0,createDoublesBlock(null,1.0),createRLEBlock(0.5,2));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_AGGREGATION,1.0,2.0,createDoublesBlock(null,1.0,2.0,3.0),createRLEBlock(0.5,4));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_AGGREGATION,1.0,2.0,createDoublesBlock(1.0,2.0,3.0),createRLEBlock(0.5,3));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_AGGREGATION,1.0,3.0,createDoublesBlock(1.0,null,2.0,2.0,null,2.0,2.0,null,2.0,2.0,null,3.0,3.0,null,3.0,null,3.0,4.0,5.0,6.0,7.0),createRLEBlock(0.5,21));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_WEIGHTED_AGGREGATION,1.0,null,createDoublesBlock(null,null),createLongsBlock(1L,1L),createRLEBlock(0.5,2));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_WEIGHTED_AGGREGATION,1.0,1.0,createDoublesBlock(null,1.0),createLongsBlock(1L,1L),createRLEBlock(0.5,2));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_WEIGHTED_AGGREGATION,1.0,2.0,createDoublesBlock(null,1.0,2.0,3.0),createLongsBlock(1L,1L,1L,1L),createRLEBlock(0.5,4));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_WEIGHTED_AGGREGATION,1.0,2.0,createDoublesBlock(1.0,2.0,3.0),createLongsBlock(1L,1L,1L),createRLEBlock(0.5,3));
  assertAggregation(DOUBLE_APPROXIMATE_PERCENTILE_WEIGHTED_AGGREGATION,1.0,3.0,createDoublesBlock(1.0,null,2.0,null,2.0,null,2.0,null,3.0,null,3.0,null,3.0,4.0,5.0,6.0,7.0),createLongsBlock(1L,1L,2L,1L,2L,1L,2L,1L,2L,1L,1L,1L,1L,1L,1L,1L,1L),createRLEBlock(0.5,17));
}
