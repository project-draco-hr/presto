{
  assertSingleStep(DoubleApproximatePercentileAggregation.INSTANCE,createPage(new Double[]{},0.5),null);
  assertSingleStep(DoubleApproximatePercentileAggregation.INSTANCE,createPage(new Double[]{1.0},0.5),1.0);
  assertSingleStep(DoubleApproximatePercentileAggregation.INSTANCE,createPage(new Double[]{1.0,2.0,2.0,2.0,2.0,2.0,2.0,3.0,3.0,3.0,3.0,4.0,5.0,6.0,7.0},0.5),3.0);
  assertSingleStep(DoubleApproximatePercentileAggregation.INSTANCE,createPage(new Double[]{null,null,null},0.5),null);
  assertSingleStep(DoubleApproximatePercentileAggregation.INSTANCE,createPage(new Double[]{1.0,null,2.0,2.0,null,2.0,2.0,null,2.0,2.0,3.0,3.0,3.0,3.0,4.0,5.0,6.0,7.0},0.5),3.0);
  assertSingleStep(DoubleApproximatePercentileAggregation.INSTANCE,createPage(new Double[]{-7.0,-6.0,-5.0,-4.0,-3.0,-2.0,-1.0,0.0,1.0,2.0,3.0},0.5),-2.0);
  assertSingleStep(DoubleApproximatePercentileWeightedAggregation.INSTANCE,createPage(new Double[]{},new Long[]{},0.5),null);
  assertSingleStep(DoubleApproximatePercentileWeightedAggregation.INSTANCE,createPage(new Double[]{1.0},new Long[]{1L},0.5),1.0);
  assertSingleStep(DoubleApproximatePercentileWeightedAggregation.INSTANCE,createPage(new Double[]{1.0,2.0,3.0,4.0,5.0,6.0,7.0},new Long[]{1L,6L,4L,1L,1L,1L,1L},0.5),3.0);
  assertSingleStep(DoubleApproximatePercentileWeightedAggregation.INSTANCE,createPage(new Double[]{null,null,null},new Long[]{1L,1L,1L},0.5),null);
  assertSingleStep(DoubleApproximatePercentileWeightedAggregation.INSTANCE,createPage(new Double[]{1.0,null,2.0,null,2.0,null,2.0,3.0,4.0,5.0,6.0,7.0},new Long[]{1L,null,2L,null,2L,null,2L,4L,1L,1L,1L,1L},0.5),3.0);
  assertSingleStep(DoubleApproximatePercentileWeightedAggregation.INSTANCE,createPage(new Double[]{-7.0,-6.0,-5.0,-4.0,-3.0,-2.0,-1.0,0.0,1.0,2.0,3.0},new Long[]{1L,1L,1L,1L,1L,1L,1L,1L,1L,1L,1L},0.5),-2.0);
}
