{
  assertFinal(LongApproximatePercentileAggregation.INSTANCE,new Page[]{createPage(new Long[]{null},0.5),createPage(new Long[]{null},0.5)},null);
  assertFinal(LongApproximatePercentileAggregation.INSTANCE,new Page[]{createPage(new Long[]{null},0.5),createPage(new Long[]{1L},0.5)},1L);
  assertFinal(LongApproximatePercentileAggregation.INSTANCE,new Page[]{createPage(new Long[]{null},0.5),createPage(new Long[]{1L,2L,3L},0.5)},2L);
  assertFinal(LongApproximatePercentileAggregation.INSTANCE,new Page[]{createPage(new Long[]{1L},0.5),createPage(new Long[]{2L,3L},0.5)},2L);
  assertFinal(LongApproximatePercentileAggregation.INSTANCE,new Page[]{createPage(new Long[]{1L,null,2L,2L,null,2L,2L,null},0.5),createPage(new Long[]{2L,2L,null,3L,3L,null,3L,null,3L,4L,5L,6L,7L},0.5)},3L);
}
