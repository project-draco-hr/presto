{
  assertAggregation(LongApproximatePercentileAggregation.INSTANCE,null,createPage(new Long[]{null},0.5),createPage(new Long[]{null},0.5));
  assertAggregation(LongApproximatePercentileAggregation.INSTANCE,1L,createPage(new Long[]{null},0.5),createPage(new Long[]{1L},0.5));
  assertAggregation(LongApproximatePercentileAggregation.INSTANCE,2L,createPage(new Long[]{null},0.5),createPage(new Long[]{1L,2L,3L},0.5));
  assertAggregation(LongApproximatePercentileAggregation.INSTANCE,2L,createPage(new Long[]{1L},0.5),createPage(new Long[]{2L,3L},0.5));
  assertAggregation(LongApproximatePercentileAggregation.INSTANCE,3L,createPage(new Long[]{1L,null,2L,2L,null,2L,2L,null},0.5),createPage(new Long[]{2L,2L,null,3L,3L,null,3L,null,3L,4L,5L,6L,7L},0.5));
  assertAggregation(LongApproximatePercentileWeightedAggregation.INSTANCE,null,createPage(new Long[]{null},new Long[]{1L},0.5),createPage(new Long[]{null},new Long[]{1L},0.5));
  assertAggregation(LongApproximatePercentileWeightedAggregation.INSTANCE,1L,createPage(new Long[]{null},new Long[]{1L},0.5),createPage(new Long[]{1L},new Long[]{1L},0.5));
  assertAggregation(LongApproximatePercentileWeightedAggregation.INSTANCE,2L,createPage(new Long[]{null},new Long[]{1L},0.5),createPage(new Long[]{1L,2L,3L},new Long[]{1L,1L,1L},0.5));
  assertAggregation(LongApproximatePercentileWeightedAggregation.INSTANCE,2L,createPage(new Long[]{1L},new Long[]{1L},0.5),createPage(new Long[]{2L,3L},new Long[]{1L,1L},0.5));
  assertAggregation(LongApproximatePercentileWeightedAggregation.INSTANCE,3L,createPage(new Long[]{1L,null,2L,null,2L,null},new Long[]{1L,1L,2L,1L,2L,1L},0.5),createPage(new Long[]{2L,null,3L,null,3L,null,3L,4L,5L,6L,7L},new Long[]{2L,1L,2L,1L,1L,1L,1L,1L,1L,1L,1L},0.5));
}
