{
  assertSingleStep(LongApproximatePercentileAggregation.INSTANCE,createPage(new Long[]{},0.5),null);
  assertSingleStep(LongApproximatePercentileAggregation.INSTANCE,createPage(new Long[]{1L},0.5),1L);
  assertSingleStep(LongApproximatePercentileAggregation.INSTANCE,createPage(new Long[]{1L,2L,2L,2L,2L,2L,2L,3L,3L,3L,3L,4L,5L,6L,7L},0.5),3L);
  assertSingleStep(LongApproximatePercentileAggregation.INSTANCE,createPage(new Long[]{null,null,null},0.5),null);
  assertSingleStep(LongApproximatePercentileAggregation.INSTANCE,createPage(new Long[]{1L,null,2L,2L,null,2L,2L,null,2L,2L,3L,3L,3L,3L,4L,5L,6L,7L},0.5),3L);
  assertSingleStep(LongApproximatePercentileAggregation.INSTANCE,createPage(new Long[]{-7L,-6L,-5L,-4L,-3L,-2L,-1L,0L,1L,2L,3L},0.5),-2L);
  assertSingleStep(LongApproximatePercentileWeightedAggregation.INSTANCE,createPage(new Long[]{},new Long[]{},0.5),null);
  assertSingleStep(LongApproximatePercentileWeightedAggregation.INSTANCE,createPage(new Long[]{1L},new Long[]{1L},0.5),1L);
  assertSingleStep(LongApproximatePercentileWeightedAggregation.INSTANCE,createPage(new Long[]{1L,2L,3L,4L,5L,6L,7L},new Long[]{1L,6L,4L,1L,1L,1L,1L},0.5),3L);
  assertSingleStep(LongApproximatePercentileWeightedAggregation.INSTANCE,createPage(new Long[]{null,null,null},new Long[]{1L,1L,1L},0.5),null);
  assertSingleStep(LongApproximatePercentileWeightedAggregation.INSTANCE,createPage(new Long[]{1L,null,2L,null,2L,null,2L,3L,4L,5L,6L,7L},new Long[]{1L,null,2L,null,2L,null,2L,4L,1L,1L,1L,1L},0.5),3L);
  assertSingleStep(LongApproximatePercentileWeightedAggregation.INSTANCE,createPage(new Long[]{-7L,-6L,-5L,-4L,-3L,-2L,-1L,0L,1L,2L,3L},new Long[]{1L,1L,1L,1L,1L,1L,1L,1L,1L,1L,1L},0.5),-2L);
}
