{
  checkNotNull(source,"source is null");
  if (source instanceof ExchangePlanFragmentSource) {
    final ExchangePlanFragmentSource exchangeSource=(ExchangePlanFragmentSource)source;
    return new ExchangeOperator(httpClient,exchangeSource.getTupleInfos(),exchangeMaxBufferedPages,exchangeExpectedPagesPerRequest,exchangeConcurrentRequestMultiplier,transform(exchangeSource.getSources().values(),new Function<URI,URI>(){
      @Override public URI apply(      URI location){
        return uriBuilderFrom(location).appendPath("results").appendPath(exchangeSource.getOutputId()).build();
      }
    }
));
  }
 else   if (source instanceof TableScanPlanFragmentSource) {
    TableScanPlanFragmentSource tableScanSource=(TableScanPlanFragmentSource)source;
    return dataStreamProvider.createDataStream(tableScanSource.getSplit(),columns);
  }
  throw new IllegalArgumentException("Unsupported source type " + source.getClass().getName());
}
