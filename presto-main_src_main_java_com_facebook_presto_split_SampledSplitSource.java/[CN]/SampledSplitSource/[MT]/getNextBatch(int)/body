{
  List<Split> nextBatch=splitSource.getNextBatch(maxSize);
  Iterable<Split> sampleIterable=Iterables.filter(nextBatch,new Predicate<Split>(){
    @Override public boolean apply(    @Nullable Split input){
      return ThreadLocalRandom.current().nextDouble() < sampleRatio;
    }
  }
);
  return ImmutableList.copyOf(sampleIterable);
}
