{
  Analyzer analyzer=new Analyzer(session,metadata,sqlParser,Optional.of(this),experimentalSyntaxEnabled);
  Analysis analysis=analyzer.analyze(statement);
  PlanNodeIdAllocator idAllocator=new PlanNodeIdAllocator();
  LogicalPlanner logicalPlanner=new LogicalPlanner(session,planOptimizers,idAllocator,metadata);
  Plan plan=logicalPlanner.plan(analysis);
  return new DistributedLogicalPlanner(session,metadata,idAllocator).createSubPlans(plan,false,distributedIndexJoinsEnabled,distributedJoinsEnabled);
}
