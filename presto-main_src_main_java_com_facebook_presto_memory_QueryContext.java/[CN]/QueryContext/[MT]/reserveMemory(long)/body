{
  checkArgument(bytes >= 0,"bytes is negative");
  if (reserved + bytes > maxMemory) {
    throw exceededLocalLimit(new DataSize(maxMemory,DataSize.Unit.BYTE).convertToMostSuccinctDataSize());
  }
  ListenableFuture<?> future=memoryPool.reserve(queryId,bytes);
  reserved+=bytes;
  return future;
}
