{
  requireNonNull(pages,"pages is null");
  requireNonNull(operatorContext,"operatorContext is null");
  this.pages=ImmutableList.copyOf(pages);
  this.taskContext=operatorContext.getDriverContext().getPipelineContext().getTaskContext();
  this.estimatedSize=requireNonNull(estimatedSize,"estimatedSize is null");
  long transferredBytes=operatorContext.transferMemoryToTaskContext();
  if (estimatedSize.toBytes() > transferredBytes) {
    taskContext.reserveMemory(estimatedSize.toBytes() - transferredBytes);
  }
 else {
    taskContext.freeMemory(transferredBytes - estimatedSize.toBytes());
  }
}
