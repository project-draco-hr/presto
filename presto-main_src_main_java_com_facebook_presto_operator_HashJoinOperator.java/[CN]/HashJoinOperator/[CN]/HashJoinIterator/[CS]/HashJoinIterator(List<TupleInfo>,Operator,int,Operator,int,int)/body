{
  this.tupleInfos=tupleInfos;
  this.buildJoinChannel=buildJoinChannel;
  probeIterator=probeSource.iterator();
  this.probeJoinChannel=probeJoinChannel;
  buildIndex=new PagesIndex(buildSource.getChannelCount(),expectedPositions,tupleInfos);
  for (  Page page : buildSource) {
    buildIndex.indexPage(page);
  }
  BlocksIndex joinChannelIndex=buildIndex.getIndex(buildJoinChannel);
  hashStrategy=new SliceHashStrategy(joinChannelIndex.getTupleInfo(),joinChannelIndex.getSlices().elements());
  joinChannelHash=new Long2IntOpenCustomHashMap(expectedPositions,hashStrategy);
  joinChannelHash.defaultReturnValue(-1);
  positionLinks=new IntArrayList(new int[joinChannelIndex.getOffsets().size()]);
  Arrays.fill(positionLinks.elements(),-1);
  for (int position=0; position < joinChannelIndex.getOffsets().size(); position++) {
    long sliceAddress=joinChannelIndex.getOffsets().elements()[position];
    int oldPosition=joinChannelHash.put(sliceAddress,position);
    if (oldPosition >= 0) {
      positionLinks.set(position,oldPosition);
    }
  }
}
