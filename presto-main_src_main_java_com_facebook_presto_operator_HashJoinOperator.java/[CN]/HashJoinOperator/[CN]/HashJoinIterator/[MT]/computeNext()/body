{
  if (hash == null) {
    hash=sourceHashProvider.get();
  }
  PageBuilder pageBuilder=new PageBuilder(getTupleInfos());
  while (joinCurrentPosition(pageBuilder)) {
    if (cursors[0] == null || !advanceNextPosition()) {
      if (!probeIterator.hasNext()) {
        break;
      }
      Page page=probeIterator.next();
      for (int i=0; i < page.getChannelCount(); i++) {
        cursors[i]=page.getBlock(i).cursor();
        cursors[i].advanceNextPosition();
      }
      UncompressedBlock probeJoinBlock=(UncompressedBlock)page.getBlock(probeJoinChannel);
      hash.setProbeSlice(probeJoinBlock.getSlice());
    }
    joinPosition=hash.getJoinPosition(cursors[probeJoinChannel]);
  }
  if (pageBuilder.isEmpty()) {
    return endOfData();
  }
  Page page=pageBuilder.build();
  return page;
}
