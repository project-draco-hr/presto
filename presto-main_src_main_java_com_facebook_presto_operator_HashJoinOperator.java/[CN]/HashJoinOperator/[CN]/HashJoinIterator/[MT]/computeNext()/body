{
  if (!probeIterator.hasNext()) {
    return endOfData();
  }
  BlockBuilder[] outputs=new BlockBuilder[tupleInfos.size()];
  for (int i=0; i < outputs.length; i++) {
    outputs[i]=new BlockBuilder(tupleInfos.get(i));
  }
  while (!isFull(outputs) && probeIterator.hasNext()) {
    Page page=probeIterator.next();
    join(page,outputs);
  }
  if (outputs[0].isEmpty()) {
    return endOfData();
  }
  Block[] blocks=new Block[outputs.length];
  for (int i=0; i < blocks.length; i++) {
    blocks[i]=outputs[i].build();
  }
  Page page=new Page(blocks);
  return page;
}
