{
  if (node.getWindow().isPresent()) {
    for (    Expression expression : node.getWindow().get().getPartitionBy()) {
      process(expression,context);
    }
    for (    SortItem sortItem : node.getWindow().get().getOrderBy()) {
      process(sortItem.getSortKey(),context);
    }
  }
  ImmutableList.Builder<Type> argumentTypes=ImmutableList.builder();
  for (  Expression expression : node.getArguments()) {
    argumentTypes.add(process(expression,context));
  }
  FunctionInfo function=metadata.resolveFunction(node.getName(),argumentTypes.build(),context.isApproximate());
  for (int i=0; i < node.getArguments().size(); i++) {
    Expression expression=node.getArguments().get(i);
    Type type=function.getArgumentTypes().get(i);
    coerceType(context,expression,type,String.format("Function %s argument %d",function.getSignature(),i));
  }
  resolvedFunctions.put(node,function);
  expressionTypes.put(node,function.getReturnType());
  return function.getReturnType();
}
