{
  List<Field> fields=IterableTransformer.on(DependencyExtractor.extractUnique(expressions)).transform(new Function<Symbol,Field>(){
    @Override public Field apply(    Symbol symbol){
      Type type=types.get(symbol);
      checkArgument(type != null,"No type for symbol %s",symbol);
      return Field.newUnqualified(symbol.getName(),type);
    }
  }
).list();
  return analyzeExpressions(session,metadata,sqlParser,new TupleDescriptor(fields),expressions);
}
