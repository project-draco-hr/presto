{
  Field[] fields=new Field[types.size()];
  for (  Entry<Input,Type> entry : types.entrySet()) {
    fields[entry.getKey().getChannel()]=Field.newUnqualified(Optional.<String>absent(),entry.getValue());
  }
  TupleDescriptor tupleDescriptor=new TupleDescriptor(fields);
  ExpressionAnalyzer expressionAnalyzer=new ExpressionAnalyzer(new Analysis(),session,metadata,false);
  for (  Expression expression : expressions) {
    expressionAnalyzer.analyze(expression,tupleDescriptor,new AnalysisContext());
  }
  return expressionAnalyzer.getSubExpressionTypes();
}
