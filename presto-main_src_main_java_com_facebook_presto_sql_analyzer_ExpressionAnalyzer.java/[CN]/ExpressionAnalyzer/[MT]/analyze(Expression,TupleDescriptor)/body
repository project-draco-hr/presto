{
  Type type=new Visitor(metadata,symbols,sourceDescriptor).process(expression,null);
  Expression rewritten=TreeRewriter.rewriteWith(new NameToSymbolRewriter(sourceDescriptor),expression);
  return new AnalyzedExpression(type,rewritten);
}
