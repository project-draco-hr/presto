{
  Preconditions.checkNotNull(sources,"sources is null");
  long newMaxAcknowledgedSplit=maxAcknowledgedSplit;
  for (  TaskSource source : sources) {
    for (    ScheduledSplit scheduledSplit : source.getSplits()) {
      if (scheduledSplit.getSequenceId() > maxAcknowledgedSplit) {
        addSplits(scheduledSplit.getSplits());
        newMaxAcknowledgedSplit=max(scheduledSplit.getSequenceId(),newMaxAcknowledgedSplit);
      }
    }
    if (source.isNoMoreSplits()) {
      noMoreSplits(source.getPlanNodeIds());
    }
  }
  maxAcknowledgedSplit=newMaxAcknowledgedSplit;
}
