{
  getTaskInfo().getStats().addSplits(1);
  if (fragment.isPartitioned() && fragment.getPartitionedSource().equals(sourceId)) {
    scheduleSplitWorker(sourceId,split);
  }
 else {
    unpartitionedSources.put(sourceId,split);
    getTaskInfo().getStats().splitStarted();
    for (    WeakReference<SplitWorker> workerReference : splitWorkers) {
      SplitWorker worker=workerReference.get();
      Preconditions.checkState(worker != null,"SplitWorker has been GCed");
      worker.addSplit(sourceId,split);
    }
  }
}
