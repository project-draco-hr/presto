{
  if (sourceId.equals(partitionedSourceId)) {
    enqueueDriver(new DriverSplitRunner(partitionedPipelineContext.addDriverContext(),new Function<DriverContext,Driver>(){
      @Override public Driver apply(      DriverContext driverContext){
        return createDriver(partitionedDriverFactory,driverContext,split);
      }
    }
));
  }
 else {
    if (!unpartitionedSources.put(sourceId,split)) {
      return;
    }
    for (    WeakReference<Driver> driverReference : drivers) {
      Driver driver=driverReference.get();
      if (driver != null) {
        driver.addSplit(sourceId,split);
      }
    }
  }
}
