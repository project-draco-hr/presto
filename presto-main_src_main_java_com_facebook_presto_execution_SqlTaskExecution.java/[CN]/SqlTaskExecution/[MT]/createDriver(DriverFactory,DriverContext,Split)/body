{
  Driver driver=driverFactory.createDriver(driverContext);
  if (partitionedSplit != null) {
    driver.addSplit(partitionedSourceId,partitionedSplit);
  }
  for (  Entry<PlanNodeId,Split> entry : unpartitionedSources.entries()) {
    driver.addSplit(entry.getKey(),entry.getValue());
  }
  for (  PlanNodeId completedUnpartitionedSource : completedUnpartitionedSources) {
    driver.noMoreSplits(completedUnpartitionedSource);
  }
  drivers.add(new WeakReference<>(driver));
  return driver;
}
