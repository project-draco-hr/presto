{
  if (taskStateMachine.getState().isDone()) {
    return;
  }
  if (partitionedDriverFactory != null && !partitionedDriverFactory.isNoMoreSplits()) {
    return;
  }
  if (remainingDrivers.get() != 0) {
    return;
  }
  sharedBuffer.finish();
  if (!sharedBuffer.isFinished()) {
    return;
  }
  taskStateMachine.finished();
}
