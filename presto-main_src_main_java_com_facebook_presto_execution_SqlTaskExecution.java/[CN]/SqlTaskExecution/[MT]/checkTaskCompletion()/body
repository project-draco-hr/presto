{
  if (fragment.isPartitioned() && !taskOutput.getNoMoreSplits().containsAll(fragment.getPartitionedSources())) {
    return;
  }
  if (pendingWorkerCount.get() != 0) {
    return;
  }
  taskOutput.finish();
}
