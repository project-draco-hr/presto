{
  ImmutableMap.Builder<PlanNodeId,PlanFragmentSource> sources=ImmutableMap.builder();
  sources.putAll(fixedSources);
  if (sourceId != null) {
    Preconditions.checkNotNull(split,"split is null");
    Preconditions.checkArgument(sourceId.equals(fragment.getPartitionedSource()),"Expected sourceId to be %s but was %s",fragment.getPartitionedSource(),sourceId);
    sources.put(sourceId,new TableScanPlanFragmentSource(split));
  }
  SplitWorker worker=new SplitWorker(session,taskOutput,fragment,sources.build(),getSourceHashProviderFactory(),sourceProvider,metadata,maxOperatorMemoryUsage);
  List<FutureTask<Void>> results=shardExecutor.processBatch(ImmutableList.of(worker));
  splitWorkers.addAll(results);
  getTaskInfo().getStats().addSplits(1);
}
