{
  if (sourceId != null) {
    Preconditions.checkNotNull(split,"split is null");
    Preconditions.checkArgument(sourceId.equals(fragment.getPartitionedSource()),"Expected sourceId to be %s but was %s",fragment.getPartitionedSource(),sourceId);
  }
  SplitWorker worker=new SplitWorker(session,taskOutput,fragment,split,exchangeSources,getSourceHashProviderFactory(),sourceProvider,metadata,maxOperatorMemoryUsage);
  List<FutureTask<Void>> results=shardExecutor.processBatch(ImmutableList.of(worker));
  splitWorkers.addAll(results);
  getTaskInfo().getStats().addSplits(1);
}
