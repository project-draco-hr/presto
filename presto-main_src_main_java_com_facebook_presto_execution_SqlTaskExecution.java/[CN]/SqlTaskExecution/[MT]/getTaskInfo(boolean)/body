{
  try (SetThreadName ignored=new SetThreadName("Task-%s",taskId)){
    checkTaskCompletion();
    TaskState state=taskStateMachine.getState();
    List<ExecutionFailureInfo> failures=ImmutableList.of();
    if (state == TaskState.FAILED) {
      failures=toFailures(taskStateMachine.getFailureCauses());
    }
    return new TaskInfo(taskStateMachine.getTaskId(),nextTaskInfoVersion.getAndIncrement(),state,location,lastHeartbeat.get(),sharedBuffer.getInfo(),getNoMoreSplits(),taskContext.getTaskStats(),failures);
  }
 }
