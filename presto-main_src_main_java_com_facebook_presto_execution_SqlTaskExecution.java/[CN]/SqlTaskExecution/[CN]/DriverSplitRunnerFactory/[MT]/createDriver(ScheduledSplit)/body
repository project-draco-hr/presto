{
  Driver driver=driverFactory.createDriver(pipelineContext.addDriverContext());
  drivers.add(new WeakReference<>(driver));
  if (partitionedSplit != null) {
    driver.updateSource(new TaskSource(partitionedSourceId,ImmutableSet.of(partitionedSplit),true));
  }
  for (  TaskSource source : unpartitionedSources.values()) {
    driver.updateSource(source);
  }
  pendingCreation.decrementAndGet();
  closeDriverFactoryIfFullyCreated();
  return driver;
}
