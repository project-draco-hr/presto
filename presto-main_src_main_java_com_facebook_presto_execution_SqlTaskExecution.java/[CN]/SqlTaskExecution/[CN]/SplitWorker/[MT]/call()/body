{
  if (!started.compareAndSet(false,true)) {
    return null;
  }
  if (taskOutput.getState().isDone()) {
    return null;
  }
  operatorStats.start();
  try (PageIterator pages=operator.iterator(operatorStats)){
    while (pages.hasNext()) {
      Page page=pages.next();
      taskOutput.getStats().addOutputDataSize(page.getDataSize());
      taskOutput.getStats().addOutputPositions(page.getPositionCount());
      if (!taskOutput.addPage(page)) {
        break;
      }
    }
    return null;
  }
 catch (  Throwable e) {
    taskOutput.queryFailed(e);
    throw e;
  }
 finally {
    operatorStats.finish();
  }
}
