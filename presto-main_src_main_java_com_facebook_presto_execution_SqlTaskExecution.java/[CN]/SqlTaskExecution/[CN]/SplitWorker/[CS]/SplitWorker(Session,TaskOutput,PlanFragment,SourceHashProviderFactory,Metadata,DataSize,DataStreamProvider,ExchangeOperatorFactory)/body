{
  this.taskOutput=taskOutput;
  partitionedSource=fragment.getPartitionedSource();
  operatorStats=new OperatorStats(taskOutput);
  LocalExecutionPlanner planner=new LocalExecutionPlanner(session,metadata,fragment.getSymbols(),operatorStats,sourceHashProviderFactory,maxOperatorMemoryUsage,dataStreamProvider,exchangeOperatorFactory);
  LocalExecutionPlan localExecutionPlan=planner.plan(fragment.getRoot());
  operator=localExecutionPlan.getRootOperator();
  sourceOperators=localExecutionPlan.getSourceOperators();
}
