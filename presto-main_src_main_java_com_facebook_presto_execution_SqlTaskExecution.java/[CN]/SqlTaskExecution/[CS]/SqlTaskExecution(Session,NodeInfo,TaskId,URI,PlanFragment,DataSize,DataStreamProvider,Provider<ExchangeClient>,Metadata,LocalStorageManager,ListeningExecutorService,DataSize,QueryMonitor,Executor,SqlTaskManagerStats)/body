{
  Preconditions.checkNotNull(session,"session is null");
  Preconditions.checkNotNull(nodeInfo,"nodeInfo is null");
  Preconditions.checkNotNull(taskId,"taskId is null");
  Preconditions.checkNotNull(fragment,"fragment is null");
  Preconditions.checkArgument(maxBufferSize.toBytes() > 0,"maxBufferSize must be at least 1");
  Preconditions.checkNotNull(metadata,"metadata is null");
  Preconditions.checkNotNull(storageManager,"storageManager is null");
  Preconditions.checkNotNull(shardExecutor,"shardExecutor is null");
  Preconditions.checkNotNull(maxOperatorMemoryUsage,"maxOperatorMemoryUsage is null");
  Preconditions.checkNotNull(queryMonitor,"queryMonitor is null");
  Preconditions.checkNotNull(globalStats,"globalStats is null");
  try (SetThreadName setThreadName=new SetThreadName("Task-%s",taskId)){
    this.session=session;
    this.nodeInfo=nodeInfo;
    this.taskId=taskId;
    this.fragment=fragment;
    this.dataStreamProvider=dataStreamProvider;
    this.exchangeClientProvider=exchangeClientProvider;
    this.shardExecutor=shardExecutor;
    this.metadata=metadata;
    this.storageManager=storageManager;
    this.maxOperatorMemoryUsage=maxOperatorMemoryUsage;
    this.queryMonitor=queryMonitor;
    this.taskOutput=new TaskOutput(taskId,location,maxBufferSize,notificationExecutor,globalStats);
  }
 }
