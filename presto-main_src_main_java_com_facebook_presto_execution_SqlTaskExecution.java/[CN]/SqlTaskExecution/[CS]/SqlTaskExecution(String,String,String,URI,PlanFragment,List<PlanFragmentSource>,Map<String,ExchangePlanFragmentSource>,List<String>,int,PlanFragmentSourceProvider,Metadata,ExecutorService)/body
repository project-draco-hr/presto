{
  Preconditions.checkNotNull(queryId,"queryId is null");
  Preconditions.checkNotNull(stageId,"stageId is null");
  Preconditions.checkNotNull(taskId,"taskId is null");
  Preconditions.checkNotNull(fragment,"fragment is null");
  Preconditions.checkNotNull(splits,"splits is null");
  Preconditions.checkNotNull(exchangeSources,"exchangeSources is null");
  Preconditions.checkNotNull(outputIds,"outputIds is null");
  Preconditions.checkArgument(!outputIds.isEmpty(),"outputIds is empty");
  Preconditions.checkArgument(pageBufferMax > 0,"pageBufferMax must be at least 1");
  Preconditions.checkNotNull(sourceProvider,"sourceProvider is null");
  Preconditions.checkNotNull(metadata,"metadata is null");
  Preconditions.checkNotNull(shardExecutor,"shardExecutor is null");
  this.taskId=taskId;
  this.fragment=fragment;
  this.splits=splits;
  this.exchangeSources=exchangeSources;
  this.sourceProvider=sourceProvider;
  this.shardExecutor=shardExecutor;
  this.metadata=metadata;
  List<TupleInfo> tupleInfos=ImmutableList.copyOf(IterableTransformer.on(fragment.getRoot().getOutputSymbols()).transform(Functions.forMap(fragment.getSymbols())).transform(com.facebook.presto.sql.analyzer.Type.toRaw()).transform(new Function<Type,TupleInfo>(){
    @Override public TupleInfo apply(    Type input){
      return new TupleInfo(input);
    }
  }
).list());
  this.taskOutput=new TaskOutput(queryId,stageId,taskId,location,outputIds,tupleInfos,pageBufferMax,splits.size());
}
