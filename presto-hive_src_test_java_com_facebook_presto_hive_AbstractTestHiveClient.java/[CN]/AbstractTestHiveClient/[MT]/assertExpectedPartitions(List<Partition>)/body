{
  assertEquals(partitions,this.partitions);
  ImmutableMap<String,Partition> actualPartitions=Maps.uniqueIndex(partitions,partitionIdGetter());
  for (  Partition expectedPartition : this.partitions) {
    Partition actualPartition=actualPartitions.get(expectedPartition.getPartitionId());
    assertNotNull(actualPartition,"partition " + expectedPartition.getPartitionId());
    assertEquals(actualPartition.getPartitionId(),expectedPartition.getPartitionId());
    assertEquals(actualPartition.getKeys(),expectedPartition.getKeys());
  }
}
