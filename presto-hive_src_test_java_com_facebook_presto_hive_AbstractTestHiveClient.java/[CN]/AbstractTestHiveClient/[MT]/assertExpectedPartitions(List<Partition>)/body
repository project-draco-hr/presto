{
  assertEquals(partitions,this.partitions);
  ImmutableMap<String,Partition> actualPartitions=uniqueIndex(partitions,partitionIdGetter());
  for (  HivePartition expectedPartition : this.partitions) {
    HivePartition actualPartition=(HivePartition)actualPartitions.get(expectedPartition.getPartitionId());
    assertNotNull(actualPartition,"partition " + expectedPartition.getPartitionId());
    assertEquals(actualPartition.getPartitionId(),expectedPartition.getPartitionId());
    assertEquals(actualPartition.getKeys(),expectedPartition.getKeys());
    assertEquals(actualPartition.getTableName(),expectedPartition.getTableName());
    assertEquals(actualPartition.getBucket(),expectedPartition.getBucket());
  }
}
