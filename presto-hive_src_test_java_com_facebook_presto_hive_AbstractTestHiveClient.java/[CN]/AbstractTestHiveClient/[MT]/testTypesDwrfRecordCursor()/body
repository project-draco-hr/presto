{
  if (metadata.getTableHandle(SESSION,new SchemaTableName(database,"presto_test_types_dwrf")) == null) {
    return;
  }
  ConnectorTableHandle tableHandle=getTableHandle(new SchemaTableName(database,"presto_test_types_dwrf"));
  ConnectorTableMetadata tableMetadata=metadata.getTableMetadata(SESSION,tableHandle);
  HiveSplit hiveSplit=getHiveSplit(tableHandle);
  List<ColumnHandle> columnHandles=ImmutableList.copyOf(metadata.getColumnHandles(SESSION,tableHandle).values());
  ReaderWriterProfiler.setProfilerOptions(new Configuration());
  ConnectorPageSourceProvider pageSourceProvider=new HivePageSourceProvider(new HiveClientConfig().setTimeZone(timeZone.getID()),hdfsEnvironment,ImmutableSet.<HiveRecordCursorProvider>of(new DwrfRecordCursorProvider()),ImmutableSet.<HivePageSourceFactory>of(),TYPE_MANAGER);
  ConnectorPageSource pageSource=pageSourceProvider.createPageSource(SESSION,hiveSplit,columnHandles);
  assertGetRecords(DWRF,tableMetadata,hiveSplit,pageSource,columnHandles);
}
