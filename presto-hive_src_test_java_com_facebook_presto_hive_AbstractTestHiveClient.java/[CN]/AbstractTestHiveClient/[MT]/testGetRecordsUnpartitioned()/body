{
  ConnectorTableHandle tableHandle=getTableHandle(tableUnpartitioned);
  List<ConnectorColumnHandle> columnHandles=ImmutableList.copyOf(metadata.getColumnHandles(tableHandle).values());
  Map<String,Integer> columnIndex=indexColumns(columnHandles);
  ConnectorPartitionResult partitionResult=splitManager.getPartitions(tableHandle,TupleDomain.<ConnectorColumnHandle>all());
  List<ConnectorSplit> splits=getAllSplits(splitManager.getPartitionSplits(tableHandle,partitionResult.getPartitions()));
  assertEquals(splits.size(),1);
  for (  ConnectorSplit split : splits) {
    HiveSplit hiveSplit=(HiveSplit)split;
    assertEquals(hiveSplit.getPartitionKeys(),ImmutableList.of());
    long rowNumber=0;
    try (RecordCursor cursor=recordSetProvider.getRecordSet(split,columnHandles).cursor()){
      assertRecordCursorType(cursor,"textfile");
      assertEquals(cursor.getTotalBytes(),hiveSplit.getLength());
      while (cursor.advanceNextPosition()) {
        rowNumber++;
        if (rowNumber % 19 == 0) {
          assertTrue(cursor.isNull(columnIndex.get("t_string")));
        }
 else         if (rowNumber % 19 == 1) {
          assertEquals(cursor.getSlice(columnIndex.get("t_string")).toStringUtf8(),"");
        }
 else {
          assertEquals(cursor.getSlice(columnIndex.get("t_string")).toStringUtf8(),"unpartitioned");
        }
        assertEquals(cursor.getLong(columnIndex.get("t_tinyint")),1 + rowNumber);
      }
    }
     assertEquals(rowNumber,100);
  }
}
