{
  doCreateView(temporaryCreateView,true);
  doCreateView(temporaryCreateView,true);
  try {
    doCreateView(temporaryCreateView,false);
    fail("create existing should fail");
  }
 catch (  ViewAlreadyExistsException e) {
    assertEquals(e.getViewName(),temporaryCreateView);
  }
  ConnectorMetadata metadata=newMetadata();
  metadata.dropView(newSession(),temporaryCreateView);
  assertEquals(metadata.getViews(newSession(),temporaryCreateView.toSchemaTablePrefix()).size(),0);
  assertFalse(metadata.listViews(newSession(),temporaryCreateView.getSchemaName()).contains(temporaryCreateView));
  try {
    metadata.dropView(newSession(),temporaryCreateView);
    fail("drop non-existing should fail");
  }
 catch (  ViewNotFoundException e) {
    assertEquals(e.getViewName(),temporaryCreateView);
  }
  doCreateView(temporaryCreateView,false);
}
