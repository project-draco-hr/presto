{
  ConnectorTableHandle tableHandle=getTableHandle(new SchemaTableName(database,tableName));
  ConnectorTableMetadata tableMetadata=metadata.getTableMetadata(SESSION,tableHandle);
  HiveSplit hiveSplit=getHiveSplit(tableHandle);
  List<ColumnHandle> columnHandles=ImmutableList.copyOf(metadata.getColumnHandles(SESSION,tableHandle).values());
  ConnectorPageSource pageSource=pageSourceProvider.createPageSource(SESSION,hiveSplit,columnHandles);
  assertGetRecords(hiveStorageFormat,tableMetadata,hiveSplit,pageSource,columnHandles);
}
