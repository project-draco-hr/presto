{
  ConnectorSession session=newSession();
  ConnectorTransactionHandle transaction=newTransaction();
  ConnectorMetadata metadata=newMetadata();
  ConnectorTableHandle tableHandle=getTableHandle(metadata,new SchemaTableName(database,tableName));
  ConnectorTableMetadata tableMetadata=metadata.getTableMetadata(session,tableHandle);
  HiveSplit hiveSplit=getHiveSplit(tableHandle);
  List<ColumnHandle> columnHandles=ImmutableList.copyOf(metadata.getColumnHandles(session,tableHandle).values());
  ConnectorPageSource pageSource=pageSourceProvider.createPageSource(transaction,session,hiveSplit,columnHandles);
  assertGetRecords(hiveStorageFormat,tableMetadata,hiveSplit,pageSource,columnHandles);
}
