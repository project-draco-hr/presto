{
  for (int columnIndex=0; columnIndex < schema.size(); columnIndex++) {
    ColumnMetadata column=schema.get(columnIndex);
    if (!cursor.isNull(columnIndex)) {
      if (BOOLEAN.equals(column.getType())) {
        cursor.getBoolean(columnIndex);
      }
 else       if (BIGINT.equals(column.getType())) {
        cursor.getLong(columnIndex);
      }
 else       if (DOUBLE.equals(column.getType())) {
        cursor.getDouble(columnIndex);
      }
 else       if (VARCHAR.equals(column.getType()) || VARBINARY.equals(column.getType())) {
        try {
          cursor.getSlice(columnIndex);
        }
 catch (        RuntimeException e) {
          throw new RuntimeException("column " + column,e);
        }
      }
 else       if (TIMESTAMP.equals(column.getType())) {
        cursor.getLong(columnIndex);
      }
 else       if (DATE.equals(column.getType())) {
        cursor.getLong(columnIndex);
      }
 else {
        fail("Unknown primitive type " + columnIndex);
      }
    }
  }
}
