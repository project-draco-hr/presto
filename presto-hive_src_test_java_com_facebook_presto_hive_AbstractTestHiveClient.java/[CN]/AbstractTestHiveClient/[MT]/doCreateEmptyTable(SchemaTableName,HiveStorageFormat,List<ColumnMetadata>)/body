{
  Map<String,Object> properties=ImmutableMap.of(STORAGE_FORMAT_PROPERTY,storageFormat);
  ConnectorTableMetadata tableMetadata=new ConnectorTableMetadata(tableName,createTableColumns,properties,SESSION.getUser());
  metadata.createTable(SESSION,tableMetadata);
  ConnectorTableHandle tableHandle=getTableHandle(tableName);
  tableMetadata=metadata.getTableMetadata(SESSION,getTableHandle(tableName));
  assertEquals(tableMetadata.getOwner(),SESSION.getUser());
  assertEquals(tableMetadata.getColumns(),createTableColumns);
  List<ColumnHandle> columnHandles=ImmutableList.copyOf(metadata.getColumnHandles(SESSION,tableHandle).values());
  MaterializedResult result=readTable(tableHandle,columnHandles,SESSION,TupleDomain.all(),OptionalInt.empty(),Optional.of(storageFormat));
  assertEquals(result.getRowCount(),0);
}
