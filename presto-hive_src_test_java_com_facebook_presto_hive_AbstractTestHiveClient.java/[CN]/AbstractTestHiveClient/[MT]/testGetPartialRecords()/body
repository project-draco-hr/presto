{
  TableHandle tableHandle=metadata.getTableHandle(TABLE);
  List<ColumnHandle> columnHandles=ImmutableList.copyOf(metadata.getColumnHandles(tableHandle).values());
  Map<String,Integer> columnIndex=indexColumns(columnHandles);
  List<Partition> partitions=splitManager.getPartitions(tableHandle,ImmutableMap.<ColumnHandle,Object>of());
  List<Split> splits=ImmutableList.copyOf(splitManager.getPartitionSplits(partitions));
  assertEquals(splits.size(),PARTITIONS.size());
  for (  Split split : splits) {
    HiveSplit hiveSplit=(HiveSplit)split;
    List<HivePartitionKey> partitionKeys=hiveSplit.getPartitionKeys();
    String ds=partitionKeys.get(0).getValue();
    String fileType=partitionKeys.get(1).getValue();
    long dummy=Long.parseLong(partitionKeys.get(2).getValue());
    long baseValue=getBaseValueForFileType(fileType);
    long rowNumber=0;
    try (RecordCursor cursor=recordSetProvider.getRecordSet(hiveSplit,columnHandles).cursor()){
      while (cursor.advanceNextPosition()) {
        rowNumber++;
        assertEquals(cursor.getDouble(columnIndex.get("t_double")),baseValue + 6.2 + rowNumber);
        assertEquals(cursor.getString(columnIndex.get("ds")),ds.getBytes(Charsets.UTF_8));
        assertEquals(cursor.getString(columnIndex.get("file_format")),fileType.getBytes(Charsets.UTF_8));
        assertEquals(cursor.getLong(columnIndex.get("dummy")),dummy);
      }
    }
     assertEquals(rowNumber,100);
  }
}
