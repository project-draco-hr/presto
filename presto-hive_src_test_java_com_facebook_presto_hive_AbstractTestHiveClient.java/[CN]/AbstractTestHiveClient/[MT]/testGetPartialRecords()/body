{
  TableHandle tableHandle=client.getTableHandle(TABLE);
  SchemaTableMetadata tableMetadata=client.getTableMetadata(tableHandle);
  List<Partition> partitions=client.getPartitions(tableHandle,ImmutableMap.<ColumnHandle,Object>of());
  ImmutableList<ColumnHandle> columns=ImmutableList.copyOf(client.getColumnHandles(tableHandle).values());
  List<PartitionChunk> partitionChunks=ImmutableList.copyOf(client.getPartitionChunks(partitions));
  assertEquals(partitionChunks.size(),PARTITIONS.size());
  for (  PartitionChunk partitionChunk : partitionChunks) {
    HivePartitionChunk chunk=(HivePartitionChunk)partitionChunk;
    byte[] bytes=client.serializePartitionChunk(chunk);
    chunk=(HivePartitionChunk)client.deserializePartitionChunk(bytes);
    Map<String,ColumnMetadata> map=uniqueIndex(tableMetadata.getColumns(),columnNameGetter());
    List<HivePartitionKey> partitionKeys=chunk.getPartitionKeys();
    String ds=partitionKeys.get(0).getValue();
    String fileType=partitionKeys.get(1).getValue();
    long dummy=Long.parseLong(partitionKeys.get(2).getValue());
    long baseValue=getBaseValueForFileType(fileType);
    long rowNumber=0;
    try (RecordCursor cursor=client.getRecords(chunk,columns).cursor()){
      while (cursor.advanceNextPosition()) {
        rowNumber++;
        assertEquals(cursor.getDouble(map.get("t_double").getOrdinalPosition()),baseValue + 6.2 + rowNumber);
        assertEquals(cursor.getString(map.get("ds").getOrdinalPosition()),ds.getBytes(Charsets.UTF_8));
        assertEquals(cursor.getString(map.get("file_format").getOrdinalPosition()),fileType.getBytes(Charsets.UTF_8));
        assertEquals(cursor.getLong(map.get("dummy").getOrdinalPosition()),dummy);
      }
    }
     assertEquals(rowNumber,100);
  }
}
