{
  ConnectorTableHandle tableHandle=getTableHandle(tableBucketedDoubleFloat);
  List<ConnectorColumnHandle> columnHandles=ImmutableList.copyOf(metadata.getColumnHandles(tableHandle).values());
  Map<String,Integer> columnIndex=indexColumns(columnHandles);
  assertTableIsBucketed(tableHandle);
  ImmutableMap<ConnectorColumnHandle,Comparable<?>> bindings=ImmutableMap.<ConnectorColumnHandle,Comparable<?>>builder().put(columnHandles.get(columnIndex.get("t_float")),87.1).put(columnHandles.get(columnIndex.get("t_double")),88.2).build();
  ConnectorPartitionResult partitionResult=splitManager.getPartitions(tableHandle,TupleDomain.withFixedValues(bindings));
  List<ConnectorSplit> splits=getAllSplits(splitManager.getPartitionSplits(tableHandle,partitionResult.getPartitions()));
  assertEquals(splits.size(),32);
  int count=0;
  for (  ConnectorSplit split : splits) {
    try (ConnectorPageSource pageSource=pageSourceProvider.createPageSource(split,columnHandles)){
      MaterializedResult result=materializeSourceDataStream(SESSION,pageSource,getTypes(columnHandles));
      count+=result.getRowCount();
    }
   }
  assertEquals(count,100);
}
