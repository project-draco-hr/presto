{
  try {
    ConnectorSession session=newSession();
    ConnectorTableMetadata tableMetadata=new ConnectorTableMetadata(temporaryCreateRollbackTable,CREATE_TABLE_COLUMNS,createTableProperties(RCBINARY),session.getUser());
    ConnectorOutputTableHandle outputHandle=metadata.beginCreateTable(session,tableMetadata);
    ConnectorPageSink sink=pageSinkProvider.createPageSink(session,outputHandle);
    sink.appendPage(CREATE_TABLE_DATA.toPage(),null);
    sink.finish();
    assertFalse(listAllDataFiles(outputHandle).isEmpty());
    metadata.rollbackCreateTable(session,outputHandle);
    assertTrue(listAllDataFiles(outputHandle).isEmpty());
    assertNull(metadata.getTableHandle(session,temporaryCreateRollbackTable));
  }
  finally {
    dropTable(temporaryCreateRollbackTable);
  }
}
