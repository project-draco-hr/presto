{
  ConnectorTableHandle tableHandle=getTableHandle(tableBucketedStringInt);
  List<ConnectorColumnHandle> columnHandles=ImmutableList.copyOf(metadata.getColumnHandles(tableHandle).values());
  Map<String,Integer> columnIndex=indexColumns(columnHandles);
  assertTableIsBucketed(tableHandle);
  String testString="test";
  Long testInt=13L;
  Long testSmallint=12L;
  ImmutableMap<ConnectorColumnHandle,Comparable<?>> bindings=ImmutableMap.<ConnectorColumnHandle,Comparable<?>>builder().put(columnHandles.get(columnIndex.get("t_int")),testInt).put(columnHandles.get(columnIndex.get("t_string")),utf8Slice(testString)).put(columnHandles.get(columnIndex.get("t_smallint")),testSmallint).build();
  ConnectorPartitionResult partitionResult=splitManager.getPartitions(tableHandle,TupleDomain.withFixedValues(bindings));
  List<ConnectorSplit> splits=getAllSplits(splitManager.getPartitionSplits(tableHandle,partitionResult.getPartitions()));
  assertEquals(splits.size(),1);
  boolean rowFound=false;
  try (RecordCursor cursor=recordSetProvider.getRecordSet(splits.get(0),columnHandles).cursor()){
    while (cursor.advanceNextPosition()) {
      if (testString.equals(cursor.getSlice(columnIndex.get("t_string")).toStringUtf8()) && testInt == cursor.getLong(columnIndex.get("t_int")) && testSmallint == cursor.getLong(columnIndex.get("t_smallint"))) {
        rowFound=true;
      }
    }
    assertTrue(rowFound);
  }
 }
