{
  List<FieldSchema> columns=ImmutableList.of(new FieldSchema("dummy","int",null));
  List<FieldSchema> partitionColumns=ImmutableList.of(new FieldSchema("name","string",null));
  createEmptyTable(tableName,storageFormat,columns,partitionColumns);
  ConnectorSession session=newSession();
  ConnectorTableHandle tableHandle=getTableHandle(tableName);
  try {
    metadata.beginInsert(session,tableHandle);
    fail("expected failure");
  }
 catch (  PrestoException e) {
    assertEquals(e.getMessage(),"Inserting into Hive table with column type int not supported");
  }
}
