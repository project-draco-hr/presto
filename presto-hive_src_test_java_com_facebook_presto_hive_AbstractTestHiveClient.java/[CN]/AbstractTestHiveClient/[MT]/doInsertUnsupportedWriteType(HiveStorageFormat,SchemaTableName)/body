{
  List<FieldSchema> columns=ImmutableList.of(new FieldSchema("dummy","smallint",null));
  List<FieldSchema> partitionColumns=ImmutableList.of(new FieldSchema("name","string",null));
  createEmptyTable(tableName,storageFormat,columns,partitionColumns);
  ConnectorMetadata metadata=newMetadata();
  ConnectorSession session=newSession();
  ConnectorTableHandle tableHandle=getTableHandle(metadata,tableName);
  try {
    metadata.beginInsert(session,tableHandle);
    fail("expected failure");
  }
 catch (  PrestoException e) {
    assertEquals(e.getMessage(),"Inserting into Hive table with column type smallint not supported");
  }
}
