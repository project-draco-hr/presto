{
  TableHandle tableHandle=metadata.getTableHandle(tableOfflinePartition);
  assertNotNull(tableHandle);
  ColumnHandle dsColumn=metadata.getColumnHandle(tableHandle,"ds");
  assertNotNull(dsColumn);
  List<Partition> partitions=splitManager.getPartitions(tableHandle,ImmutableMap.<ColumnHandle,Object>of(dsColumn,"2012-12-30"));
  for (  Partition partition : partitions) {
    if ("2012-12-30".equals(partition.getKeys().get(dsColumn))) {
      try {
        Iterables.size(splitManager.getPartitionSplits(tableHandle,ImmutableList.of(partition)));
        fail("Expected PartitionOfflineException");
      }
 catch (      PartitionOfflineException e) {
        assertEquals(e.getTableName(),tableOfflinePartition);
        assertEquals(e.getPartition(),"ds=2012-12-30");
      }
    }
 else {
      Iterables.size(splitManager.getPartitionSplits(tableHandle,ImmutableList.of(partition)));
    }
  }
}
