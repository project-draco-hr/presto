{
  TableHandle tableHandle=getTableHandle(tableOfflinePartition);
  assertNotNull(tableHandle);
  ColumnHandle dsColumn=metadata.getColumnHandle(tableHandle,"ds");
  assertNotNull(dsColumn);
  Domain domain=Domain.singleValue(Slices.utf8Slice("2012-12-30"));
  TupleDomain tupleDomain=TupleDomain.withColumnDomains(ImmutableMap.<ColumnHandle,Domain>of(dsColumn,domain));
  PartitionResult partitionResult=splitManager.getPartitions(tableHandle,tupleDomain);
  for (  Partition partition : partitionResult.getPartitions()) {
    if (domain.equals(partition.getTupleDomain().getDomains().get(dsColumn))) {
      try {
        getSplitCount(splitManager.getPartitionSplits(tableHandle,ImmutableList.of(partition)));
        fail("Expected PartitionOfflineException");
      }
 catch (      PartitionOfflineException e) {
        assertEquals(e.getTableName(),tableOfflinePartition);
        assertEquals(e.getPartition(),"ds=2012-12-30");
      }
    }
 else {
      getSplitCount(splitManager.getPartitionSplits(tableHandle,ImmutableList.of(partition)));
    }
  }
}
