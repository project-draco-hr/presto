{
  TableHandle tableHandle=getTableHandle(tableOfflinePartition);
  assertNotNull(tableHandle);
  ColumnHandle dsColumn=metadata.getColumnHandle(tableHandle,"ds");
  assertNotNull(dsColumn);
  TupleDomain tupleDomain=TupleDomain.withColumnDomains(ImmutableMap.<ColumnHandle,Domain>of(dsColumn,Domain.singleValue("2012-12-30")));
  PartitionResult partitionResult=splitManager.getPartitions(tableHandle,tupleDomain);
  for (  Partition partition : partitionResult.getPartitions()) {
    if (Domain.singleValue("2012-12-30").equals(partition.getTupleDomain().getDomains().get(dsColumn))) {
      try {
        Iterables.size(splitManager.getPartitionSplits(tableHandle,ImmutableList.of(partition)));
        fail("Expected PartitionOfflineException");
      }
 catch (      PartitionOfflineException e) {
        assertEquals(e.getTableName(),tableOfflinePartition);
        assertEquals(e.getPartition(),"ds=2012-12-30");
      }
    }
 else {
      Iterables.size(splitManager.getPartitionSplits(tableHandle,ImmutableList.of(partition)));
    }
  }
}
