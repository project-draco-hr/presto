{
  ConnectorMetadata metadata=newMetadata();
  ConnectorTransactionHandle transaction=newTransaction();
  ConnectorInsertTableHandle insertTableHandle=metadata.beginInsert(session,tableHandle);
  ConnectorPageSink sink=pageSinkProvider.createPageSink(transaction,session,insertTableHandle);
  sink.appendPage(data.toPage(),null);
  Collection<Slice> fragments=sink.finish();
  metadata.finishInsert(session,insertTableHandle,fragments);
  Path writePath=getStagingPathRoot(insertTableHandle);
  Path targetPath=getTargetPathRoot(insertTableHandle);
  if (!writePath.equals(targetPath)) {
    FileSystem fileSystem=hdfsEnvironment.getFileSystem("user",writePath);
    assertFalse(fileSystem.exists(writePath));
  }
}
