{
  checkNotNull(block,"tuples is null");
  checkState(!finished,"already finished");
  if (encoding == null) {
    encoding=new SnappyBlockEncoding(block.getTupleInfo(),block.getEncoding());
    blockBuilder=createBlockBuilder(block.getTupleInfo());
  }
  BlockCursor cursor=block.cursor();
  while (cursor.advanceNextPosition()) {
    cursor.appendTupleTo(blockBuilder);
    if (blockBuilder.isFull()) {
      flushBlock();
    }
  }
  return this;
}
