{
  Preconditions.checkNotNull(tuples,"tuples is null");
  checkState(!finished,"already finished");
  for (  Tuple tuple : tuples) {
    if (encoding == null) {
      encoding=new SnappyBlockEncoding(tuple.getTupleInfo());
    }
    tuple.writeTo(buffer);
    tupleCount++;
    if (buffer.size() >= MAX_UNCOMPRESSED_BLOCK_SIZE) {
      flushBlock();
    }
  }
  return this;
}
