{
  assertUpdate("CREATE TABLE test_delete AS SELECT * FROM orders","SELECT count(*) FROM orders");
  assertUpdate("DELETE FROM test_delete WHERE orderkey % 2 = 0","SELECT count(*) FROM orders WHERE orderkey % 2 = 0");
  assertQuery("SELECT * FROM test_delete","SELECT * FROM orders WHERE orderkey % 2 <> 0");
  assertUpdate("DELETE FROM test_delete","SELECT count(*) FROM orders WHERE orderkey % 2 <> 0");
  assertQuery("SELECT * FROM test_delete","SELECT * FROM orders LIMIT 0");
  assertUpdate("DROP TABLE test_delete");
  assertUpdate("CREATE TABLE test_delete AS SELECT * FROM orders","SELECT count(*) FROM orders");
  assertUpdate("DELETE FROM test_delete WHERE custkey <= 100","SELECT count(*) FROM orders WHERE custkey <= 100");
  assertQuery("SELECT * FROM test_delete","SELECT * FROM orders WHERE custkey > 100");
  assertUpdate("DELETE FROM test_delete WHERE custkey <= 300","SELECT count(*) FROM orders WHERE custkey > 100 AND custkey <= 300");
  assertQuery("SELECT * FROM test_delete","SELECT * FROM orders WHERE custkey > 300");
  assertUpdate("DELETE FROM test_delete WHERE custkey <= 500","SELECT count(*) FROM orders WHERE custkey > 300 AND custkey <= 500");
  assertQuery("SELECT * FROM test_delete","SELECT * FROM orders WHERE custkey > 500");
  assertUpdate("DROP TABLE test_delete");
  assertUpdate("CREATE TABLE test_delete AS SELECT * FROM orders","SELECT count(*) FROM orders");
  assertUpdate("DELETE FROM test_delete WHERE orderstatus = 'O'","SELECT count(*) FROM orders WHERE orderstatus = 'O'");
  assertQuery("SELECT * FROM test_delete","SELECT * FROM orders WHERE orderstatus <> 'O'");
  assertUpdate("DROP TABLE test_delete");
  assertUpdate("CREATE TABLE test_delete AS SELECT * FROM orders","SELECT count(*) FROM orders");
  assertUpdate("DELETE FROM test_delete WHERE rand() < 0",0);
  assertUpdate("DROP TABLE test_delete");
  assertUpdate("CREATE TABLE test_delete AS SELECT * FROM orders","SELECT count(*) FROM orders");
  assertUpdate("DELETE FROM test_delete WHERE orderkey > 5 AND orderkey < 4",0);
  assertUpdate("DROP TABLE test_delete");
  assertUpdate("CREATE TABLE test_delete AS SELECT * FROM lineitem","SELECT count(*) FROM lineitem");
  assertUpdate("DELETE FROM test_delete WHERE orderkey IN (SELECT orderkey FROM orders WHERE orderstatus = 'F')","SELECT count(*) FROM lineitem WHERE orderkey IN (SELECT orderkey FROM orders WHERE orderstatus = 'F')");
  assertQuery("SELECT * FROM test_delete","SELECT * FROM lineitem WHERE orderkey IN (SELECT orderkey FROM orders WHERE orderstatus <> 'F')");
  assertUpdate("DROP TABLE test_delete");
  assertUpdate("CREATE TABLE test_delete AS SELECT * FROM lineitem","SELECT count(*) FROM lineitem");
  assertUpdate("DELETE FROM test_delete\n" + "WHERE orderkey IN (SELECT orderkey FROM orders WHERE orderstatus = 'F')\n" + "  AND orderkey IN (SELECT orderkey FROM orders WHERE custkey % 5 = 0)\n","SELECT count(*) FROM lineitem\n" + "WHERE orderkey IN (SELECT orderkey FROM orders WHERE orderstatus = 'F')\n" + "  AND orderkey IN (SELECT orderkey FROM orders WHERE custkey % 5 = 0)");
  assertQuery("SELECT * FROM test_delete","SELECT * FROM lineitem\n" + "WHERE orderkey IN (SELECT orderkey FROM orders WHERE orderstatus <> 'F')\n" + "  OR orderkey IN (SELECT orderkey FROM orders WHERE custkey % 5 <> 0)");
  assertUpdate("DROP TABLE test_delete");
  assertUpdate("CREATE TABLE test_delete AS SELECT * FROM orders","SELECT count(*) FROM orders");
  assertUpdate("DELETE FROM test_delete\n" + "WHERE (orderkey IN (SELECT CASE WHEN orderkey % 3 = 0 THEN NULL ELSE orderkey END FROM lineitem)) IS NULL\n","SELECT count(*) FROM orders\n" + "WHERE (orderkey IN (SELECT CASE WHEN orderkey % 3 = 0 THEN NULL ELSE orderkey END FROM lineitem)) IS NULL\n");
  assertQuery("SELECT * FROM test_delete","SELECT * FROM orders\n" + "WHERE (orderkey IN (SELECT CASE WHEN orderkey % 3 = 0 THEN NULL ELSE orderkey END FROM lineitem)) IS NOT NULL\n");
  assertUpdate("DROP TABLE test_delete");
  assertUpdate("CREATE TABLE test_delete AS SELECT * FROM orders","SELECT count(*) FROM orders");
  assertUpdate("DELETE FROM test_delete WHERE orderkey = (SELECT orderkey FROM orders ORDER BY orderkey LIMIT 1)",1);
  assertUpdate("DELETE FROM test_delete WHERE orderkey = (SELECT orderkey FROM orders WHERE false)",0);
  assertUpdate("DELETE FROM test_delete WHERE (SELECT true)","SELECT count(*) - 1 FROM orders");
  assertUpdate("DROP TABLE test_delete");
  assertExplainAnalyze("EXPLAIN ANALYZE CREATE TABLE analyze_test AS SELECT CAST(orderstatus AS VARCHAR(15)) orderstatus FROM orders");
  assertQuery("SELECT * from analyze_test","SELECT orderstatus FROM orders");
  assertExplainAnalyze("EXPLAIN ANALYZE INSERT INTO analyze_test SELECT clerk FROM orders");
  assertQuery("SELECT * from analyze_test","SELECT orderstatus FROM orders UNION ALL SELECT clerk FROM orders");
  assertExplainAnalyze("EXPLAIN ANALYZE DELETE FROM analyze_test WHERE TRUE");
  assertQuery("SELECT COUNT(*) from analyze_test","SELECT 0");
  assertUpdate("DROP TABLE analyze_test");
}
