{
  @Language("SQL") String query="SELECT orderdate, orderkey FROM orders";
  assertUpdate("CREATE TABLE test_insert AS " + query + " WITH NO DATA",0);
  assertQuery("SELECT count(*) FROM test_insert","SELECT 0");
  assertUpdate("INSERT INTO test_insert " + query,"SELECT count(*) FROM orders");
  assertQuery("SELECT * FROM test_insert",query);
  assertUpdate("INSERT INTO test_insert (orderkey) VALUES (-1)",1);
  assertUpdate("INSERT INTO test_insert (orderdate) VALUES (DATE '2001-01-01')",1);
  assertUpdate("INSERT INTO test_insert (orderkey, orderdate) VALUES (-2, DATE '2001-01-02')",1);
  assertUpdate("INSERT INTO test_insert (orderdate, orderkey) VALUES (DATE '2001-01-03', -3)",1);
  assertQuery("SELECT * FROM test_insert",query + " UNION ALL SELECT null, -1" + " UNION ALL SELECT DATE '2001-01-01', null"+ " UNION ALL SELECT DATE '2001-01-02', -2"+ " UNION ALL SELECT DATE '2001-01-03', -3");
  assertUpdate("INSERT INTO test_insert (orderkey, orderdate) " + "SELECT orderkey, orderdate FROM orders " + "UNION ALL "+ "SELECT orderkey, orderdate FROM orders","SELECT 2 * count(*) FROM orders");
  assertUpdate("DROP TABLE test_insert");
}
