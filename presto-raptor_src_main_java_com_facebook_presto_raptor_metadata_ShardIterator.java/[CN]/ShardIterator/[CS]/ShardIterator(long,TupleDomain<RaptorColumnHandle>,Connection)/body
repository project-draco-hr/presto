{
  ShardPredicate predicate=ShardPredicate.create(effectivePredicate);
  String sql="" + "SELECT shard_uuid, node_identifier\n" + "FROM " + shardIndexTable(tableId) + " t\n"+ "LEFT JOIN shard_nodes sn ON (t.shard_id = sn.shard_id)\n"+ "LEFT JOIN nodes n ON (sn.node_id = n.node_id)\n"+ "WHERE "+ predicate.getPredicate()+ "\n"+ "ORDER BY shard_uuid";
  this.connection=checkNotNull(connection,"connection is null");
  try {
    statement=connection.prepareStatement(sql);
    predicate.bind(statement);
    resultSet=statement.executeQuery();
  }
 catch (  SQLException e) {
    close();
    throw new PrestoException(RAPTOR_ERROR,e);
  }
}
