{
  if (!resultSet.next()) {
    return endOfData();
  }
  UUID shardUuid=uuidFromBytes(resultSet.getBytes("shard_uuid"));
  List<Integer> nodeIds=intArrayFromBytes(resultSet.getBytes("node_ids"));
  OptionalInt bucketNumber=bucketed ? OptionalInt.of(resultSet.getInt("bucket_number")) : OptionalInt.empty();
  ShardNodes shard=new ShardNodes(shardUuid,getNodeIdentifiers(nodeIds,shardUuid));
  return new BucketShards(bucketNumber,ImmutableSet.of(shard));
}
