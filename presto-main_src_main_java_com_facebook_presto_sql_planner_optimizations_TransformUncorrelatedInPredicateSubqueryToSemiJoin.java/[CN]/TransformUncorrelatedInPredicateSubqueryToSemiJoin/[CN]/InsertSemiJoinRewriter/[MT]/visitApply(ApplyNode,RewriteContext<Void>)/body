{
  Symbol value=asSymbol(inPredicate.getValue());
  Symbol valueList=asSymbol(inPredicate.getValueList());
  if (node.getCorrelation().isEmpty() && inPredicateMatchesApply(node,value,valueList)) {
    checkState(!semiJoinSymbol.isPresent(),"Semi join symbol is already set");
    semiJoinSymbol=Optional.of(symbolAllocator.newSymbol("semijoin_result",BOOLEAN));
    return new SemiJoinNode(idAllocator.getNextId(),node.getInput(),node.getSubquery(),value,valueList,semiJoinSymbol.get(),Optional.empty(),Optional.empty());
  }
  return context.defaultRewrite(node,context.get());
}
