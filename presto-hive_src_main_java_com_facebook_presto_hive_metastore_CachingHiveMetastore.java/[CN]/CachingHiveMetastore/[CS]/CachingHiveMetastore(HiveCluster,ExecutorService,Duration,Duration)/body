{
  this.clientProvider=checkNotNull(hiveCluster,"hiveCluster is null");
  long expiresAfterWriteMillis=checkNotNull(cacheTtl,"cacheTtl is null").toMillis();
  long refreshMills=checkNotNull(refreshInterval,"refreshInterval is null").toMillis();
  databaseNamesCache=CacheBuilder.newBuilder().expireAfterWrite(expiresAfterWriteMillis,MILLISECONDS).refreshAfterWrite(refreshMills,MILLISECONDS).build(asyncReloading(new CacheLoader<String,List<String>>(){
    @Override public List<String> load(    String key) throws Exception {
      return loadAllDatabases();
    }
  }
,executor));
  databaseCache=CacheBuilder.newBuilder().expireAfterWrite(expiresAfterWriteMillis,MILLISECONDS).refreshAfterWrite(refreshMills,MILLISECONDS).build(asyncReloading(new CacheLoader<String,Database>(){
    @Override public Database load(    String databaseName) throws Exception {
      return loadDatabase(databaseName);
    }
  }
,executor));
  tableNamesCache=CacheBuilder.newBuilder().expireAfterWrite(expiresAfterWriteMillis,MILLISECONDS).refreshAfterWrite(refreshMills,MILLISECONDS).build(asyncReloading(new CacheLoader<String,List<String>>(){
    @Override public List<String> load(    String databaseName) throws Exception {
      return loadAllTables(databaseName);
    }
  }
,executor));
  tableCache=CacheBuilder.newBuilder().expireAfterWrite(expiresAfterWriteMillis,MILLISECONDS).refreshAfterWrite(refreshMills,MILLISECONDS).build(asyncReloading(new CacheLoader<HiveTableName,Table>(){
    @Override public Table load(    HiveTableName hiveTableName) throws Exception {
      return loadTable(hiveTableName);
    }
  }
,executor));
  viewNamesCache=CacheBuilder.newBuilder().expireAfterWrite(expiresAfterWriteMillis,MILLISECONDS).refreshAfterWrite(refreshMills,MILLISECONDS).build(asyncReloading(new CacheLoader<String,List<String>>(){
    @Override public List<String> load(    String databaseName) throws Exception {
      return loadAllViews(databaseName);
    }
  }
,executor));
  partitionNamesCache=CacheBuilder.newBuilder().expireAfterWrite(expiresAfterWriteMillis,MILLISECONDS).refreshAfterWrite(refreshMills,MILLISECONDS).build(asyncReloading(new CacheLoader<HiveTableName,List<String>>(){
    @Override public List<String> load(    HiveTableName hiveTableName) throws Exception {
      return loadPartitionNames(hiveTableName);
    }
  }
,executor));
  partitionFilterCache=CacheBuilder.newBuilder().expireAfterWrite(expiresAfterWriteMillis,MILLISECONDS).refreshAfterWrite(refreshMills,MILLISECONDS).build(asyncReloading(new CacheLoader<PartitionFilter,List<String>>(){
    @Override public List<String> load(    PartitionFilter partitionFilter) throws Exception {
      return loadPartitionNamesByParts(partitionFilter);
    }
  }
,executor));
  partitionCache=CacheBuilder.newBuilder().expireAfterWrite(expiresAfterWriteMillis,MILLISECONDS).refreshAfterWrite(refreshMills,MILLISECONDS).build(asyncReloading(new CacheLoader<HivePartitionName,Partition>(){
    @Override public Partition load(    HivePartitionName partitionName) throws Exception {
      return loadPartitionByName(partitionName);
    }
    @Override public Map<HivePartitionName,Partition> loadAll(    Iterable<? extends HivePartitionName> partitionNames) throws Exception {
      return loadPartitionsByNames(partitionNames);
    }
  }
,executor));
}
