{
  Iterable<HivePartitionName> names=transform(partitionNames,partitionNameCreator(databaseName,tableName));
  ImmutableMap.Builder<String,Partition> partitionsByName=ImmutableMap.builder();
  Map<HivePartitionName,Partition> all=getAll(partitionCache,names,NoSuchObjectException.class);
  for (  Entry<HivePartitionName,Partition> entry : all.entrySet()) {
    partitionsByName.put(entry.getKey().getPartitionName(),entry.getValue());
  }
  return partitionsByName.build();
}
