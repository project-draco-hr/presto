{
  try {
    retry().stopOn(AlreadyExistsException.class,InvalidObjectException.class,MetaException.class,NoSuchObjectException.class).stopOnIllegalExceptions().run("createTable",stats.getCreateTable().wrap(new Callable<Void>(){
      @Override public Void call() throws Exception {
        try (HiveMetastoreClient client=clientProvider.createMetastoreClient()){
          client.create_table(table);
        }
         tableNamesCache.invalidate(table.getDbName());
        viewNamesCache.invalidate(table.getDbName());
        return null;
      }
    }
));
  }
 catch (  AlreadyExistsException e) {
    throw new TableAlreadyExistsException(new SchemaTableName(table.getDbName(),table.getTableName()));
  }
catch (  InvalidObjectException|NoSuchObjectException|MetaException e) {
    throw Throwables.propagate(e);
  }
catch (  TException e) {
    throw new PrestoException(HIVE_METASTORE_ERROR,e);
  }
catch (  Exception e) {
    if (e instanceof InterruptedException) {
      Thread.currentThread().interrupt();
    }
    throw Throwables.propagate(e);
  }
}
