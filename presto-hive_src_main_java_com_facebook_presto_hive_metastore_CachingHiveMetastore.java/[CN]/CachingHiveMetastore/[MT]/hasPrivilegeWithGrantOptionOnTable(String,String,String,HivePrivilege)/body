{
  try (HiveMetastoreClient metastoreClient=clientProvider.createMetastoreClient()){
    PrincipalPrivilegeSet principalPrivilegeSet=metastoreClient.getPrivilegeSet(new HiveObjectRef(HiveObjectType.TABLE,databaseName,tableName,null,null),user,null);
    for (    PrivilegeGrantInfo privilegeGrantInfo : principalPrivilegeSet.getUserPrivileges().get(user)) {
      if (privilegeGrantInfo.getPrivilege().equalsIgnoreCase(hivePrivilege.name()) && privilegeGrantInfo.isGrantOption()) {
        return true;
      }
    }
    return false;
  }
 catch (  TException e) {
    throw new PrestoException(HIVE_METASTORE_ERROR,e);
  }
}
