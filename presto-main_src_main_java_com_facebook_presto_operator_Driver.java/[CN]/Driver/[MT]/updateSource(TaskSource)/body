{
  PlanNodeId sourceId=source.getPlanNodeId();
  if (!sourceOperators.containsKey(sourceId)) {
    return;
  }
  Set<ScheduledSplit> newSplits;
  TaskSource currentSource=sources.get(sourceId);
  if (currentSource == null) {
    newSplits=source.getSplits();
  }
 else {
    TaskSource newSource=currentSource.update(source);
    if (newSource == currentSource) {
      return;
    }
    newSplits=Sets.difference(newSource.getSplits(),currentSource.getSplits());
    sources.put(sourceId,newSource);
  }
  for (  ScheduledSplit newSplit : newSplits) {
    addSplit(sourceId,newSplit.getSplit());
  }
  if (source.isNoMoreSplits()) {
    sourceOperators.get(sourceId).noMoreSplits();
  }
}
