{
  checkLockNotHeld("Can not check finished status while holding the driver lock");
  try (DriverLockResult lockResult=tryLockAndProcessPendingStateChanges(0,TimeUnit.MILLISECONDS)){
    if (lockResult.wasAcquired()) {
      boolean finished=state.get() != State.ALIVE || driverContext.isDone() || operators.get(operators.size() - 1).isFinished();
      if (finished) {
        state.compareAndSet(State.ALIVE,State.NEED_DESTRUCTION);
      }
      return finished;
    }
 else {
      return state.get() != State.ALIVE || driverContext.isDone();
    }
  }
 }
