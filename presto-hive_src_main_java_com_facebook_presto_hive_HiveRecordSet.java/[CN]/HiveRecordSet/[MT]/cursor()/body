{
  ColumnProjectionUtils.setReadColumnIDs(configuration,readHiveColumnIndexes);
  RecordReader<?,?> recordReader=createRecordReader(split,configuration,wrappedPath);
  if (usesColumnarTextSerDe(split)) {
    return new ColumnarTextHiveRecordCursor<>(bytesRecordReader(recordReader),split.getLength(),split.getSchema(),split.getPartitionKeys(),columns);
  }
 else   if (usesColumnarBinarySerDe(split)) {
    return new ColumnarBinaryHiveRecordCursor<>(bytesRecordReader(recordReader),split.getLength(),split.getSchema(),split.getPartitionKeys(),columns);
  }
  return new GenericHiveRecordCursor<>(genericRecordReader(recordReader),split.getLength(),split.getSchema(),split.getPartitionKeys(),columns);
}
