{
  try {
    ColumnProjectionUtils.setReadColumnIDs(configuration,readHiveColumnIndexes);
    RecordReader<?,?> recordReader=createRecordReader(split,configuration,wrappedPath);
    if (recordReader.createValue() instanceof BytesRefArrayWritable) {
      return new BytesHiveRecordCursor<>(bytesRecordReader(recordReader),split.getLength(),split.getSchema(),split.getPartitionKeys(),columns);
    }
    return new GenericHiveRecordCursor<>(genericRecordReader(recordReader),split.getLength(),split.getSchema(),split.getPartitionKeys(),columns);
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
}
