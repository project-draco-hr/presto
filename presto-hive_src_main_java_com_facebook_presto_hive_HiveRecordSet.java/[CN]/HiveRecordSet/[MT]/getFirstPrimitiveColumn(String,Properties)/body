{
  int index=0;
  for (  StructField field : getTableObjectInspector(schema).getAllStructFieldRefs()) {
    if (field.getFieldObjectInspector().getCategory() == ObjectInspector.Category.PRIMITIVE) {
      PrimitiveObjectInspector inspector=(PrimitiveObjectInspector)field.getFieldObjectInspector();
      HiveType hiveType=HiveType.getSupportedHiveType(inspector.getTypeName());
      return new HiveColumnHandle(clientId,field.getFieldName(),index,hiveType,getType(inspector).getName(),index,false);
    }
    index++;
  }
  throw new IllegalStateException("Table doesn't have any PRIMITIVE columns");
}
