{
  try {
    int index=0;
    for (    StructField field : getTableObjectInspector(schema).getAllStructFieldRefs()) {
      if (field.getFieldObjectInspector().getCategory() == ObjectInspector.Category.PRIMITIVE) {
        PrimitiveObjectInspector inspector=(PrimitiveObjectInspector)field.getFieldObjectInspector();
        HiveType hiveType=HiveType.getSupportedHiveType(inspector.getPrimitiveCategory());
        return new HiveColumnHandle(clientId,field.getFieldName(),index,hiveType,index,false);
      }
      index++;
    }
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
  throw new IllegalStateException("Table doesn't have any PRIMITIVE columns");
}
