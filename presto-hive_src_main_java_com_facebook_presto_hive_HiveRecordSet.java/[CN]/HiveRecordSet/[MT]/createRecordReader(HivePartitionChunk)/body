{
  InputFormat inputFormat=getInputFormat(hdfsEnvironment.getConfiguration(),chunk.getSchema(),true);
  final Path wrappedPath=hdfsEnvironment.getFileSystemWrapper().wrap(chunk.getPath());
  FileSplit split=new FileSplit(wrappedPath,chunk.getStart(),chunk.getLength(),(String[])null){
    @Override public Path getPath(){
      return wrappedPath;
    }
  }
;
  JobConf jobConf=new JobConf(hdfsEnvironment.getConfiguration());
  try {
    return inputFormat.getRecordReader(split,jobConf,Reporter.NULL);
  }
 catch (  IOException e) {
    throw new RuntimeException("Unable to create record reader for input format " + getInputFormatName(chunk.getSchema()),e);
  }
}
