{
  this.hdfsEnvironment=Preconditions.checkNotNull(hdfsEnvironment,"hdfsEnvironment is null");
  this.chunk=chunk;
  this.columns=columns;
  this.columnTypes=ImmutableList.copyOf(Iterables.transform(columns,nativeTypeGetter()));
  List<HiveColumnHandle> readColumns=ImmutableList.copyOf(filter(columns,partitionColumnPredicate()));
  if (readColumns.isEmpty()) {
    HiveColumnHandle primitiveColumn=getFirstPrimitiveColumn(chunk.getClientId(),chunk.getSchema());
    readColumns=ImmutableList.of(primitiveColumn);
  }
  readHiveColumnIndexes=new ArrayList<>(transform(readColumns,hiveColumnIndexGetter()));
}
