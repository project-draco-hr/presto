{
  this.split=checkNotNull(split,"split is null");
  this.columns=ImmutableList.copyOf(checkNotNull(columns,"columns is null"));
  this.columnTypes=ImmutableList.copyOf(Iterables.transform(columns,nativeTypeGetter()));
  List<HiveColumnHandle> readColumns=ImmutableList.copyOf(filter(columns,not(isPartitionKeyPredicate())));
  if (readColumns.isEmpty()) {
    HiveColumnHandle primitiveColumn=getFirstPrimitiveColumn(split.getClientId(),split.getSchema());
    readColumns=ImmutableList.of(primitiveColumn);
  }
  readHiveColumnIndexes=new ArrayList<>(transform(readColumns,hiveColumnIndexGetter()));
  Path path=new Path(split.getPath());
  this.configuration=hdfsEnvironment.getConfiguration(path);
  this.wrappedPath=hdfsEnvironment.getFileSystemWrapper().wrap(path);
}
