{
  @SuppressWarnings("deprecation") Deserializer deserializer=getDeserializer(schema);
  if (!(deserializer instanceof ParquetHiveSerDe)) {
    return Optional.empty();
  }
  List<HiveColumnHandle> unsupportedColumns=ImmutableList.copyOf(filter(columns,not(isParquetSupportedType())));
  if (!unsupportedColumns.isEmpty()) {
    throw new IllegalArgumentException("Can not read Parquet column: " + unsupportedColumns);
  }
  return Optional.<HiveRecordCursor>of(new ParquetHiveRecordCursor(configuration,path,start,length,schema,partitionKeys,columns,typeManager));
}
