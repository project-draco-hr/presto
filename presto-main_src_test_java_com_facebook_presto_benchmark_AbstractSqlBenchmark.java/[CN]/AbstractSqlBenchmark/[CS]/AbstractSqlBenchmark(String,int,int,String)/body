{
  super(benchmarkName,warmupIterations,measuredIterations);
  try {
    Statement statement=SqlParser.createStatement(query);
    metadata=TpchSchema.createMetadata();
    Session session=new Session(TpchSchema.CATALOG_NAME,TpchSchema.SCHEMA_NAME);
    analysis=new Analyzer(session,metadata).analyze(statement);
    PlanNode plan=new Planner().plan((Query)statement,analysis);
    fragment=Iterables.getOnlyElement(new FragmentPlanner(metadata).createFragments(plan,analysis.getSymbolAllocator(),true));
    new PlanPrinter().print(fragment.getRoot(),analysis.getTypes());
  }
 catch (  RecognitionException e) {
    throw Throwables.propagate(e);
  }
}
