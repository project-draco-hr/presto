{
  TpchTableHandle table=(TpchTableHandle)((TableScan)Iterables.getOnlyElement(fragment.getSources())).getTable();
  PlanFragmentSource tableScanSource=new TableScanPlanFragmentSource(new TpchSplit(table));
  ExecutionPlanner executionPlanner=new ExecutionPlanner(sessionMetadata,new HackPlanFragmentSourceProvider(new TpchDataStreamProvider(provider),jsonCodec(QueryTaskInfo.class)),analysis.getTypes(),ImmutableMap.<String,PlanFragmentSource>of(table.getHandleId(),tableScanSource));
  return executionPlanner.plan(fragment.getRoot());
}
