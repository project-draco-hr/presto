{
  TpchTableHandle table=(TpchTableHandle)((TableScan)Iterables.getOnlyElement(fragment.getSources())).getTable();
  PlanFragmentSource tableScanSource=new TableScanPlanFragmentSource(new TpchSplit(table));
  ExecutionPlanner executionPlanner=new ExecutionPlanner(sessionMetadata,new HackPlanFragmentSourceProvider(new TpchDataStreamProvider(provider),jsonCodec(QueryTaskInfo.class)),analysis.getTypes(),tableScanSource,ImmutableMap.<String,ExchangePlanFragmentSource>of(),new SourceHashProviderFactory());
  return executionPlanner.plan(fragment.getRoot());
}
