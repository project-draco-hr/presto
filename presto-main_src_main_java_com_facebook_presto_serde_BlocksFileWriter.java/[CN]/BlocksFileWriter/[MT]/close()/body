{
  if (!closed && encoder != null) {
    BlockEncoding blockEncoding=encoder.finish();
    int startingIndex=sliceOutput.size();
    BlockEncodings.writeBlockEncoding(sliceOutput,blockEncoding);
    BlocksFileStats.serialize(statsBuilder.build(),sliceOutput);
    int footerSize=sliceOutput.size() - startingIndex;
    checkState(footerSize > 0);
    sliceOutput.writeInt(footerSize);
    try {
      sliceOutput.close();
    }
 catch (    IOException e) {
      throw Throwables.propagate(e);
    }
    closed=true;
  }
}
