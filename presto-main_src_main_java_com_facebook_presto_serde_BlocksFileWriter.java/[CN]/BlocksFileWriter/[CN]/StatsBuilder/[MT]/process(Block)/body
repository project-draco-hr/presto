{
  checkNotNull(block,"block is null");
  if (dictionaryBuilder == null) {
    dictionaryBuilder=new DictionaryBuilder(block.getType());
  }
  BlockCursor cursor=block.cursor();
  while (cursor.advanceNextPosition()) {
    RandomAccessBlock randomAccessBlock=cursor.getSingleValueBlock();
    if (lastValue == null) {
      lastValue=randomAccessBlock;
    }
 else     if (!randomAccessBlock.equalTo(0,lastValue,0)) {
      runsCount++;
      lastValue=randomAccessBlock;
    }
    if (dictionaryBuilder.size() < MAX_UNIQUE_COUNT) {
      dictionaryBuilder.putIfAbsent(cursor);
    }
    rowCount++;
  }
}
