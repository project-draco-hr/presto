{
  checkNotNull(block,"block is null");
  BlockCursor cursor=block.cursor();
  while (cursor.advanceNextPosition()) {
    Tuple tuple=cursor.getTuple();
    if (lastTuple == null) {
      lastTuple=tuple;
      if (set.size() < MAX_UNIQUE_COUNT) {
        set.add(lastTuple);
      }
    }
 else     if (!tuple.equals(lastTuple)) {
      runsCount++;
      lastTuple=tuple;
      if (set.size() < MAX_UNIQUE_COUNT) {
        set.add(lastTuple);
      }
    }
    rowCount++;
  }
}
