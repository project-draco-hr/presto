{
  checkNotNull(block,"block is null");
  if (dictionaryBuilder == null) {
    dictionaryBuilder=new ChannelSetBuilder(type,MAX_UNIQUE_COUNT,null);
  }
  for (int position=0; position < block.getPositionCount(); position++) {
    Block value=block.getSingleValueBlock(position);
    if (lastValue == null) {
      lastValue=value;
    }
 else     if (!type.equalTo(value,0,lastValue,0)) {
      runsCount++;
      lastValue=value;
    }
    if (dictionaryBuilder.size() < MAX_UNIQUE_COUNT) {
      dictionaryBuilder.add(position,block);
    }
    rowCount++;
  }
}
