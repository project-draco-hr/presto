{
  PlanNode node=new AggregationNode(newId(),filter(baseTableScan,and(equals(AE,DE),equals(BE,EE),equals(CE,FE),lessThan(DE,number(10)),lessThan(CE,DE),greaterThan(AE,number(2)),equals(EE,FE))),ImmutableList.of(A,B,C),ImmutableMap.of(C,fakeFunction("test"),D,fakeFunction("test")),ImmutableMap.of(C,fakeFunctionHandle("test"),D,fakeFunctionHandle("test")),ImmutableMap.<Symbol,Symbol>of(),AggregationNode.Step.FINAL,Optional.<Symbol>absent());
  Expression effectivePredicate=EffectivePredicateExtractor.extract(node);
  Assert.assertEquals(normalizeConjuncts(effectivePredicate),normalizeConjuncts(lessThan(AE,number(10)),lessThan(BE,AE),greaterThan(AE,number(2)),equals(BE,CE)));
}
