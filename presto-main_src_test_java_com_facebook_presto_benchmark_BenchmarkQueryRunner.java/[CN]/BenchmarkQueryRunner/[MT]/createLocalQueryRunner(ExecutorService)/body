{
  Session session=new Session("user","test","default","default",TimeZone.getTimeZone("UTC"),Locale.ENGLISH,null,null);
  LocalQueryRunner localQueryRunner=new LocalQueryRunner(session,executor);
  InMemoryNodeManager nodeManager=localQueryRunner.getNodeManager();
  localQueryRunner.createCatalog("tpch",new TpchConnectorFactory(nodeManager,1),ImmutableMap.<String,String>of());
  NativeConnectorFactory nativeConnectorFactory=createNativeConnectorFactory(nodeManager,localQueryRunner.getTypeManager(),System.getProperty("tpchCacheDir","/tmp/presto_tpch/data_cache"));
  localQueryRunner.createCatalog("default",nativeConnectorFactory,ImmutableMap.<String,String>of());
  MetadataManager metadata=localQueryRunner.getMetadata();
  if (!metadata.getTableHandle(new QualifiedTableName("default","default","orders")).isPresent()) {
    localQueryRunner.execute("CREATE TABLE orders AS SELECT * FROM tpch.sf1.orders");
  }
  if (!metadata.getTableHandle(new QualifiedTableName("default","default","lineitem")).isPresent()) {
    localQueryRunner.execute("CREATE TABLE lineitem AS SELECT * FROM tpch.sf1.lineitem");
  }
  return localQueryRunner;
}
