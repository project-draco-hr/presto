{
  checkArgument(!expression1.equals(expression2),"need to provide equality between different expressions");
  checkArgument(DeterminismEvaluator.isDeterministic(expression1),"Expression must be deterministic: " + expression1);
  checkArgument(DeterminismEvaluator.isDeterministic(expression2),"Expression must be deterministic: " + expression2);
  Expression canonical1=canonicalize(expression1);
  Expression canonical2=canonicalize(expression2);
  if (!canonical1.equals(canonical2)) {
    map.put(canonical1,canonical2);
    reverseMap.put(canonical2,canonical1);
  }
  return this;
}
