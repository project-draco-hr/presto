{
  Statement statement=unwrapExecuteStatement(sqlParser.createStatement(sql),sqlParser,session);
  assertFormattedSql(sqlParser,statement);
  PlanNodeIdAllocator idAllocator=new PlanNodeIdAllocator();
  QueryExplainer queryExplainer=new QueryExplainer(optimizerProvider.get(),metadata,accessControl,sqlParser,dataDefinitionTask,featuresConfig.isExperimentalSyntaxEnabled());
  Analyzer analyzer=new Analyzer(session,metadata,sqlParser,accessControl,Optional.of(queryExplainer),featuresConfig.isExperimentalSyntaxEnabled());
  Analysis analysis=analyzer.analyze(statement);
  return new LogicalPlanner(session,optimizerProvider.get(),idAllocator,metadata,sqlParser).plan(analysis);
}
