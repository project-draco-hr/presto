{
  requireNonNull(sourceTypes,"sourceType is null");
  return new OperatorFactory(){
    @Override public List<Type> getTypes(){
      return ImmutableList.of();
    }
    @Override public Operator createOperator(    DriverContext driverContext){
      OperatorContext operatorContext=driverContext.addOperatorContext(operatorId,MaterializingOperator.class.getSimpleName());
      MaterializingOperator operator=new MaterializingOperator(operatorContext,sourceTypes);
      if (!materializingOperator.compareAndSet(null,operator)) {
        throw new IllegalArgumentException("Output already created");
      }
      return operator;
    }
    @Override public void close(){
    }
    @Override public OperatorFactory duplicate(){
      throw new UnsupportedOperationException();
    }
  }
;
}
