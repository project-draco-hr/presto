{
  Iterable<SerializedPartitionChunk> chunks=supplier.get();
  List<Long> shardIds=shardManager.createImportPartition(tableId,partitionName,chunks);
  PartitionMarker partitionMarker=PartitionMarker.from(tableId,partitionName);
  checkState(partitionOperationTracker.claimPartition(partitionMarker,shardIds.size()));
  log.debug("retrieved partition chunks: %s: %s: %s",partitionName,shardIds.size(),shardIds);
  Iterator<Long> shardIdIter=shardIds.iterator();
  for (  SerializedPartitionChunk chunk : chunks) {
    checkState(shardIdIter.hasNext());
    Long shardId=shardIdIter.next();
    chunkBoundedExecutor.execute(shardId,new ChunkImportJob(partitionMarker,sourceName,shardId,chunk,fields));
  }
}
