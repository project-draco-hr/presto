{
  DriverContext driverContext=taskContext.addPipelineContext(true,true).addDriverContext();
  OperatorContext operatorContext=driverContext.addOperatorContext(0,ValuesOperator.class.getSimpleName());
  List<Type> buildTypes=ImmutableList.<Type>of(VARCHAR);
  RowPagesBuilder rowPagesBuilder=rowPagesBuilder(hashEnabled,Ints.asList(0),buildTypes);
  Operator buildOperator=new ValuesOperator(operatorContext,buildTypes,rowPagesBuilder.row("a").row("b").row("c").build());
  HashBuilderOperatorFactory hashBuilderOperatorFactory=new HashBuilderOperatorFactory(1,rowPagesBuilder.getTypes(),Ints.asList(0),rowPagesBuilder.getHashChannel(),100);
  Operator sourceHashProvider=hashBuilderOperatorFactory.createOperator(driverContext);
  Driver driver=new Driver(driverContext,buildOperator,sourceHashProvider);
  while (!driver.isFinished()) {
    driver.process();
  }
  List<Type> probeTypes=ImmutableList.<Type>of(VARCHAR);
  RowPagesBuilder rowPagesBuilderProbe=rowPagesBuilder(probeTypes);
  List<Page> probeInput=rowPagesBuilderProbe.row("a").row((String)null).row((String)null).row("a").row("b").build();
  OperatorFactory joinOperatorFactory=LookupJoinOperators.outerJoin(0,hashBuilderOperatorFactory.getLookupSourceSupplier(),rowPagesBuilderProbe.getTypes(),Ints.asList(0),rowPagesBuilderProbe.getHashChannel());
  Operator joinOperator=joinOperatorFactory.createOperator(taskContext.addPipelineContext(true,true).addDriverContext());
  MaterializedResult expected=MaterializedResult.resultBuilder(taskContext.getSession(),concat(probeTypes,buildTypes)).row("a","a").row(null,null).row(null,null).row("a","a").row("b","b").build();
  assertOperatorEquals(joinOperator,probeInput,expected,hashEnabled,ImmutableList.of(buildTypes.size() + probeTypes.size()));
}
