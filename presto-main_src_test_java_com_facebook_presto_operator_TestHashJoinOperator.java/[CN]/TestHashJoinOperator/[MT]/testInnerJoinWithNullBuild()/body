{
  Operator probeSource=createOperator(new Page(createStringsBlock("a","b","c")));
  Operator buildSource=createOperator(new Page(createStringsBlock("a",null,null,"a","b")));
  SourceHashSupplier sourceHashSupplier=new SourceHashSupplier(buildSource,0,10,new TaskMemoryManager(new DataSize(1,MEGABYTE)),new OperatorStats());
  HashJoinOperator joinOperator=HashJoinOperator.innerJoin(sourceHashSupplier,probeSource,0);
  Operator expected=createOperator(new Page(createStringsBlock("a","a","b"),createStringsBlock("a","a","b")));
  assertOperatorEquals(joinOperator,expected);
}
