{
  if (finishing || !buffer.isEmpty()) {
    return NOT_BLOCKED;
  }
  SettableFuture<?> settableFuture=SettableFuture.create();
  blockedCallers.add(settableFuture);
  return settableFuture;
}
