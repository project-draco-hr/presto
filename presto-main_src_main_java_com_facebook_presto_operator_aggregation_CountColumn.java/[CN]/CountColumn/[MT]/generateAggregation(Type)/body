{
  DynamicClassLoader classLoader=new DynamicClassLoader(CountColumn.class.getClassLoader());
  AccumulatorStateSerializer<LongState> stateSerializer=new StateCompiler().generateStateSerializer(LongState.class,classLoader);
  AccumulatorStateFactory<LongState> stateFactory=new StateCompiler().generateStateFactory(LongState.class,classLoader);
  Type intermediateType=stateSerializer.getSerializedType();
  List<Type> inputTypes=ImmutableList.of(type);
  AggregationMetadata metadata=new AggregationMetadata(generateAggregationName(NAME,BIGINT,inputTypes),createInputParameterMetadata(type),INPUT_FUNCTION,null,null,COMBINE_FUNCTION,OUTPUT_FUNCTION,LongState.class,stateSerializer,stateFactory,BIGINT,false);
  GenericAccumulatorFactoryBinder factory=new AccumulatorCompiler().generateAccumulatorFactoryBinder(metadata,classLoader);
  return new InternalAggregationFunction(NAME,inputTypes,intermediateType,BIGINT,true,false,factory);
}
