{
  boolean distinct=isDistinctOperator(node);
  PlanNode rewrittenNode=planRewriter.rewrite(node.getSource(),distinct);
  if (upstreamDistinct && distinct) {
    return rewrittenNode;
  }
  return new AggregationNode(node.getId(),rewrittenNode,node.getGroupBy(),node.getAggregations(),node.getFunctions(),node.getMasks());
}
