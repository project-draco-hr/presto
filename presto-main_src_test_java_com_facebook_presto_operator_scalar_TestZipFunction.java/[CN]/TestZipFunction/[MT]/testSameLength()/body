{
  assertFunction("zip(ARRAY[1, 2], ARRAY['a', 'b'])",zipReturnType(INTEGER,createVarcharType(1)),asList(asList(1,"a"),asList(2,"b")));
  assertFunction("zip(ARRAY[1, 2], ARRAY['a', CAST('b' AS VARCHAR)])",zipReturnType(INTEGER,VARCHAR),asList(asList(1,"a"),asList(2,"b")));
  assertFunction("zip(ARRAY[1, 2, 3, 4], ARRAY['a', 'b', 'c', 'd'])",zipReturnType(INTEGER,createVarcharType(1)),asList(asList(1,"a"),asList(2,"b"),asList(3,"c"),asList(4,"d")));
  assertFunction("zip(ARRAY[1, 2], ARRAY['a', 'b'],  ARRAY['c', 'd'])",zipReturnType(INTEGER,createVarcharType(1),createVarcharType(1)),asList(asList(1,"a","c"),asList(2,"b","d")));
  assertFunction("zip(ARRAY[1, 2], ARRAY['a', 'b'],  ARRAY['c', 'd'], ARRAY['e', 'f'])",zipReturnType(INTEGER,createVarcharType(1),createVarcharType(1),createVarcharType(1)),asList(asList(1,"a","c","e"),asList(2,"b","d","f")));
  assertFunction("zip(ARRAY[], ARRAY[])",zipReturnType(UNKNOWN,UNKNOWN),asList());
  assertFunction("zip(ARRAY[], ARRAY[], ARRAY[])",zipReturnType(UNKNOWN,UNKNOWN,UNKNOWN),asList());
  assertFunction("zip(ARRAY[], ARRAY[], ARRAY[], ARRAY[])",zipReturnType(UNKNOWN,UNKNOWN,UNKNOWN,UNKNOWN),asList());
  assertFunction("zip(ARRAY[NULL], ARRAY[NULL])",zipReturnType(UNKNOWN,UNKNOWN),asList(asList(null,null)));
  assertFunction("zip(ARRAY[ARRAY[1, 1], ARRAY[1, 2]], ARRAY[ARRAY[2, 1], ARRAY[2, 2]])",zipReturnType(new ArrayType(INTEGER),new ArrayType(INTEGER)),asList(asList(asList(1,1),asList(2,1)),asList(asList(1,2),asList(2,2))));
}
