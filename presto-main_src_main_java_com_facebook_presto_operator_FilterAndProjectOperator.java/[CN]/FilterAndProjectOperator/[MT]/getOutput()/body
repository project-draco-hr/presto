{
  if (!pageBuilder.isFull() && currentPage != null) {
    if (columnarProcessingDictionaryEnabled) {
      Page page=processor.processColumnarDictionary(operatorContext.getSession().toConnectorSession(),currentPage,getTypes());
      currentPage=null;
      currentPosition=0;
      return page;
    }
 else     if (columnarProcessingEnabled) {
      Page page=processor.processColumnar(operatorContext.getSession().toConnectorSession(),currentPage,getTypes());
      currentPage=null;
      currentPosition=0;
      return page;
    }
 else {
      currentPosition=processor.process(operatorContext.getSession().toConnectorSession(),currentPage,currentPosition,currentPage.getPositionCount(),pageBuilder);
      if (currentPosition == currentPage.getPositionCount()) {
        currentPage=null;
        currentPosition=0;
      }
    }
  }
  if (!finishing && !pageBuilder.isFull() || pageBuilder.isEmpty()) {
    return null;
  }
  Page page=pageBuilder.build();
  pageBuilder.reset();
  return page;
}
