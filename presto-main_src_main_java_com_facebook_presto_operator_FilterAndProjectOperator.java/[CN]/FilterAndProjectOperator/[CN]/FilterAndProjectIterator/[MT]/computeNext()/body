{
  BlockBuilder[] outputs=new BlockBuilder[projections.size()];
  for (int i=0; i < outputs.length; i++) {
    outputs[i]=new BlockBuilder(projections.get(i).getTupleInfo());
  }
  int outputCount=0;
  while (!isFull(outputs) && pageIterator.hasNext()) {
    Page page=pageIterator.next();
    Block[] blocks=page.getBlocks();
    outputCount+=filterAndProjectRowOriented(blocks,outputs);
  }
  if (outputCount == 0) {
    return endOfData();
  }
  Block[] blocks=new Block[projections.size()];
  for (int i=0; i < blocks.length; i++) {
    blocks[i]=outputs[i].build();
  }
  Page page=new Page(outputCount,blocks);
  return page;
}
