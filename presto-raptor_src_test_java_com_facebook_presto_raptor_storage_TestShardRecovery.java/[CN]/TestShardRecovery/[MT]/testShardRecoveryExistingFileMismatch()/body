{
  UUID shardUuid=UUID.randomUUID();
  File file=storageService.getStorageFile(shardUuid);
  storageService.createParents(file);
  File tempFile=createTempFile("tmp",null,temporary);
  Files.write("test data",tempFile,UTF_8);
  Files.write("bad data",file,UTF_8);
  backupStore.backupShard(shardUuid,tempFile);
  long backupSize=backupStore.shardSize(shardUuid).getAsLong();
  assertEquals(backupSize,tempFile.length());
  assertTrue(file.exists());
  assertNotEquals(file.length(),backupSize);
  recoveryManager.restoreFromBackup(shardUuid);
  assertTrue(file.exists());
  assertEquals(file.length(),backupSize);
}
