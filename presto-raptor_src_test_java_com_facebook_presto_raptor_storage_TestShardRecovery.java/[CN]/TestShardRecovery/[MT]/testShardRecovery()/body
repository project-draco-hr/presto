{
  UUID shardUuid=UUID.randomUUID();
  File file=storageService.getStorageFile(shardUuid);
  File tempFile=createTempFile("tmp",null,temporary);
  Files.write("test data",tempFile,UTF_8);
  backupStore.backupShard(shardUuid,tempFile);
  assertTrue(backupStore.getBackupFile(shardUuid).exists());
  assertEquals(backupStore.shardSize(shardUuid).getAsLong(),tempFile.length());
  recoveryManager.restoreFromBackup(shardUuid);
  assertTrue(file.exists());
  assertEquals(file.length(),tempFile.length());
}
