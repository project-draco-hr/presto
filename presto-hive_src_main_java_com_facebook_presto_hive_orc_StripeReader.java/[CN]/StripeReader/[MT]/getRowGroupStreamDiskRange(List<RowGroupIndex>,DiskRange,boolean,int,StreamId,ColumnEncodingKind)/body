{
  long start=streamDiskRange.getOffset() + getOffsetPositions(streamId,encoding,hasNulls,indexes.get(groupId).getPositions()).get(0);
  long end;
  if (groupId == indexes.size() - 1) {
    end=streamDiskRange.getEnd();
  }
 else {
    end=streamDiskRange.getOffset() + getOffsetPositions(streamId,encoding,hasNulls,indexes.get(groupId + 1).getPositions()).get(0);
    if (compressionKind != UNCOMPRESSED) {
      end+=2 * (BLOCK_HEADER_SIZE + bufferSize);
    }
 else {
      end+=WORST_UNCOMPRESSED_SLOP;
    }
    end=Math.min(streamDiskRange.getEnd(),end);
  }
  return new DiskRange(start,Ints.checkedCast(end - start));
}
