{
  long start=streamDiskRange.getOffset() + getOffsetPositions(streamId,encoding,hasNulls,index.getEntry(groupId).getPositionsList()).get(0);
  long end;
  if (groupId == index.getEntryCount() - 1) {
    end=streamDiskRange.getEnd();
  }
 else {
    end=streamDiskRange.getOffset() + getOffsetPositions(streamId,encoding,hasNulls,index.getEntry(groupId + 1).getPositionsList()).get(0);
    if (compressionKind != NONE) {
      end+=2 * (BLOCK_HEADER_SIZE + bufferSize);
    }
 else {
      end+=WORST_UNCOMPRESSED_SLOP;
    }
    end=Math.min(streamDiskRange.getEnd(),end);
  }
  return new DiskRange(start,Ints.checkedCast(end - start));
}
