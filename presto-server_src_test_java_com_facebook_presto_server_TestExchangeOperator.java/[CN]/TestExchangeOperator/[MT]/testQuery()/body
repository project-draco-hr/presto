{
  ExchangeOperator operator=new ExchangeOperator(exchangeClientFactory,TUPLE_INFOS);
  operator.addSplit(new RemoteSplit(scheduleTask(server1),TUPLE_INFOS));
  operator.addSplit(new RemoteSplit(scheduleTask(server2),TUPLE_INFOS));
  operator.addSplit(new RemoteSplit(scheduleTask(server3),TUPLE_INFOS));
  operator.noMoreSplits();
  int count=0;
  PageIterator iterator=operator.iterator(new OperatorStats());
  while (iterator.hasNext()) {
    Page page=iterator.next();
    BlockCursor cursor=page.getBlock(0).cursor();
    while (cursor.advanceNextPosition()) {
      count++;
    }
  }
  assertEquals(count,312 * 3);
}
