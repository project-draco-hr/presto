{
  return new RowExpressionVisitor<CompilerContext,ByteCodeNode>(){
    @Override public ByteCodeNode visitInputReference(    InputReferenceExpression node,    CompilerContext context){
      int field=node.getField();
      Type type=node.getType();
      Class<?> javaType=type.getJavaType();
      IfStatement ifStatement=new IfStatement();
      ifStatement.condition().setDescription(format("cursor.get%s(%d)",type,field)).getVariable(cursorVariable).push(field).invokeInterface(RecordCursor.class,"isNull",boolean.class,int.class);
      ifStatement.ifTrue().putVariable(wasNullVariable,true).pushJavaDefault(javaType);
      ifStatement.ifFalse().getVariable(cursorVariable).push(field).invokeInterface(RecordCursor.class,"get" + Primitives.wrap(javaType).getSimpleName(),javaType,int.class);
      return ifStatement;
    }
    @Override public ByteCodeNode visitCall(    CallExpression call,    CompilerContext context){
      throw new UnsupportedOperationException("not yet implemented");
    }
    @Override public ByteCodeNode visitConstant(    ConstantExpression literal,    CompilerContext context){
      throw new UnsupportedOperationException("not yet implemented");
    }
  }
;
}
