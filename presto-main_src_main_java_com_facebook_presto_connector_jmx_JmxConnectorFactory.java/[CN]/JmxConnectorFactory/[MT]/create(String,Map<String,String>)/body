{
  return new InternalConnector(){
    @Override public ConnectorHandleResolver getHandleResolver(){
      return new JmxHandleResolver();
    }
    @Override public ConnectorMetadata getMetadata(){
      return new JmxMetadata(new JmxConnectorId(connectorId),mbeanServer);
    }
    @Override public ConnectorSplitManager getSplitManager(){
      return new JmxSplitManager(new JmxConnectorId(connectorId),nodeManager);
    }
    @Override public ConnectorDataStreamProvider getDataStreamProvider(){
      return new JmxDataStreamProvider(new JmxConnectorId(connectorId),mbeanServer,nodeInfo);
    }
    @Override public ConnectorRecordSetProvider getRecordSetProvider(){
      throw new UnsupportedOperationException();
    }
    @Override public ConnectorRecordSinkProvider getRecordSinkProvider(){
      throw new UnsupportedOperationException();
    }
    @Override public ConnectorOutputHandleResolver getOutputHandleResolver(){
      throw new UnsupportedOperationException();
    }
  }
;
}
