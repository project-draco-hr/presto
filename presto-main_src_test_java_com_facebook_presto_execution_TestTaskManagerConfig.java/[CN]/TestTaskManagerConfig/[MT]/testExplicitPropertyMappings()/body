{
  Map<String,String> properties=new ImmutableMap.Builder<String,String>().put("task.initial-splits-per-node","1").put("task.split-concurrency-adjustment-interval","1s").put("task.status-refresh-max-wait","2s").put("task.info-update-interval","2s").put("task.verbose-stats","true").put("task.cpu-timer-enabled","false").put("task.max-index-memory","512MB").put("task.share-index-loading","true").put("task.operator-pre-allocated-memory","2MB").put("task.max-partial-aggregation-memory","32MB").put("task.max-worker-threads","3").put("task.min-drivers","2").put("task.info.max-age","22m").put("task.client.timeout","10s").put("sink.max-buffer-size","42MB").put("driver.max-page-partitioning-buffer-size","40MB").put("task.writer-count","3").put("task.concurrency","5").put("task.http-response-threads","4").put("task.http-timeout-threads","10").put("task.task-notification-threads","13").build();
  TaskManagerConfig expected=new TaskManagerConfig().setInitialSplitsPerNode(1).setSplitConcurrencyAdjustmentInterval(new Duration(1,TimeUnit.SECONDS)).setStatusRefreshMaxWait(new Duration(2,TimeUnit.SECONDS)).setInfoUpdateInterval(new Duration(2,TimeUnit.SECONDS)).setVerboseStats(true).setTaskCpuTimerEnabled(false).setMaxIndexMemoryUsage(new DataSize(512,Unit.MEGABYTE)).setShareIndexLoading(true).setOperatorPreAllocatedMemory(new DataSize(2,Unit.MEGABYTE)).setMaxPartialAggregationMemoryUsage(new DataSize(32,Unit.MEGABYTE)).setMaxWorkerThreads(3).setMinDrivers(2).setInfoMaxAge(new Duration(22,TimeUnit.MINUTES)).setClientTimeout(new Duration(10,TimeUnit.SECONDS)).setSinkMaxBufferSize(new DataSize(42,Unit.MEGABYTE)).setMaxPagePartitioningBufferSize(new DataSize(40,Unit.MEGABYTE)).setWriterCount(3).setTaskConcurrency(5).setHttpResponseThreads(4).setHttpTimeoutThreads(10).setTaskNotificationThreads(13);
  assertFullMapping(properties,expected);
}
