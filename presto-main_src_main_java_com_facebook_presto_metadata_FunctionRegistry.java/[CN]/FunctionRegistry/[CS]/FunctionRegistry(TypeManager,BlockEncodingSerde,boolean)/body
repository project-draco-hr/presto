{
  this.typeManager=checkNotNull(typeManager,"typeManager is null");
  this.blockEncodingSerde=checkNotNull(blockEncodingSerde,"blockEncodingSerde is null");
  specializedFunctionCache=CacheBuilder.newBuilder().maximumSize(1000).build(new CacheLoader<SpecializedFunctionKey,FunctionInfo>(){
    @Override public FunctionInfo load(    SpecializedFunctionKey key) throws Exception {
      return key.getFunction().specialize(key.getBoundTypeParameters(),key.getArity(),typeManager,FunctionRegistry.this);
    }
  }
);
  FunctionListBuilder builder=new FunctionListBuilder(typeManager).window("row_number",BIGINT,ImmutableList.<Type>of(),RowNumberFunction.class).window("rank",BIGINT,ImmutableList.<Type>of(),RankFunction.class).window("dense_rank",BIGINT,ImmutableList.<Type>of(),DenseRankFunction.class).window("percent_rank",DOUBLE,ImmutableList.<Type>of(),PercentRankFunction.class).window("cume_dist",DOUBLE,ImmutableList.<Type>of(),CumulativeDistributionFunction.class).window("ntile",BIGINT,ImmutableList.<Type>of(BIGINT),NTileFunction.class).window("first_value",BIGINT,ImmutableList.of(BIGINT),FirstValueFunction.class).window("first_value",DOUBLE,ImmutableList.of(DOUBLE),FirstValueFunction.class).window("first_value",BOOLEAN,ImmutableList.of(BOOLEAN),FirstValueFunction.class).window("first_value",VARCHAR,ImmutableList.of(VARCHAR),FirstValueFunction.class).window("first_value",TIMESTAMP,ImmutableList.of(TIMESTAMP),FirstValueFunction.class).window("last_value",BIGINT,ImmutableList.of(BIGINT),LastValueFunction.class).window("last_value",DOUBLE,ImmutableList.of(DOUBLE),LastValueFunction.class).window("last_value",BOOLEAN,ImmutableList.of(BOOLEAN),LastValueFunction.class).window("last_value",VARCHAR,ImmutableList.of(VARCHAR),LastValueFunction.class).window("last_value",TIMESTAMP,ImmutableList.of(TIMESTAMP),LastValueFunction.class).window("nth_value",BIGINT,ImmutableList.of(BIGINT,BIGINT),NthValueFunction.class).window("nth_value",DOUBLE,ImmutableList.of(DOUBLE,BIGINT),NthValueFunction.class).window("nth_value",BOOLEAN,ImmutableList.of(BOOLEAN,BIGINT),NthValueFunction.class).window("nth_value",VARCHAR,ImmutableList.of(VARCHAR,BIGINT),NthValueFunction.class).window("nth_value",TIMESTAMP,ImmutableList.of(TIMESTAMP,BIGINT),NthValueFunction.class).window("lag",BIGINT,ImmutableList.of(BIGINT),LagFunction.class).window("lag",BIGINT,ImmutableList.of(BIGINT,BIGINT),LagFunction.class).window("lag",BIGINT,ImmutableList.of(BIGINT,BIGINT,BIGINT),LagFunction.class).window("lag",DOUBLE,ImmutableList.of(DOUBLE),LagFunction.class).window("lag",DOUBLE,ImmutableList.of(DOUBLE,BIGINT),LagFunction.class).window("lag",DOUBLE,ImmutableList.of(DOUBLE,BIGINT,DOUBLE),LagFunction.class).window("lag",BOOLEAN,ImmutableList.of(BOOLEAN),LagFunction.class).window("lag",BOOLEAN,ImmutableList.of(BOOLEAN,BIGINT),LagFunction.class).window("lag",BOOLEAN,ImmutableList.of(BOOLEAN,BIGINT,BOOLEAN),LagFunction.class).window("lag",VARCHAR,ImmutableList.of(VARCHAR),LagFunction.class).window("lag",VARCHAR,ImmutableList.of(VARCHAR,BIGINT),LagFunction.class).window("lag",VARCHAR,ImmutableList.of(VARCHAR,BIGINT,VARCHAR),LagFunction.class).window("lag",TIMESTAMP,ImmutableList.of(TIMESTAMP),LagFunction.class).window("lag",TIMESTAMP,ImmutableList.of(TIMESTAMP,BIGINT),LagFunction.class).window("lag",TIMESTAMP,ImmutableList.of(TIMESTAMP,BIGINT,VARCHAR),LagFunction.class).window("lead",BIGINT,ImmutableList.of(BIGINT),LeadFunction.class).window("lead",BIGINT,ImmutableList.of(BIGINT,BIGINT),LeadFunction.class).window("lead",BIGINT,ImmutableList.of(BIGINT,BIGINT,BIGINT),LeadFunction.class).window("lead",DOUBLE,ImmutableList.of(DOUBLE),LeadFunction.class).window("lead",DOUBLE,ImmutableList.of(DOUBLE,BIGINT),LeadFunction.class).window("lead",DOUBLE,ImmutableList.of(DOUBLE,BIGINT,DOUBLE),LeadFunction.class).window("lead",BOOLEAN,ImmutableList.of(BOOLEAN),LeadFunction.class).window("lead",BOOLEAN,ImmutableList.of(BOOLEAN,BIGINT),LeadFunction.class).window("lead",BOOLEAN,ImmutableList.of(BOOLEAN,BIGINT,BOOLEAN),LeadFunction.class).window("lead",VARCHAR,ImmutableList.of(VARCHAR),LeadFunction.class).window("lead",VARCHAR,ImmutableList.of(VARCHAR,BIGINT),LeadFunction.class).window("lead",VARCHAR,ImmutableList.of(VARCHAR,BIGINT,VARCHAR),LeadFunction.class).window("lead",TIMESTAMP,ImmutableList.of(TIMESTAMP),LeadFunction.class).window("lead",TIMESTAMP,ImmutableList.of(TIMESTAMP,BIGINT),LeadFunction.class).window("lead",TIMESTAMP,ImmutableList.of(TIMESTAMP,BIGINT,VARCHAR),LeadFunction.class).aggregate(CountAggregation.class).aggregate(VarianceAggregation.class).aggregate(ApproximateLongPercentileAggregations.class).aggregate(ApproximateDoublePercentileAggregations.class).aggregate(CountIfAggregation.class).aggregate(BooleanAndAggregation.class).aggregate(BooleanOrAggregation.class).aggregate(DoubleSumAggregation.class).aggregate(LongSumAggregation.class).aggregate(AverageAggregations.class).aggregate(ApproximateCountDistinctAggregations.class).aggregate(MergeHyperLogLogAggregation.class).aggregate(ApproximateSetAggregation.class).aggregate(NumericHistogramAggregation.class).aggregate(CovarianceAggregation.class).aggregate(RegressionAggregation.class).aggregate(CorrelationAggregation.class).scalar(StringFunctions.class).scalar(VarbinaryFunctions.class).scalar(RegexpFunctions.class).scalar(UrlFunctions.class).scalar(MathFunctions.class).scalar(DateTimeFunctions.class).scalar(JsonFunctions.class).scalar(ColorFunctions.class).scalar(HyperLogLogFunctions.class).scalar(UnknownOperators.class).scalar(BooleanOperators.class).scalar(BigintOperators.class).scalar(DoubleOperators.class).scalar(VarcharOperators.class).scalar(VarbinaryOperators.class).scalar(DateOperators.class).scalar(TimeOperators.class).scalar(TimestampOperators.class).scalar(IntervalDayTimeOperators.class).scalar(IntervalYearMonthOperators.class).scalar(TimeWithTimeZoneOperators.class).scalar(TimestampWithTimeZoneOperators.class).scalar(DateTimeOperators.class).scalar(HyperLogLogOperators.class).scalar(LikeFunctions.class).scalar(ArrayFunctions.class).scalar(CombineHashFunction.class).scalar(JsonOperators.class).function(IDENTITY_CAST).functions(ARRAY_CONTAINS,ARRAY_JOIN,ARRAY_JOIN_WITH_NULL_REPLACEMENT).functions(ARRAY_MIN,ARRAY_MAX).functions(ARRAY_TO_ARRAY_CAST,ARRAY_HASH_CODE,ARRAY_EQUAL,ARRAY_NOT_EQUAL,ARRAY_LESS_THAN,ARRAY_LESS_THAN_OR_EQUAL,ARRAY_GREATER_THAN,ARRAY_GREATER_THAN_OR_EQUAL).functions(ARRAY_CONCAT_FUNCTION,ARRAY_TO_ELEMENT_CONCAT_FUNCTION,ELEMENT_TO_ARRAY_CONCAT_FUNCTION).functions(MAP_EQUAL,MAP_NOT_EQUAL,MAP_HASH_CODE).functions(ARRAY_CONSTRUCTOR,ARRAY_SUBSCRIPT,ARRAY_ELEMENT_AT_FUNCTION,ARRAY_CARDINALITY,ARRAY_POSITION,ARRAY_SORT_FUNCTION,ARRAY_INTERSECT_FUNCTION,ARRAY_TO_JSON,JSON_TO_ARRAY,ARRAY_DISTINCT_FUNCTION,ARRAY_REMOVE_FUNCTION,ARRAY_SLICE_FUNCTION).functions(MAP_CONSTRUCTOR,MAP_CARDINALITY,MAP_SUBSCRIPT,MAP_TO_JSON,JSON_TO_MAP,MAP_KEYS,MAP_VALUES,MAP_AGG).function(HISTOGRAM).function(ARBITRARY_AGGREGATION).function(ARRAY_AGGREGATION).function(LEAST).function(GREATEST).function(MAX_BY).function(MIN_BY).functions(MAX_AGGREGATION,MIN_AGGREGATION).function(COUNT_COLUMN).functions(ROW_HASH_CODE,ROW_TO_JSON,ROW_EQUAL,ROW_NOT_EQUAL).function(CONCAT).function(TRY_CAST);
  if (experimentalSyntaxEnabled) {
    builder.aggregate(ApproximateAverageAggregations.class).aggregate(ApproximateSumAggregations.class).aggregate(ApproximateCountAggregation.class).aggregate(ApproximateCountColumnAggregations.class);
  }
  addFunctions(builder.getFunctions());
}
