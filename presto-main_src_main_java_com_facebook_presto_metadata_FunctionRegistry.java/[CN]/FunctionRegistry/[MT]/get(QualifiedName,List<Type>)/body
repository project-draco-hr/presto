{
  for (  FunctionInfo functionInfo : functionsByName.get(name)) {
    if (functionInfo.getArgumentTypes().equals(parameterTypes)) {
      return functionInfo;
    }
  }
  for (  FunctionInfo functionInfo : functionsByName.get(name)) {
    if (canCoerce(parameterTypes,functionInfo)) {
      return functionInfo;
    }
  }
  List<String> expectedParameters=new ArrayList<>();
  for (  FunctionInfo functionInfo : functionsByName.get(name)) {
    expectedParameters.add(format("%s(%s)",name,Joiner.on(", ").join(functionInfo.getArgumentTypes())));
  }
  String parameters=Joiner.on(", ").useForNull("NULL").join(parameterTypes);
  String message=format("Function %s not registered",name);
  if (!expectedParameters.isEmpty()) {
    String expected=Joiner.on(", ").join(expectedParameters);
    message=format("Unexpected parameters (%s) for function %s. Expected: %s",parameters,name,expected);
  }
  throw new IllegalArgumentException(message);
}
