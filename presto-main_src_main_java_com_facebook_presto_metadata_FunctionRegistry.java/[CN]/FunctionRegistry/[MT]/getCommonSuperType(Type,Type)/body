{
  if (firstType.equals(UNKNOWN)) {
    return Optional.of(secondType);
  }
  if (secondType.equals(UNKNOWN)) {
    return Optional.of(firstType);
  }
  if (firstType.equals(secondType)) {
    return Optional.of(firstType);
  }
  if ((firstType.equals(BIGINT) || firstType.equals(DOUBLE)) && (secondType.equals(BIGINT) || secondType.equals(DOUBLE))) {
    return Optional.<Type>of(DOUBLE);
  }
  if ((firstType.equals(DATE) || firstType.equals(TIMESTAMP)) && (secondType.equals(DATE) || secondType.equals(TIMESTAMP))) {
    return Optional.<Type>of(TIMESTAMP);
  }
  if ((firstType.equals(DATE) || firstType.equals(TIMESTAMP_WITH_TIME_ZONE)) && (secondType.equals(DATE) || secondType.equals(TIMESTAMP_WITH_TIME_ZONE))) {
    return Optional.<Type>of(TIMESTAMP_WITH_TIME_ZONE);
  }
  if ((firstType.equals(TIME) || firstType.equals(TIME_WITH_TIME_ZONE)) && (secondType.equals(TIME) || secondType.equals(TIME_WITH_TIME_ZONE))) {
    return Optional.<Type>of(TIME_WITH_TIME_ZONE);
  }
  if ((firstType.equals(TIMESTAMP) || firstType.equals(TIMESTAMP_WITH_TIME_ZONE)) && (secondType.equals(TIMESTAMP) || secondType.equals(TIMESTAMP_WITH_TIME_ZONE))) {
    return Optional.<Type>of(TIMESTAMP_WITH_TIME_ZONE);
  }
  if (firstType instanceof ArrayType && secondType instanceof ArrayType) {
    Optional<Type> elementType=getCommonSuperType(((ArrayType)firstType).getElementType(),((ArrayType)secondType).getElementType());
    if (elementType.isPresent()) {
      return Optional.of(new ArrayType(elementType.get()));
    }
  }
  return Optional.empty();
}
