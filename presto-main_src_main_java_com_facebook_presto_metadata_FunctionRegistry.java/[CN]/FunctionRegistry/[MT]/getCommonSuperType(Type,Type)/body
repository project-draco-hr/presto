{
  if (firstType.equals(UNKNOWN)) {
    return Optional.of(secondType);
  }
  if (secondType.equals(UNKNOWN)) {
    return Optional.of(firstType);
  }
  if (firstType.equals(secondType)) {
    return Optional.of(firstType);
  }
  if ((firstType.equals(BIGINT) || firstType.equals(DOUBLE)) && (secondType.equals(BIGINT) || secondType.equals(DOUBLE))) {
    return Optional.<Type>of(DOUBLE);
  }
  if ((firstType.equals(TIME) || firstType.equals(TIME_WITH_TIME_ZONE)) && (secondType.equals(TIME) || secondType.equals(TIME_WITH_TIME_ZONE))) {
    return Optional.<Type>of(TIME_WITH_TIME_ZONE);
  }
  if ((firstType.equals(TIMESTAMP) || firstType.equals(TIMESTAMP_WITH_TIME_ZONE)) && (secondType.equals(TIMESTAMP) || secondType.equals(TIMESTAMP_WITH_TIME_ZONE))) {
    return Optional.<Type>of(TIMESTAMP_WITH_TIME_ZONE);
  }
  return Optional.absent();
}
