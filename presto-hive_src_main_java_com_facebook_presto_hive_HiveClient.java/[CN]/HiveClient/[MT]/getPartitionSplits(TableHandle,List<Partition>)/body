{
  checkNotNull(partitions,"partitions is null");
  Partition partition=Iterables.getFirst(partitions,null);
  if (partition == null) {
    return ImmutableList.of();
  }
  checkArgument(partition instanceof HivePartition,"Partition must be a hive partition");
  SchemaTableName tableName=((HivePartition)partition).getTableName();
  Optional<Integer> bucketNumber=((HivePartition)partition).getBucket();
  List<String> partitionNames=new ArrayList<>(Lists.transform(partitions,HiveUtil.partitionIdGetter()));
  Collections.sort(partitionNames,Ordering.natural().reverse());
  Table table;
  Iterable<org.apache.hadoop.hive.metastore.api.Partition> hivePartitions;
  try {
    table=metastore.getTable(tableName.getSchemaName(),tableName.getTableName());
    hivePartitions=getPartitions(table,tableName,partitionNames);
  }
 catch (  NoSuchObjectException e) {
    throw new TableNotFoundException(tableName);
  }
  return new HiveSplitIterable(connectorId,table,partitionNames,hivePartitions,bucketNumber,maxSplitSize,maxOutstandingSplits,maxSplitIteratorThreads,hdfsEnvironment,executor,maxPartitionBatchSize);
}
