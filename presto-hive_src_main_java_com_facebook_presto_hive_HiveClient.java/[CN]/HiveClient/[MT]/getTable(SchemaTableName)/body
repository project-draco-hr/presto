{
  try {
    Table table=metastore.getTable(tableName.getSchemaName(),tableName.getTableName());
    String protectMode=table.getParameters().get(ProtectMode.PARAMETER_NAME);
    if (protectMode != null && getProtectModeFromString(protectMode).offline) {
      throw new TableOfflineException(tableName);
    }
    String prestoOffline=table.getParameters().get(PRESTO_OFFLINE);
    if (!isNullOrEmpty(prestoOffline)) {
      throw new TableOfflineException(tableName,format("Table '%s' is offline for Presto: %s",tableName,prestoOffline));
    }
    return table;
  }
 catch (  NoSuchObjectException e) {
    throw new TableNotFoundException(tableName);
  }
}
