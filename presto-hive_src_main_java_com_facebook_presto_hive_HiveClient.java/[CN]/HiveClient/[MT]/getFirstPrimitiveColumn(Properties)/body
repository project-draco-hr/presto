{
  try {
    Deserializer deserializer=MetaStoreUtils.getDeserializer(null,schema);
    StructObjectInspector rowInspector=(StructObjectInspector)deserializer.getObjectInspector();
    int index=0;
    for (    StructField field : rowInspector.getAllStructFieldRefs()) {
      if (field.getFieldObjectInspector().getCategory() == ObjectInspector.Category.PRIMITIVE) {
        PrimitiveObjectInspector inspector=(PrimitiveObjectInspector)field.getFieldObjectInspector();
        SchemaField.Type type=getSupportedPrimitiveType(inspector.getPrimitiveCategory());
        return new HiveColumn(field.getFieldName(),index,type,inspector.getPrimitiveCategory());
      }
      index++;
    }
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
  throw new IllegalStateException("Table doesn't have any PRIMITIVE columns");
}
