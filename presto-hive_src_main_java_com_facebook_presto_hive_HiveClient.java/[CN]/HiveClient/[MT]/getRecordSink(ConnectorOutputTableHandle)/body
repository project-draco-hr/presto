{
  checkNotNull(tableHandle,"tableHandle is null");
  checkArgument(tableHandle instanceof HiveOutputTableHandle,"tableHandle is not an instance of HiveOutputTableHandle");
  HiveOutputTableHandle handle=(HiveOutputTableHandle)tableHandle;
  Path target=new Path(handle.getTemporaryPath(),randomUUID().toString());
  JobConf conf=new JobConf(hdfsEnvironment.getConfiguration(target));
  return new HiveRecordSink(handle,target,conf);
}
