{
  return new Function<String,HivePartition>(){
    @Override public HivePartition apply(    String partitionId){
      try {
        if (partitionId.equals(UNPARTITIONED_ID)) {
          return new HivePartition(tableName);
        }
        ImmutableMap.Builder<ColumnHandle,Comparable<?>> builder=ImmutableMap.builder();
        for (        Entry<String,String> entry : makeSpecFromName(partitionId).entrySet()) {
          ColumnHandle columnHandle=columnsByName.get(entry.getKey());
          checkArgument(columnHandle != null,"Invalid partition key %s in partition %s",entry.getKey(),partitionId);
          checkArgument(columnHandle instanceof HiveColumnHandle,"columnHandle is not an instance of HiveColumnHandle");
          HiveColumnHandle hiveColumnHandle=(HiveColumnHandle)columnHandle;
          String value=entry.getValue();
          Type type=hiveColumnHandle.getType();
          if (BOOLEAN.equals(type)) {
            if (value.isEmpty()) {
              builder.put(columnHandle,false);
            }
 else {
              builder.put(columnHandle,parseBoolean(value));
            }
          }
 else           if (BIGINT.equals(type)) {
            if (value.isEmpty()) {
              builder.put(columnHandle,0L);
            }
 else             if (hiveColumnHandle.getHiveType() == HiveType.TIMESTAMP) {
              builder.put(columnHandle,parseHiveTimestamp(value,timeZone));
            }
 else {
              builder.put(columnHandle,parseLong(value));
            }
          }
 else           if (DOUBLE.equals(type)) {
            if (value.isEmpty()) {
              builder.put(columnHandle,0.0);
            }
 else {
              builder.put(columnHandle,parseDouble(value));
            }
          }
 else           if (VARCHAR.equals(type)) {
            builder.put(columnHandle,utf8Slice(value));
          }
 else {
            throw new IllegalArgumentException(format("Unsupported partition type [%s] for partition: %s",type,partitionId));
          }
        }
        return new HivePartition(tableName,partitionId,builder.build(),bucket);
      }
 catch (      MetaException e) {
        throw Throwables.propagate(e);
      }
    }
  }
;
}
