{
  ImmutableList.Builder<HiveColumnHandle> columns=ImmutableList.builder();
  int hiveColumnIndex=0;
  for (  StructField field : getTableStructFields(table)) {
    HiveType hiveType=getHiveType(field.getFieldObjectInspector());
    if (hiveType != null && (includeSampleWeight || !field.getFieldName().equals(SAMPLE_WEIGHT_COLUMN_NAME))) {
      Type type=getType(field.getFieldObjectInspector(),typeManager);
      checkNotNull(type,"Unsupported hive type: %s",field.getFieldObjectInspector().getTypeName());
      columns.add(new HiveColumnHandle(connectorId,field.getFieldName(),hiveColumnIndex,hiveType,type.getTypeSignature().toString(),hiveColumnIndex,false));
    }
    hiveColumnIndex++;
  }
  List<FieldSchema> partitionKeys=table.getPartitionKeys();
  for (int i=0; i < partitionKeys.size(); i++) {
    FieldSchema field=partitionKeys.get(i);
    HiveType hiveType=getSupportedHiveType(field.getType());
    columns.add(new HiveColumnHandle(connectorId,field.getName(),hiveColumnIndex + i,hiveType,getType(field.getType()).getTypeSignature().toString(),-1,true));
  }
  return columns.build();
}
