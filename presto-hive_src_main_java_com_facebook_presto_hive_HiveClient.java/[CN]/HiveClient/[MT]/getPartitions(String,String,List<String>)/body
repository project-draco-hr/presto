{
  if (partitionNames.equals(ImmutableList.of(UnpartitionedPartition.UNPARTITIONED_NAME))) {
    return ImmutableList.<Partition>of(UnpartitionedPartition.INSTANCE);
  }
  ImmutableList.Builder<Partition> partitionsBuilder=ImmutableList.builder();
  for (  List<String> batchedPartitionNames : Lists.partition(partitionNames,partitionBatchSize)) {
    partitionsBuilder.addAll(metastore.getPartitionsByNames(databaseName,tableName,batchedPartitionNames));
  }
  return partitionsBuilder.build();
}
