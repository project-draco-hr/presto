{
  return new Function<String,Partition>(){
    @Override public Partition apply(    String partitionName){
      if (partitionName.equals(UNPARTITIONED_NAME)) {
        return new HivePartition(tableName,UNPARTITIONED_NAME,ImmutableMap.<ColumnHandle,String>of());
      }
      try {
        ImmutableMap.Builder<ColumnHandle,String> builder=ImmutableMap.builder();
        List<String> parts=Warehouse.getPartValuesFromPartName(partitionName);
        for (int i=0; i < parts.size(); i++) {
          builder.put(new HiveColumnHandle(keys.get(i)),parts.get(i));
        }
        return new HivePartition(tableName,partitionName,builder.build());
      }
 catch (      MetaException e) {
        throw Throwables.propagate(e);
      }
    }
  }
;
}
