{
  List<String> schemaNames;
  if (schemaNameOrNull == null) {
    schemaNames=listSchemaNames();
  }
 else {
    schemaNames=Collections.singletonList(schemaNameOrNull);
  }
  ImmutableList.Builder<SchemaTableName> tableNames=ImmutableList.builder();
  for (  String schemaName : schemaNames) {
    try {
      for (      String tableName : metastore.getAllTables(schemaName)) {
        tableNames.add(new SchemaTableName(schemaName,tableName));
      }
    }
 catch (    NoSuchObjectException e) {
    }
  }
  return tableNames.build();
}
