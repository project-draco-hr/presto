{
  return new Function<String,PartitionInfo>(){
    @Override public PartitionInfo apply(    String partitionName){
      if (partitionName.equals(UnpartitionedPartition.UNPARTITIONED_NAME)) {
        return new PartitionInfo(UnpartitionedPartition.UNPARTITIONED_NAME);
      }
      try {
        ImmutableMap.Builder<String,String> builder=ImmutableMap.builder();
        List<String> parts=Warehouse.getPartValuesFromPartName(partitionName);
        for (int i=0; i < parts.size(); i++) {
          builder.put(keys.get(i).getFieldName(),parts.get(i));
        }
        return new PartitionInfo(partitionName,builder.build());
      }
 catch (      MetaException e) {
        throw Throwables.propagate(e);
      }
    }
  }
;
}
