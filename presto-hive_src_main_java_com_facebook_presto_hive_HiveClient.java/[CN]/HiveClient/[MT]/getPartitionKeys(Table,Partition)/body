{
  if (partition instanceof UnpartitionedPartition) {
    return ImmutableList.of();
  }
  ImmutableList.Builder<HivePartitionKey> partitionKeys=ImmutableList.builder();
  List<FieldSchema> keys=table.getPartitionKeys();
  List<String> values=partition.getValues();
  checkArgument(keys.size() == values.size(),"Expected %s partition key values, but got %s",keys.size(),values.size());
  for (int i=0; i < keys.size(); i++) {
    String name=keys.get(i).getName();
    PrimitiveCategory hiveType=convertNativeHiveType(keys.get(i).getType());
    Type type=getSupportedPrimitiveType(hiveType);
    String value=values.get(i);
    checkNotNull(value,"partition key value cannot be null for field: %s",name);
    partitionKeys.add(new HivePartitionKey(name,type,hiveType,value));
  }
  return partitionKeys.build();
}
