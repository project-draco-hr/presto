{
  ImmutableMap.Builder<String,String> builder=ImmutableMap.builder();
  for (  FieldSchema field : concat(table.getSd().getCols(),table.getPartitionKeys())) {
    if (field.getComment() != null) {
      builder.put(field.getName(),field.getComment());
    }
  }
  final Map<String,String> columnComment=builder.build();
  return new Function<HiveColumnHandle,ColumnMetadata>(){
    @Override public ColumnMetadata apply(    HiveColumnHandle input){
      return new ColumnMetadata(input.getName(),typeManager.getType(parseTypeSignature(input.getTypeName())),input.getOrdinalPosition(),input.isPartitionKey(),columnComment.get(input.getName()),false);
    }
  }
;
}
