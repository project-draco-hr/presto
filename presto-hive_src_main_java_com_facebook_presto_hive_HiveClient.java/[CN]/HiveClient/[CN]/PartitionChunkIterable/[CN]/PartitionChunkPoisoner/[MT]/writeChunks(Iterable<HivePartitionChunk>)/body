{
  checkNotNull(chunks,"chunks is null");
  checkState(!done.get(),"already done");
  for (  HivePartitionChunk chunk : chunks) {
    HivePartitionChunk previousChunk=chunkHolder.getAndSet(chunk);
    if (previousChunk != null) {
      partitionChunkQueue.addToQueue(previousChunk);
    }
  }
}
