{
  checkState(!done.getAndSet(true),"already done");
  HivePartitionChunk finalChunk=chunkHolder.getAndSet(null);
  if (finalChunk != null) {
    partitionChunkQueue.addToQueue(makeLastChunk(finalChunk));
  }
}
