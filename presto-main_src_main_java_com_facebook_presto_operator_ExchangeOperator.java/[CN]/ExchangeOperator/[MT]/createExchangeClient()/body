{
  ExchangeClient exchangeClient;
synchronized (this) {
    checkState(activeClient == null,"ExchangeOperator can only be used once");
    exchangeClient=exchangeClientSupplier.get();
    for (    URI location : locations) {
      exchangeClient.addLocation(location);
    }
    if (noMoreLocations) {
      exchangeClient.noMoreLocations();
    }
    activeClient=exchangeClient;
  }
  exchangeClient.scheduleRequestIfNecessary();
  return exchangeClient;
}
