{
  try (Handle handle=dbi.open()){
    ShardManagerDao dao=handle.attach(ShardManagerDao.class);
    dao.dropTableTemporaryCreatedShards();
    dao.createTableTemporaryCreatedShards();
    dao.insertTemporaryCreatedShards();
    dao.insertDeletedShardsFromCreated();
    dao.deleteOldCreatedShards();
    dao.dropTableTemporaryCreatedShards();
    dao.dropTableTemporaryCreatedShardNodes();
    dao.createTableTemporaryCreatedShardNodes();
    dao.insertTemporaryCreatedShardNodes();
    dao.insertDeletedShardNodesFromCreated();
    dao.deleteOldCreatedShardNodes();
    dao.dropTableTemporaryCreatedShardNodes();
  }
 }
