{
  try (Handle handle=dbi.open()){
    ShardDao dao=shardDaoSupplier.attach(handle);
    dao.dropTableTemporaryCreatedShards();
    dao.createTableTemporaryCreatedShards();
    dao.insertTemporaryCreatedShards();
    dao.insertDeletedShardsFromCreated();
    dao.deleteOldCreatedShards();
    dao.dropTableTemporaryCreatedShards();
    dao.dropTableTemporaryCreatedShardNodes();
    dao.createTableTemporaryCreatedShardNodes();
    dao.insertTemporaryCreatedShardNodes();
    dao.insertDeletedShardNodesFromCreated();
    dao.deleteOldCreatedShardNodes();
    dao.dropTableTemporaryCreatedShardNodes();
  }
 }
