{
  while (!Thread.currentThread().isInterrupted()) {
    List<UUID> shards=dao.getOldCreatedShardsBatch();
    dao.insertDeletedShards(shards);
    dao.deleteCreatedShards(shards);
    List<ShardNodeId> shardNodes=dao.getOldCreatedShardNodesBatch();
    dao.insertDeletedShardNodes(shardNodes);
    dao.deleteCreatedShardNodes(shardNodes);
    if (shards.isEmpty() && shardNodes.isEmpty()) {
      break;
    }
  }
}
