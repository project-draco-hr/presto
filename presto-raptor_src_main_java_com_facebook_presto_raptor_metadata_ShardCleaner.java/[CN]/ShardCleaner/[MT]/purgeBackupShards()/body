{
  while (!Thread.currentThread().isInterrupted()) {
    List<UUID> uuids=dao.getPurgableShardsBatch(maxTimestamp(backupPurgeTime));
    if (uuids.isEmpty()) {
      break;
    }
    long start=System.nanoTime();
    executeDeletes(uuids);
    dao.deletePurgedShards(uuids);
    backupShardsPurged.update(uuids.size());
    log.info("Purged %s backup shards in %s",uuids.size(),nanosSince(start));
  }
}
