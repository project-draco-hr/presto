{
  while (!Thread.currentThread().isInterrupted()) {
    List<UUID> uuids=dao.getCleanableShardNodesBatch(currentNode,maxTimestamp(localCleanTime));
    if (uuids.isEmpty()) {
      break;
    }
    long start=System.nanoTime();
    for (    UUID uuid : uuids) {
      deleteFile(storageService.getStorageFile(uuid));
    }
    dao.updateCleanedShardNodes(uuids,getCurrentNodeId());
    log.info("Cleaned %s local shards in %s",uuids.size(),nanosSince(start));
  }
}
