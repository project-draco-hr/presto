{
  this.dbi=requireNonNull(dbi,"dbi is null");
  this.dao=onDemandDao(dbi,ShardManagerDao.class);
  this.currentNode=requireNonNull(currentNode,"currentNode is null");
  this.coordinator=coordinator;
  this.storageService=requireNonNull(storageService,"storageService is null");
  this.backupStore=requireNonNull(backupStore,"backupStore is null");
  this.maxTransactionAge=requireNonNull(maxTransactionAge,"maxTransactionAge");
  this.localCleanerInterval=requireNonNull(localCleanerInterval,"localCleanerInterval is null");
  this.localCleanTime=requireNonNull(localCleanTime,"localCleanTime is null");
  this.localPurgeTime=requireNonNull(localPurgeTime,"localPurgeTime is null");
  this.backupCleanerInterval=requireNonNull(backupCleanerInterval,"backupCleanerInterval is null");
  this.backupCleanTime=requireNonNull(backupCleanTime,"backupCleanTime is null");
  this.backupPurgeTime=requireNonNull(backupPurgeTime,"backupPurgeTime is null");
  this.scheduler=newScheduledThreadPool(2,daemonThreadsNamed("shard-cleaner-%s"));
  this.backupExecutor=newFixedThreadPool(backupDeletionThreads,daemonThreadsNamed("shard-cleaner-backup-%s"));
}
