{
  StreamPreferredProperties requiredProperties;
  StreamPreferredProperties preferredProperties;
  if (getTaskWriterCount(session) > 1) {
    requiredProperties=fixedParallelism(getTaskWriterCount(session));
    preferredProperties=fixedParallelism(getTaskWriterCount(session));
  }
 else {
    requiredProperties=singleStream();
    preferredProperties=defaultParallelism(session);
  }
  return planAndEnforceChildren(node,requiredProperties,preferredProperties);
}
