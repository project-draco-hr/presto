{
  List<Partition> partitions=splitManager.getPartitions(tableHandle,Optional.<Map<ColumnHandle,Object>>of(ImmutableMap.<ColumnHandle,Object>of(dsColumnHandle,"1")));
  assertEquals(partitions.size(),2);
  Expression nonMatching=new ComparisonExpression(Type.EQUAL,new QualifiedNameReference(new QualifiedName("ds")),new StringLiteral("1"));
  DataSource dataSource=splitManager.getSplits(session,tableHandle,BooleanLiteral.TRUE_LITERAL,nonMatching,Predicates.<Partition>alwaysTrue(),symbols);
  List<Split> splits=ImmutableList.copyOf(dataSource.getSplits());
  assertEquals(splits.size(),3);
}
