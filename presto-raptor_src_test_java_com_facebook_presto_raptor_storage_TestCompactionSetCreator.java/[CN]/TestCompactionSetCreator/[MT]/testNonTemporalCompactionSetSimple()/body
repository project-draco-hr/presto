{
  CompactionSetCreator compactionSetCreator=new FileCompactionSetCreator(new DataSize(1,KILOBYTE));
  Set<ShardMetadata> inputShards=ImmutableSet.of(shardWithSize(100),shardWithSize(100),shardWithSize(100));
  Set<CompactionSet> compactionSets=compactionSetCreator.createCompactionSets(1L,inputShards);
  assertEquals(compactionSets.size(),1);
  assertEquals(getOnlyElement(compactionSets).getShardsToCompact(),inputShards);
}
