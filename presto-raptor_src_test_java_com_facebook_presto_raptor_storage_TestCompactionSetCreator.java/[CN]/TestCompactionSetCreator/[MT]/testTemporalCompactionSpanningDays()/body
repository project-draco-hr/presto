{
  CompactionSetCreator compactionSetCreator=new TemporalCompactionSetCreator(new DataSize(100,BYTE));
  long tableId=1L;
  long day1=Duration.ofDays(Duration.ofMillis(System.currentTimeMillis()).toDays()).toMillis();
  long day2=Duration.ofDays(Duration.ofMillis(day1).toDays() + 1).toMillis();
  long day3=Duration.ofDays(Duration.ofMillis(day1).toDays() + 2).toMillis();
  long day4=Duration.ofDays(Duration.ofMillis(day1).toDays() + 3).toMillis();
  List<ShardMetadata> inputShards=ImmutableList.of(shardWithRange(10,day1,day3),shardWithRange(10,day2,day2),shardWithRange(10,day1,day1),shardWithRange(10,day1 + 100,day2 + 100),shardWithRange(10,day1 - 100,day2 - 100),shardWithRange(10,day2 - 100,day3 - 100),shardWithRange(10,day1,day4));
  Set<CompactionSet> compactionSets=compactionSetCreator.createCompactionSets(tableId,ImmutableSet.copyOf(inputShards));
  assertEquals(compactionSets.size(),2);
  Set<CompactionSet> expected=ImmutableSet.of(new CompactionSet(tableId,ImmutableSet.of(inputShards.get(0),inputShards.get(1),inputShards.get(5),inputShards.get(6))),new CompactionSet(tableId,ImmutableSet.of(inputShards.get(2),inputShards.get(3),inputShards.get(4))));
  assertEquals(compactionSets,expected);
}
