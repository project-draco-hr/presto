{
  if (!groups.containsKey(id)) {
    if (id.getParent().isPresent()) {
      ResourceGroup parent=groups.get(id.getParent().get());
      requireNonNull(parent,"parent is null");
      ResourceGroup group=parent.getOrCreateSubGroup(id.getLastSegment(),definition.getMaxConcurrent(),definition.getMaxQueued(),new DataSize(Long.MAX_VALUE,BYTE));
      checkState(groups.put(id,group) == null,"Unexpected existing resource group");
    }
 else {
      RootResourceGroup group=new RootResourceGroup(id.getSegments().get(0),definition.getMaxConcurrent(),definition.getMaxQueued(),new DataSize(Long.MAX_VALUE,BYTE),executor);
      rootGroups.add(group);
      checkState(groups.put(id,group) == null,"Unexpected existing resource group");
    }
  }
}
