{
  if (!groups.containsKey(id)) {
    ResourceGroup group;
    if (id.getParent().isPresent()) {
      ResourceGroup parent=groups.get(id.getParent().get());
      requireNonNull(parent,"parent is null");
      group=parent.getOrCreateSubGroup(id.getLastSegment());
    }
 else {
      RootResourceGroup root=new RootResourceGroup(id.getSegments().get(0),executor);
      group=root;
      rootGroups.add(root);
    }
    group.setSoftMemoryLimit(new DataSize(Long.MAX_VALUE,BYTE));
    group.setMaxQueuedQueries(definition.getMaxQueued());
    group.setMaxRunningQueries(definition.getMaxConcurrent());
    checkState(groups.put(id,group) == null,"Unexpected existing resource group");
  }
}
