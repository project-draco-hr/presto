{
  BiMap<Symbol,String> symbolToColumn=MapTransformer.of(mappings).transformValues(MoreFunctions.<ColumnHandle,ImportColumnHandle>cast(ImportColumnHandle.class)).transformValues(columnNameGetter()).biMap();
  Iterable<PartitionInfo> partitions=getCandidatePartitions(sourceName,databaseName,tableName,predicate,partitionPredicate,symbolToColumn);
  List<PartitionInfo> prunedPartitions=prunePartitions(session,partitions,predicate,symbolToColumn.inverse());
  return Lists.transform(prunedPartitions,partitionNameGetter());
}
