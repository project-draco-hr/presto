{
  Set<ComparisonExpression> comparisons=IterableTransformer.on(extractConjuncts(predicate)).select(instanceOf(ComparisonExpression.class)).cast(ComparisonExpression.class).select(or(matchesPattern(ComparisonExpression.Type.EQUAL,QualifiedNameReference.class,StringLiteral.class),matchesPattern(ComparisonExpression.Type.EQUAL,StringLiteral.class,QualifiedNameReference.class),matchesPattern(ComparisonExpression.Type.EQUAL,QualifiedNameReference.class,LongLiteral.class),matchesPattern(ComparisonExpression.Type.EQUAL,LongLiteral.class,QualifiedNameReference.class),matchesPattern(ComparisonExpression.Type.EQUAL,QualifiedNameReference.class,DoubleLiteral.class),matchesPattern(ComparisonExpression.Type.EQUAL,DoubleLiteral.class,QualifiedNameReference.class))).set();
  Set<String> partitionKeys=ImmutableSet.copyOf(getPartitionKeys(tableName));
  final Map<String,Object> bindings=new HashMap<>();
  for (  ComparisonExpression comparison : comparisons) {
    QualifiedNameReference reference=extractReference(comparison);
    Symbol symbol=Symbol.fromQualifiedName(reference.getName());
    String columnName=symbolToColumnName.get(symbol);
    if (columnName != null && partitionKeys.contains(columnName)) {
      Literal literal=extractLiteral(comparison);
      Object value;
      if (literal instanceof DoubleLiteral) {
        value=((DoubleLiteral)literal).getValue();
      }
 else       if (literal instanceof LongLiteral) {
        value=((LongLiteral)literal).getValue();
      }
 else       if (literal instanceof StringLiteral) {
        value=((StringLiteral)literal).getValue();
      }
 else {
        throw new AssertionError(String.format("Literal type (%s) not currently handled",literal.getClass().getName()));
      }
      Object previous=bindings.get(columnName);
      if (previous != null && !previous.equals(value)) {
        return ImmutableList.of();
      }
      bindings.put(columnName,value);
    }
  }
  return retry().stopOn(NotFoundException.class).stopOnIllegalExceptions().runUnchecked(new Callable<Iterable<PartitionInfo>>(){
    @Override public Iterable<PartitionInfo> call() throws Exception {
      ImportClient importClient=importClientManager.getClient(tableName.getCatalogName());
      return importClient.getPartitions(tableName.asSchemaTableName(),bindings);
    }
  }
);
}
