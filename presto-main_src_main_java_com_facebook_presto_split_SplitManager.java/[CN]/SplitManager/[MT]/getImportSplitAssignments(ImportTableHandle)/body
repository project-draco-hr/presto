{
  final String sourceName=handle.getSourceName();
  final String databaseName=handle.getDatabaseName();
  final String tableName=handle.getTableName();
  final List<String> partitions=runWithRetryUnchecked(new Callable<List<String>>(){
    @Override public List<String> call() throws Exception {
      ImportClient importClient=importClientFactory.getClient(sourceName);
      return importClient.getPartitionNames(databaseName,tableName);
    }
  }
);
  Iterable<List<PartitionChunk>> chunks=runWithRetryUnchecked(new Callable<Iterable<List<PartitionChunk>>>(){
    @Override public Iterable<List<PartitionChunk>> call() throws Exception {
      ImportClient importClient=importClientFactory.getClient(sourceName);
      return importClient.getPartitionChunks(databaseName,tableName,partitions);
    }
  }
);
  return Iterables.transform(Iterables.concat(chunks),createImportSplitFunction(sourceName));
}
