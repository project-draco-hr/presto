{
  String connectorId=layout.getConnectorId();
  ConnectorSplitManager splitManager=getConnectorSplitManager(connectorId);
  ConnectorSplitSource source;
  if (layout.getConnectorHandle() instanceof LegacyTableLayoutHandle) {
    LegacyTableLayoutHandle handle=(LegacyTableLayoutHandle)layout.getConnectorHandle();
    if (handle.getPartitions().isEmpty()) {
      return new ConnectorAwareSplitSource(connectorId,new FixedSplitSource(connectorId,ImmutableList.<ConnectorSplit>of()));
    }
    source=splitManager.getPartitionSplits(handle.getTable(),handle.getPartitions());
  }
 else {
    source=splitManager.getSplits(layout.getConnectorHandle());
  }
  return new ConnectorAwareSplitSource(connectorId,source);
}
