{
  Iterable<SplitAssignments> assignments;
switch (handle.getDataSourceType()) {
case NATIVE:
    assignments=getNativeSplitAssignments((NativeTableHandle)handle);
  break;
case INTERNAL:
assignments=getInternalSplitAssignments((InternalTableHandle)handle,predicate,mappings);
break;
case IMPORT:
assignments=getImportSplitAssignments(session,(ImportTableHandle)handle,predicate,mappings);
break;
default :
throw new IllegalArgumentException("unsupported handle type: " + handle);
}
return throwIfExceedsSize(assignments,maxSplitCount);
}
