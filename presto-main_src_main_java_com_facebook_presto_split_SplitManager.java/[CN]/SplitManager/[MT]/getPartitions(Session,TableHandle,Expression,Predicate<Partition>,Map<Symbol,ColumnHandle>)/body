{
  BiMap<Symbol,ColumnHandle> symbolToColumn=ImmutableBiMap.copyOf(mappings);
  List<Partition> partitions=getCandidatePartitions(table,predicate,symbolToColumn);
  partitions=ImmutableList.copyOf(filter(partitions,partitionPredicate));
  partitions=prunePartitions(session,partitions,predicate,symbolToColumn.inverse());
  return partitions;
}
