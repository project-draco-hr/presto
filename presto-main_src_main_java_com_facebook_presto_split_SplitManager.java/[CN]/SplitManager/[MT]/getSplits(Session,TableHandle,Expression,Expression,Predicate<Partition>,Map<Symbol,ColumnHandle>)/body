{
  List<Partition> partitions=getPartitions(session,handle,and(predicate,upstreamHint),partitionPredicate,mappings);
  ConnectorSplitManager connectorSplitManager=getConnectorSplitManager(handle);
  String connectorId=connectorSplitManager.getConnectorId();
  return new DataSource(connectorId,connectorSplitManager.getPartitionSplits(handle,partitions));
}
