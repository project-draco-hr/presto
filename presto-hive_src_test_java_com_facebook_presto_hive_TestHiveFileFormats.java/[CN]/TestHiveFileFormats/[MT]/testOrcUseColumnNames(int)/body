{
  HiveOutputFormat<?,?> outputFormat=new org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat();
  InputFormat<?,?> inputFormat=new org.apache.hadoop.hive.ql.io.orc.OrcInputFormat();
  @SuppressWarnings("deprecation") SerDe serde=new org.apache.hadoop.hive.ql.io.orc.OrcSerde();
  File file=File.createTempFile("presto_test","orc");
  file.delete();
  try {
    FileSplit split=createTestFile(file.getAbsolutePath(),outputFormat,serde,null,TEST_COLUMNS,rowCount);
    List<TestColumn> reversedColumns=Lists.reverse(TEST_COLUMNS);
    TestingConnectorSession session=new TestingConnectorSession(new HiveSessionProperties(new HiveClientConfig()).getSessionProperties());
    testPageSourceFactory(new OrcPageSourceFactory(TYPE_MANAGER,true),split,inputFormat,serde,reversedColumns,session,rowCount);
  }
  finally {
    file.delete();
  }
}
