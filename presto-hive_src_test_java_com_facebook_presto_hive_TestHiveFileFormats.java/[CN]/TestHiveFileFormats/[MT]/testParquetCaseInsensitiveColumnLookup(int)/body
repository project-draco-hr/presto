{
  List<TestColumn> writeColumns=ImmutableList.of(new TestColumn("column_name",javaStringObjectInspector,"test",utf8Slice("test"),false));
  List<TestColumn> readColumns=ImmutableList.of(new TestColumn("Column_Name",javaStringObjectInspector,"test",utf8Slice("test"),false));
  HiveOutputFormat<?,?> outputFormat=new MapredParquetOutputFormat();
  InputFormat<?,?> inputFormat=new MapredParquetInputFormat();
  @SuppressWarnings("deprecation") SerDe serde=new ParquetHiveSerDe();
  File file=File.createTempFile("presto_test","parquet");
  file.delete();
  try {
    FileSplit split=createTestFile(file.getAbsolutePath(),outputFormat,serde,null,writeColumns,rowCount);
    HiveRecordCursorProvider cursorProvider=new ParquetRecordCursorProvider(true);
    testCursorProvider(cursorProvider,split,inputFormat,serde,readColumns,rowCount);
  }
  finally {
    file.delete();
  }
}
