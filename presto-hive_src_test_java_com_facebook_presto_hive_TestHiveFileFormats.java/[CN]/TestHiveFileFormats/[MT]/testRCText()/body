{
  List<TestColumn> testColumns=ImmutableList.copyOf(filter(TEST_COLUMNS,new Predicate<TestColumn>(){
    @Override public boolean apply(    TestColumn testColumn){
      return !testColumn.getName().equals("t_struct_null");
    }
  }
));
  HiveOutputFormat<?,?> outputFormat=new RCFileOutputFormat();
  InputFormat<?,?> inputFormat=new RCFileInputFormat<>();
  @SuppressWarnings("deprecation") SerDe serde=new ColumnarSerDe();
  File file=File.createTempFile("presto_test","rc-text");
  try {
    FileSplit split=createTestFile(file.getAbsolutePath(),outputFormat,serde,null,testColumns);
    testCursorProvider(new ColumnarTextHiveRecordCursorProvider(),split,inputFormat,serde,testColumns);
    testCursorProvider(new GenericHiveRecordCursorProvider(),split,inputFormat,serde,testColumns);
  }
  finally {
    file.delete();
  }
}
