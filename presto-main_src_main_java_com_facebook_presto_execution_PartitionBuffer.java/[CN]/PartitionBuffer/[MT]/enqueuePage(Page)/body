{
  if (bufferedBytes.get() < maxBufferedBytes) {
    addToMasterBuffer(page);
    return immediateFuture(true);
  }
 else {
    QueuedPage queuedPage=new QueuedPage(page);
    queuedPages.add(queuedPage);
    return queuedPage.getFuture();
  }
}
