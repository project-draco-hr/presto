{
  BlockCursor valueCursor=blocks[0].cursor();
  int valueField=fields[0];
  while (valueCursor.advanceNextPosition()) {
    if (!valueCursor.isNull(valueField)) {
      double value=valueCursor.getDouble(valueField);
      currentValue.digest.add(doubleToSortableLong(value));
    }
  }
  BlockCursor percentileCursor=blocks[1].cursor();
  int percentileField=fields[1];
  if (percentileCursor.advanceNextPosition()) {
    if (!percentileCursor.isNull(percentileField)) {
      currentValue.percentile=percentileCursor.getDouble(percentileField);
    }
  }
  return currentValue;
}
