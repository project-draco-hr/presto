{
  DigestAndPercentile currentValue=digests.get((long)groupId);
  if (currentValue == null || currentValue.getDigest().getCount() == 0.0) {
    output.appendNull();
  }
 else {
    checkState(currentValue.getPercentile() != -1.0,"Percentile is missing");
    output.append(longToDouble(currentValue.getDigest().getQuantile(currentValue.getPercentile())));
  }
}
