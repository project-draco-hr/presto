{
  if (!advanceGroupByBlock()) {
    endOfData();
    return null;
  }
  Pair entry=currentGroupByBlock.next();
  Object groupByKey=entry.getValue();
  long startPosition=entry.getPosition();
  while (true) {
    while (currentGroupByBlock.hasNext() && currentGroupByBlock.peek().getValue().equals(groupByKey)) {
      entry=currentGroupByBlock.next();
    }
    if (!currentGroupByBlock.hasNext()) {
      if (!groupBySource.hasNext()) {
        break;
      }
      currentGroupByBlock=groupBySource.next().pairIterator();
    }
 else {
      break;
    }
  }
  long endPosition=entry.getPosition();
  return processGroup(Ranges.closed(startPosition,endPosition));
}
