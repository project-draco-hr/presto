{
  long transactionId=shardManager.beginTransaction();
  try {
    compactShards(transactionId,bucketNumber,tableId,shardUuids);
  }
 catch (  Throwable e) {
    shardManager.rollbackTransaction(transactionId);
    throw e;
  }
}
