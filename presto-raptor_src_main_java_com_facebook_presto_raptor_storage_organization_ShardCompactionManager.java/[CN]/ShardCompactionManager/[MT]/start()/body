{
  if (!compactionEnabled) {
    return;
  }
  if (!discoveryStarted.getAndSet(true)) {
    startDiscovery();
  }
  if (!compactionStarted.getAndSet(true)) {
    compactionDriverService.submit(new ShardCompactionDriver());
  }
}
