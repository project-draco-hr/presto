{
  indexSnapshot=indexLoader.getIndexSnapshot();
  long joinPosition=indexSnapshot.getJoinPosition(position,blocks);
  if (joinPosition == UNLOADED_INDEX_KEY) {
    indexSnapshot=indexLoader.getIndexSnapshotForKeys(position,blocks);
    joinPosition=indexSnapshot.getJoinPosition(position,blocks);
    checkState(joinPosition != UNLOADED_INDEX_KEY);
  }
  return joinPosition;
}
