{
  Set<Symbol> requiredTableScanOutputs=FluentIterable.from(context.get()).filter(in(ImmutableSet.copyOf(node.getOutputSymbols()))).toSet();
  List<Symbol> newOutputSymbols=FluentIterable.from(node.getOutputSymbols()).filter(in(requiredTableScanOutputs)).toList();
  Map<Symbol,ColumnHandle> newAssignments=Maps.filterKeys(node.getAssignments(),in(requiredTableScanOutputs));
  return new TableScanNode(node.getId(),node.getTable(),newOutputSymbols,newAssignments,node.getLayout(),node.getCurrentConstraint(),node.getOriginalConstraint());
}
