{
  ImmutableSet<Symbol> inputContext=ImmutableSet.<Symbol>builder().addAll(context.get()).addAll(node.getCorrelation()).build();
  PlanNode input=context.rewrite(node.getInput(),inputContext);
  PlanNode subquery=context.rewrite(node.getSubquery(),context.get());
  return new ApplyNode(node.getId(),input,subquery,node.getCorrelation());
}
