{
  Set<Symbol> expectedInputs=ImmutableSet.<Symbol>builder().addAll(expectedOutputs).addAll(DependencyExtractor.extract(node.getCriteria())).build();
  PlanNode left=planRewriter.rewrite(node.getLeft(),expectedInputs);
  PlanNode right=planRewriter.rewrite(node.getRight(),expectedInputs);
  return new JoinNode(left,right,node.getCriteria());
}
