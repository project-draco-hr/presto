{
  Set<Symbol> leftInputs=ImmutableSet.<Symbol>builder().addAll(expectedOutputs).addAll(Iterables.transform(node.getCriteria(),leftGetter())).build();
  Set<Symbol> rightInputs=ImmutableSet.<Symbol>builder().addAll(expectedOutputs).addAll(Iterables.transform(node.getCriteria(),rightGetter())).build();
  PlanNode left=planRewriter.rewrite(node.getLeft(),leftInputs);
  PlanNode right=planRewriter.rewrite(node.getRight(),rightInputs);
  return new JoinNode(node.getId(),node.getType(),left,right,node.getCriteria());
}
