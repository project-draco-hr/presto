{
  ImmutableSet.Builder<Symbol> expectedInputs=ImmutableSet.<Symbol>builder().addAll(expectedOutputs).addAll(node.getPartitionBy());
  PlanNode source=planRewriter.rewrite(node.getSource(),expectedInputs.build());
  return new RowNumberLimitNode(node.getId(),source,node.getPartitionBy(),node.getRowNumberSymbol(),node.getMaxRowCountPerPartition());
}
