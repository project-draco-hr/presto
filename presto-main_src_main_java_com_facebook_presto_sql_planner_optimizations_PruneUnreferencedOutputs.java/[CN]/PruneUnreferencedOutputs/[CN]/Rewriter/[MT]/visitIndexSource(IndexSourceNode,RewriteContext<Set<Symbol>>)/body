{
  List<Symbol> newOutputSymbols=FluentIterable.from(node.getOutputSymbols()).filter(in(context.get())).toList();
  Set<Symbol> newLookupSymbols=FluentIterable.from(node.getLookupSymbols()).filter(in(context.get())).toSet();
  Set<Symbol> requiredAssignmentSymbols=context.get();
  if (!node.getEffectiveTupleDomain().isNone()) {
    Set<Symbol> requiredSymbols=Maps.filterValues(node.getAssignments(),in(node.getEffectiveTupleDomain().getDomains().keySet())).keySet();
    requiredAssignmentSymbols=Sets.union(context.get(),requiredSymbols);
  }
  Map<Symbol,ColumnHandle> newAssignments=Maps.filterKeys(node.getAssignments(),in(requiredAssignmentSymbols));
  return new IndexSourceNode(node.getId(),node.getIndexHandle(),node.getTableHandle(),newLookupSymbols,newOutputSymbols,newAssignments,node.getEffectiveTupleDomain());
}
