{
  ImmutableSet.Builder<Symbol> expectedInputs=ImmutableSet.<Symbol>builder().addAll(node.getColumns());
  if (node.getSampleWeightSymbol().isPresent()) {
    expectedInputs.add(node.getSampleWeightSymbol().get());
  }
  PlanNode source=planRewriter.rewrite(node.getSource(),expectedInputs.build());
  return new TableWriterNode(node.getId(),source,node.getTarget(),node.getColumns(),node.getColumnNames(),node.getOutputSymbols(),node.getSampleWeightSymbol(),node.getCatalog(),node.getTableMetadata(),node.isSampleWeightSupported());
}
