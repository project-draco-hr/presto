{
  boolean empty=true;
  ImmutableMap.Builder<Symbol,ColumnHandle> assignments=ImmutableMap.builder();
  for (  Map.Entry<Symbol,ColumnHandle> entry : node.getAssignments().entrySet()) {
    Symbol symbol=entry.getKey();
    if (expectedOutputs.contains(symbol) || expectedOutputs.isEmpty() && Type.isNumeric(types.get(symbol))) {
      assignments.put(symbol,entry.getValue());
      empty=false;
      if (expectedOutputs.isEmpty()) {
        break;
      }
    }
  }
  if (empty) {
    Map.Entry<Symbol,ColumnHandle> first=Iterables.getFirst(node.getAssignments().entrySet(),null);
    assignments.put(first.getKey(),first.getValue());
  }
  return new TableScanNode(node.getId(),node.getTable(),assignments.build());
}
