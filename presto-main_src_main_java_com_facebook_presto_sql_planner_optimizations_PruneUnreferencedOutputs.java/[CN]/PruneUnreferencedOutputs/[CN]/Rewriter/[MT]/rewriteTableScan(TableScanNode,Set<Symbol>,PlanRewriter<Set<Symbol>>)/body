{
  Map<Symbol,ColumnHandle> assignments=new HashMap<>();
  for (  Map.Entry<Symbol,ColumnHandle> entry : node.getAssignments().entrySet()) {
    Symbol symbol=entry.getKey();
    if (expectedOutputs.contains(symbol) || expectedOutputs.isEmpty() && Type.isNumeric(types.get(symbol))) {
      assignments.put(symbol,entry.getValue());
      if (expectedOutputs.isEmpty()) {
        break;
      }
    }
  }
  if (assignments.isEmpty()) {
    Map.Entry<Symbol,ColumnHandle> first=Iterables.getFirst(node.getAssignments().entrySet(),null);
    assignments.put(first.getKey(),first.getValue());
  }
  return new TableScanNode(node.getId(),node.getTable(),assignments);
}
