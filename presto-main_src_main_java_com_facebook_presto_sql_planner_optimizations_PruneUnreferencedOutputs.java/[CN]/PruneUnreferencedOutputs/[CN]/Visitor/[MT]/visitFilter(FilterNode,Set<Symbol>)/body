{
  Set<Symbol> expectedInputs=ImmutableSet.<Symbol>builder().addAll(DependencyExtractor.extract(node.getPredicate())).addAll(expectedOutputs).build();
  PlanNode source=node.getSource().accept(this,expectedInputs);
  List<Symbol> outputs=ImmutableList.copyOf(Iterables.filter(source.getOutputSymbols(),in(expectedOutputs)));
  if (expectedOutputs.isEmpty()) {
    outputs=ImmutableList.copyOf(Iterables.limit(source.getOutputSymbols(),1));
  }
  return new FilterNode(source,node.getPredicate(),outputs);
}
