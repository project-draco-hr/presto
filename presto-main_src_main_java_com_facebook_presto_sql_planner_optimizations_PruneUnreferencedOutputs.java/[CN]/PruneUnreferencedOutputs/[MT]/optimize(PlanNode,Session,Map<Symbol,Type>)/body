{
  checkNotNull(plan,"plan is null");
  checkNotNull(session,"session is null");
  checkNotNull(types,"types is null");
  return PlanRewriter.rewriteWith(new Rewriter(types),plan,ImmutableSet.<Symbol>of());
}
