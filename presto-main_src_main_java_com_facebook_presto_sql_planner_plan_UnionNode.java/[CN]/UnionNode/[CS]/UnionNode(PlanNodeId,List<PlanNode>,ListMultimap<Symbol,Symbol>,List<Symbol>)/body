{
  super(id);
  requireNonNull(sources,"sources is null");
  checkArgument(!sources.isEmpty(),"Must have at least one source");
  requireNonNull(symbolMapping,"symbolMapping is null");
  requireNonNull(outputs,"outputs is null");
  this.sources=ImmutableList.copyOf(sources);
  this.symbolMapping=ImmutableListMultimap.copyOf(symbolMapping);
  this.outputs=ImmutableList.copyOf(outputs);
  for (  Collection<Symbol> symbols : this.symbolMapping.asMap().values()) {
    checkArgument(symbols.size() == this.sources.size(),"Every source needs to map its symbols to an output UNION symbol");
  }
  for (int i=0; i < sources.size(); i++) {
    for (    Collection<Symbol> symbols : this.symbolMapping.asMap().values()) {
      checkArgument(sources.get(i).getOutputSymbols().contains(Iterables.get(symbols,i)),"Source does not provide required symbols");
    }
  }
}
