{
  List<? extends StructField> allStructFieldRefs=getTableObjectInspector(schema).getAllStructFieldRefs();
  checkArgument(!allStructFieldRefs.isEmpty(),"Table doesn't have any columns");
  int index=0;
  for (  StructField field : allStructFieldRefs) {
    ObjectInspector inspector=field.getFieldObjectInspector();
    if (inspector.getCategory() == ObjectInspector.Category.PRIMITIVE) {
      return createHiveColumnHandle(clientId,index,field,inspector,typeManager);
    }
    index++;
  }
  StructField field=allStructFieldRefs.get(0);
  return createHiveColumnHandle(clientId,index,field,field.getFieldObjectInspector(),typeManager);
}
