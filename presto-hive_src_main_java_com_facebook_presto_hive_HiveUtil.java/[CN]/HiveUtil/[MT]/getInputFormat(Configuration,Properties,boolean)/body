{
  String inputFormatName=getInputFormatName(schema);
  try {
    JobConf jobConf=new JobConf(configuration);
    Class<? extends InputFormat> inputFormatClass=jobConf.getClassByName(inputFormatName).asSubclass(InputFormat.class);
    if (inputFormatClass == null) {
      inputFormatClass=TextInputFormat.class;
    }
 else     if (symlinkTarget && (inputFormatClass == SymlinkTextInputFormat.class)) {
      inputFormatClass=TextInputFormat.class;
    }
    return ReflectionUtils.newInstance(inputFormatClass,jobConf);
  }
 catch (  Exception e) {
    throw new RuntimeException("Unable to create input format " + inputFormatName,e);
  }
}
