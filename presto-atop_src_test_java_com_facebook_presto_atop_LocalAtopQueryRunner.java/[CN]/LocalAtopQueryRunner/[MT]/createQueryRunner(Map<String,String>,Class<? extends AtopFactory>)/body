{
  Session session=testSessionBuilder().setCatalog("atop").setSchema("default").setTimeZoneKey(TimeZoneKey.getTimeZoneKey(TimeZone.getDefault().getID())).build();
  LocalQueryRunner queryRunner=new LocalQueryRunner(session);
  try {
    NodeConfig nodeConfig=new NodeConfig().setEnvironment("test");
    AtopConnectorFactory connectorFactory=new AtopConnectorFactory(factoryClass,ImmutableMap.of(),LocalAtopQueryRunner.class.getClassLoader(),queryRunner.getTypeManager(),queryRunner.getNodeManager(),nodeConfig);
    ImmutableMap.Builder<String,String> properties=ImmutableMap.<String,String>builder().putAll(catalogProperties).put("atop.max-history-days","1");
    queryRunner.createCatalog("atop",connectorFactory,properties.build());
    return queryRunner;
  }
 catch (  Exception e) {
    closeAllSuppress(e,queryRunner);
    throw e;
  }
}
