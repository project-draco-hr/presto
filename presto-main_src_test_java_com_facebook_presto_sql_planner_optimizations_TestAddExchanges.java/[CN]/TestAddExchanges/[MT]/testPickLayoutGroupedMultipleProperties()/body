{
  Comparator<ActualProperties> preference=streamingExecutionPreference(PreferredProperties.local(ImmutableList.of(grouped("a"),grouped("b"))));
  List<ActualProperties> input=ImmutableList.<ActualProperties>builder().add(builder().global(distributed(partitioned(ImmutableSet.of(symbol("a"))))).build()).add(builder().global(undistributed()).build()).add(builder().global(distributed()).local(ImmutableList.of(grouped("a","b"))).build()).add(builder().global(distributed()).build()).add(builder().global(distributed(hashPartitioned(ImmutableList.of(symbol("a"))))).build()).add(builder().global(distributed(singlePartition())).local(ImmutableList.of(constant("a"),sorted("b",ASC_NULLS_FIRST))).build()).add(builder().global(undistributed()).local(ImmutableList.of(sorted("a",ASC_NULLS_FIRST))).build()).add(builder().global(distributed(hashPartitioned(ImmutableList.of(symbol("a"))))).build()).build();
  List<ActualProperties> expected=ImmutableList.<ActualProperties>builder().add(builder().global(distributed(singlePartition())).local(ImmutableList.of(constant("a"),sorted("b",ASC_NULLS_FIRST))).build()).add(builder().global(undistributed()).local(ImmutableList.of(sorted("a",ASC_NULLS_FIRST))).build()).add(builder().global(distributed(partitioned(ImmutableSet.of(symbol("a"))))).build()).add(builder().global(undistributed()).build()).add(builder().global(distributed()).local(ImmutableList.of(grouped("a","b"))).build()).add(builder().global(distributed()).build()).add(builder().global(distributed(hashPartitioned(ImmutableList.of(symbol("a"))))).build()).add(builder().global(distributed(hashPartitioned(ImmutableList.of(symbol("a"))))).build()).build();
  Assert.assertEquals(stableSort(input,preference),expected);
}
