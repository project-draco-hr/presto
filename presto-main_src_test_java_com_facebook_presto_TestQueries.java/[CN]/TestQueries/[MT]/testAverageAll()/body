{
  List<Tuple> expected=computeExpected("SELECT AVG(totalprice) FROM orders",DOUBLE);
  Operator orders=scanTable(ordersRecords,TOTALPRICE);
  Operator aggregation=new AggregationOperator(orders,ImmutableList.of(DoubleAverageAggregation.provider(0,0)),ImmutableList.of(singleColumn(DOUBLE,0,0)));
  assertEqualsIgnoreOrder(tuples(aggregation),expected);
}
