{
  checkArgument(!data.isEmpty(),"no data to insert");
  int columns=data.get(0).size();
  String vars=Joiner.on(',').join(nCopies(columns,"?"));
  String sql=format("INSERT INTO %s VALUES (%s)",table,vars);
  for (  List<List<String>> rows : Lists.partition(data,1000)) {
    PreparedBatch batch=handle.prepareBatch(sql);
    for (    List<String> row : rows) {
      checkArgument(row.size() == columns,"rows have differing column counts");
      PreparedBatchPart part=batch.add();
      for (int i=0; i < row.size(); i++) {
        part.bind(i,row.get(i));
      }
    }
    batch.execute();
  }
}
