{
  checkArgument(data.iterator(new OperatorStats()).hasNext(),"no data to insert");
  int columns=data.iterator(new OperatorStats()).next().getFieldCount();
  String vars=Joiner.on(',').join(nCopies(columns,"?"));
  String sql=format("INSERT INTO %s VALUES (%s)",table,vars);
  UnmodifiableIterator<List<Record>> partitions=Iterators.partition(data.iterator(new OperatorStats()),1000);
  while (partitions.hasNext()) {
    List<Record> partition=partitions.next();
    PreparedBatch batch=handle.prepareBatch(sql);
    for (    Record record : partition) {
      checkArgument(record.getFieldCount() == columns,"rows have differing column counts");
      PreparedBatchPart part=batch.add();
      for (int i=0; i < record.getFieldCount(); i++) {
        part.bind(i,new String(record.getString(i),UTF_8));
      }
    }
    batch.execute();
  }
}
