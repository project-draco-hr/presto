{
  TupleInfo sourceTupleInfo=new TupleInfo(VARIABLE_BINARY,FIXED_INT_64,DOUBLE,BOOLEAN);
  List<Page> input=rowPagesBuilder(sourceTupleInfo).row("b",-1,-0.1,true).row("a",2,0.3,false).row("a",4,0.2,true).pageBreak().row("b",5,0.4,false).row("a",6,0.1,true).build();
  NewOperator operator=new NewInMemoryWindowOperator(ImmutableList.of(sourceTupleInfo),0,ints(0),ROW_NUMBER,ints(0),ints(1),bools(true),10,new TaskMemoryManager(MAX_SIZE));
  MaterializedResult expected=resultBuilder(VARIABLE_BINARY,FIXED_INT_64,DOUBLE,BOOLEAN,FIXED_INT_64).row("a",2,0.3,false,1).row("a",4,0.2,true,2).row("a",6,0.1,true,3).row("b",-1,-0.1,true,1).row("b",5,0.4,false,2).build();
  assertOperatorEquals(operator,input,expected);
}
