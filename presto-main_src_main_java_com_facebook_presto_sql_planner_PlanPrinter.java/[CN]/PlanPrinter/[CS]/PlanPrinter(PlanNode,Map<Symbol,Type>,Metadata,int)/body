{
  checkNotNull(plan,"plan is null");
  checkNotNull(types,"types is null");
  checkNotNull(metadata,"metadata is null");
  this.metadata=metadata;
  Visitor visitor=new Visitor(types);
  plan.accept(visitor,indent);
}
