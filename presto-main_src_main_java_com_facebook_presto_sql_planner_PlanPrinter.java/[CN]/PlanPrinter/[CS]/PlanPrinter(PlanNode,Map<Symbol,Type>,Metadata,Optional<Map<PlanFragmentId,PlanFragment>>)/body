{
  checkNotNull(plan,"plan is null");
  checkNotNull(types,"types is null");
  checkNotNull(fragmentsById,"fragmentsById is null");
  checkNotNull(metadata,"metadata is null");
  this.metadata=metadata;
  Visitor visitor=new Visitor(types,fragmentsById);
  plan.accept(visitor,0);
}
