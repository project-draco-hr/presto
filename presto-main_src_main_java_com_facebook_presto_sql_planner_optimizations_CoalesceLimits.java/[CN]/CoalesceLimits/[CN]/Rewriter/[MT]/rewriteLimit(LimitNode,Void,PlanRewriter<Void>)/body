{
  PlanNode source=planRewriter.rewrite(node.getSource(),context);
  if (source instanceof LimitNode) {
    LimitNode limitNode=(LimitNode)source;
    return new LimitNode(node.getId(),limitNode.getSource(),Math.min(node.getCount(),limitNode.getCount()));
  }
 else   if (source != node.getSource()) {
    return new LimitNode(node.getId(),source,node.getCount());
  }
  return node;
}
