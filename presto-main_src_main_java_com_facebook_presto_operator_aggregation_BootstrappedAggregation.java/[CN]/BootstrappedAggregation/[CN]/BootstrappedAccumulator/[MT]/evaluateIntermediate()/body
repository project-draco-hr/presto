{
  Block[] blocks=new Block[accumulators.size()];
  int sizeEstimate=64 * accumulators.size();
  for (int i=0; i < accumulators.size(); i++) {
    blocks[i]=accumulators.get(i).evaluateIntermediate();
    sizeEstimate+=blocks[i].getDataSize().toBytes();
  }
  SliceOutput output=new DynamicSliceOutput(sizeEstimate);
  PagesSerde.writePages(blockEncodingManager,output,new Page(blocks));
  BlockBuilder builder=VARCHAR.createBlockBuilder(DEFAULT_MAX_BLOCK_SIZE);
  builder.append(output.slice());
  return builder.build();
}
