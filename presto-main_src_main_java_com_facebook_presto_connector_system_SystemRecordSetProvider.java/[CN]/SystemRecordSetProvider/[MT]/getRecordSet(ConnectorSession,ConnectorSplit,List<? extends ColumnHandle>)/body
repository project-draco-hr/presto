{
  SchemaTableName tableName=checkType(split,SystemSplit.class,"split").getTableHandle().getSchemaTableName();
  checkNotNull(columns,"columns is null");
  SystemTable systemTable=tables.get(tableName);
  checkArgument(systemTable != null,"Table %s does not exist",tableName);
  List<ColumnMetadata> tableColumns=systemTable.getTableMetadata().getColumns();
  Map<String,Integer> columnsByName=new HashMap<>();
  for (int i=0; i < tableColumns.size(); i++) {
    ColumnMetadata column=tableColumns.get(i);
    if (columnsByName.put(column.getName(),i) != null) {
      throw new PrestoException(INTERNAL_ERROR,"Duplicate column name: " + column.getName());
    }
  }
  ImmutableList.Builder<Integer> userToSystemFieldIndex=ImmutableList.builder();
  for (  ColumnHandle column : columns) {
    String columnName=checkType(column,SystemColumnHandle.class,"column").getColumnName();
    Integer index=columnsByName.get(columnName);
    if (index == null) {
      throw new PrestoException(INTERNAL_ERROR,format("Column does not exist: %s.%s",tableName,columnName));
    }
    userToSystemFieldIndex.add(index);
  }
  return new MappedRecordSet(toRecordSet(systemTable),userToSystemFieldIndex.build());
}
