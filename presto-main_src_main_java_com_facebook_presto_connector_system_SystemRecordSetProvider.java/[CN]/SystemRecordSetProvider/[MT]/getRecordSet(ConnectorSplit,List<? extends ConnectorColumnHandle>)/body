{
  SchemaTableName tableName=checkType(split,SystemSplit.class,"split").getTableHandle().getSchemaTableName();
  checkNotNull(columns,"columns is null");
  SystemTable systemTable=tables.get(tableName);
  checkArgument(systemTable != null,"Table %s does not exist",tableName);
  Map<String,ColumnMetadata> columnsByName=Maps.uniqueIndex(systemTable.getTableMetadata().getColumns(),columnNameGetter());
  ImmutableList.Builder<Integer> userToSystemFieldIndex=ImmutableList.builder();
  for (  ConnectorColumnHandle column : columns) {
    String columnName=checkType(column,SystemColumnHandle.class,"column").getColumnName();
    ColumnMetadata columnMetadata=columnsByName.get(columnName);
    checkArgument(columnMetadata != null,"Column %s.%s does not exist",tableName,columnName);
    userToSystemFieldIndex.add(columnMetadata.getOrdinalPosition());
  }
  return new MappedRecordSet(systemTable,userToSystemFieldIndex.build());
}
