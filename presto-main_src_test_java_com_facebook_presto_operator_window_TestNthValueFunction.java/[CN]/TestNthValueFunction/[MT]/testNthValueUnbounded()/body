{
  assertUnboundedWindowQuery("nth_value(orderkey, 2) OVER (PARTITION BY orderstatus ORDER BY orderkey)",resultBuilder(TEST_SESSION,BIGINT,VARCHAR,VARCHAR).row(3L,"F",5L).row(5L,"F",5L).row(6L,"F",5L).row(33L,"F",5L).row(1L,"O",2L).row(2L,"O",2L).row(4L,"O",2L).row(7L,"O",2L).row(32L,"O",2L).row(34L,"O",2L).build());
  assertUnboundedWindowQueryWithNulls("nth_value(orderkey, 2) OVER (PARTITION BY orderstatus ORDER BY orderkey)",resultBuilder(TEST_SESSION,BIGINT,VARCHAR,VARCHAR).row(3L,"F",5L).row(5L,"F",5L).row(null,"F",5L).row(null,"F",5L).row(34L,"O",null).row(null,"O",null).row(1L,null,7L).row(7L,null,7L).row(null,null,7L).row(null,null,7L).build());
  assertUnboundedWindowQuery("nth_value(orderkey, orderkey) OVER (PARTITION BY orderstatus ORDER BY orderkey)",resultBuilder(TEST_SESSION,BIGINT,VARCHAR,VARCHAR).row(3L,"F",6L).row(5L,"F",null).row(6L,"F",null).row(33L,"F",null).row(1L,"O",1L).row(2L,"O",2L).row(4L,"O",7L).row(7L,"O",null).row(32L,"O",null).row(34L,"O",null).build());
  assertUnboundedWindowQueryWithNulls("nth_value(orderkey, orderkey) OVER (PARTITION BY orderstatus ORDER BY orderkey DESC NULLS FIRST)",resultBuilder(TEST_SESSION,BIGINT,VARCHAR,VARCHAR).row(3L,"F",5L).row(5L,"F",null).row(null,"F",null).row(null,"F",null).row(34L,"O",null).row(null,"O",null).row(1L,null,null).row(7L,null,null).row(null,null,null).row(null,null,null).build());
  assertUnboundedWindowQuery("nth_value(orderkey, null) OVER (PARTITION BY orderstatus ORDER BY orderkey)",resultBuilder(TEST_SESSION,BIGINT,VARCHAR,VARCHAR).row(3L,"F",null).row(5L,"F",null).row(6L,"F",null).row(33L,"F",null).row(1L,"O",null).row(2L,"O",null).row(4L,"O",null).row(7L,"O",null).row(32L,"O",null).row(34L,"O",null).build());
  assertUnboundedWindowQuery("nth_value(orderkey, 8 * 1000 * 1000 * 1000) OVER (PARTITION BY orderstatus ORDER BY orderkey)",resultBuilder(TEST_SESSION,BIGINT,VARCHAR,VARCHAR).row(3L,"F",null).row(5L,"F",null).row(6L,"F",null).row(33L,"F",null).row(1L,"O",null).row(2L,"O",null).row(4L,"O",null).row(7L,"O",null).row(32L,"O",null).row(34L,"O",null).build());
}
