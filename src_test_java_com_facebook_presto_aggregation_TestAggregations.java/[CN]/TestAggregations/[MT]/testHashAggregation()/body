{
  GroupByBlockStream groupBy=new GroupByBlockStream(newGroupColumn());
  HashAggregationBlockStream aggregation=new HashAggregationBlockStream(groupBy,newAggregateColumn(),SumAggregation.PROVIDER);
  Map<Object,Object> expected=ImmutableMap.<Object,Object>of("apple",createTuple("apple",10L),"banana",createTuple("banana",17L),"cherry",createTuple("cherry",15L),"date",createTuple("date",6L));
  Map<Object,Object> actual=new HashMap<>();
  Cursor cursor=aggregation.cursor();
  while (cursor.advanceNextValue()) {
    Tuple tuple=cursor.getTuple();
    String key=tuple.getSlice(0).toString(UTF_8);
    actual.put(key,tuple);
  }
  Assert.assertEquals(actual,expected);
}
