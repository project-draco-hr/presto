{
  Map<String,Slot> assignments=new HashMap<>();
  for (  Map.Entry<String,Slot> entry : node.getAttributes().entrySet()) {
    Slot slot=entry.getValue();
    if (expectedOutputs.contains(slot) || expectedOutputs.isEmpty() && (slot.getType() == Type.LONG || slot.getType() == Type.DOUBLE)) {
      assignments.put(entry.getKey(),slot);
      if (expectedOutputs.isEmpty()) {
        break;
      }
    }
  }
  if (assignments.isEmpty()) {
    Map.Entry<String,Slot> first=Iterables.getFirst(node.getAttributes().entrySet(),null);
    assignments.put(first.getKey(),first.getValue());
  }
  return new TableScan(node.getCatalogName(),node.getSchemaName(),node.getTableName(),assignments);
}
