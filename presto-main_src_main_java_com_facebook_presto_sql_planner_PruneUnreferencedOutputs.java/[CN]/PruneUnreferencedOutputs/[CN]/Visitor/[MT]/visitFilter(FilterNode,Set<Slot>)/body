{
  Set<Slot> expectedInputs=ImmutableSet.<Slot>builder().addAll(new DependencyExtractor().extract(node.getPredicate())).addAll(expectedOutputs).build();
  PlanNode source=Iterables.getOnlyElement(node.getSources()).accept(this,expectedInputs);
  List<Slot> outputs=ImmutableList.copyOf(Iterables.filter(source.getOutputs(),in(expectedOutputs)));
  if (expectedOutputs.isEmpty()) {
    outputs=ImmutableList.copyOf(Iterables.limit(source.getOutputs(),1));
  }
  return new FilterNode(source,node.getPredicate(),outputs);
}
