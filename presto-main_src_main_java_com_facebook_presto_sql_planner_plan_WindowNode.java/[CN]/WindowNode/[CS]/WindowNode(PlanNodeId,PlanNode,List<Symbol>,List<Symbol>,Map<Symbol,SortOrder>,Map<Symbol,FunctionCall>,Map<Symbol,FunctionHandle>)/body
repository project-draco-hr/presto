{
  super(id);
  checkNotNull(source,"source is null");
  checkNotNull(partitionBy,"partitionBy is null");
  checkNotNull(orderBy,"orderBy is null");
  checkArgument(orderings.size() == orderBy.size(),"orderBy and orderings sizes don't match");
  checkNotNull(windowFunctions,"windowFunctions is null");
  checkNotNull(functionHandles,"functionHandles is null");
  checkArgument(windowFunctions.keySet().equals(functionHandles.keySet()),"windowFunctions does not match functionHandles");
  this.source=source;
  this.partitionBy=ImmutableList.copyOf(partitionBy);
  this.orderBy=ImmutableList.copyOf(orderBy);
  this.orderings=ImmutableMap.copyOf(orderings);
  this.windowFunctions=ImmutableMap.copyOf(windowFunctions);
  this.functionHandles=ImmutableMap.copyOf(functionHandles);
}
