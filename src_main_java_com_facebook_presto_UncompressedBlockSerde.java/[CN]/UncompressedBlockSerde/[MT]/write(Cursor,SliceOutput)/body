{
  UncompressedTupleInfoSerde.serialize(cursor.getTupleInfo(),new OutputStreamSliceOutput(out));
  DynamicSliceOutput buffer=new DynamicSliceOutput(MAX_BLOCK_SIZE);
  int tupleCount=0;
  while (cursor.hasNextPosition()) {
    cursor.advanceNextPosition();
    cursor.getTuple().writeTo(buffer);
    tupleCount++;
    if (buffer.size() > MAX_BLOCK_SIZE) {
      write(out,tupleCount,buffer.slice());
      tupleCount=0;
      buffer=new DynamicSliceOutput(MAX_BLOCK_SIZE);
    }
  }
  if (buffer.size() > 0) {
    write(out,tupleCount,buffer.slice());
  }
}
