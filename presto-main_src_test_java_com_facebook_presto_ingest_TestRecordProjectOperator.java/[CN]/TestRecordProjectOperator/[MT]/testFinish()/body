{
  InfiniteRecordSet records=new InfiniteRecordSet(ImmutableList.of(STRING,LONG),ImmutableList.of("abc",1L));
  RecordProjectOperator operator=new RecordProjectOperator(records);
  TaskOutput taskOutput=new TaskOutput(new TaskId("0","0","0"),URI.create("unknown://unknown"),1000);
  taskOutput.addResultQueue("unknown");
  taskOutput.noMoreResultQueues();
  int pageCount=0;
  PageIterator iterator=operator.iterator(new OperatorStats(taskOutput));
  while (iterator.hasNext()) {
    iterator.next();
    pageCount++;
    if (pageCount == 2) {
      taskOutput.finish();
    }
    if (pageCount > 2) {
      break;
    }
  }
  assertEquals(pageCount,2);
}
