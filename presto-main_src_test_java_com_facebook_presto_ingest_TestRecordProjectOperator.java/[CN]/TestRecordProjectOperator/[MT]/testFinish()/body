{
  InfiniteRecordSet records=new InfiniteRecordSet(ImmutableList.of(VARIABLE_BINARY,FIXED_INT_64),ImmutableList.of("abc",1L));
  RecordProjectOperator operator=new RecordProjectOperator(records,records.getColumns());
  TaskOutput taskOutput=new TaskOutput("unknown","unknown","unknown",URI.create("unknown://unknown"),ImmutableList.of("unknown"),1000);
  taskOutput.noMoreResultQueues();
  int pageCount=0;
  PageIterator iterator=operator.iterator(new OperatorStats(taskOutput));
  while (iterator.hasNext()) {
    iterator.next();
    pageCount++;
    if (pageCount == 2) {
      taskOutput.finish();
    }
    if (pageCount > 2) {
      break;
    }
  }
  assertEquals(pageCount,2);
}
