{
  DynamicSliceOutputSupplier sliceOutput=new DynamicSliceOutputSupplier(1024);
  BlocksFileWriter fileWriter=new BlocksFileWriter(VARCHAR,createTestingBlockEncodingManager(),sliceOutput);
  fileWriter.append(expectedBlock);
  fileWriter.append(expectedBlock);
  fileWriter.append(expectedBlock);
  fileWriter.close();
  Slice slice=sliceOutput.getLastSlice();
  BlocksFileReader actualBlocks=readBlocks(createTestingBlockEncodingManager(),slice);
  List<Object> actualValues=BlockAssertions.toValues(VARCHAR,actualBlocks);
  assertEquals(actualValues,expectedValues);
}
