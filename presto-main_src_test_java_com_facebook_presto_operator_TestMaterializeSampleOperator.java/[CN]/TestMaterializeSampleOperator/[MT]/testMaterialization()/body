{
  List<Page> input=rowPagesBuilder(SINGLE_LONG).addSequencePage(100,1).build();
  input=appendSampleWeight(input,2);
  OperatorFactory operatorFactory=new MaterializeSampleOperatorFactory(0,ImmutableList.of(SINGLE_LONG),1);
  Operator operator=operatorFactory.createOperator(driverContext);
  List<Page> expectedPages=rowPagesBuilder(SINGLE_LONG).addSequencePage(100,1).addSequencePage(100,1).build();
  MaterializedResult expected=resultBuilder(SINGLE_LONG).pages(expectedPages).build();
  OperatorAssertion.assertOperatorEqualsIgnoreOrder(operator,input,expected);
}
