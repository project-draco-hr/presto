{
  List<Page> pages=toPages(operator,input);
  List<Page> actualPages=dropChannel(pages,hashChannels);
  List<Type> expectedTypes=without(operator.getTypes(),hashChannels);
  MaterializedResult actual=toMaterializedResult(operator.getOperatorContext().getSession(),expectedTypes,actualPages);
  assertEquals(actual.getTypes(),expected.getTypes());
  assertEqualsIgnoreOrder(actual.getMaterializedRows(),expected.getMaterializedRows());
}
