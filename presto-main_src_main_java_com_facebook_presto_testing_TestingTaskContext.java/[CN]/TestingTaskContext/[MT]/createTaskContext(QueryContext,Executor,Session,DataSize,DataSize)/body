{
  return queryContext.addTaskContext(new TaskStateMachine(new TaskId("query","stage","task"),checkNotSameThreadExecutor(executor,"executor is null")),session,checkNotNull(maxMemory,"maxMemory is null"),preallocated,true,true);
}
