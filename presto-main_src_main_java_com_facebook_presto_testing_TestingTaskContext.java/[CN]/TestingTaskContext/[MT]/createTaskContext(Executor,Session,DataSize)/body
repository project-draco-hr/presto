{
  return new TaskContext(new TaskStateMachine(new TaskId("query","stage","task"),checkNotSameThreadExecutor(executor,"executor is null")),executor,session,checkNotNull(maxMemory,"maxMemory is null"),new DataSize(1,MEGABYTE),true,true);
}
