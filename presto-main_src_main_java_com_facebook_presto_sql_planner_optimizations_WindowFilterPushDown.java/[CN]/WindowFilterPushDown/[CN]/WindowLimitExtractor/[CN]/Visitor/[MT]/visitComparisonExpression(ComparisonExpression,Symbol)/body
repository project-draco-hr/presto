{
  Optional<QualifiedNameReference> reference=extractReference(node);
  Optional<Literal> literal=extractLiteral(node);
  if (!reference.isPresent() || !literal.isPresent()) {
    return null;
  }
  if (!Symbol.fromQualifiedName(reference.get().getName()).equals(rowNumberSymbol)) {
    return null;
  }
  long literalValue=extractValue(literal.get());
  if (node.getLeft() instanceof QualifiedNameReference && node.getRight() instanceof Literal) {
    if (node.getType() == ComparisonExpression.Type.LESS_THAN_OR_EQUAL) {
      return literalValue;
    }
    if (node.getType() == ComparisonExpression.Type.LESS_THAN) {
      return literalValue - 1;
    }
  }
 else   if (node.getLeft() instanceof Literal && node.getRight() instanceof QualifiedNameReference) {
    if (node.getType() == ComparisonExpression.Type.GREATER_THAN_OR_EQUAL) {
      return literalValue;
    }
    if (node.getType() == ComparisonExpression.Type.GREATER_THAN) {
      return literalValue - 1;
    }
  }
  return null;
}
