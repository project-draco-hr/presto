{
  QualifiedNameReference reference=extractReference(node);
  Literal literal=extractLiteral(node);
  if (!Symbol.fromQualifiedName(reference.getName()).equals(rowNumberSymbol)) {
    return null;
  }
  if (node.getLeft() instanceof QualifiedNameReference && node.getRight() instanceof Literal) {
    if (node.getType() == ComparisonExpression.Type.LESS_THAN_OR_EQUAL) {
      return extractValue(literal);
    }
 else     if (node.getType() == ComparisonExpression.Type.LESS_THAN) {
      return extractValue(literal) - 1;
    }
  }
 else   if (node.getLeft() instanceof Literal && node.getRight() instanceof QualifiedNameReference) {
    if (node.getType() == ComparisonExpression.Type.GREATER_THAN_OR_EQUAL) {
      return extractValue(literal);
    }
 else     if (node.getType() == ComparisonExpression.Type.GREATER_THAN) {
      return extractValue(literal) - 1;
    }
  }
  return null;
}
