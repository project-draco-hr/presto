{
  if (node.getCount() >= Integer.MAX_VALUE) {
    return context.defaultRewrite(node);
  }
  Constraint constraint=new Constraint(Optional.of((int)node.getCount()),Optional.empty());
  PlanNode rewrittenSource=context.rewrite(node.getSource(),constraint);
  if (rewrittenSource != node.getSource()) {
    return new LimitNode(idAllocator.getNextId(),rewrittenSource,node.getCount());
  }
  return context.defaultRewrite(node);
}
