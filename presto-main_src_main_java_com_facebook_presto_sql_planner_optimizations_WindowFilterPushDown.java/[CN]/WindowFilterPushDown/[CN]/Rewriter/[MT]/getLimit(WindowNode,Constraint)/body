{
  if (filter == null || (!filter.getLimit().isPresent() && !filter.getFilterExpression().isPresent())) {
    return Optional.empty();
  }
  if (filter.getLimit().isPresent()) {
    return filter.getLimit();
  }
  if (filterContainsWindowFunctions(node,filter.getFilterExpression().get()) && filter.getFilterExpression().get() instanceof ComparisonExpression) {
    Symbol rowNumberSymbol=Iterables.getOnlyElement(node.getWindowFunctions().entrySet()).getKey();
    return WindowLimitExtractor.extract(filter.getFilterExpression().get(),rowNumberSymbol);
  }
  return Optional.empty();
}
