{
  while (cursor.hasNextPosition()) {
    cursor.advanceNextPosition();
    Slice slice=cursor.getSlice(index);
    buffer.appendShort(slice.length() + SIZE_OF_SHORT);
    buffer.appendBytes(slice);
    tupleCount++;
    flushIfNecessary();
    if (cursor.getPosition() >= end) {
      return true;
    }
  }
  return false;
}
