{
  this.operatorContext=checkNotNull(operatorContext,"operatorContext is null");
  checkNotNull(step,"step is null");
  checkNotNull(functionDefinitions,"functionDefinitions is null");
  checkNotNull(operatorContext,"operatorContext is null");
  this.groupByTypes=groupByTypes;
  this.groupByChannels=groupByChannels;
  this.functionDefinitions=ImmutableList.copyOf(functionDefinitions);
  this.step=step;
  this.expectedGroups=expectedGroups;
  this.memoryManager=new HashMemoryManager(operatorContext);
  this.types=toTypes(groupByTypes,step,functionDefinitions);
}
