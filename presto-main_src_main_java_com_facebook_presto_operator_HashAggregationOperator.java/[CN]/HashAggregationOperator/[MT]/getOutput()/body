{
  if (outputIterator == null || !outputIterator.hasNext()) {
    if (aggregationBuilder == null) {
      return null;
    }
    if (!finishing && !aggregationBuilder.isFull()) {
      return null;
    }
    checkState(finishing || step == Step.PARTIAL,"Task exceeded max memory size of %s",memoryManager.getMaxMemorySize());
    outputIterator=aggregationBuilder.build();
    aggregationBuilder=null;
    if (!outputIterator.hasNext()) {
      return null;
    }
  }
  return outputIterator.next();
}
