{
  AggregationFunction function=functionDefinition.getFunction();
  if (function instanceof VariableWidthAggregationFunction) {
    return new VariableWidthAggregator((VariableWidthAggregationFunction)functionDefinition.getFunction(),functionDefinition.getInput(),step,expectedGroups);
  }
 else {
    return new FixedWidthAggregator((FixedWidthAggregationFunction)functionDefinition.getFunction(),functionDefinition.getInput(),step);
  }
}
