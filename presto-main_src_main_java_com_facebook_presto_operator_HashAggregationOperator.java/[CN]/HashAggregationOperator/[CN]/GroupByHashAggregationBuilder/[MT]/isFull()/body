{
  long memorySize=groupByHash.getEstimatedSize();
  for (  Aggregator aggregator : aggregators) {
    memorySize+=aggregator.getEstimatedSize();
  }
  memorySize-=operatorContext.getOperatorPreAllocatedMemory().toBytes();
  if (memorySize < 0) {
    memorySize=0;
  }
  try {
    operatorContext.setMemoryReservation(memorySize);
    return false;
  }
 catch (  ExceededMemoryLimitException e) {
    if (partial) {
      return true;
    }
    throw e;
  }
}
