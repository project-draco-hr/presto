{
  initializeLogging(false);
  ExecutorService executor=Executors.newCachedThreadPool();
  try {
    ApacheHttpClient httpClient=new ApacheHttpClient(new HttpClientConfig().setConnectTimeout(new Duration(1,TimeUnit.MINUTES)).setReadTimeout(new Duration(30,TimeUnit.MINUTES)));
    AsyncHttpClient asyncHttpClient=new AsyncHttpClient(httpClient,executor);
    QueryDriversTupleStream tupleStream=new QueryDriversTupleStream(new TupleInfo(Type.FIXED_INT_64),10,new HttpQueryProvider(query,asyncHttpClient,server));
    TuplePrinter tuplePrinter=new DelimitedTuplePrinter();
    Cursor cursor=tupleStream.cursor(new QuerySession());
    while (advanceNextPositionNoYield(cursor)) {
      Tuple tuple=cursor.getTuple();
      tuplePrinter.print(tuple);
    }
    log.info("Query complete.");
  }
  finally {
    executor.shutdownNow();
  }
}
