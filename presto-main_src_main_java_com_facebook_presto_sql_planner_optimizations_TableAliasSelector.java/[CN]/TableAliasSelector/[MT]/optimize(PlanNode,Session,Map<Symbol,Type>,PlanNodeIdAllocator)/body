{
  checkNotNull(plan,"plan is null");
  checkNotNull(session,"session is null");
  checkNotNull(types,"types is null");
  checkNotNull(idAllocator,"idAllocator is null");
  if (containsTableWriter(plan)) {
    return plan;
  }
  if (sitevars.isAliasEnabled()) {
    return PlanRewriter.rewriteWith(new Rewriter(),plan);
  }
 else {
    return plan;
  }
}
