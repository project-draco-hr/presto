{
  super(id);
  checkNotNull(table,"table is null");
  checkNotNull(outputSymbols,"outputSymbols is null");
  checkNotNull(assignments,"assignments is null");
  checkArgument(assignments.keySet().containsAll(outputSymbols),"assignments does not cover all of outputSymbols");
  checkArgument(!assignments.isEmpty(),"assignments is empty");
  checkNotNull(generatedPartitions,"generatedPartitions is null");
  this.table=table;
  this.outputSymbols=ImmutableList.copyOf(outputSymbols);
  this.assignments=ImmutableMap.copyOf(assignments);
  this.originalConstraint=originalConstraint;
  this.generatedPartitions=generatedPartitions;
  this.partitionsDroppedBySerialization=partitionsDroppedBySerialization;
  this.partitionDomainSummary=computePartitionsDomainSummary(generatedPartitions);
  checkArgument(partitionDomainSummary.isNone() || assignments.values().containsAll(partitionDomainSummary.getDomains().keySet()),"Assignments do not include all of the ColumnHandles specified by the Partitions");
}
