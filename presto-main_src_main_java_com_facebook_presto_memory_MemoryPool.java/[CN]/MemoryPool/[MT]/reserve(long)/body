{
  checkArgument(bytes >= 0,"bytes is negative");
  freeBytes-=bytes;
  if (freeBytes <= 0) {
    if (future == null) {
      future=SettableFuture.create();
    }
    checkState(!future.isDone(),"future is already completed");
    if (enableBlocking) {
      return future;
    }
  }
  return NOT_BLOCKED;
}
