{
  Configuration config=new Configuration();
  if (resourcePaths != null) {
    for (    String resourcePath : resourcePaths) {
      config.addResource(new Path(resourcePath));
    }
  }
  config.setClass("topology.node.switch.mapping.impl",NoOpDNSToSwitchMapping.class,DNSToSwitchMapping.class);
  if (socksProxy != null) {
    config.setClass("hadoop.rpc.socket.factory.class.default",SocksSocketFactory.class,SocketFactory.class);
    config.set("hadoop.socks.server",socksProxy.toString());
  }
  config.setBoolean("dfs.client.read.shortcircuit",true);
  if (domainSocketPath != null) {
    config.setStrings("dfs.domain.socket.path",domainSocketPath);
  }
  config.setInt("dfs.socket.timeout",Ints.checkedCast(dfsTimeout.toMillis()));
  config.setInt("ipc.ping.interval",Ints.checkedCast(dfsTimeout.toMillis()));
  config.setInt("ipc.client.connect.timeout",Ints.checkedCast(dfsConnectTimeout.toMillis()));
  config.setInt("ipc.client.connect.max.retries",dfsConnectMaxRetries);
  updateConfiguration(config);
  return config;
}
