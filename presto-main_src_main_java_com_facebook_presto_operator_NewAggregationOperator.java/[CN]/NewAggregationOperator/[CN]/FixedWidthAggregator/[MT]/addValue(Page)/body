{
  if (step == Step.FINAL) {
    BlockCursor cursor=page.getBlock(input.getChannel()).cursor();
    while (cursor.advanceNextPosition()) {
      function.addIntermediate(cursor,input.getField(),intermediateValue,0);
    }
  }
 else {
    Block block;
    int field=-1;
    if (input != null) {
      block=page.getBlock(input.getChannel());
      field=input.getField();
    }
 else {
      block=null;
    }
    function.addInput(page.getPositionCount(),block,field,intermediateValue,0);
  }
}
