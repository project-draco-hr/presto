{
  Preconditions.checkNotNull(queryId,"queryId is null");
  Preconditions.checkNotNull(stageId,"stageId is null");
  Preconditions.checkNotNull(taskId,"taskId is null");
  Preconditions.checkArgument(!taskId.isEmpty(),"taskId is empty");
  Preconditions.checkNotNull(fragment,"fragment is null");
  Preconditions.checkNotNull(outputIds,"outputIds is null");
  Preconditions.checkNotNull(splits,"splits is null");
  Preconditions.checkNotNull(exchangeSources,"exchangeSources is null");
  URI location=uriBuilderFrom(httpServerInfo.getHttpUri()).appendPath("v1/task").appendPath(taskId).build();
  SqlTaskExecution taskExecution=new SqlTaskExecution(queryId,stageId,taskId,location,fragment,splits,exchangeSources,outputIds,pageBufferMax,sourceProvider,metadata,shardExecutor);
  taskExecutor.submit(new TaskStarter(taskExecution));
  tasks.put(taskId,taskExecution);
  return taskExecution.getTaskInfo();
}
