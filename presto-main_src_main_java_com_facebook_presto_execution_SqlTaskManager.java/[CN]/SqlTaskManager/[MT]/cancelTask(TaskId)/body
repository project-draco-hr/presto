{
  checkNotNull(taskId,"taskId is null");
  TaskExecution taskExecution=tasks.get(taskId);
  if (taskExecution == null) {
    TaskInfo taskInfo=taskInfos.get(taskId);
    if (taskInfo == null) {
      TaskContext taskContext=new TaskContext(new TaskStateMachine(taskId,taskNotificationExecutor),taskManagementExecutor,null,maxTaskMemoryUsage,operatorPreAllocatedMemory);
      taskInfo=new TaskInfo(taskId,Long.MAX_VALUE,TaskState.CANCELED,URI.create("unknown"),DateTime.now(),new SharedBufferInfo(QueueState.FINISHED,0,0,ImmutableList.<BufferInfo>of()),ImmutableSet.<PlanNodeId>of(),taskContext.getTaskStats(),ImmutableList.<FailureInfo>of(),ImmutableMap.<PlanNodeId,Set<?>>of());
      TaskInfo existingTaskInfo=taskInfos.putIfAbsent(taskId,taskInfo);
      if (existingTaskInfo != null) {
        taskInfo=existingTaskInfo;
      }
    }
    return taskInfo;
  }
  taskExecution.cancel();
  return getTaskInfo(taskExecution,false);
}
