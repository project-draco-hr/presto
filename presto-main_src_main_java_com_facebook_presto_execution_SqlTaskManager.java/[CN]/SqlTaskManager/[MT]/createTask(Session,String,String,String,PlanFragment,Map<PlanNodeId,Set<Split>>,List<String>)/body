{
  Preconditions.checkNotNull(session,"session is null");
  Preconditions.checkNotNull(queryId,"queryId is null");
  Preconditions.checkNotNull(stageId,"stageId is null");
  Preconditions.checkNotNull(taskId,"taskId is null");
  Preconditions.checkArgument(!taskId.isEmpty(),"taskId is empty");
  Preconditions.checkNotNull(fragment,"fragment is null");
  Preconditions.checkNotNull(outputIds,"outputIds is null");
  Preconditions.checkNotNull(fixedSources,"fixedSources is null");
  URI location=uriBuilderFrom(httpServerInfo.getHttpUri()).appendPath("v1/task").appendPath(taskId).build();
  SqlTaskExecution taskExecution=new SqlTaskExecution(session,queryId,stageId,taskId,location,fragment,fixedSources,outputIds,pageBufferMax,dataStreamProvider,exchangeOperatorFactory,metadata,shardExecutor,maxOperatorMemoryUsage);
  tasks.put(taskId,taskExecution);
  return taskExecution.getTaskInfo();
}
