{
  Preconditions.checkNotNull(session,"session is null");
  Preconditions.checkNotNull(queryId,"queryId is null");
  Preconditions.checkNotNull(stageId,"stageId is null");
  Preconditions.checkNotNull(taskId,"taskId is null");
  Preconditions.checkArgument(!taskId.isEmpty(),"taskId is empty");
  Preconditions.checkNotNull(fragment,"fragment is null");
  Preconditions.checkNotNull(initialOutputIds,"initialOutputIds is null");
  Preconditions.checkNotNull(initialSources,"initialSources is null");
  URI location=uriBuilderFrom(httpServerInfo.getHttpUri()).appendPath("v1/task").appendPath(taskId).build();
  SqlTaskExecution taskExecution=SqlTaskExecution.createSqlTaskExecution(session,queryId,stageId,taskId,location,fragment,initialSources,initialOutputIds,pageBufferMax,dataStreamProvider,exchangeOperatorFactory,metadata,taskMasterExecutor,shardExecutor,maxOperatorMemoryUsage);
  tasks.put(taskId,taskExecution);
  return taskExecution.getTaskInfo();
}
