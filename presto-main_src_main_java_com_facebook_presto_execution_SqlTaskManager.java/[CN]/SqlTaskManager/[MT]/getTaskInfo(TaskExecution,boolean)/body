{
  TaskInfo taskInfo=taskExecution.getTaskInfo(full);
  if (taskInfo.getState().isDone()) {
    if (taskInfo.getStats().getEndTime() == null) {
      log.warn("Task %s is in done state %s but does not have an end time",taskInfo.getTaskId(),taskInfo.getState());
    }
    taskInfos.putIfAbsent(taskInfo.getTaskId(),taskInfo);
    tasks.remove(taskInfo.getTaskId());
  }
  return taskInfo;
}
