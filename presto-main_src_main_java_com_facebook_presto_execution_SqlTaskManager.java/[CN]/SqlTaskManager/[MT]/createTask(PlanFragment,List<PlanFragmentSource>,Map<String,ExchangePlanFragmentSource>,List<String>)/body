{
  Preconditions.checkNotNull(fragment,"fragment is null");
  Preconditions.checkNotNull(outputIds,"outputIds is null");
  Preconditions.checkNotNull(splits,"splits is null");
  Preconditions.checkNotNull(exchangeSources,"exchangeSources is null");
  String taskId=UUID.randomUUID().toString();
  URI location=uriBuilderFrom(httpServerInfo.getHttpUri()).appendPath("v1/presto/task").appendPath(taskId).build();
  SqlTaskExecution taskExecution=new SqlTaskExecution(taskId,location,fragment,splits,exchangeSources,outputIds,pageBufferMax,sourceProvider,metadata,shardExecutor);
  taskExecutor.submit(new TaskStarter(taskExecution));
  tasks.put(taskId,taskExecution);
  return taskExecution.getTaskInfo();
}
