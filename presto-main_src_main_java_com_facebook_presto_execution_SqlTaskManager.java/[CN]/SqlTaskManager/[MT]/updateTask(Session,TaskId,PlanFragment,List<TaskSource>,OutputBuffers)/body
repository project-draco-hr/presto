{
  URI location=locationFactory.createLocalTaskLocation(taskId);
  TaskExecution taskExecution;
synchronized (this) {
    taskExecution=tasks.get(taskId);
    if (taskExecution == null) {
      TaskInfo taskInfo=taskInfos.get(taskId);
      if (taskInfo != null) {
        return taskInfo;
      }
      taskExecution=SqlTaskExecution.createSqlTaskExecution(session,taskId,location,fragment,planner,maxBufferSize,taskMasterExecutor,shardExecutor,maxTaskMemoryUsage,queryMonitor,stats);
      tasks.put(taskId,taskExecution);
    }
  }
  taskExecution.recordHeartbeat();
  taskExecution.addSources(sources);
  taskExecution.addResultQueue(outputIds);
  return getTaskInfo(taskExecution,false);
}
