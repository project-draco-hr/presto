{
  URI location=locationFactory.createLocalTaskLocation(taskId);
  TaskExecution taskExecution;
synchronized (this) {
    taskExecution=tasks.get(taskId);
    if (taskExecution == null) {
      TaskInfo taskInfo=taskInfos.get(taskId);
      if (taskInfo != null) {
        return taskInfo;
      }
      taskExecution=SqlTaskExecution.createSqlTaskExecution(session,nodeInfo,taskId,location,fragment,pageBufferMax,dataStreamProvider,exchangeOperatorFactory,metadata,storageManager,taskMasterExecutor,shardExecutor,maxOperatorMemoryUsage,queryMonitor,stats);
      tasks.put(taskId,taskExecution);
    }
  }
  taskExecution.recordHeartbeat();
  taskExecution.addSources(sources);
  taskExecution.addResultQueue(outputIds);
  return taskExecution.getTaskInfo(false);
}
