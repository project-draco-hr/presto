{
  DateTime oldestAllowedTask=DateTime.now().minus(infoCacheTime.toMillis());
  for (  TaskInfo taskInfo : filter(transform(tasks.asMap().values(),SqlTask.taskInfoGetter()),notNull())) {
    try {
      DateTime endTime=taskInfo.getStats().getEndTime();
      if (endTime != null && endTime.isBefore(oldestAllowedTask)) {
        tasks.asMap().remove(taskInfo.getTaskId());
      }
    }
 catch (    RuntimeException e) {
      log.warn(e,"Error while inspecting age of complete task %s",taskInfo.getTaskId());
    }
  }
}
