{
  Preconditions.checkNotNull(metadata,"metadata is null");
  Preconditions.checkNotNull(sourceProvider,"sourceProvider is null");
  Preconditions.checkNotNull(httpServerInfo,"httpServerInfo is null");
  Preconditions.checkNotNull(config,"config is null");
  this.metadata=metadata;
  this.sourceProvider=sourceProvider;
  this.httpServerInfo=httpServerInfo;
  this.pageBufferMax=20;
  this.maxOperatorMemoryUsage=config.getMaxOperatorMemoryUsage();
  this.maxNumberOfGroups=config.getMaxNumberOfGroups();
  int processors=Runtime.getRuntime().availableProcessors();
  taskExecutor=new ThreadPoolExecutor(1000,1000,1,TimeUnit.MINUTES,new LinkedBlockingQueue<Runnable>(),threadsNamed("task-processor-%d"));
  shardExecutor=new FairBatchExecutor(8 * processors,threadsNamed("shard-processor-%d"));
}
