{
  checkNotNull(source,"source is null");
  checkArgument(setChannel >= 0,"setChannel must be greater than or equal to zero");
  checkArgument(expectedPositions >= 0,"expectedPositions must be greater than or equal to zero");
  checkNotNull(taskMemoryManager,"taskMemoryManager is null");
  checkNotNull(operatorStats,"operatorStats is null");
  TupleInfo tupleInfo=source.getTupleInfos().get(setChannel);
  checkArgument(tupleInfo.getFieldCount() == 1,"ChannelSet only supports single field set building channels");
  ChannelSetBuilder builder=new ChannelSetBuilder(tupleInfo,expectedPositions,taskMemoryManager);
  try (PageIterator pageIterator=source){
    while (pageIterator.hasNext() && !operatorStats.isDone()) {
      Block sourceBlock=pageIterator.next().getBlock(setChannel);
      builder.addBlock(sourceBlock);
    }
  }
   this.strategy=builder.strategy;
  this.addressValueSet=builder.addressValueSet;
  this.containsNull=builder.containsNull;
}
