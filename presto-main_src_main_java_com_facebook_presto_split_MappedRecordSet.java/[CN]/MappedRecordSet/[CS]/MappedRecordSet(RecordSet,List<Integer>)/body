{
  this.delegate=delegate;
  this.userToSystemFieldIndex=userToSystemFieldIndex;
  List<Type> delegateColumnTypes=delegate.getColumnTypes();
  ImmutableList.Builder<Type> columnTypes=ImmutableList.builder();
  for (  int systemField : userToSystemFieldIndex) {
    checkArgument(systemField >= 0 && systemField < delegateColumnTypes.size(),"Invalid system field %s",systemField);
    columnTypes.add(delegateColumnTypes.get(systemField));
  }
  this.columnTypes=columnTypes.build();
}
