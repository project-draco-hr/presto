{
  this.delegate=delegate;
  this.delegateFieldIndex=new int[delegateFieldIndex.size()];
  for (int i=0; i < delegateFieldIndex.size(); i++) {
    this.delegateFieldIndex[i]=delegateFieldIndex.get(i);
  }
  List<Type> delegateColumnTypes=delegate.getColumnTypes();
  ImmutableList.Builder<Type> columnTypes=ImmutableList.builder();
  for (  int delegateField : delegateFieldIndex) {
    checkArgument(delegateField >= 0 && delegateField < delegateColumnTypes.size(),"Invalid system field %s",delegateField);
    columnTypes.add(delegateColumnTypes.get(delegateField));
  }
  this.columnTypes=columnTypes.build();
}
