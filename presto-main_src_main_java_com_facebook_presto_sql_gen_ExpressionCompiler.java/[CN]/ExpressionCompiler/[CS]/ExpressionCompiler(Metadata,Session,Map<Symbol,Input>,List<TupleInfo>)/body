{
  this.metadata=checkNotNull(metadata,"metadata is null");
  this.session=checkNotNull(session,"session is null");
  this.layout=ImmutableMap.copyOf(checkNotNull(layout,"layout is null"));
  Builder<Input,Type> inputTypes=ImmutableMap.builder();
  for (  Input input : layout.values()) {
    TupleInfo.Type type=tupleInfos.get(input.getChannel()).getTypes().get(input.getField());
switch (type) {
case FIXED_INT_64:
      inputTypes.put(input,Type.LONG);
    break;
case VARIABLE_BINARY:
  inputTypes.put(input,Type.STRING);
break;
case DOUBLE:
inputTypes.put(input,Type.DOUBLE);
break;
default :
throw new IllegalArgumentException("Unsupported type " + type);
}
}
this.inputTypes=inputTypes.build();
FunctionBootstrap.metadataReference.set(metadata);
}
