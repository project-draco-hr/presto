{
  this.session=checkNotNull(session,"session is null");
  this.layout=ImmutableMap.copyOf(checkNotNull(layout,"layout is null"));
  Builder<Input,Type> inputTypes=ImmutableMap.builder();
  for (  Input input : layout.values()) {
    inputTypes.put(input,tupleInfos.get(input.getChannel()).getTypes().get(input.getField()));
  }
  this.inputTypes=inputTypes.build();
}
