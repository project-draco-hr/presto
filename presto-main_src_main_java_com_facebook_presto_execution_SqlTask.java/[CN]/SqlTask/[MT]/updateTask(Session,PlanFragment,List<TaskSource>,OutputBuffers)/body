{
  SqlTaskExecution taskExecution;
synchronized (this) {
    TaskHolder taskHolder=taskHolderReference.get();
    if (taskHolder.isFinished()) {
      return taskHolder.getFinalTaskInfo();
    }
    taskExecution=taskHolder.getTaskExecution();
    if (taskExecution == null) {
      try {
        taskExecution=sqlTaskExecutionFactory.create(session,taskStateMachine,sharedBuffer,fragment,sources);
        taskHolderReference.compareAndSet(taskHolder,new TaskHolder(taskExecution));
      }
 catch (      RuntimeException e) {
        failed(e);
      }
    }
  }
  lastHeartbeat.set(DateTime.now());
  if (taskExecution != null) {
    sharedBuffer.setOutputBuffers(outputBuffers);
    taskExecution.addSources(sources);
  }
  return getTaskInfo();
}
