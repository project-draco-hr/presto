{
  ServiceSelector selector=new StaticServiceSelector(serviceDescriptor("hive-metastore").addProperty("thrift","meta1.test:9083").addProperty("name","fuu").build(),serviceDescriptor("hive-metastore").addProperty("thrift","meta2.text:9083").addProperty("name","fuu").build(),serviceDescriptor("hive-metastore").addProperty("thrift","meta3.text:9083").addProperty("name","bar").build(),serviceDescriptor("hive-metastore").addProperty("thrift","missing-port").build(),serviceDescriptor("hive-metastore").build());
  ImportClientFactory factory=new ImportClientFactory(selector,new HiveClientConfig(),testExporter);
  assertInstanceOf(factory.getClient("hive_fuu"),CachingHiveClient.class);
  assertInstanceOf(factory.getClient("hive_bar"),CachingHiveClient.class);
}
