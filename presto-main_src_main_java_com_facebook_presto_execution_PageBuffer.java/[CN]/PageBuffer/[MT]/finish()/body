{
  state.compareAndSet(BufferState.OPEN,BufferState.FINISHING);
  if (buffer.isEmpty()) {
    state.set(BufferState.FINISHED);
    buffer.clear();
  }
}
