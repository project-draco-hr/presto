{
  Preconditions.checkNotNull(bufferId,"bufferId is null");
  Preconditions.checkNotNull(tupleInfos,"tupleInfos is null");
  Preconditions.checkArgument(sourceCount > 0,"sourceCount must be at least 1");
  Preconditions.checkArgument(pageBufferMax > 0,"pageBufferMax must be at least 1");
  this.bufferId=bufferId;
  this.tupleInfos=tupleInfos;
  this.sourceCount=sourceCount;
  this.pageBuffer=new ArrayDeque<>(pageBufferMax);
  this.notFull=new Semaphore(pageBufferMax);
  this.notEmpty=new Semaphore(0);
}
