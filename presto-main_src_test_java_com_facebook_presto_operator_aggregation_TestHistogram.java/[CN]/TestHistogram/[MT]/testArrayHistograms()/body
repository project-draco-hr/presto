{
  ArrayType arrayType=new ArrayType(VARCHAR);
  MapType mapType=new MapType(arrayType,BIGINT);
  InternalAggregationFunction aggregationFunction=metadata.getExactFunction(new Signature(NAME,mapType.getTypeSignature().toString(),arrayType.getTypeSignature().toString())).getAggregationFunction();
  PageBuilder builder=new PageBuilder(ImmutableList.of(arrayType));
  builder.declarePosition();
  arrayType.writeObject(builder.getBlockBuilder(0),arrayBlockOf(VARCHAR,"a","b","c"));
  builder.declarePosition();
  arrayType.writeObject(builder.getBlockBuilder(0),arrayBlockOf(VARCHAR,"d","e","f"));
  builder.declarePosition();
  arrayType.writeObject(builder.getBlockBuilder(0),arrayBlockOf(VARCHAR,"c","b","a"));
  assertAggregation(aggregationFunction,1.0,ImmutableMap.of(ImmutableList.of("a","b","c"),1L,ImmutableList.of("d","e","f"),1L,ImmutableList.of("c","b","a"),1L),builder.build());
}
