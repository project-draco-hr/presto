{
  OutputBuffers newOutputBuffers;
synchronized (this) {
    if (outputBuffers.isNoMoreBufferIds()) {
      return;
    }
    checkArgument(partition == BROADCAST_PARTITION_ID,"Broadcast partition must be %s",BROADCAST_PARTITION_ID);
    newOutputBuffers=outputBuffers.withBuffer(bufferId,partition);
    if (newOutputBuffers == outputBuffers) {
      return;
    }
    outputBuffers=newOutputBuffers;
  }
  outputBufferTarget.accept(newOutputBuffers);
}
