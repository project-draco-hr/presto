{
  checkState(!closed,"Factory is already closed");
  checkState(bufferIndex < inMemoryExchange.getBufferCount(),"All operators already created");
  OperatorContext operatorContext=driverContext.addOperatorContext(operatorId,planNodeId,InMemoryExchangeSourceOperator.class.getSimpleName());
  Operator operator=new InMemoryExchangeSourceOperator(operatorContext,inMemoryExchange,bufferIndex);
  if (broadcast) {
    bufferIndex++;
  }
  return operator;
}
