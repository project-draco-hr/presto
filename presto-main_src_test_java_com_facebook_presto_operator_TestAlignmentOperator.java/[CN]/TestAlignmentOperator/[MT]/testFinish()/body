{
  Operator operator=createAlignmentOperator();
  assertEquals(operator.isFinished(),false);
  assertEquals(operator.needsInput(),false);
  assertPageEquals(operator.getOutput(),rowPageBuilder(SINGLE_VARBINARY,SINGLE_LONG).row("alice",0).row("bob",1).row("charlie",2).row("dave",3).build());
  assertEquals(operator.isFinished(),false);
  assertEquals(operator.needsInput(),false);
  assertPageEquals(operator.getOutput(),rowPageBuilder(SINGLE_VARBINARY,SINGLE_LONG).row("alice",4).row("bob",5).row("charlie",6).row("dave",7).build());
  assertEquals(operator.isFinished(),false);
  assertEquals(operator.needsInput(),false);
  operator.finish();
  assertEquals(operator.isFinished(),true);
  assertEquals(operator.needsInput(),false);
  assertEquals(operator.getOutput(),null);
}
