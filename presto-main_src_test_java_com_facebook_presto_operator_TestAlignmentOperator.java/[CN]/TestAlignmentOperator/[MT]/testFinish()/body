{
  AlignmentOperator operator=createAlignmentOperator();
  TaskOutput taskOutput=new TaskOutput(new TaskId("0","0","0"),URI.create("unknown://unknown"),new DataSize(100,Unit.MEGABYTE),executor,new SqlTaskManagerStats());
  taskOutput.addResultQueue("unknown");
  taskOutput.noMoreResultQueues();
  int pageCount=0;
  PageIterator iterator=operator.iterator(new OperatorStats(taskOutput));
  while (iterator.hasNext()) {
    iterator.next();
    pageCount++;
    if (pageCount == 2) {
      taskOutput.finish();
    }
    if (pageCount > 2) {
      break;
    }
  }
  assertEquals(pageCount,2);
}
