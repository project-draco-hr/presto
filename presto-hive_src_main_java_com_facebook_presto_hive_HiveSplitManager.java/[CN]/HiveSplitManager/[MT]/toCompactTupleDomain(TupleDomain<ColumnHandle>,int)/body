{
  ImmutableMap.Builder<HiveColumnHandle,Domain> builder=ImmutableMap.builder();
  for (  Map.Entry<ColumnHandle,Domain> entry : effectivePredicate.getDomains().entrySet()) {
    HiveColumnHandle hiveColumnHandle=checkType(entry.getKey(),HiveColumnHandle.class,"ConnectorColumnHandle");
    SortedRangeSet ranges=entry.getValue().getRanges();
    if (ranges.getRangeCount() > threshold) {
      ranges=SortedRangeSet.of(ranges.getSpan());
    }
    builder.put(hiveColumnHandle,new Domain(ranges,entry.getValue().isNullAllowed()));
  }
  return TupleDomain.withColumnDomains(builder.build());
}
