{
  Preconditions.checkNotNull(source,"source is null");
  Preconditions.checkNotNull(functionProvider,"functionProvider is null");
  this.groupBySource=source;
  this.functionProvider=functionProvider;
  groupByTypeInfo=new TupleInfo(source.getTupleInfo().getTypes().subList(0,source.getTupleInfo().getFieldCount() - 1));
  info=new TupleInfo(ImmutableList.<Type>builder().addAll(groupByTypeInfo.getTypes()).addAll(functionProvider.get().getTupleInfo().getTypes()).build());
}
