{
  checkArgument(page.getChannelCount() == columnTypes.size(),"channelCount does not match");
  for (int channel=0; channel < page.getChannelCount(); channel++) {
    Object value=getValue(position,page.getBlock(channel),columnTypes.get(channel));
    tableInspector.setStructFieldData(row,structFields.get(channel),value);
  }
  try {
    recordWriter.write(serializer.serialize(row,tableInspector));
  }
 catch (  IOException e) {
    throw new PrestoException(RAPTOR_ERROR,"Failed to write record",e);
  }
}
