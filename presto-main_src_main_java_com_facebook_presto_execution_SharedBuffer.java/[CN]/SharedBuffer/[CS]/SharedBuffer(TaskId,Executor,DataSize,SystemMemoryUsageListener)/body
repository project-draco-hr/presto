{
  requireNonNull(taskId,"taskId is null");
  requireNonNull(executor,"executor is null");
  state=new StateMachine<>(taskId + "-buffer",executor,OPEN,TERMINAL_BUFFER_STATES);
  requireNonNull(maxBufferSize,"maxBufferSize is null");
  checkArgument(maxBufferSize.toBytes() > 0,"maxBufferSize must be at least 1");
  requireNonNull(systemMemoryUsageListener,"systemMemoryUsageListener is null");
  this.memoryManager=new SharedBufferMemoryManager(maxBufferSize.toBytes(),systemMemoryUsageListener);
}
