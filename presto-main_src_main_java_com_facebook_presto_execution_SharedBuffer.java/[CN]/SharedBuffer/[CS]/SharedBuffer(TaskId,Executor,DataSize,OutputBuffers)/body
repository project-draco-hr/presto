{
  checkNotNull(taskId,"taskId is null");
  checkNotNull(executor,"executor is null");
  state=new StateMachine<>(taskId + "-buffer",executor,QueueState.OPEN);
  checkNotNull(maxBufferSize,"maxBufferSize is null");
  checkArgument(maxBufferSize.toBytes() > 0,"maxBufferSize must be at least 1");
  this.maxBufferedBytes=maxBufferSize.toBytes();
  this.outputBuffers=checkNotNull(outputBuffers,"outputBuffers is null");
  updateOutputBuffers();
}
