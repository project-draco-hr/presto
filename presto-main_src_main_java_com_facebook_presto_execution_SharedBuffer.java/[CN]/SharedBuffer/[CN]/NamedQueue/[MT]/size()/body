{
  Preconditions.checkState(Thread.holdsLock(SharedBuffer.this),"Thread must hold a lock on the %s",SharedBuffer.class.getSimpleName());
  if (finished) {
    return 0;
  }
  int listOffset=Ints.checkedCast(sequenceId - masterSequenceId);
  if (listOffset >= masterQueue.size()) {
    return 0;
  }
  return masterQueue.size() - listOffset;
}
