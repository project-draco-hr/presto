{
  checkHoldsLock();
  if (finished.get()) {
    return true;
  }
  long pagesAdded=partitionBuffer.getPageCount();
  if (!state.get().canAddPages() && sequenceId.get() >= pagesAdded) {
    finished.set(true);
    checkFlushComplete();
  }
  return finished.get();
}
