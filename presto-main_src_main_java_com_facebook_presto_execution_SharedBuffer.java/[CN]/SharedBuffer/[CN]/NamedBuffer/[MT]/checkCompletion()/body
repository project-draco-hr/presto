{
  checkState(Thread.holdsLock(SharedBuffer.this),"Thread must hold a lock on the %s",SharedBuffer.class.getSimpleName());
  if (finished.get()) {
    return true;
  }
  long pagesAdded=partitionBuffer.getPageCount();
  if (!state.get().canAddPages() && sequenceId.get() >= pagesAdded) {
    finished.set(true);
    checkFlushComplete();
  }
  return finished.get();
}
