{
  checkState(!Thread.holdsLock(SharedBuffer.this),"Thread must NOT hold a lock on the %s",SharedBuffer.class.getSimpleName());
  long sequenceId=this.sequenceId.get();
  if (finished.get()) {
    return new BufferInfo(bufferId,true,0,sequenceId);
  }
  int size=Math.max(Ints.checkedCast(pagesAdded.get() + queuedPages.size() - sequenceId),0);
  return new BufferInfo(bufferId,finished.get(),size,sequenceId);
}
