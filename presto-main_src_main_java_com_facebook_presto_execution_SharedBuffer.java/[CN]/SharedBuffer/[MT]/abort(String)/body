{
  Preconditions.checkNotNull(outputId,"outputId is null");
  NamedQueue namedQueue=namedQueues.get(outputId);
  Preconditions.checkArgument(namedQueue != null,"Unknown output %s: available outputs %s",outputId,namedQueues.keySet());
  namedQueue.setFinished();
  openQueuesBySequenceId.remove(namedQueue);
  this.notifyAll();
  updateState();
}
