{
  checkNotNull(outputId,"outputId is null");
  checkArgument(maxSize.toBytes() > 0,"maxSize must be at least 1 byte");
  BufferState state=this.state.get();
  if (state != FAILED && !state.canAddBuffers() && namedBuffers.get(outputId) == null) {
    return completedFuture(emptyResults(0,true));
  }
  GetBufferResult getBufferResult=new GetBufferResult(outputId,startingSequenceId,maxSize);
  stateChangeListeners.add(getBufferResult);
  updateState();
  return getBufferResult.getFuture();
}
