{
  checkNotNull(newOutputBuffers,"newOutputBuffers is null");
  if (state == QueueState.FINISHED || outputBuffers.getVersion() >= newOutputBuffers.getVersion()) {
    return;
  }
  SetView<String> missingBuffers=Sets.difference(outputBuffers.getBufferIds(),newOutputBuffers.getBufferIds());
  checkArgument(missingBuffers.isEmpty(),"newOutputBuffers does not have existing buffers %s",missingBuffers);
  checkArgument(!outputBuffers.isNoMoreBufferIds() || newOutputBuffers.isNoMoreBufferIds(),"Expected newOutputBuffers to have noMoreBufferIds set");
  outputBuffers=newOutputBuffers;
  updateOutputBuffers();
}
