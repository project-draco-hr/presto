{
  Preconditions.checkNotNull(page,"page is null");
  while (!closed.get() && !failed.get() && bufferedBytes >= maxBufferedBytes) {
    TimeUnit.SECONDS.timedWait(this,1);
  }
  if (closed.get() || failed.get()) {
    return false;
  }
  addInternal(page);
  return true;
}
