{
  if (failed.get()) {
    return;
  }
  closed.set(true);
  state=QueueState.FINISHED;
  for (  NamedQueue namedQueue : openQueuesBySequenceId) {
    namedQueue.setFinished();
  }
  openQueuesBySequenceId.clear();
  masterQueue.clear();
  bufferedBytes=0;
  for (  QueuedPage queuedPage : queuedPages) {
    queuedPage.getFuture().set(null);
  }
  queuedPages.clear();
  this.notifyAll();
}
