{
  requireNonNull(page,"page is null");
  if (!state.get().canAddPages()) {
    return immediateFuture(true);
  }
  PartitionBuffer partitionBuffer=createOrGetPartitionBuffer(partition);
  ListenableFuture<?> result=partitionBuffer.enqueuePage(page);
  processPendingReads();
  updateState();
  return result;
}
