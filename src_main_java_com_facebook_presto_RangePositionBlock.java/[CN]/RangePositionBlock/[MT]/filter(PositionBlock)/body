{
  if (positionBlock.isEmpty()) {
    return positionBlock;
  }
  if (positionBlock.isPositionsContiguous()) {
    if (!range.overlaps(positionBlock.getRange())) {
      return EmptyPositionBlock.INSTANCE;
    }
    return new RangePositionBlock(range.intersect(positionBlock.getRange()));
  }
  ImmutableList.Builder<Long> builder=ImmutableList.builder();
  for (  Long position : positionBlock.getPositions()) {
    if (this.apply(position)) {
      builder.add(position);
    }
  }
  if (positionBlock.isEmpty()) {
    return EmptyPositionBlock.INSTANCE;
  }
  return new UncompressedPositionBlock(builder.build());
}
