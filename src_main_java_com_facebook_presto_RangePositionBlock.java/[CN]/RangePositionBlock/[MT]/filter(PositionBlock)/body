{
  if (positionBlock.isPositionsContiguous()) {
    if (!range.overlaps(positionBlock.getRange())) {
      return Optional.absent();
    }
    return Optional.<PositionBlock>of(new RangePositionBlock(range.intersect(positionBlock.getRange())));
  }
  ImmutableList.Builder<Long> builder=ImmutableList.builder();
  for (  Long position : positionBlock.getPositions()) {
    if (this.apply(position)) {
      builder.add(position);
    }
  }
  return Optional.<PositionBlock>of(new UncompressedPositionBlock(builder.build()));
}
