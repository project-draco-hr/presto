{
  if (!PARQUET_SERDE_CLASS_NAMES.contains(getDeserializerClassName(schema))) {
    return Optional.empty();
  }
  List<HiveColumnHandle> unsupportedColumns=ImmutableList.copyOf(filter(columns,not(isParquetSupportedType())));
  if (!unsupportedColumns.isEmpty()) {
    throw new IllegalArgumentException("Can not read Parquet column: " + unsupportedColumns);
  }
  return Optional.<HiveRecordCursor>of(new ParquetHiveRecordCursor(configuration,path,start,length,schema,partitionKeys,columns,useParquetColumnNames,hiveStorageTimeZone,typeManager,isParquetPredicatePushdownEnabled(session),effectivePredicate));
}
