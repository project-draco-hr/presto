{
  Preconditions.checkArgument(node.getCriteria().size() == 1,"Joining by multiple conditions not yet supported");
  JoinNode.EquiJoinClause clause=Iterables.getOnlyElement(node.getCriteria());
  PhysicalOperation leftSource=node.getLeft().accept(this,context);
  int probeChannel=leftSource.getLayout().get(clause.getLeft()).getChannel();
  PhysicalOperation rightSource=node.getRight().accept(this,context);
  int buildChannel=rightSource.getLayout().get(clause.getRight()).getChannel();
  Preconditions.checkState(leftSource.getOperator().getTupleInfos().get(probeChannel).getFieldCount() == 1 && rightSource.getOperator().getTupleInfos().get(buildChannel).getFieldCount() == 1,"JOIN with the results of a multi-field GROUP BY, DISTINCT or ORDER BY not yet supported");
  SourceHashProvider hashProvider=joinHashFactory.getSourceHashProvider(node,rightSource.getOperator(),buildChannel,operatorStats);
  ImmutableMap.Builder<Symbol,Input> outputMappings=ImmutableMap.builder();
  outputMappings.putAll(leftSource.getLayout());
  int offset=leftSource.getOperator().getChannelCount();
  for (  Map.Entry<Symbol,Input> entry : rightSource.getLayout().entrySet()) {
    Input input=entry.getValue();
    outputMappings.put(entry.getKey(),new Input(offset + input.getChannel(),input.getField()));
  }
  HashJoinOperator operator=new HashJoinOperator(hashProvider,leftSource.getOperator(),probeChannel);
  return new PhysicalOperation(operator,outputMappings.build());
}
