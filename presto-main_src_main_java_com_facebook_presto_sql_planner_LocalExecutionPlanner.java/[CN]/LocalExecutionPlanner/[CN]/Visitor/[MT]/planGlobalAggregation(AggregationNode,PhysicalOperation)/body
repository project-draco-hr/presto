{
  int outputChannel=0;
  ImmutableMap.Builder<Symbol,Input> outputMappings=ImmutableMap.builder();
  List<AggregationFunctionDefinition> functionDefinitions=new ArrayList<>();
  for (  Map.Entry<Symbol,FunctionCall> entry : node.getAggregations().entrySet()) {
    Symbol symbol=entry.getKey();
    functionDefinitions.add(buildFunctionDefinition(source,node.getFunctions().get(symbol),entry.getValue()));
    outputMappings.put(symbol,new Input(outputChannel,0));
    outputChannel++;
  }
  Operator operator=new AggregationOperator(source.getOperator(),node.getStep(),functionDefinitions);
  return new PhysicalOperation(operator,outputMappings.build());
}
