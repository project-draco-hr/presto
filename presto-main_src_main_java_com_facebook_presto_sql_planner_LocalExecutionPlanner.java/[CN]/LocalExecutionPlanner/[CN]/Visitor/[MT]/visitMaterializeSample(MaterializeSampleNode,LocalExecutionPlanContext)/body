{
  PhysicalOperation source=node.getSource().accept(this,context);
  int sampleWeightChannel=Iterables.getOnlyElement(getChannelsForSymbols(ImmutableList.of(node.getSampleWeightSymbol()),source.getLayout()));
  ImmutableMap.Builder<Symbol,Input> outputMappings=ImmutableMap.builder();
  for (  Map.Entry<Symbol,Input> entry : source.getLayout().entrySet()) {
    int value=entry.getValue().getChannel();
    if (value == sampleWeightChannel) {
      continue;
    }
    outputMappings.put(entry.getKey(),new Input(value > sampleWeightChannel ? value - 1 : value));
  }
  List<TupleInfo> tupleInfos=new ArrayList<>();
  tupleInfos.addAll(source.getTupleInfos());
  tupleInfos.remove(sampleWeightChannel);
  MaterializeSampleOperator.MaterializeSampleOperatorFactory operator=new MaterializeSampleOperator.MaterializeSampleOperatorFactory(context.getNextOperatorId(),tupleInfos,sampleWeightChannel);
  return new PhysicalOperation(operator,outputMappings.build(),source);
}
