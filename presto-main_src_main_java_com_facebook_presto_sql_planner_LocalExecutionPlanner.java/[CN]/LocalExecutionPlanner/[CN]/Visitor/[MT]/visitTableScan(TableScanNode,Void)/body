{
  Preconditions.checkState(split != null || tableScans != null,"This fragment does not have a split");
  PlanFragmentSource tableSplit;
  if (split != null) {
    tableSplit=new TableScanPlanFragmentSource(split);
  }
 else {
    tableSplit=tableScans.get(node.getId());
  }
  Map<Symbol,Input> mappings=new HashMap<>();
  List<ColumnHandle> columns=new ArrayList<>();
  int channel=0;
  for (  Symbol symbol : node.getOutputSymbols()) {
    columns.add(node.getAssignments().get(symbol));
    mappings.put(symbol,new Input(channel,0));
    channel++;
  }
  Operator operator=sourceProvider.createDataStream(tableSplit,columns);
  return new PhysicalOperation(operator,mappings);
}
