{
  PhysicalOperation source=node.getSource().accept(this,context);
  boolean projectionMatchesOutput=IterableTransformer.on(source.getLayout().entrySet()).orderBy(inputOrdering().onResultOf(MoreFunctions.<Symbol,Input>valueGetter())).transform(MoreFunctions.<Symbol,Input>keyGetter()).list().equals(node.getOutputSymbols());
  if (!projectionMatchesOutput) {
    IdentityProjectionInfo mappings=computeIdentityMapping(node.getOutputSymbols(),source.getLayout(),context.getTypes());
    OperatorFactory operatorFactory=new FilterAndProjectOperatorFactory(context.getNextOperatorId(),FilterFunctions.TRUE_FUNCTION,mappings.getProjections());
    return new PhysicalOperation(operatorFactory,mappings.getOutputLayout(),source);
  }
  return source;
}
