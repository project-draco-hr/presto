{
  if (node.getStep() == Step.INTERMEDIATE) {
    return true;
  }
  if (node.getStep() != Step.FINAL || node.getSources().size() != 1) {
    return false;
  }
  PlanNode source=node.getSources().get(0);
  return source instanceof AggregationNode && ((AggregationNode)source).getStep() == Step.PARTIAL;
}
