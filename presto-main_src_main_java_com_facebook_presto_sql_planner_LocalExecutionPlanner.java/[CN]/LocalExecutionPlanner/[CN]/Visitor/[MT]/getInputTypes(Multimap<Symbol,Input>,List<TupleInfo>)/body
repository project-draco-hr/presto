{
  Builder<Input,Type> inputTypes=ImmutableMap.builder();
  for (  Input input : ImmutableSet.copyOf(layout.values())) {
    TupleInfo.Type type=tupleInfos.get(input.getChannel()).getTypes().get(input.getField());
switch (type) {
case BOOLEAN:
      inputTypes.put(input,Type.BOOLEAN);
    break;
case FIXED_INT_64:
  inputTypes.put(input,Type.LONG);
break;
case VARIABLE_BINARY:
inputTypes.put(input,Type.STRING);
break;
case DOUBLE:
inputTypes.put(input,Type.DOUBLE);
break;
default :
throw new IllegalArgumentException("Unsupported type " + type);
}
}
return inputTypes.build();
}
