{
  PhysicalOperation source=node.getSource().accept(this,context);
  List<Symbol> resultSymbols=Lists.transform(node.getColumnNames(),forMap(node.getAssignments()));
  Ordering<Input> comparator=inputOrdering();
  List<Symbol> sourceSymbols=IterableTransformer.on(source.getLayout().entrySet()).orderBy(comparator.onResultOf(MoreFunctions.<Symbol,Input>valueGetter())).transform(MoreFunctions.<Symbol,Input>keyGetter()).list();
  if (resultSymbols.equals(sourceSymbols) && resultSymbols.size() == source.getOperator().getChannelCount()) {
    return source;
  }
  IdentityProjectionInfo mappings=computeIdentityMapping(resultSymbols,source.getLayout(),types);
  FilterAndProjectOperator operator=new FilterAndProjectOperator(source.getOperator(),FilterFunctions.TRUE_FUNCTION,mappings.getProjections());
  return new PhysicalOperation(operator,mappings.getOutputLayout());
}
