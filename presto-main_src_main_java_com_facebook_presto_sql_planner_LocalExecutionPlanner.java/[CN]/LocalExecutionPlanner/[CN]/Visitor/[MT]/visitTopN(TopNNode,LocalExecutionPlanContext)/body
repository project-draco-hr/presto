{
  PhysicalOperation source=node.getSource().accept(this,context);
  List<Symbol> orderBySymbols=node.getOrderBy();
  List<Integer> sortChannels=new ArrayList<>();
  List<SortOrder> sortOrders=new ArrayList<>();
  for (  Symbol symbol : orderBySymbols) {
    sortChannels.add(source.getLayout().get(symbol).getChannel());
    sortOrders.add(node.getOrderings().get(symbol));
  }
  Optional<Integer> sampleWeightChannel=node.getSampleWeight().transform(source.channelGetter());
  OperatorFactory operator=new TopNOperatorFactory(context.getNextOperatorId(),source.getTypes(),(int)node.getCount(),sortChannels,sortOrders,sampleWeightChannel,node.isPartial());
  return new PhysicalOperation(operator,source.getLayout(),source);
}
