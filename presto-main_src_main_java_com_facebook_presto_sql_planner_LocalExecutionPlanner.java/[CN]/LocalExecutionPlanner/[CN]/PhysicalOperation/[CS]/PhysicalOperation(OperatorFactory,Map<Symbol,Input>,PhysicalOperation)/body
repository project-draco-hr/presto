{
  checkNotNull(operatorFactory,"operatorFactory is null");
  checkNotNull(layout,"layout is null");
  checkNotNull(source,"source is null");
  this.operatorFactories=ImmutableList.<OperatorFactory>builder().addAll(source.getOperatorFactories()).add(operatorFactory).build();
  this.layout=ImmutableMap.copyOf(layout);
  this.tupleInfos=operatorFactory.getTupleInfos();
}
