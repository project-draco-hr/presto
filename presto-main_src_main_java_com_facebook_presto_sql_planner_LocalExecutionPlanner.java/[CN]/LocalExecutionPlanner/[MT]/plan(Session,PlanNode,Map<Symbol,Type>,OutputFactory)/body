{
  LocalExecutionPlanContext context=new LocalExecutionPlanContext(session,types);
  PhysicalOperation physicalOperation=plan.accept(new Visitor(),context);
  DriverFactory driverFactory=new DriverFactory(context.isInputDriver(),true,ImmutableList.<OperatorFactory>builder().addAll(physicalOperation.getOperatorFactories()).add(outputOperatorFactory.createOutputOperator(context.getNextOperatorId(),physicalOperation.getTypes())).build());
  context.addDriverFactory(driverFactory);
  return new LocalExecutionPlan(context.getDriverFactories());
}
