{
  WriterTarget target=node.getTarget();
  return new TableCommitter(){
    @Override public void commitTable(    Collection<Slice> fragments){
      if (target instanceof CreateHandle) {
        metadata.commitCreateTable(((CreateHandle)target).getHandle(),fragments);
      }
 else       if (target instanceof InsertHandle) {
        metadata.commitInsert(((InsertHandle)target).getHandle(),fragments);
      }
 else       if (target instanceof DeleteHandle) {
        metadata.commitDelete(((DeleteHandle)target).getHandle(),fragments);
      }
 else {
        throw new AssertionError("Unhandled target type: " + target.getClass().getName());
      }
    }
    @Override public void rollbackTable(){
      if (target instanceof CreateHandle) {
        metadata.rollbackCreateTable(((CreateHandle)target).getHandle());
      }
 else       if (target instanceof InsertHandle) {
        metadata.rollbackInsert(((InsertHandle)target).getHandle());
      }
 else       if (target instanceof DeleteHandle) {
        metadata.rollbackDelete(((DeleteHandle)target).getHandle());
      }
 else {
        throw new AssertionError("Unhandled target type: " + target.getClass().getName());
      }
    }
  }
;
}
