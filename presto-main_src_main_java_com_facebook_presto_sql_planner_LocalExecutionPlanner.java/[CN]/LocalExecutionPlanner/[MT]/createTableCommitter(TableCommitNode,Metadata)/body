{
  final WriterTarget target=node.getTarget();
  return new TableCommitter(){
    @Override public void commitTable(    Collection<Slice> fragments){
      if (target instanceof CreateHandle) {
        metadata.commitCreateTable(((CreateHandle)target).getHandle(),fragments);
      }
 else       if (target instanceof InsertHandle) {
        metadata.commitInsert(((InsertHandle)target).getHandle(),fragments);
      }
 else {
        throw new AssertionError("Unhandled target type: " + target.getClass().getName());
      }
    }
  }
;
}
