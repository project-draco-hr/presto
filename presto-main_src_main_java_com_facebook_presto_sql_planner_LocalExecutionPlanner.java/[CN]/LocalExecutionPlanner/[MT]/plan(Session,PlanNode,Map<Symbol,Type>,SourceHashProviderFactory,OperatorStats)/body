{
  LocalExecutionPlanContext context=new LocalExecutionPlanContext(session,types,joinHashFactory,operatorStats);
  Operator rootOperator=plan.accept(new Visitor(),context).getOperator();
  return new LocalExecutionPlan(rootOperator,context.getSourceOperators(),context.getOutputOperators());
}
