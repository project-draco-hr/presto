{
  while (!pageBuilder.isFull() && advance()) {
    pageBuilder.declarePosition();
    for (int i=0; i < cursors.length; i++) {
      cursors[i].appendTupleTo(pageBuilder.getBlockBuilder(i));
    }
  }
  if (pageBuilder.isFull() || (finishing && !pageBuilder.isEmpty() && sampleWeightCursor == null)) {
    Page page=pageBuilder.build();
    pageBuilder.reset();
    return page;
  }
  return null;
}
