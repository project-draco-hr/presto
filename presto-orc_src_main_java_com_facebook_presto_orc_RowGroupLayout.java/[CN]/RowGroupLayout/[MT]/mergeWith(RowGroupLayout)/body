{
  checkNotNull(otherGroup,"otherGroup is null");
  checkArgument(groupId != otherGroup.groupId,"can not merge with self");
  if (otherGroup.getGroupId() < groupId) {
    return otherGroup.mergeWith(this);
  }
  List<StreamLayout> otherStreamLayouts=otherGroup.getStreamLayouts();
  checkArgument(otherStreamLayouts.size() == streamLayouts.size());
  ImmutableList.Builder<StreamLayout> builder=ImmutableList.builder();
  for (int i=0; i < streamLayouts.size(); i++) {
    StreamLayout streamLayout=streamLayouts.get(i);
    StreamLayout otherStreamLayout=otherStreamLayouts.get(i);
    builder.add(streamLayout.mergeWith(otherStreamLayout));
  }
  return new RowGroupLayout(groupId,rowCount + otherGroup.getRowCount(),builder.build());
}
