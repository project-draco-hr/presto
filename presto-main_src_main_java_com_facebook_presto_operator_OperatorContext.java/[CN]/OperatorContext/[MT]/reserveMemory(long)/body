{
  driverContext.reserveMemory(bytes);
  long newReservation=memoryReservation.getAndAdd(bytes);
  if (newReservation > maxMemoryReservation) {
    memoryReservation.getAndAdd(-bytes);
    throw new ExceededMemoryLimitException(getMaxMemorySize());
  }
}
