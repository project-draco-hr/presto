{
  Type returnType=null;
  int index=0;
  for (  RowField field : type.getFields()) {
    if (field.getName().equals(Optional.of(fieldName))) {
      returnType=field.getType();
      break;
    }
    index++;
  }
  requireNonNull(returnType,format("%s not found in row type %s",fieldName,type));
  signature=new Signature(mangleFieldReference(fieldName),returnType.getTypeSignature(),type.getTypeSignature());
  String stackType=returnType.getJavaType().getSimpleName().toLowerCase();
  MethodHandle methodHandle;
  if (METHOD_HANDLE_MAP.containsKey(stackType)) {
    methodHandle=METHOD_HANDLE_MAP.get(stackType);
  }
 else {
    methodHandle=METHOD_HANDLE_OBJECT;
  }
  this.methodHandle=methodHandle.bindTo(returnType).bindTo(index);
}
