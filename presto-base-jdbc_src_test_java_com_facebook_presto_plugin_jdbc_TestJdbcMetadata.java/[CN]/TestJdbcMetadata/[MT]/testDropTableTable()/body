{
  try {
    metadata.dropTable(SESSION,tableHandle);
    fail("expected exception");
  }
 catch (  PrestoException e) {
    assertEquals(e.getErrorCode(),PERMISSION_DENIED.toErrorCode());
  }
  JdbcMetadataConfig config=new JdbcMetadataConfig().setAllowDropTable(true);
  metadata=new JdbcMetadata(new JdbcConnectorId(CONNECTOR_ID),database.getJdbcClient(),config);
  metadata.dropTable(SESSION,tableHandle);
  try {
    metadata.getTableMetadata(SESSION,tableHandle);
    fail("expected exception");
  }
 catch (  PrestoException e) {
    assertEquals(e.getErrorCode(),NOT_FOUND.toErrorCode());
  }
}
