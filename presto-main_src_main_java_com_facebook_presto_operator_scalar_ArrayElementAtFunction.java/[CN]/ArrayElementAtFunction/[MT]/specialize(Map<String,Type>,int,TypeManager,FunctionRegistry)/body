{
  checkArgument(types.size() == 1,"Expected one type, got %s",types);
  Type elementType=types.get("E");
  MethodHandle methodHandle;
  if (METHOD_HANDLES.containsKey(elementType.getJavaType())) {
    methodHandle=METHOD_HANDLES.get(elementType.getJavaType());
  }
 else {
    checkArgument(!elementType.getJavaType().isPrimitive(),"Unsupported primitive type: " + elementType.getJavaType());
    methodHandle=OBJECT_METHOD_HANDLE;
  }
  requireNonNull(methodHandle,"methodHandle is null");
  methodHandle=methodHandle.bindTo(elementType);
  Signature signature=new Signature(FUNCTION_NAME,elementType.getTypeSignature(),parameterizedTypeName("array",elementType.getTypeSignature()),parseTypeSignature("bigint"));
  return new FunctionInfo(signature,getDescription(),isHidden(),methodHandle,isDeterministic(),true,ImmutableList.of(false,false));
}
