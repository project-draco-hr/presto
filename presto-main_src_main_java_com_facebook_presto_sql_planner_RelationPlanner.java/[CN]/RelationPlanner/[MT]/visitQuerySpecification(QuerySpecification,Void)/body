{
  PlanBuilder subPlan=new QueryPlanner(analysis,symbolAllocator,idAllocator,metadata,session,Optional.empty()).process(node,null);
  ImmutableList.Builder<Symbol> outputSymbols=ImmutableList.builder();
  for (  FieldOrExpression fieldOrExpression : analysis.getOutputExpressions(node)) {
    outputSymbols.add(subPlan.translate(fieldOrExpression));
  }
  return new RelationPlan(subPlan.getRoot(),analysis.getOutputDescriptor(node),outputSymbols.build(),subPlan.getSampleWeight());
}
