{
  PlanBuilder subPlan=new QueryPlanner(analysis,symbolAllocator,idAllocator,metadata,session).process(node,null);
  TupleDescriptor outputDescriptor=analysis.getOutputDescriptor(node);
  ImmutableList.Builder<Symbol> outputSymbols=ImmutableList.builder();
  for (  FieldOrExpression fieldOrExpression : analysis.getOutputExpressions(node)) {
    outputSymbols.add(subPlan.translate(fieldOrExpression));
  }
  return new RelationPlan(subPlan.getRoot(),outputDescriptor,outputSymbols.build());
}
