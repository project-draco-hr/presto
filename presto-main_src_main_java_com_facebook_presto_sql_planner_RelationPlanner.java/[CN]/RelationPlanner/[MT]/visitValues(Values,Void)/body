{
  TupleDescriptor descriptor=analysis.getOutputDescriptor(node);
  ImmutableList.Builder<Symbol> outputSymbolsBuilder=ImmutableList.builder();
  for (  Field field : descriptor.getVisibleFields()) {
    Symbol symbol=symbolAllocator.newSymbol(field);
    outputSymbolsBuilder.add(symbol);
  }
  ImmutableList.Builder<List<Expression>> rows=ImmutableList.builder();
  for (  Expression row : node.getRows()) {
    ImmutableList.Builder<Expression> values=ImmutableList.builder();
    if (row instanceof Row) {
      List<Expression> items=((Row)row).getItems();
      for (int i=0; i < items.size(); i++) {
        Expression expression=items.get(i);
        Object constantValue=evaluateConstantExpression(expression,analysis.getCoercions(),metadata,session);
        values.add(LiteralInterpreter.toExpression(constantValue,descriptor.getFieldByIndex(i).getType()));
      }
    }
 else {
      Object constantValue=evaluateConstantExpression(row,analysis.getCoercions(),metadata,session);
      values.add(LiteralInterpreter.toExpression(constantValue,descriptor.getFieldByIndex(0).getType()));
    }
    rows.add(values.build());
  }
  ValuesNode valuesNode=new ValuesNode(idAllocator.getNextId(),outputSymbolsBuilder.build(),rows.build());
  return new RelationPlan(valuesNode,descriptor,outputSymbolsBuilder.build(),Optional.empty());
}
