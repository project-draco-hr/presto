{
  if (!node.getName().getPrefix().isPresent()) {
    Query namedQuery=analysis.getNamedQuery(node);
    if (namedQuery != null) {
      RelationPlan subPlan=process(namedQuery,null);
      return new RelationPlan(subPlan.getRoot(),analysis.getOutputDescriptor(node),subPlan.getOutputSymbols());
    }
  }
  TupleDescriptor descriptor=analysis.getOutputDescriptor(node);
  TableHandle handle=analysis.getTableHandle(node);
  ImmutableList.Builder<Symbol> outputSymbols=ImmutableList.builder();
  ImmutableMap.Builder<Symbol,ColumnHandle> columns=ImmutableMap.builder();
  for (int i=0; i < descriptor.getFields().size(); i++) {
    Field field=descriptor.getFields().get(i);
    Symbol symbol=symbolAllocator.newSymbol(field.getName().get(),field.getType());
    outputSymbols.add(symbol);
    columns.put(symbol,analysis.getColumn(field));
  }
  return new RelationPlan(new TableScanNode(idAllocator.getNextId(),handle,columns.build()),descriptor,outputSymbols.build());
}
