{
  if (node.getColumnsToStratifyOn().isPresent()) {
    throw new UnsupportedOperationException("STRATIFY ON is not yet implemented");
  }
  RelationPlan subPlan=process(node.getRelation(),context);
  TupleDescriptor outputDescriptor=analysis.getOutputDescriptor(node);
  double ratio=analysis.getSampleRatio(node);
  return new RelationPlan(new SampleNode(idAllocator.getNextId(),subPlan.getRoot(),ratio,SampleNode.Type.fromType(node.getType())),outputDescriptor,subPlan.getOutputSymbols());
}
