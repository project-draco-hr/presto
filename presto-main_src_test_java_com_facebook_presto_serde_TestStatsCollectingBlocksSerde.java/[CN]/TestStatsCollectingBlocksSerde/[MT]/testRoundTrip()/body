{
  UncompressedBlock expectedBlock=new BlockBuilder(0,SINGLE_VARBINARY).append("alice").append("bob").append("charlie").append("dave").build();
  DynamicSliceOutput sliceOutput=new DynamicSliceOutput(1024);
  writeBlocks(sliceOutput,expectedBlock,expectedBlock,expectedBlock);
  Slice slice=sliceOutput.slice();
  BlockIterable actualBlocks=readBlocks(slice,0);
  assertBlocksEquals(actualBlocks,createBlockIterable(new BlockBuilder(0,SINGLE_VARBINARY).append("alice").append("bob").append("charlie").append("dave").append("alice").append("bob").append("charlie").append("dave").append("alice").append("bob").append("charlie").append("dave").build()));
  Stats stats=readStats(slice);
  assertEquals(stats.getAvgRunLength(),1);
  assertEquals(stats.getMinPosition(),0);
  assertEquals(stats.getMaxPosition(),3);
  assertEquals(stats.getRowCount(),12);
  assertEquals(stats.getRunsCount(),12);
  assertEquals(stats.getUniqueCount(),4);
}
