{
  TaskInfo outputTask=mockTaskManager.getTaskInfo(outputTaskId);
  QueryState state;
switch (outputTask.getState()) {
case PLANNED:
case RUNNING:
    state=QueryState.RUNNING;
  break;
case FINISHED:
state=QueryState.FINISHED;
break;
case CANCELED:
state=QueryState.CANCELED;
break;
case FAILED:
state=QueryState.FAILED;
break;
default :
throw new IllegalStateException("Unknown task state " + outputTask.getState());
}
return new QueryInfo(outputTaskId.getQueryId(),new ConnectorSession("user","test","test_catalog","test_schema",UTC_KEY,Locale.ENGLISH,null,null),state,self,ImmutableList.of("out"),"query",new QueryStats(),new StageInfo(outputTaskId.getStageId(),StageState.FINISHED,locationFactory.createStageLocation(outputTaskId.getStageId()),null,TYPES,new StageStats(),ImmutableList.of(outputTask),ImmutableList.<StageInfo>of(),ImmutableList.<ExecutionFailureInfo>of()),null,null,null);
}
