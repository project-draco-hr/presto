{
  TaskInfo outputTask=mockTaskManager.getTaskInfo(outputTaskId);
  QueryState state;
switch (outputTask.getState()) {
case PLANNED:
case QUEUED:
case RUNNING:
    state=QueryState.RUNNING;
  break;
case FINISHED:
state=QueryState.FINISHED;
break;
case CANCELED:
state=QueryState.CANCELED;
break;
case FAILED:
state=QueryState.FAILED;
break;
default :
throw new IllegalStateException("Unknown task state " + outputTask.getState());
}
String stageId=queryId + "-0";
return new QueryInfo(queryId,new Session(null,"test_catalog","test_schema"),state,self,ImmutableList.of("out"),"query",new QueryStats(),new StageInfo(queryId,stageId,StageState.FINISHED,locationFactory.createStageLocation(stageId),null,TUPLE_INFOS,ImmutableList.<TaskInfo>of(outputTask),ImmutableList.<StageInfo>of(),ImmutableList.<FailureInfo>of()),ImmutableList.<FailureInfo>of());
}
