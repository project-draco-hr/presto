{
  RaptorOutputTableHandle handle=checkType(tableHandle,RaptorOutputTableHandle.class,"tableHandle");
  return new RaptorPageSink(pageSorter,storageManager,shardInfoCodec,toColumnIds(handle.getColumnHandles()),handle.getColumnTypes(),optionalColumnId(handle.getSampleWeightColumnHandle()),toColumnIds(handle.getSortColumnHandles()),handle.getSortOrders(),maxBufferSize);
}
