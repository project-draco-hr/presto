{
  try (ThreadContextClassLoader ignored=new ThreadContextClassLoader(FileSystem.class.getClassLoader())){
    OrcFile.WriterOptions options=OrcFile.writerOptions(conf).fileSystem(target.getFileSystem(conf)).compress(SNAPPY);
    return WRITER_CONSTRUCTOR.newInstance(target,options);
  }
 catch (  ReflectiveOperationException|IOException e) {
    throw new PrestoException(RAPTOR_ERROR,"Failed to create writer",e);
  }
}
