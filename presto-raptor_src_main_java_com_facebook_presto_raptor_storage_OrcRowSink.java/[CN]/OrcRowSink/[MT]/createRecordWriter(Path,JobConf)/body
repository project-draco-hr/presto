{
  try {
    OrcFile.WriterOptions options=OrcFile.writerOptions(conf).fileSystem(getFileSystem(target,conf)).compress(SNAPPY);
    return WRITER_CONSTRUCTOR.newInstance(target,options);
  }
 catch (  ReflectiveOperationException|IOException e) {
    throw new PrestoException(RAPTOR_ERROR,"Failed to create writer",e);
  }
}
