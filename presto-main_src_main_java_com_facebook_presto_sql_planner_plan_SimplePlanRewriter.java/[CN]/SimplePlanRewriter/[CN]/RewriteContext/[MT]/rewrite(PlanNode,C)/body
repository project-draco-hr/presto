{
  PlanNode result=node.accept(nodeRewriter,new RewriteContext<>(nodeRewriter,userContext));
  if (result == null) {
    throw new NullPointerException(format("nodeRewriter returned null for %s",node.getClass().getName()));
  }
  return result;
}
