{
  ByteBuffer buf=ByteBuffer.allocate(100);
  buf.putDouble(Math.PI);
  buf.putFloat((float)Math.E);
  buf.putDouble(Math.E);
  byte[] row=new byte[buf.position()];
  System.arraycopy(buf.array(),0,row,0,buf.position());
  RawKafkaRowDecoder rowDecoder=new RawKafkaRowDecoder();
  KafkaColumnHandle row1=new KafkaColumnHandle("",0,"row1",VarcharType.VARCHAR,null,"DOUBLE",null,false,false,false);
  KafkaColumnHandle row2=new KafkaColumnHandle("",1,"row2",VarcharType.VARCHAR,"8","FLOAT",null,false,false,false);
  List<KafkaColumnHandle> columns=ImmutableList.of(row1,row2);
  Set<KafkaFieldValueProvider> providers=new HashSet<>();
  boolean corrupt=rowDecoder.decodeRow(row,providers,columns,buildMap(columns));
  assertFalse(corrupt);
  assertEquals(providers.size(),columns.size());
  checkValue(providers,row1,Math.PI);
  checkValue(providers,row2,Math.E);
}
