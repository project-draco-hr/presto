{
  MetadataManager metadata=new MetadataManager();
  Type arrayType=metadata.getType(parseTypeSignature("array<bigint>"));
  Type mapType=metadata.getType(parseTypeSignature("map<bigint,bigint>"));
  List<Page> input=rowPagesBuilder(BIGINT,arrayType,mapType).row(1,"[2, 3]","{\"4\": 5}").pageBreak().row(6,"[7, 8]","{\"9\": 10, \"11\": 12}").build();
  OperatorFactory operatorFactory=new UnnestOperator.UnnestOperatorFactory(0,ImmutableList.of(0),ImmutableList.<Type>of(BIGINT),ImmutableList.of(1,2),ImmutableList.of(arrayType,mapType));
  Operator operator=operatorFactory.createOperator(driverContext);
  MaterializedResult expected=resultBuilder(driverContext.getSession(),BIGINT,BIGINT,BIGINT,BIGINT).row(1,2,4,5).row(1,3,null,null).row(6,7,9,10).row(6,8,11,12).build();
  assertOperatorEquals(operator,input,expected);
}
