{
  List<Page> pages=createPages();
  int expectedCount=0;
  for (  Page page : pages) {
    expectedCount+=page.getPositionCount();
  }
  ExecutorService executor=Executors.newCachedThreadPool();
  try {
    QueryDriversOperator operator=new QueryDriversOperator(10,TUPLE_INFOS,new StaticQueryDriverProvider(executor,pages),new StaticQueryDriverProvider(executor,pages),new StaticQueryDriverProvider(executor,pages));
    int count=0;
    PageIterator iterator=operator.iterator(new OperatorStats());
    while (iterator.hasNext()) {
      Page page=iterator.next();
      BlockCursor cursor=page.getBlock(0).cursor();
      while (cursor.advanceNextPosition()) {
        count++;
      }
    }
    assertEquals(count,expectedCount * 3);
  }
  finally {
    executor.shutdownNow();
  }
}
