{
  BlockCursor cursor=page.getBlock(sampleWeightChannel).cursor();
  BlockBuilder builder=BIGINT.createBlockBuilder(new BlockBuilderStatus());
  int rowsToCopy=0;
  while (remainingLimit > 0 && cursor.advanceNextPosition()) {
    rowsToCopy++;
    long sampleWeight=cursor.getLong();
    if (sampleWeight <= remainingLimit) {
      builder.appendLong(sampleWeight);
    }
 else {
      builder.appendLong(remainingLimit);
    }
    remainingLimit-=sampleWeight;
  }
  if (remainingLimit >= 0 && rowsToCopy == page.getPositionCount()) {
    nextPage=page;
  }
 else {
    Block[] blocks=new Block[page.getChannelCount()];
    blocks[sampleWeightChannel]=builder.build();
    for (int channel=0; channel < page.getChannelCount(); channel++) {
      if (channel == sampleWeightChannel) {
        continue;
      }
      Block block=page.getBlock(channel);
      blocks[channel]=block.getRegion(0,rowsToCopy);
    }
    nextPage=new Page(rowsToCopy,blocks);
    remainingLimit=0;
  }
}
