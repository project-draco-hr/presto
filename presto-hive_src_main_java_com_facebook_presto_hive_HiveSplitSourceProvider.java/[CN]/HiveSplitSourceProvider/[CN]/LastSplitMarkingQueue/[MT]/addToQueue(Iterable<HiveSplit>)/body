{
  checkNotNull(splits,"splits is null");
  checkState(!done.get(),"already done");
  for (  HiveSplit split : splits) {
    HiveSplit previousSplit=bufferedSplit.getAndSet(split);
    if (previousSplit != null) {
      hiveSplitSource.addToQueue(previousSplit);
    }
  }
}
