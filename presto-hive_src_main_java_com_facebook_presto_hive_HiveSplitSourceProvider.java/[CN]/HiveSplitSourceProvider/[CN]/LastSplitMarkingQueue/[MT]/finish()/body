{
  checkState(!done.getAndSet(true),"already done");
  HiveSplit finalSplit=bufferedSplit.getAndSet(null);
  if (finalSplit != null) {
    hiveSplitSource.addToQueue(markAsLastSplit(finalSplit));
  }
}
