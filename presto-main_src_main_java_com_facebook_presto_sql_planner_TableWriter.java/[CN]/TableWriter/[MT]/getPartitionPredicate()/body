{
  checkState(!predicateHandedOut.getAndSet(true),"Predicate can only be handed out once");
  final Set<String> allPartitions=ImmutableSet.copyOf(remainingPartitions);
  return new Predicate<PartitionInfo>(){
    public boolean apply(    PartitionInfo input){
      remainingPartitions.remove(input.getName());
      return !allPartitions.contains(input.getName());
    }
  }
;
}
