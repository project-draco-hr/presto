{
  try (SetThreadName setThreadName=new SetThreadName("HttpRemoteTask-%s",taskId)){
    checkNotNull(split,"split is null");
    checkState(!noMoreSplits,"noMoreSplits has already been set");
    checkState(planFragment.getPartitioning() != PlanFragment.Partitioning.NONE,"Plan is not partitioned");
    if (!getTaskInfo().getState().isDone()) {
      pendingSplits.put(planFragment.getPartitionedSource(),new ScheduledSplit(nextSplitId.getAndIncrement(),split));
      needsUpdate.set(true);
    }
    scheduleUpdate();
  }
 }
