{
  int pendingSplitCount=0;
  if (planFragment.isPartitioned()) {
    Set<ScheduledSplit> partitionSplits=pendingSplits.get(planFragment.getPartitionedSources());
    if (partitionSplits != null) {
      pendingSplitCount=partitionSplits.size();
    }
  }
  return pendingSplitCount + taskInfo.get().getStats().getQueuedSplits();
}
