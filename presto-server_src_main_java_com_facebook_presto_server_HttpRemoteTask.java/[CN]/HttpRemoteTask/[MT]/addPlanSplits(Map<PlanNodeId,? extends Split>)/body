{
  checkState(planFragment.isPartitioned(),"can not add plan split to unpartitioned plan");
  checkState(planFragment.getPartitionedSources().equals(splits.keySet()),"Can only add a split matching the partition sources (%s vs %s)",planFragment.getPartitionedSources(),splits.keySet());
  Map<PlanNodeId,? extends Split> splitMap=ImmutableMap.copyOf(splits);
  pendingSplits.put(splitMap.keySet(),new ScheduledSplit(nextSplitId.getAndIncrement(),splitMap));
}
