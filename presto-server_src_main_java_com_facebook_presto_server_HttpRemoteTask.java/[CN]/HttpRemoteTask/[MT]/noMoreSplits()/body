{
synchronized (this) {
    Preconditions.checkState(!noMoreSplits,"noMoreSplits has already been set");
    noMoreSplits=true;
  }
  if (planFragment.getPartitionedSource() != null) {
    noMoreSources(planFragment.getPartitionedSource());
  }
}
