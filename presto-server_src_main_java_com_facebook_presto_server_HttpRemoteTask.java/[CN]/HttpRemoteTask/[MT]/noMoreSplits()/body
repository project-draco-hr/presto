{
  Preconditions.checkState(!Thread.holdsLock(this),"Update state can not be called while holding a lock on this");
synchronized (this) {
    Preconditions.checkState(!noMoreSplits.get(),"noMoreSplits has already been set");
    noMoreSplits.set(true);
  }
  updateState(false);
}
