{
  boolean distributedJoinEnabled=SystemSessionProperties.isDistributedJoinEnabled(session,distributedJoins);
  boolean redistributeWrites=SystemSessionProperties.isRedistributeWrites(session,this.redistributeWrites);
  boolean preferStreamingOperators=SystemSessionProperties.preferStreamingOperators(session,false);
  PlanWithProperties result=plan.accept(new Rewriter(symbolAllocator,idAllocator,symbolAllocator,session,distributedIndexJoins,distributedJoinEnabled,preferStreamingOperators,redistributeWrites),PreferredProperties.any());
  return result.getNode();
}
