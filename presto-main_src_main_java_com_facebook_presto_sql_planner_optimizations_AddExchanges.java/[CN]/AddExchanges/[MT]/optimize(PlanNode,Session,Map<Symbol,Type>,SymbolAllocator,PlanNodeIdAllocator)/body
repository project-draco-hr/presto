{
  boolean distributedJoinEnabled=SystemSessionProperties.isDistributedJoinEnabled(session,distributedJoins);
  PlanWithProperties result=plan.accept(new Rewriter(symbolAllocator,idAllocator,session,distributedIndexJoins,distributedJoinEnabled),PreferredProperties.any());
  return result.getNode();
}
