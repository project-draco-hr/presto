{
  boolean distributedJoinEnabled=SystemSessionProperties.isDistributedJoinEnabled(session,distributedJoins);
  boolean forceDistributedWriting=SystemSessionProperties.isForceDistributedWriting(session,this.forceDistributedWriting);
  boolean preferStreamingOperators=SystemSessionProperties.preferStreamingOperators(session,false);
  PlanWithProperties result=plan.accept(new Rewriter(symbolAllocator,idAllocator,symbolAllocator,session,distributedIndexJoins,distributedJoinEnabled,preferStreamingOperators,forceDistributedWriting),PreferredProperties.any());
  return result.getNode();
}
