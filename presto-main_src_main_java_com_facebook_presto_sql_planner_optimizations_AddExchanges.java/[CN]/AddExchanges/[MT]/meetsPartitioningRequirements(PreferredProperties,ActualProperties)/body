{
  if (!preferred.getPartitioningProperties().isPresent()) {
    return true;
  }
  PartitioningPreferences partitioningPreferences=preferred.getPartitioningProperties().get();
  if (!partitioningPreferences.isPartitioned()) {
    return !actual.isDistributed();
  }
  if (!partitioningPreferences.getPartitioningColumns().isPresent()) {
    return actual.isDistributed();
  }
  return actual.isPartitionedOn(partitioningPreferences.getPartitioningColumns().get());
}
