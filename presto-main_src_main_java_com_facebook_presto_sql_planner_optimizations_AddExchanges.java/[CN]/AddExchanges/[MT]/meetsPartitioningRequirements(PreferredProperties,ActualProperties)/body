{
  if (!preferred.getGlobalProperties().isPresent()) {
    return true;
  }
  PreferredProperties.Global preferredGlobal=preferred.getGlobalProperties().get();
  if (!preferredGlobal.isDistributed()) {
    return !actual.isDistributed();
  }
  if (!preferredGlobal.getPartitioningProperties().isPresent()) {
    return actual.isDistributed();
  }
  return actual.isPartitionedOn(preferredGlobal.getPartitioningProperties().get().getPartitioningColumns());
}
