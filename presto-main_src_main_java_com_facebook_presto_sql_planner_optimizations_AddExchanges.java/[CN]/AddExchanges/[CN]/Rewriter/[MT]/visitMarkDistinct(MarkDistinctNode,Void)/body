{
  PlanWithProperties child=node.getSource().accept(this,context);
  if (child.getProperties().isPartitioned() || isBigQueryEnabled(session,false)) {
    child=enforce(child,Requirements.of(PartitioningProperties.partitioned(node.getDistinctSymbols(),node.getHashSymbol())));
  }
  return propagateChildProperties(node,child);
}
