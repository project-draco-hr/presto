{
  List<LocalProperty<Symbol>> local=ImmutableList.<LocalProperty<Symbol>>builder().add(new GroupingProperty<>(groupingColumns)).addAll(preferencesFromParent.getLocalProperties()).build();
  Set<Symbol> partitioning=Sets.intersection(preferencesFromParent.getPartitioningColumns().orElse(ImmutableSet.of()),ImmutableSet.copyOf(partitioningColumns));
  if (partitioning.isEmpty()) {
    partitioning=ImmutableSet.copyOf(partitioningColumns);
  }
  return PreferredProperties.partitionedWithLocal(partitioning,local);
}
