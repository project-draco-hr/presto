{
  Set<Symbol> partitioning=Sets.intersection(preferencesFromParent.getPartitioningColumns().orElse(ImmutableSet.of()),ImmutableSet.copyOf(partitioningColumns));
  if (partitioning.isEmpty()) {
    partitioning=ImmutableSet.copyOf(partitioningColumns);
  }
  return PreferredProperties.partitioned(partitioning);
}
