{
  PlanWithProperties source=node.getSource().accept(this,context);
  if (!source.getProperties().isDistributed() && forceDistributedWriting) {
    source=withDerivedProperties(partitionedExchange(idAllocator.getNextId(),source.getNode(),Optional.empty(),Optional.empty()),source.getProperties());
  }
  return rebaseAndDeriveProperties(node,source);
}
