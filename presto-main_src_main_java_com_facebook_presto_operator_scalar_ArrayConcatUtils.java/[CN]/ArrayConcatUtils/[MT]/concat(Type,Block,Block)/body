{
  if (leftBlock.getPositionCount() == 0) {
    return rightBlock;
  }
  if (rightBlock.getPositionCount() == 0) {
    return leftBlock;
  }
  int totalSize=leftBlock.getSizeInBytes() + rightBlock.getSizeInBytes();
  int totalEntries=leftBlock.getPositionCount() + rightBlock.getPositionCount();
  BlockBuilder blockBuilder=elementType.createBlockBuilder(new BlockBuilderStatus(),totalEntries,(int)Math.ceil(totalSize / (double)totalEntries));
  for (int i=0; i < leftBlock.getPositionCount(); i++) {
    elementType.appendTo(leftBlock,i,blockBuilder);
  }
  for (int i=0; i < rightBlock.getPositionCount(); i++) {
    elementType.appendTo(rightBlock,i,blockBuilder);
  }
  return blockBuilder.build();
}
