{
switch (node.getSampleType()) {
case BERNOULLI:
    return node.getSource().accept(this,materializedViewPartitionPredicate);
case SYSTEM:
{
    NodeSplits nodeSplits=node.getSource().accept(this,materializedViewPartitionPredicate);
    if (nodeSplits.getDataSource().isPresent()) {
      SplitSource sampledSplitSource=new SampledSplitSource(nodeSplits.getDataSource().get(),node.getSampleRatio());
      return new NodeSplits(node.getId(),sampledSplitSource);
    }
 else {
      return nodeSplits;
    }
  }
default :
throw new UnsupportedOperationException("Sampling is not supported for type " + node.getSampleType());
}
}
