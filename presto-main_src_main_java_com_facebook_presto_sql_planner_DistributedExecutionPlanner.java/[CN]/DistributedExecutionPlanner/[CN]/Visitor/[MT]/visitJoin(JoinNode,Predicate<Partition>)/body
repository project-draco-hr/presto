{
  NodeSplits leftSplits=node.getLeft().accept(this,materializedViewPartitionPredicate);
  NodeSplits rightSplits=node.getRight().accept(this,materializedViewPartitionPredicate);
  if (leftSplits.dataSource.isPresent() && rightSplits.dataSource.isPresent()) {
    throw new IllegalArgumentException("Both left and right join nodes are partitioned");
  }
  return leftSplits.dataSource.isPresent() ? leftSplits : rightSplits;
}
