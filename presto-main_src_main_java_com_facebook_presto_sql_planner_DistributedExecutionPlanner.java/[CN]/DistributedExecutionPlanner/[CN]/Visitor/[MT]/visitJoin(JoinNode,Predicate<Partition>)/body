{
  NodeSplits leftSplits=node.getLeft().accept(this,materializedViewPartitionPredicate);
  NodeSplits rightSplits=node.getRight().accept(this,materializedViewPartitionPredicate);
  if (leftSplits.getDataSource().isPresent() && rightSplits.getDataSource().isPresent()) {
    throw new IllegalArgumentException("Both left and right join nodes are partitioned");
  }
  return leftSplits.getDataSource().isPresent() ? leftSplits : rightSplits;
}
