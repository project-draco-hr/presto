{
  TableWriter tableWriter=new TableWriter(node,shardManager);
  NodeSplits nodeSplits=node.getSource().accept(this,new VisitorContext(context.getInheritedPredicate(),tableWriter.getPartitionPredicate()));
  checkState(nodeSplits.splits.isPresent(),"No splits present for import");
  outputReceivers.put(node.getId(),tableWriter.getOutputReceiver());
  return new NodeSplits(node.getId(),Optional.of(tableWriter.getSplitAssignments(nodeSplits.planNodeId,nodeSplits.splits.get())));
}
