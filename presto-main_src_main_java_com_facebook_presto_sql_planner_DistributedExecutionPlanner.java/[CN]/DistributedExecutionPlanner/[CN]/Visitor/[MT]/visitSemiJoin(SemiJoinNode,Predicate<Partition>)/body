{
  NodeSplits sourceSplits=node.getSource().accept(this,materializedViewPartitionPredicate);
  NodeSplits filteringSourceSplits=node.getFilteringSource().accept(this,materializedViewPartitionPredicate);
  if (sourceSplits.getDataSource().isPresent() && filteringSourceSplits.getDataSource().isPresent()) {
    throw new IllegalArgumentException("Both source and filteringSource semi join nodes are partitioned");
  }
  return sourceSplits.getDataSource().isPresent() ? sourceSplits : filteringSourceSplits;
}
