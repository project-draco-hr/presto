{
  NodeSplits sourceSplits=node.getSource().accept(this,materializedViewPartitionPredicate);
  NodeSplits filteringSourceSplits=node.getFilteringSource().accept(this,materializedViewPartitionPredicate);
  if (sourceSplits.dataSource.isPresent() && filteringSourceSplits.dataSource.isPresent()) {
    throw new IllegalArgumentException("Both source and filteringSource semi join nodes are partitioned");
  }
  return sourceSplits.dataSource.isPresent() ? sourceSplits : filteringSourceSplits;
}
