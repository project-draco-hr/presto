{
  MaterializedViewWriter materializedViewWriter=new MaterializedViewWriter(node,shardManager);
  NodeSplits nodeSplits=node.getSource().accept(this,materializedViewWriter.getPartitionPredicate());
  checkState(nodeSplits.getDataSource().isPresent(),"No splits present for import");
  SplitSource splitSource=nodeSplits.getDataSource().get();
  outputReceivers.put(node.getId(),materializedViewWriter.getOutputReceiver());
  return new NodeSplits(node.getId(),materializedViewWriter.wrapSplitSource(nodeSplits.getPlanNodeId(),splitSource));
}
