{
  List<Partition> leftPartitions=node.getLeft().accept(this,context);
  List<Partition> rightPartitions=node.getRight().accept(this,context);
  if (!leftPartitions.isEmpty() && !rightPartitions.isEmpty()) {
    throw new IllegalArgumentException("Both left and right join nodes are partitioned");
  }
  if (!leftPartitions.isEmpty()) {
    return leftPartitions;
  }
 else {
    return rightPartitions;
  }
}
