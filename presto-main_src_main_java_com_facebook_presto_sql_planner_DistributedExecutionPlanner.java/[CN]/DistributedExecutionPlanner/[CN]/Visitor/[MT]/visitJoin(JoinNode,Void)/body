{
  Optional<SplitSource> leftSplits=node.getLeft().accept(this,context);
  Optional<SplitSource> rightSplits=node.getRight().accept(this,context);
  if (leftSplits.isPresent() && rightSplits.isPresent()) {
    throw new IllegalArgumentException("Both left and right join nodes are partitioned");
  }
  return leftSplits.isPresent() ? leftSplits : rightSplits;
}
