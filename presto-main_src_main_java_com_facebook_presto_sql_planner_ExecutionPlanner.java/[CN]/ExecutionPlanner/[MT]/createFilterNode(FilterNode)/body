{
  PlanNode source=Iterables.getOnlyElement(node.getSources());
  Operator sourceOperator=plan(source);
  Map<Slot,Integer> slotToChannelMappings=mapSlotsToChannels(source.getOutputs());
  FilterFunction filter=new InterpretedFilterFunction(node.getPredicate(),slotToChannelMappings);
  List<ProjectionFunction> projections=new ArrayList<>();
  for (int i=0; i < node.getOutputs().size(); i++) {
    Slot slot=node.getOutputs().get(i);
    ProjectionFunction function=ProjectionFunctions.singleColumn(slot.getType().getRawType(),slotToChannelMappings.get(slot),0);
    projections.add(function);
  }
  return new FilterAndProjectOperator(sourceOperator,filter,projections);
}
