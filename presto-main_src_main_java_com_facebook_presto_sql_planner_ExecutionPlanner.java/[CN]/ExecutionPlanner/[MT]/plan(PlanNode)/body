{
  if (plan instanceof AlignNode) {
    return createAlignmentNode((AlignNode)plan);
  }
 else   if (plan instanceof ProjectNode) {
    return createProjectNode((ProjectNode)plan);
  }
 else   if (plan instanceof FilterNode) {
    return createFilterNode((FilterNode)plan);
  }
 else   if (plan instanceof OutputPlan) {
    return plan(Iterables.getOnlyElement(plan.getSources()));
  }
 else   if (plan instanceof AggregationNode) {
    return createAggregationNode((AggregationNode)plan);
  }
  throw new UnsupportedOperationException("not yet implemented: " + plan.getClass().getName());
}
