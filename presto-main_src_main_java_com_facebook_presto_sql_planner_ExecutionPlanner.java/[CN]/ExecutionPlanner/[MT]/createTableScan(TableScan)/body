{
  TableMetadata tableMetadata=metadata.getTable(QualifiedName.of(node.getCatalogName(),node.getSchemaName(),node.getTableName()));
  Integer[] indicies=new Integer[node.getAttributes().size()];
  Map<Slot,Integer> slotToChannelMappings=mapSlotsToChannels(node.getOutputs());
  for (  Map.Entry<String,Slot> entry : node.getAttributes().entrySet()) {
    int channel=slotToChannelMappings.get(entry.getValue());
    indicies[channel]=findIndex(entry.getKey(),tableMetadata);
  }
  return storage.getOperator(node.getSchemaName(),node.getTableName(),Arrays.asList(indicies));
}
