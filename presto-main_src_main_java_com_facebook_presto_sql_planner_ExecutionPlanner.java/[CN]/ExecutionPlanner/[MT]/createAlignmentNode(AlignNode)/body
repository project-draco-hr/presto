{
  BlockIterable[] blocks=new BlockIterable[node.getSources().size()];
  for (int i=0; i < node.getSources().size(); i++) {
    PlanNode source=node.getSources().get(i);
    ColumnScan scan=(ColumnScan)source;
    TableMetadata tableMetadata=metadata.getTable(QualifiedName.of(scan.getCatalogName(),scan.getSchemaName(),scan.getTableName()));
    int index=0;
    for (    ColumnMetadata columnMetadata : tableMetadata.getColumns()) {
      if (columnMetadata.getName().equals(scan.getAttributeName())) {
        break;
      }
      ++index;
    }
    blocks[i]=storage.getBlocks(scan.getSchemaName(),scan.getTableName(),index);
  }
  return new AlignmentOperator(blocks);
}
