{
  FunctionRegistry.FunctionListBuilder builder=new FunctionRegistry.FunctionListBuilder(typeManager);
  for (  InternalAggregationFunction aggregation : new AggregationCompiler(typeManager).generateAggregationFunctions(clazz)) {
    builder.aggregate(aggregation);
  }
  return new GenericAggregationFunctionFactory(builder.getFunctions());
}
