{
  AggregationFunctionMetadata metadata=clazz.getAnnotation(AggregationFunctionMetadata.class);
  checkNotNull(metadata,"AggregationFunctionMetadata annotate missing");
  FunctionRegistry.FunctionListBuilder builder=new FunctionRegistry.FunctionListBuilder();
  for (  AggregationFunction aggregation : new AggregationCompiler().generateAggregationFunctions(clazz)) {
    builder.aggregate(metadata.value(),aggregation);
  }
  return new GenericAggregationFunctionFactory(builder.getFunctions());
}
