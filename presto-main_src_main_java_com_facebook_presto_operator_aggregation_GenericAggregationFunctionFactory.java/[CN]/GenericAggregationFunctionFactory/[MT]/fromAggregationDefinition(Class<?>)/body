{
  AggregationFunction metadata=clazz.getAnnotation(AggregationFunction.class);
  checkNotNull(metadata,"AggregationFunctionMetadata annotate missing");
  FunctionRegistry.FunctionListBuilder builder=new FunctionRegistry.FunctionListBuilder();
  for (  InternalAggregationFunction aggregation : new AggregationCompiler().generateAggregationFunctions(clazz)) {
    builder.aggregate(metadata.value(),aggregation);
  }
  return new GenericAggregationFunctionFactory(builder.getFunctions());
}
