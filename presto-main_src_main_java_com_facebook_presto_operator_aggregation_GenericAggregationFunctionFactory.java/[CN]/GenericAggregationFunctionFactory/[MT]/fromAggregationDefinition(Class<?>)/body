{
  AggregationFunctionMetadata metadata=clazz.getAnnotation(AggregationFunctionMetadata.class);
  checkNotNull(metadata,"AggregationFunctionMetadata annotate missing");
  return new GenericAggregationFunctionFactory(ImmutableMap.of(metadata.value(),new AggregationCompiler().generateAggregationFunction(clazz)));
}
