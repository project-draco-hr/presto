{
  assertEquals(expression.toString(),expectedRendering);
  ClassDefinition classDefinition=new ClassDefinition(new CompilerContext(BOOTSTRAP_METHOD),a(PUBLIC,FINAL),typeFromPathName("Test_" + CLASS_ID.incrementAndGet()),type(Object.class));
  classDefinition.declareMethod(new CompilerContext(BOOTSTRAP_METHOD),a(PUBLIC,STATIC),"test",expression.getType()).getBody().append(expression.ret());
  if (DUMP_BYTE_CODE_TREE) {
    DumpByteCodeVisitor dumpByteCode=new DumpByteCodeVisitor(System.out);
    dumpByteCode.visitClass(classDefinition);
  }
  DynamicClassLoader classLoader=new DynamicClassLoader();
  ClassWriter cw=new SmartClassWriter(ClassInfoLoader.createClassInfoLoader(ImmutableList.of(classDefinition),classLoader));
  classDefinition.visit(cw);
  Class<?> clazz=classLoader.defineClass(classDefinition.getType().getJavaClassName(),cw.toByteArray());
  Object actual=clazz.getMethod("test").invoke(null);
  assertEquals(actual,expected);
}
