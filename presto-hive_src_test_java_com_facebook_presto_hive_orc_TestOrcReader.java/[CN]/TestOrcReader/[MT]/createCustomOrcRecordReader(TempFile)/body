{
  Path path=new Path(tempFile.getFile().toURI());
  FileSystem fileSystem=path.getFileSystem(new Configuration());
  long size=fileSystem.getFileStatus(path).getLen();
  FSDataInputStream inputStream=fileSystem.open(path);
  try {
    HdfsOrcDataSource orcDataSource=new HdfsOrcDataSource(path.toString(),inputStream,size);
    OrcReader orcReader=new OrcReader(orcDataSource,new OrcMetadataReader());
    return orcReader.createRecordReader(ImmutableSet.of(0),new OrcPredicate(){
      @Override public boolean matches(      long numberOfRows,      Map<Integer,ColumnStatistics> statisticsByHiveColumnIndex){
        return true;
      }
    }
,0,tempFile.getFile().length(),HIVE_STORAGE_TIME_ZONE,HIVE_STORAGE_TIME_ZONE);
  }
 catch (  Throwable e) {
    inputStream.close();
    throw e;
  }
}
