{
  Path path=new Path(tempFile.getFile().toURI());
  FileSystem fileSystem=path.getFileSystem(new Configuration());
  long size=fileSystem.getFileStatus(path).getLen();
  FSDataInputStream inputStream=fileSystem.open(path);
  try {
    HdfsOrcDataSource orcDataSource=new HdfsOrcDataSource(path.toString(),inputStream,size);
    OrcReader orcReader=new OrcReader(orcDataSource,TYPE_MANAGER);
    Type type=getType(objectInspector,TYPE_MANAGER);
    checkArgument(type != null,"No type for object inspector: %s",objectInspector);
    HiveColumnHandle columnHandle=new HiveColumnHandle("clientId","col_0",0,HiveType.toHiveType(type),type.getTypeSignature(),0,false);
    return orcReader.createRecordReader(0,tempFile.getFile().length(),ImmutableList.of(columnHandle),TupleDomain.<HiveColumnHandle>all(),HIVE_STORAGE_TIME_ZONE,HIVE_STORAGE_TIME_ZONE);
  }
 catch (  Throwable e) {
    inputStream.close();
    throw e;
  }
}
