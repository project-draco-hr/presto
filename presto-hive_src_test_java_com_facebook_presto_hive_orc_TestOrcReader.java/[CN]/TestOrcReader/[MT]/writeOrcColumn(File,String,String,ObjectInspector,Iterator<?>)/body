{
  RecordWriter recordWriter;
  if ("DWRF".equals(formatVersion)) {
    recordWriter=createDwrfRecordWriter(outputFile,compressionCodec,columnObjectInspector);
  }
 else {
    recordWriter=createOrcRecordWriter(outputFile,formatVersion,compressionCodec,columnObjectInspector);
  }
  SettableStructObjectInspector objectInspector=createSettableStructObjectInspector("test",columnObjectInspector);
  Object row=objectInspector.create();
  List<StructField> fields=ImmutableList.copyOf(objectInspector.getAllStructFieldRefs());
  while (values.hasNext()) {
    Object value=values.next();
    objectInspector.setStructFieldData(row,fields.get(0),value);
    @SuppressWarnings("deprecation") Serializer serde;
    if ("DWRF".equals(formatVersion)) {
      serde=new com.facebook.hive.orc.OrcSerde();
    }
 else {
      serde=new OrcSerde();
    }
    Writable record=serde.serialize(row,objectInspector);
    recordWriter.write(record);
  }
  recordWriter.close(false);
  return new DataSize(outputFile.length(),Unit.BYTE).convertToMostSuccinctDataSize();
}
