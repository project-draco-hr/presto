{
  for (  String formatVersion : ImmutableList.of("0.12","DWRF")) {
    MetadataReader metadataReader;
    if ("DWRF".equals(formatVersion)) {
      if (hasType(objectInspector,PrimitiveCategory.DATE)) {
        return;
      }
      metadataReader=new DwrfMetadataReader();
    }
 else {
      metadataReader=new OrcMetadataReader();
    }
    for (    String compressionKind : ImmutableList.of("ZLIB")) {
      try (TempFile tempFile=new TempFile("test","orc")){
        writeOrcColumn(tempFile.getFile(),formatVersion,compressionKind,objectInspector,writeValues.iterator());
        assertFileContents(objectInspector,tempFile,readValues,false,metadataReader);
        assertFileContents(objectInspector,tempFile,readValues,true,metadataReader);
      }
     }
  }
}
