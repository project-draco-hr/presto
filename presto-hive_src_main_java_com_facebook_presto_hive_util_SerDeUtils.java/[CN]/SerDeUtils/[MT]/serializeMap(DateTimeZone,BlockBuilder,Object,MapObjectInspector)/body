{
  Map<?,?> map=inspector.getMap(object);
  if (map == null) {
    checkNotNull(builder,"parent builder is null").appendNull();
    return null;
  }
  ObjectInspector keyInspector=inspector.getMapKeyObjectInspector();
  ObjectInspector valueInspector=inspector.getMapValueObjectInspector();
  BlockBuilder currentBuilder=createBlockBuilder();
  for (  Map.Entry<?,?> entry : map.entrySet()) {
    if (entry.getKey() != null) {
      serializeObject(sessionTimeZone,currentBuilder,entry.getKey(),keyInspector);
      serializeObject(sessionTimeZone,currentBuilder,entry.getValue(),valueInspector);
    }
  }
  SliceOutput out=new DynamicSliceOutput(1024);
  currentBuilder.getEncoding().writeBlock(out,currentBuilder.build());
  if (builder != null) {
    VARBINARY.writeSlice(builder,out.slice());
  }
  return out.slice();
}
