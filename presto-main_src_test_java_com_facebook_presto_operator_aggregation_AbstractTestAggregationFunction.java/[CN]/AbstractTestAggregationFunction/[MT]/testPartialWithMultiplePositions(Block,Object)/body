{
  UncompressedBlock partialsBlock=performPartialAggregation(block);
  Aggregator function=createAggregator(aggregation(getFunction(),0),Step.FINAL);
  BlockCursor partialsCursor=partialsBlock.cursor();
  while (partialsCursor.advanceNextPosition()) {
    function.addValue(partialsCursor);
  }
  assertEquals(getActualValue(function),expectedValue);
}
