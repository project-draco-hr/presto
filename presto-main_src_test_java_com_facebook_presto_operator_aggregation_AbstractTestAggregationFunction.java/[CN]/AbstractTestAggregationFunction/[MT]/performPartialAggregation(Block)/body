{
  BlockBuilder blockBuilder=new BlockBuilder(getFunction().getIntermediateTupleInfo());
  BlockCursor cursor=block.cursor();
  while (cursor.advanceNextPosition()) {
    AggregationFunctionStep function=partialAggregation(getFunction());
    function.add(cursor);
    Tuple tuple=function.evaluate();
    blockBuilder.append(tuple);
  }
  return blockBuilder.build();
}
