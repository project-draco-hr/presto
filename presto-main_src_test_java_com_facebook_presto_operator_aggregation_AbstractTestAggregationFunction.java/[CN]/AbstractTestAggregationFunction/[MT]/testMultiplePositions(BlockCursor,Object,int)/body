{
  Aggregator function=createAggregator(aggregation(getFunction(),0),Step.SINGLE);
  for (int i=0; i < positions; i++) {
    assertTrue(cursor.advanceNextPosition());
    function.addValue(new BlockCursor[]{cursor});
  }
  Object actualValue=getActualValue(function);
  assertEquals(actualValue,expectedValue);
  if (positions > 0) {
    assertEquals(cursor.getPosition(),positions - 1);
  }
}
