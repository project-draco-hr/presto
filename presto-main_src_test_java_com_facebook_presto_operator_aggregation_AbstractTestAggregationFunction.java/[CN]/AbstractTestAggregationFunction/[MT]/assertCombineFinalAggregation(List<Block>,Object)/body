{
  Block combinedBlock=null;
  for (  Block block : blocks) {
    AggregationFunctionStep function=combinerAggregation(getFunction());
    if (combinedBlock != null) {
      BlockCursor intermediateCursor=combinedBlock.cursor();
      assertTrue(intermediateCursor.advanceNextPosition());
      function.add(intermediateCursor);
    }
    BlockCursor intermediateCursor=block.cursor();
    assertTrue(intermediateCursor.advanceNextPosition());
    function.add(intermediateCursor);
    Tuple tuple=function.evaluate();
    combinedBlock=new BlockBuilder(getFunction().getIntermediateTupleInfo()).append(tuple).build();
  }
  assertFinalAggregation(combinedBlock,expectedValue);
}
