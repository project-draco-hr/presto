{
  AggregationFunctionStep function=singleNodeAggregation(getFunction());
  for (int i=0; i < positions; i++) {
    assertTrue(cursor.advanceNextPosition());
    function.add(cursor);
  }
  assertEquals(getActualValue(function),expectedValue);
  if (positions > 0) {
    assertEquals(cursor.getPosition(),positions - 1);
  }
}
