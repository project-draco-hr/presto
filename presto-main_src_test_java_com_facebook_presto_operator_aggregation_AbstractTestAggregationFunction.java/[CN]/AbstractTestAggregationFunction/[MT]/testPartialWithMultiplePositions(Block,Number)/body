{
  UncompressedBlock partialsBlock=performPartialAggregation(block);
  AggregationFunction function=finalAggregation(getFullFunction());
  BlockCursor partialsCursor=partialsBlock.cursor();
  while (partialsCursor.advanceNextPosition()) {
    function.add(partialsCursor);
  }
  assertEquals(getActualValue(function),expectedValue);
}
