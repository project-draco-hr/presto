{
  UncompressedBlock partialsBlock=performPartialAggregation(block);
  AggregationFunctionStep function=finalAggregation(getFunction());
  BlockCursor partialsCursor=partialsBlock.cursor();
  while (partialsCursor.advanceNextPosition()) {
    function.add(partialsCursor);
  }
  assertEquals(getActualValue(function),expectedValue);
}
