{
  UncompressedBlock partialsBlock=performPartialAggregation(block);
  Aggregator function=createAggregator(aggregation(getFunction(),0),Step.FINAL);
  BlockCursor blockCursor=partialsBlock.cursor();
  while (blockCursor.advanceNextPosition()) {
    function.addValue(blockCursor);
  }
  assertEquals(getActualValue(function),expectedValue);
}
