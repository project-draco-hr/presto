{
  if (rowCount >= maxRowCount) {
    storagePageSink.close();
    storagePageSink=createPageSink(storageManager,storageOutputHandle);
    rowCount=0;
  }
  if (sampleWeightField >= 0) {
    page=createPageWithSampleWeightBlock(page,sampleWeightBlock);
  }
  appendPage(page);
  rowCount+=page.getPositionCount();
}
