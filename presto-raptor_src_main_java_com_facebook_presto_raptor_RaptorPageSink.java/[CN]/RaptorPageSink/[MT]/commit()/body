{
  flushPages(pageBuffer.getPages());
  List<ShardInfo> shards=storagePageSink.commit();
  ImmutableList.Builder<Slice> fragments=ImmutableList.builder();
  for (  ShardInfo shard : shards) {
    fragments.add(Slices.wrappedBuffer(shardInfoCodec.toJsonBytes(shard)));
  }
  return fragments.build();
}
