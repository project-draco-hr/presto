{
  DynamicClassLoader classLoader=new DynamicClassLoader(ChecksumAggregation.class.getClassLoader());
  List<Type> inputTypes=ImmutableList.of(type);
  AggregationMetadata metadata=new AggregationMetadata(generateAggregationName(NAME,type,inputTypes),createInputParameterMetadata(type),INPUT_FUNCTION.bindTo(type),null,null,COMBINE_FUNCTION,OUTPUT_FUNCTION,NullableLongState.class,new StateCompiler().generateStateSerializer(NullableLongState.class,classLoader),new StateCompiler().generateStateFactory(NullableLongState.class,classLoader),VARBINARY,false);
  GenericAccumulatorFactoryBinder factory=new AccumulatorCompiler().generateAccumulatorFactoryBinder(metadata,classLoader);
  return new InternalAggregationFunction(NAME,inputTypes,BIGINT,VARBINARY,true,false,factory);
}
