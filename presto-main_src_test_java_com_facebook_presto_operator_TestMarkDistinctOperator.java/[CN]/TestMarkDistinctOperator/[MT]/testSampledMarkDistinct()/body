{
  List<Page> input=rowPagesBuilder(BIGINT).addSequencePage(100,0).addSequencePage(100,0).build();
  input=appendSampleWeight(input,2);
  OperatorFactory operatorFactory=new MarkDistinctOperatorFactory(0,ImmutableList.of(BIGINT,BIGINT),ImmutableList.of(0),Optional.of(1));
  Operator operator=operatorFactory.createOperator(driverContext);
  MaterializedResult.Builder expected=resultBuilder(driverContext.getSession(),BIGINT,BIGINT,BOOLEAN);
  for (int i=0; i < 100; i++) {
    expected.row(i,1,true);
    expected.row(i,1,false);
    expected.row(i,2,false);
  }
  OperatorAssertion.assertOperatorEqualsIgnoreOrder(operator,input,expected.build());
}
