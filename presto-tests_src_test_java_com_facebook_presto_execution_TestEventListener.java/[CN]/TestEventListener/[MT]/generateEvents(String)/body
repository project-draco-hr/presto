{
  EventsBuilder generatedEvents=new EventsBuilder();
  try {
    queryRunner=new DistributedQueryRunner(testSessionBuilder().build(),1);
    queryRunner.installPlugin(new TpchPlugin());
    queryRunner.installPlugin(new TestingEventListenerPlugin(generatedEvents));
    queryRunner.createCatalog("tpch","tpch",ImmutableMap.of());
  }
 catch (  Exception e) {
    queryRunner.close();
    throw e;
  }
  session=testSessionBuilder().setCatalog("tpch").setSchema("tiny").build();
  queryRunner.execute(session,sql);
  queryRunner.close();
  return generatedEvents;
}
