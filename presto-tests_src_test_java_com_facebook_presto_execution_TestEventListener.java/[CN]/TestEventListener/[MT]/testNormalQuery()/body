{
  EventsBuilder events=generateEvents("SELECT sum(linenumber) FROM lineitem");
  assertEquals(events.getQueryCreatedEvents().size(),1);
  QueryCreatedEvent queryCreatedEvent=getOnlyElement(events.getQueryCreatedEvents());
  assertEquals(queryCreatedEvent.getContext().getEnvironment(),"testing");
  assertEquals(queryCreatedEvent.getMetadata().getQuery(),"SELECT sum(linenumber) FROM lineitem");
  assertEquals(events.getQueryCompletedEvents().size(),1);
  QueryCompletedEvent queryCompletedEvent=getOnlyElement(events.getQueryCompletedEvents());
  assertEquals(queryCompletedEvent.getIoMetadata().getOutput(),Optional.empty());
  assertEquals(queryCompletedEvent.getIoMetadata().getInputs().size(),1);
  assertEquals(getOnlyElement(queryCompletedEvent.getIoMetadata().getInputs()).getConnectorId(),"tpch");
  assertTrue(events.getSplitCompletedEvents().size() >= queryCompletedEvent.getStatistics().getCompletedSplits());
}
