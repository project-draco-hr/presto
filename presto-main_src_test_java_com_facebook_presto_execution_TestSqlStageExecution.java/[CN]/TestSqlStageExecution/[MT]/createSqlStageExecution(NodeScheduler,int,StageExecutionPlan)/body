{
  ExecutorService remoteTaskExecutor=newCachedThreadPool(daemonThreadsNamed("remoteTaskExecutor-%s"));
  MockRemoteTaskFactory remoteTaskFactory=new MockRemoteTaskFactory(remoteTaskExecutor);
  ExecutorService executor=newCachedThreadPool(daemonThreadsNamed("stageExecutor-%s"));
  OutputBuffers outputBuffers=INITIAL_EMPTY_OUTPUT_BUFFERS.withBuffer(OUT,new UnpartitionedPagePartitionFunction()).withNoMoreBufferIds();
  return new SqlStageExecution(new QueryId("query"),locationFactory,tableScanPlan,nodeScheduler,remoteTaskFactory,TEST_SESSION,splitBatchSize,8,executor,nodeTaskMap,outputBuffers);
}
