{
  StageId stageId=new StageId(new QueryId("query"),"stage");
  SqlStageExecution stage=new SqlStageExecution(stageId,locationFactory.createStageLocation(stageId),tableScanPlan.getFragment(),tableScanPlan.getDataSource(),nodeScheduler,new MockRemoteTaskFactory(executor),TEST_SESSION,splitBatchSize,8,nodeTaskMap,executor);
  stage.setOutputBuffers(INITIAL_EMPTY_OUTPUT_BUFFERS.withBuffer(OUT,new UnpartitionedPagePartitionFunction()).withNoMoreBufferIds());
  return stage;
}
