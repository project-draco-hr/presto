{
  int splitCount=20;
  ExecutorService remoteTaskExecutor=newCachedThreadPool(daemonThreadsNamed("remoteTaskExecutor"));
  MockRemoteTaskFactory remoteTaskFactory=new MockRemoteTaskFactory(remoteTaskExecutor);
  ExecutorService executor=newCachedThreadPool(daemonThreadsNamed("stageExecutor"));
  OutputBuffers outputBuffers=INITIAL_EMPTY_OUTPUT_BUFFERS.withBuffer("out",new UnpartitionedPagePartitionFunction()).withNoMoreBufferIds();
  StageExecutionPlan tableScanPlan=createTableScanPlan("test",splitCount);
  return new SqlStageExecution(new QueryId("query"),locationFactory,tableScanPlan,nodeScheduler,remoteTaskFactory,SESSION,splitBatchSize,maxPendingSplitsPerNode,8,executor,outputBuffers);
}
