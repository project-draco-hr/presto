{
  StageExecutionPlan build=createTableScanPlan("build",1,splitFactory);
  RemoteSourceNode buildSource=new RemoteSourceNode(new PlanNodeId(planId + "-build"),build.getFragment().getId(),ImmutableList.copyOf(build.getFragment().getSymbols().keySet()));
  StageExecutionPlan probe=createTableScanPlan("probe",10,splitFactory);
  RemoteSourceNode probeSource=new RemoteSourceNode(new PlanNodeId(planId + "-probe"),probe.getFragment().getId(),ImmutableList.copyOf(probe.getFragment().getSymbols().keySet()));
  JoinNode joinNode=new JoinNode(new PlanNodeId(planId),JoinNode.Type.INNER,probeSource,buildSource,ImmutableList.<EquiJoinClause>of(),Optional.empty(),Optional.empty());
  PlanFragment joinPlan=new PlanFragment(new PlanFragmentId(planId),joinNode,probe.getFragment().getSymbols(),joinNode.getOutputSymbols(),PlanDistribution.SOURCE,new PlanNodeId(planId),OutputPartitioning.NONE,Optional.empty(),Optional.empty());
  return new StageExecutionPlan(joinPlan,probe.getDataSource(),ImmutableList.of(probe,build));
}
