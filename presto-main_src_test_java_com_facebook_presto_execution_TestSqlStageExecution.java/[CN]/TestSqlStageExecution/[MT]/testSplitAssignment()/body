{
  SqlStageExecution sqlStageExecution1=createSqlStageExecution(nodeScheduler,2,15);
  Future future1=sqlStageExecution1.start();
  future1.get(1,TimeUnit.SECONDS);
  Map<Node,RemoteTask> tasks1=sqlStageExecution1.getTasks();
  for (  Map.Entry<Node,RemoteTask> entry : tasks1.entrySet()) {
    assertEquals(entry.getValue().getPartitionedSplitCount(),5);
  }
  Node additionalNode=new PrestoNode("other4",URI.create("http://127.0.0.1:14"),NodeVersion.UNKNOWN);
  nodeManager.addNode("foo",additionalNode);
  SqlStageExecution sqlStageExecution2=createSqlStageExecution(nodeScheduler,5,5);
  Future future2=sqlStageExecution2.start();
  future2.get(1,TimeUnit.SECONDS);
  Map<Node,RemoteTask> tasks2=sqlStageExecution2.getTasks();
  RemoteTask task=tasks2.get(additionalNode);
  assertNotNull(task);
  assertEquals(task.getPartitionedSplitCount(),5);
}
