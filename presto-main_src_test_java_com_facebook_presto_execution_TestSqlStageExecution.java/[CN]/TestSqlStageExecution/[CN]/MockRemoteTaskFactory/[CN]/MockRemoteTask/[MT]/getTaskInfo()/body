{
  TaskState state=taskStateMachine.getState();
  List<ExecutionFailureInfo> failures=ImmutableList.of();
  if (state == TaskState.FAILED) {
    failures=toFailures(taskStateMachine.getFailureCauses());
  }
  return new TaskInfo(taskStateMachine.getTaskId(),nextTaskInfoVersion.getAndIncrement(),state,location,DateTime.now(),sharedBuffer.getInfo(),ImmutableSet.<PlanNodeId>of(),taskContext.getTaskStats(),failures);
}
