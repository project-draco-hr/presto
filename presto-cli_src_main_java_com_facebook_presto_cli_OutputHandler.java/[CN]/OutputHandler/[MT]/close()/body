{
  if (!closed.getAndSet(true)) {
    flush();
    printer.finish();
  }
}
