{
  while (client.isValid()) {
    Iterable<List<Object>> data=client.current().getData();
    if (data != null) {
      for (      List<Object> tuple : data) {
        processRow(unmodifiableList(tuple));
      }
    }
    if (nanosSince(bufferStart).compareTo(MAX_BUFFER_TIME) >= 0) {
      flush();
    }
    client.advance();
  }
}
