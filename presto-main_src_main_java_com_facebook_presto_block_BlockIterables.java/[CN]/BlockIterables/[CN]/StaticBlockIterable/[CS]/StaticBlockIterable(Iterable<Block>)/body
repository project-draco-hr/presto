{
  Preconditions.checkNotNull(blocks,"blocks is null");
  this.blocks=ImmutableList.copyOf(blocks);
  Preconditions.checkArgument(!this.blocks.isEmpty(),"blocks is empty");
  long positionCount=0;
  long dataSize=0;
  for (  Block block : this.blocks) {
    positionCount+=block.getPositionCount();
    dataSize+=block.getDataSize().toBytes();
  }
  this.positionCount=Ints.checkedCast(positionCount);
  this.dataSize=new DataSize(dataSize,BYTE);
}
