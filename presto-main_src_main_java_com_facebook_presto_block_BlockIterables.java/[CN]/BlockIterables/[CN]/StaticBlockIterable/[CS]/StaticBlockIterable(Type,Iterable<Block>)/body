{
  this.type=checkNotNull(type,"type is null");
  this.blocks=ImmutableList.copyOf(checkNotNull(blocks,"blocks is null"));
  long positionCount=0;
  long dataSize=0;
  for (  Block block : this.blocks) {
    positionCount+=block.getPositionCount();
    dataSize+=block.getDataSize().toBytes();
  }
  this.positionCount=Ints.checkedCast(positionCount);
  this.dataSize=new DataSize(dataSize,BYTE);
}
