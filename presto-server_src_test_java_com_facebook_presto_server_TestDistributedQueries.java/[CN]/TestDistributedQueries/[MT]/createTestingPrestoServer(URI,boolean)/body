{
  Map<String,String> properties=ImmutableMap.<String,String>builder().put("query.client.timeout","10m").put("exchange.http-client.read-timeout","1h").put("datasources","default,tpch,tpch_sampled").build();
  TestingPrestoServer server=new TestingPrestoServer(coordinator,properties,ENVIRONMENT,discoveryUri,ImmutableList.<Module>of());
  server.installPlugin(new TpchPlugin());
  server.createConnection("tpch","tpch");
  server.installPlugin(new SampledTpchPlugin());
  server.createConnection("tpch_sampled","tpch_sampled");
  File baseDir=server.getBaseDataDir().toFile();
  Map<String,String> raptorProperties=ImmutableMap.<String,String>builder().put("metadata.db.type","h2").put("metadata.db.filename",new File(baseDir,"db").getAbsolutePath()).put("storage.data-directory",new File(baseDir,"data").getAbsolutePath()).build();
  server.installPlugin(new RaptorPlugin());
  server.createConnection("default","raptor",raptorProperties);
  return server;
}
