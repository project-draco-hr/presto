{
  try {
    assertQuery("CREATE TABLE " + table + " AS "+ query,rowCountQuery);
    assertQuery("SELECT * FROM " + table,expectedQuery);
  }
  finally {
    QualifiedTableName name=new QualifiedTableName(TEST_CATALOG,"test",table);
    Optional<TableHandle> handle=coordinator.getMetadata().getTableHandle(SESSION,name);
    if (handle.isPresent()) {
      coordinator.getMetadata().dropTable(handle.get());
    }
  }
}
