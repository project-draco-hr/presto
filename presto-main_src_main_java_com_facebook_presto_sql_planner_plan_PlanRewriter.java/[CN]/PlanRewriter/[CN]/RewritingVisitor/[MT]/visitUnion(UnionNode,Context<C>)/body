{
  if (!context.isDefaultRewrite()) {
    PlanNode result=nodeRewriter.rewriteUnion(node,context.get(),PlanRewriter.this);
    if (result != null) {
      return result;
    }
  }
  boolean modified=false;
  ImmutableList.Builder<PlanNode> builder=ImmutableList.builder();
  for (  PlanNode subPlan : node.getSources()) {
    PlanNode rewriteSubPlan=rewrite(subPlan,context.get());
    if (rewriteSubPlan != subPlan) {
      modified=true;
    }
    builder.add(rewriteSubPlan);
  }
  if (modified) {
    return new UnionNode(node.getId(),builder.build(),node.getOutputSymbols());
  }
  return node;
}
