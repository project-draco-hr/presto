{
  checkNotNull(block,"block is null");
  checkState(!finished,"already finished");
  if (tupleInfo == null) {
    tupleInfo=block.getTupleInfo();
    dictionaryBuilder=new DictionaryBuilder(tupleInfo);
  }
  BlockCursor cursor=block.cursor();
  while (cursor.advanceNextPosition()) {
    long id=dictionaryBuilder.getId(cursor.getTuple());
    idWriter.append(createTuple(id));
  }
  return this;
}
