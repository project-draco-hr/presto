{
  checkNotNull(tuple,"tuple is null");
  checkState(!finished,"already finished");
  if (tupleInfo == null) {
    tupleInfo=tuple.getTupleInfo();
    dictionaryBuilder=new DictionaryBuilder(tupleInfo);
  }
  long id=dictionaryBuilder.getId(tuple);
  idWriter.append(createTuple(id));
  return this;
}
