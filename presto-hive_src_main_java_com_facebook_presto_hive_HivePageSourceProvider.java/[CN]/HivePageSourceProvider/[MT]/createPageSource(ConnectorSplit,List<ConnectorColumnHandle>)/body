{
  HiveSplit hiveSplit=checkType(split,HiveSplit.class,"split");
  String clientId=hiveSplit.getClientId();
  ConnectorSession session=hiveSplit.getSession();
  Path path=new Path(hiveSplit.getPath());
  long start=hiveSplit.getStart();
  long length=hiveSplit.getLength();
  Configuration configuration=hdfsEnvironment.getConfiguration(path);
  TupleDomain<HiveColumnHandle> tupleDomain=hiveSplit.getTupleDomain();
  Properties schema=hiveSplit.getSchema();
  List<HivePartitionKey> partitionKeys=hiveSplit.getPartitionKeys();
  List<HiveColumnHandle> hiveColumns=ImmutableList.copyOf(transform(columns,hiveColumnHandle()));
  HiveRecordCursor recordCursor=getHiveRecordCursor(clientId,session,configuration,path,start,length,schema,tupleDomain,partitionKeys,hiveColumns);
  if (recordCursor == null) {
    throw new RuntimeException("Configured cursor providers did not provide a cursor");
  }
  List<Type> columnTypes=ImmutableList.copyOf(transform(hiveColumns,nativeTypeGetter(typeManager)));
  RecordPageSource recordPageSource=new RecordPageSource(columnTypes,recordCursor);
  return recordPageSource;
}
