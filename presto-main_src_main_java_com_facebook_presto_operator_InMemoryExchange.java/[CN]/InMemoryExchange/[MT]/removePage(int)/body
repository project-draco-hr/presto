{
  PageReference pageReference=buffers.get(bufferIndex).poll();
  if (pageReference == null) {
    return null;
  }
  Page page=pageReference.removePage();
  if (!pageReference.isReferenced()) {
    bufferBytes-=page.getSizeInBytes();
    if (bufferBytes < maxBufferedBytes) {
      notifyBlockedWriters();
    }
  }
  return page;
}
