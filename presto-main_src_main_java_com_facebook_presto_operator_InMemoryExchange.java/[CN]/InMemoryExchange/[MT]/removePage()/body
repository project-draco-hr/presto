{
  Page page=buffer.poll();
  if (page != null) {
    bufferBytes-=page.getSizeInBytes();
  }
  if (bufferBytes < maxBufferedBytes) {
    notifyBlockedWriters();
  }
  return page;
}
