{
  Page page=buffer.poll();
  if (page != null) {
    bufferBytes-=page.getDataSize().toBytes();
  }
  if (bufferBytes < maxBufferedBytes) {
    notifyBlockedWriters();
  }
  return page;
}
