{
  this.types=ImmutableList.copyOf(checkNotNull(types,"types is null"));
  this.buffer=new ConcurrentLinkedQueue<>();
  checkArgument(maxBufferedBytes.toBytes() > 0,"maxBufferedBytes must be greater than zero");
  this.maxBufferedBytes=maxBufferedBytes.toBytes();
}
