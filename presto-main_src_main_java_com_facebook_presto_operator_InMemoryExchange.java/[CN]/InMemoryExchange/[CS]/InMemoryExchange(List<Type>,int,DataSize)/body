{
  this.types=ImmutableList.copyOf(requireNonNull(types,"types is null"));
  ImmutableList.Builder<Queue<PageReference>> buffers=ImmutableList.builder();
  for (int i=0; i < bufferCount; i++) {
    buffers.add(new ConcurrentLinkedQueue<>());
  }
  this.buffers=buffers.build();
  checkArgument(maxBufferedBytes.toBytes() > 0,"maxBufferedBytes must be greater than zero");
  this.maxBufferedBytes=maxBufferedBytes.toBytes();
}
