{
  ClassDefinition classDefinition=new ClassDefinition(new CompilerContext(bootstrapMethod),a(PUBLIC,FINAL),typeFromPathName("JoinProbe_" + CLASS_ID.incrementAndGet()),type(Object.class),type(JoinProbe.class));
  FieldDefinition lookupSourceField=classDefinition.declareField(a(PRIVATE,FINAL),"lookupSource",LookupSource.class);
  FieldDefinition positionCountField=classDefinition.declareField(a(PRIVATE,FINAL),"positionCount",int.class);
  List<FieldDefinition> blockFields=new ArrayList<>();
  for (int i=0; i < channelCount; i++) {
    FieldDefinition channelField=classDefinition.declareField(a(PRIVATE,FINAL),"block_" + i,com.facebook.presto.spi.block.Block.class);
    blockFields.add(channelField);
  }
  List<FieldDefinition> probeBlockFields=new ArrayList<>();
  for (int i=0; i < probeChannels.size(); i++) {
    FieldDefinition channelField=classDefinition.declareField(a(PRIVATE,FINAL),"probeBlock_" + i,com.facebook.presto.spi.block.Block.class);
    probeBlockFields.add(channelField);
  }
  FieldDefinition probeBlocksArrayField=classDefinition.declareField(a(PRIVATE,FINAL),"probeBlocks",com.facebook.presto.spi.block.Block[].class);
  FieldDefinition positionField=classDefinition.declareField(a(PRIVATE),"position",int.class);
  generateConstructor(classDefinition,probeChannels,lookupSourceField,blockFields,probeBlockFields,probeBlocksArrayField,positionField,positionCountField);
  generateGetChannelCountMethod(classDefinition,blockFields.size());
  generateAppendToMethod(classDefinition,blockFields,positionField);
  generateAdvanceNextPosition(classDefinition,positionField,positionCountField);
  generateGetCurrentJoinPosition(classDefinition,lookupSourceField,probeBlocksArrayField,positionField);
  generateCurrentRowContainsNull(classDefinition,probeBlockFields,positionField);
  Class<? extends JoinProbe> joinProbeClass=defineClass(classDefinition,JoinProbe.class,classLoader);
  return joinProbeClass;
}
