{
  DynamicClassLoader classLoader=new DynamicClassLoader(getClass().getClassLoader());
  Class<? extends JoinProbe> joinProbeClass=compileJoinProbe(types,probeJoinChannel,classLoader);
  ClassDefinition classDefinition=new ClassDefinition(new CompilerContext(BOOTSTRAP_METHOD),a(PUBLIC,FINAL),makeClassName("JoinProbeFactory"),type(Object.class),type(JoinProbeFactory.class));
  classDefinition.declareDefaultConstructor(a(PUBLIC));
  classDefinition.declareMethod(new CompilerContext(BOOTSTRAP_METHOD),a(PUBLIC),"createJoinProbe",type(JoinProbe.class),arg("lookupSource",LookupSource.class),arg("page",Page.class)).getBody().newObject(joinProbeClass).dup().getVariable("lookupSource").getVariable("page").invokeConstructor(joinProbeClass,LookupSource.class,Page.class).retObject();
  Class<? extends JoinProbeFactory> joinProbeFactoryClass=defineClass(classDefinition,JoinProbeFactory.class,classLoader);
  JoinProbeFactory joinProbeFactory;
  try {
    joinProbeFactory=joinProbeFactoryClass.newInstance();
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
  Class<? extends OperatorFactory> operatorFactoryClass=IsolatedClass.isolateClass(classLoader,OperatorFactory.class,LookupJoinOperatorFactory.class,LookupJoinOperator.class);
  return new HashJoinOperatorFactoryFactory(joinProbeFactory,operatorFactoryClass);
}
