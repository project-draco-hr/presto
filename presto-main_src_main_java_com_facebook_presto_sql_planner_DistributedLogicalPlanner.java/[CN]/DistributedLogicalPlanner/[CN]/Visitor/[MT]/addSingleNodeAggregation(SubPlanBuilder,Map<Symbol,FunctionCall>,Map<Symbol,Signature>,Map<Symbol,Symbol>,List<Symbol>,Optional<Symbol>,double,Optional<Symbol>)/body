{
  plan.setRoot(new SinkNode(idAllocator.getNextId(),plan.getRoot(),plan.getRoot().getOutputSymbols()));
  ExchangeNode source=new ExchangeNode(idAllocator.getNextId(),plan.getId(),plan.getRoot().getOutputSymbols());
  AggregationNode aggregation=new AggregationNode(idAllocator.getNextId(),source,groupBy,aggregations,functions,masks,SINGLE,sampleWeight,confidence,hashSymbol);
  plan=createSingleNodePlan(aggregation).addChild(plan.build());
  return plan;
}
