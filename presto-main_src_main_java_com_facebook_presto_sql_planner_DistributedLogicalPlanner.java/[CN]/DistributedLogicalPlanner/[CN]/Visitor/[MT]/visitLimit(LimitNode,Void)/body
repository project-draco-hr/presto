{
  SubPlanBuilder current=node.getSource().accept(this,context);
  current.setRoot(new LimitNode(current.getRoot(),node.getCount()));
  if (current.isPartitioned()) {
    PlanNode source=new ExchangeNode(current.getId(),current.getRoot().getOutputSymbols());
    LimitNode merge=new LimitNode(source,node.getCount());
    current=newSubPlan(merge).setPartitioned(false).setChildren(ImmutableList.of(current.build()));
  }
  return current;
}
