{
  if (target instanceof CreateName) {
    CreateName create=(CreateName)target;
    return new CreateHandle(metadata.beginCreateTable(session,create.getCatalog(),create.getTableMetadata()));
  }
  if (target instanceof InsertReference) {
    InsertReference insert=(InsertReference)target;
    return new InsertHandle(metadata.beginInsert(session,insert.getHandle()));
  }
  throw new AssertionError("Unhandled target type: " + target.getClass().getName());
}
