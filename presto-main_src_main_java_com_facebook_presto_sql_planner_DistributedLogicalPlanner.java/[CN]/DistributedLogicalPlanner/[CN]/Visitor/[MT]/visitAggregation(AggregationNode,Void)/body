{
  SubPlanBuilder current=node.getSource().accept(this,context);
  if (!current.isPartitioned()) {
    current.setRoot(new AggregationNode(node.getId(),current.getRoot(),node.getGroupBy(),node.getAggregations(),node.getFunctions(),SINGLE));
    return current;
  }
  Map<Symbol,FunctionCall> aggregations=node.getAggregations();
  Map<Symbol,FunctionHandle> functions=node.getFunctions();
  List<Symbol> groupBy=node.getGroupBy();
  return addDistributedAggregation(current,aggregations,functions,groupBy);
}
