{
  Expression partitionPredicate=node.getPartitionPredicate();
  checkState(DeterminismEvaluator.isDeterministic(partitionPredicate));
  EqualityInference equalityInference=createEqualityInference(partitionPredicate);
  ImmutableList.Builder<Expression> effectiveConjuncts=ImmutableList.builder();
  for (  Expression conjunct : EqualityInference.nonInferrableConjuncts(partitionPredicate)) {
    Expression rewritten=equalityInference.rewriteExpression(conjunct,in(node.getOutputSymbols()));
    if (rewritten != null) {
      effectiveConjuncts.add(rewritten);
    }
  }
  effectiveConjuncts.addAll(equalityInference.generateEqualitiesPartitionedBy(in(node.getOutputSymbols())).getScopeEqualities());
  return combineConjuncts(effectiveConjuncts.build());
}
