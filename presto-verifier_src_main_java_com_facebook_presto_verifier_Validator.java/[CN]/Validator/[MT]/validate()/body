{
  controlResult=executeQuery(controlGateway,controlUsername,controlPassword,queryPair.getControl(),controlTimeout,sessionProperties);
  if (controlResult.getState() == State.TOO_MANY_ROWS) {
    testResult=new QueryResult(State.INVALID,null,null,ImmutableList.<List<Object>>of());
    return false;
  }
 else   if (controlResult.getState() != State.SUCCESS) {
    testResult=new QueryResult(State.INVALID,null,null,ImmutableList.<List<Object>>of());
    return true;
  }
  testResult=executeQuery(testGateway,testUsername,testPassword,queryPair.getTest(),testTimeout,sessionProperties);
  if ((controlResult.getState() != State.SUCCESS) || (testResult.getState() != State.SUCCESS)) {
    return false;
  }
  if (!checkCorrectness) {
    return true;
  }
  if (resultsMatch(controlResult,testResult)) {
    return true;
  }
  for (int i=0; i < 3; i++) {
    QueryResult results=executeQuery(controlGateway,controlUsername,controlPassword,queryPair.getControl(),controlTimeout,sessionProperties);
    if (results.getState() != State.SUCCESS) {
      return false;
    }
    if (!resultsMatch(controlResult,results)) {
      deterministic=false;
      return false;
    }
  }
  for (int i=0; i < 3; i++) {
    testResult=executeQuery(testGateway,testUsername,testPassword,queryPair.getTest(),testTimeout,sessionProperties);
    if (testResult.getState() != State.SUCCESS) {
      return false;
    }
    if (!resultsMatch(controlResult,testResult)) {
      return false;
    }
  }
  return resultsMatch(controlResult,testResult);
}
