{
  try (PrismClient prismClient=prismClientProvider.get()){
    PrismNamespace prismNamespace=prismClient.getNamespace(namespace);
    List<HostAndPort> services=smcLookup.getServices(prismNamespace.getHiveMetastore());
    if (services.isEmpty()) {
      throw new RuntimeException("No services found for tier: " + prismNamespace.getHiveMetastore());
    }
    return new HiveNamespace(prismNamespace.getHiveMetastore(),services,prismNamespace.getHiveDatabaseName());
  }
 catch (  PrismNamespaceNotFound prismNamespaceNotFound) {
    throw new ObjectNotFoundException(format("Unknown namespace: %s (raw: '%s')",namespace,prismNamespaceNotFound.getMessage()));
  }
catch (  PrismRepositoryError prismRepositoryError) {
    throw Throwables.propagate(prismRepositoryError);
  }
}
