{
  if (page.getPositionCount() == 0) {
    return;
  }
  Block[] dataBlocks=getDataBlocks(page,sampleWeightBlock);
  if (writer == null) {
    writer=createWriter();
  }
  for (int position=0; position < page.getPositionCount(); position++) {
    buildRow(dataColumnTypes,dataRow,dataBlocks,position);
    writer.addRow(dataRow);
  }
}
