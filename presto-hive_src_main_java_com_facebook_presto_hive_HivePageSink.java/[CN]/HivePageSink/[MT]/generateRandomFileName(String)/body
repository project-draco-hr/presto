{
  String extension="";
  if (HiveConf.getBoolVar(conf,COMPRESSRESULT) && HiveIgnoreKeyTextOutputFormat.class.getName().equals(outputFormat)) {
    extension=new DefaultCodec().getDefaultExtension();
    String compressionCodecClass=conf.get("mapred.output.compression.codec");
    if (compressionCodecClass != null) {
      try {
        Class<? extends CompressionCodec> codecClass=conf.getClassByName(compressionCodecClass).asSubclass(CompressionCodec.class);
        extension=ReflectionUtil.newInstance(codecClass,conf).getDefaultExtension();
      }
 catch (      ClassNotFoundException e) {
        throw new PrestoException(HIVE_UNSUPPORTED_FORMAT,"Compression codec not found: " + compressionCodecClass,e);
      }
catch (      RuntimeException e) {
        throw new PrestoException(HIVE_UNSUPPORTED_FORMAT,"Failed to load compression codec: " + compressionCodecClass,e);
      }
    }
  }
  return filePrefix + "_" + randomUUID()+ extension;
}
