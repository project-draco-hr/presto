{
  checkState(fieldValues.size() == fieldCount,"Invalid row");
  for (int field=0; field < fieldCount; field++) {
    tableInspector.setStructFieldData(row,structFields.get(field),fieldValues.get(field));
  }
  try {
    recordWriter.write(serializer.serialize(row,tableInspector));
  }
 catch (  SerDeException|IOException e) {
    throw new PrestoException(HIVE_WRITER_ERROR,e);
  }
}
