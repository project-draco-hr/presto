{
  Cursor cursor=values.cursor();
  cursor.advanceNextPosition();
  CountAggregation count=new CountAggregation();
  for (  Range range : ranges) {
    if (cursor.advanceToPosition(range.getStart())) {
      count.add(cursor,range.getEnd());
    }
  }
  assertEquals(count.evaluate().getLong(0),expected);
}
