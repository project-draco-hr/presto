{
  Cursor cursor=values.cursor(new QuerySession());
  assertAdvanceNextPosition(cursor);
  CountAggregation count=new CountAggregation();
  for (  Range range : ranges) {
    if (Cursors.advanceToPositionNoYield(cursor,range.getStart())) {
      count.add(cursor,range.getEnd());
    }
  }
  assertEquals(count.evaluate().getLong(0),expected);
}
