{
  Expression originalExpression=greaterThan(B,longLiteral(2L));
  ExtractionResult result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(B,Domain.create(ValueSet.ofRanges(Range.greaterThan(DOUBLE,2.0)),false))));
  originalExpression=greaterThan(C,stringLiteral("test"));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(C,Domain.create(ValueSet.ofRanges(Range.greaterThan(VARCHAR,utf8Slice("test"))),false))));
  originalExpression=greaterThan(A,doubleLiteral(2.0));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.greaterThan(BIGINT,2L)),false))));
  originalExpression=greaterThan(A,doubleLiteral(2.1));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.greaterThan(BIGINT,2L)),false))));
  originalExpression=greaterThanOrEqual(A,doubleLiteral(2.0));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.greaterThanOrEqual(BIGINT,2L)),false))));
  originalExpression=greaterThanOrEqual(A,doubleLiteral(2.1));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.greaterThanOrEqual(BIGINT,3L)),false))));
  originalExpression=lessThan(A,doubleLiteral(2.0));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.lessThan(BIGINT,2L)),false))));
  originalExpression=lessThan(A,doubleLiteral(2.1));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.lessThan(BIGINT,3L)),false))));
  originalExpression=lessThanOrEqual(A,doubleLiteral(2.0));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.lessThanOrEqual(BIGINT,2L)),false))));
  originalExpression=lessThanOrEqual(A,doubleLiteral(2.1));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.lessThanOrEqual(BIGINT,2L)),false))));
  originalExpression=equal(A,doubleLiteral(2.0));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.equal(BIGINT,2L)),false))));
  originalExpression=equal(A,doubleLiteral(2.1));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.none(BIGINT))));
  originalExpression=notEqual(A,doubleLiteral(2.0));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.lessThan(BIGINT,2L),Range.greaterThan(BIGINT,2L)),false))));
  originalExpression=notEqual(A,doubleLiteral(2.1));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.notNull(BIGINT))));
  originalExpression=isDistinctFrom(A,doubleLiteral(2.0));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.lessThan(BIGINT,2L),Range.greaterThan(BIGINT,2L)),true))));
  originalExpression=isDistinctFrom(A,doubleLiteral(2.1));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertTrue(result.getTupleDomain().isAll());
  originalExpression=not(greaterThan(B,longLiteral(2L)));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(B,Domain.create(ValueSet.ofRanges(Range.lessThanOrEqual(DOUBLE,2.0)),false))));
  originalExpression=not(greaterThan(C,stringLiteral("test")));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(C,Domain.create(ValueSet.ofRanges(Range.lessThanOrEqual(VARCHAR,utf8Slice("test"))),false))));
  originalExpression=not(greaterThan(A,doubleLiteral(2.0)));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.lessThanOrEqual(BIGINT,2L)),false))));
  originalExpression=not(greaterThan(A,doubleLiteral(2.1)));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.lessThanOrEqual(BIGINT,2L)),false))));
  originalExpression=not(greaterThanOrEqual(A,doubleLiteral(2.0)));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.lessThan(BIGINT,2L)),false))));
  originalExpression=not(greaterThanOrEqual(A,doubleLiteral(2.1)));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.lessThan(BIGINT,3L)),false))));
  originalExpression=not(lessThan(A,doubleLiteral(2.0)));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.greaterThanOrEqual(BIGINT,2L)),false))));
  originalExpression=not(lessThan(A,doubleLiteral(2.1)));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.greaterThanOrEqual(BIGINT,3L)),false))));
  originalExpression=not(lessThanOrEqual(A,doubleLiteral(2.0)));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.greaterThan(BIGINT,2L)),false))));
  originalExpression=not(lessThanOrEqual(A,doubleLiteral(2.1)));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.greaterThan(BIGINT,2L)),false))));
  originalExpression=not(equal(A,doubleLiteral(2.0)));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.lessThan(BIGINT,2L),Range.greaterThan(BIGINT,2L)),false))));
  originalExpression=not(equal(A,doubleLiteral(2.1)));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.notNull(BIGINT))));
  originalExpression=not(notEqual(A,doubleLiteral(2.0)));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.equal(BIGINT,2L)),false))));
  originalExpression=not(notEqual(A,doubleLiteral(2.1)));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.none(BIGINT))));
  originalExpression=not(isDistinctFrom(A,doubleLiteral(2.0)));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertEquals(result.getTupleDomain(),withColumnDomains(ImmutableMap.of(A,Domain.create(ValueSet.ofRanges(Range.equal(BIGINT,2L)),false))));
  originalExpression=not(isDistinctFrom(A,doubleLiteral(2.1)));
  result=fromPredicate(originalExpression);
  assertEquals(result.getRemainingExpression(),TRUE_LITERAL);
  assertTrue(result.getTupleDomain().isNone());
}
