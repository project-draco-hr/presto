{
  try {
    File dataDir=new File(cacheDir);
    File databaseDir=new File(dataDir,"db");
    Map<String,String> config=ImmutableMap.<String,String>builder().put("metadata.db.type","h2").put("metadata.db.filename",databaseDir.getAbsolutePath()).put("storage.data-directory",dataDir.getAbsolutePath()).put("storage.compress","false").build();
    RaptorPlugin plugin=new RaptorPlugin();
    plugin.setOptionalConfig(config);
    ConnectorFactoryContext context=new TestingConnectorFactoryContext(){
      @Override public NodeManager getNodeManager(){
        return nodeManager;
      }
    }
;
    return getOnlyElement(plugin.getConnectorFactories(context));
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
}
