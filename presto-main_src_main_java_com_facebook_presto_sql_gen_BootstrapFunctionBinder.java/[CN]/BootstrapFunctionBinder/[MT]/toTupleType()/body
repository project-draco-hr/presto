{
  return new Function<TypedByteCodeNode,Type>(){
    @Override public Type apply(    TypedByteCodeNode node){
      Class<?> type=node.getType();
      if (type == boolean.class) {
        return Type.BOOLEAN;
      }
      if (type == long.class) {
        return Type.BIGINT;
      }
      if (type == double.class) {
        return Type.DOUBLE;
      }
      if (type == String.class) {
        return Type.VARCHAR;
      }
      if (type == Slice.class) {
        return Type.VARCHAR;
      }
      throw new UnsupportedOperationException("Unsupported function type " + type);
    }
  }
;
}
