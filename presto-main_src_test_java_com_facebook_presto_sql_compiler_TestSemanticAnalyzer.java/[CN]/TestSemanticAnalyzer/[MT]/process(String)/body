{
  System.out.println(header("SQL",80));
  System.out.println(query.replaceAll("\\s+"," "));
  System.out.println();
  System.out.println(header("Antlr AST",80));
  CommonTree tree=SqlParser.parseStatement(query);
  System.out.println(treeToString(tree));
  System.out.println();
  System.out.println(header("AST",80));
  Statement statement=SqlParser.createStatement(tree);
  try {
    SemanticAnalyzer analyzer=new SemanticAnalyzer(metadata);
    AnalysisResult result=analyzer.analyze(statement);
    new TreePrinter(result.getResolvedNames(),result.getTypes(),System.out).print(statement);
    System.out.println();
  }
 catch (  SemanticException e) {
    System.out.println(e.getMessage() + " at " + e.getNode());
  }
}
