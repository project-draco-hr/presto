{
  assertRequest(!isNullOrEmpty(statement),"SQL statement is empty");
  assertRequest(!isNullOrEmpty(user),"User (%s) is empty",PRESTO_USER);
  assertRequest(!isNullOrEmpty(catalog),"Catalog (%s) is empty",PRESTO_CATALOG);
  assertRequest(!isNullOrEmpty(schema),"Schema (%s) is empty",PRESTO_SCHEMA);
  if (timeZoneId == null) {
    timeZoneId=TimeZone.getDefault().getID();
  }
  Locale locale=Locale.getDefault();
  if (language != null) {
    locale=Locale.forLanguageTag(language);
  }
  String remoteUserAddress=requestContext.getRemoteAddr();
  Session session=Session.builder().setUser(user).setSource(source).setCatalog(catalog).setSchema(schema).setTimeZoneKey(getTimeZoneKey(timeZoneId)).setLocale(locale).setRemoteUserAddress(remoteUserAddress).setUserAgent(userAgent).build();
  QueryInfo queryInfo=queryManager.createQuery(session,statement);
  URI pagesUri=uriBuilderFrom(uriInfo.getRequestUri()).appendPath(queryInfo.getQueryId().toString()).build();
  return Response.created(pagesUri).entity(queryInfo).build();
}
