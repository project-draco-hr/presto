{
  QualifiedTableName tableName=createQualifiedTableName(stateMachine.getSession(),statement.getTableName());
  log.debug("Dropping %s",tableName);
  final TableMetadata tableMetadata=metadataManager.getTable(tableName);
  Preconditions.checkState(tableMetadata != null,"Table %s does not exist",tableName);
  TableHandle tableHandle=tableMetadata.getTableHandle().get();
  Preconditions.checkState(DataSourceType.NATIVE == tableHandle.getDataSourceType(),"Can drop only native tables");
  storageManager.dropTableSource((NativeTableHandle)tableHandle);
  periodicImportManager.dropJobs(new Predicate<PersistentPeriodicImportJob>(){
    @Override public boolean apply(    PersistentPeriodicImportJob job){
      return job.getDstTable().equals(tableMetadata.getTable());
    }
  }
);
  Set<String> partitions=shardManager.getPartitions(tableHandle);
  for (  String partition : partitions) {
    shardManager.dropPartition(tableHandle,partition);
  }
  metadataManager.dropTable(tableMetadata);
  stateMachine.finished();
}
