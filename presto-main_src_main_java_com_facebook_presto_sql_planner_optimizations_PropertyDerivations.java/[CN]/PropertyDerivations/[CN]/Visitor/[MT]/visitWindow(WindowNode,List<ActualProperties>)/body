{
  if (ImmutableSet.copyOf(node.getPartitionBy()).equals(node.getPrePartitionedInputs()) && node.getPreSortedOrderPrefix() == node.getOrderBy().size()) {
    return Iterables.getOnlyElement(inputProperties);
  }
  ImmutableList.Builder<LocalProperty<Symbol>> localProperties=ImmutableList.builder();
  if (!node.getPartitionBy().isEmpty()) {
    localProperties.add(new GroupingProperty<>(node.getPartitionBy()));
  }
  for (  Symbol column : node.getOrderBy()) {
    localProperties.add(new SortingProperty<>(column,node.getOrderings().get(column)));
  }
  ActualProperties properties=Iterables.getOnlyElement(inputProperties);
  return ActualProperties.builder().partitioned(properties).coordinatorOnly(properties).local(localProperties.build()).constants(properties).build();
}
