{
  ActualProperties properties=Iterables.getOnlyElement(inputProperties);
  if (ImmutableSet.copyOf(node.getPartitionBy()).equals(node.getPrePartitionedInputs()) && node.getPreSortedOrderPrefix() == node.getOrderBy().size()) {
    return properties;
  }
  ImmutableList.Builder<LocalProperty<Symbol>> localProperties=ImmutableList.builder();
  if (!node.getPartitionBy().isEmpty()) {
    localProperties.add(new GroupingProperty<>(node.getPartitionBy()));
  }
  for (  Symbol column : node.getOrderBy()) {
    localProperties.add(new SortingProperty<>(column,node.getOrderings().get(column)));
  }
  return ActualProperties.builderFrom(properties).local(localProperties.build()).build();
}
