{
  checkNotNull(projection,"projection is null");
  OperatorFactory operatorFactory=createCompiledOperatorFactory(projection);
  Operator operator=operatorFactory.createOperator(createTableScanOperator(SOURCE),SESSION);
  Object directOperatorValue=execute(operator);
  Type expressionType=Type.fromRaw(operator.getTupleInfos().get(0).getTypes().get(0));
  Object recordValue=execute(operatorFactory.createOperator(createTableScanOperator(createRecordProjectOperator()),SESSION));
  assertEquals(recordValue,directOperatorValue);
  FilterAndProjectOperator interpretedOperator=createInterpretedOperator(projection,expressionType);
  Object interpretedValue=execute(interpretedOperator);
  assertEquals(interpretedValue,directOperatorValue);
  return directOperatorValue;
}
