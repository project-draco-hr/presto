{
  checkTableName(catalogName,schemaName,tableName);
  ImportClient client=importClientManager.getClient(catalogName);
  List<String> databaseNames=schemaName.isPresent() ? ImmutableList.of(schemaName.get()) : getDatabaseNames(client);
  ImmutableList.Builder<Map<String,String>> list=ImmutableList.builder();
  for (  String databaseName : databaseNames) {
    List<String> tableNames=tableName.isPresent() ? ImmutableList.of(tableName.get()) : getTableNames(client,databaseName);
    for (    String tblName : tableNames) {
      for (      PartitionInfo partition : getPartitions(client,databaseName,tblName)) {
        list.add(partition.getKeyFields());
      }
    }
  }
  return list.build();
}
