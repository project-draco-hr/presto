{
  checkNotNull(prefix,"prefix is null");
  Iterable<String> databaseNames=prefix.getSchemaName().isPresent() ? prefix.getSchemaName().asSet() : listSchemaNames();
  ImmutableList.Builder<Map<String,String>> list=ImmutableList.builder();
  for (  String databaseName : databaseNames) {
    Iterable<String> tableNames=prefix.getTableName().isPresent() ? prefix.getTableName().asSet() : getTableNames(client,databaseName);
    for (    String tblName : tableNames) {
      for (      PartitionInfo partition : getPartitions(client,databaseName,tblName)) {
        list.add(partition.getKeyFields());
      }
    }
  }
  return list.build();
}
