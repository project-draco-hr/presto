{
  checkTableName(catalogName,schemaName,tableName);
  ImportClient client=importClientManager.getClient(catalogName);
  List<String> databaseNames=schemaName.isPresent() ? ImmutableList.of(schemaName.get()) : getDatabaseNames(client);
  ImmutableList.Builder<TableColumn> list=ImmutableList.builder();
  for (  String databaseName : databaseNames) {
    List<String> tableNames=tableName.isPresent() ? ImmutableList.of(tableName.get()) : getTableNames(client,databaseName);
    for (    String tblName : tableNames) {
      List<SchemaField> tableSchema=getTableSchema(client,databaseName,tblName);
      Map<String,List<ColumnMetadata>> map=ImmutableMap.of(tblName,convertToMetadata(catalogName,tableSchema));
      list.addAll(getTableColumns(catalogName,databaseName,map));
    }
  }
  return list.build();
}
