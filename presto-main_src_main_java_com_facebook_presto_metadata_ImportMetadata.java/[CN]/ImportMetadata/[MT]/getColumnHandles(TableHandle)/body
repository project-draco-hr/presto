{
  Map<String,ColumnHandle> columnHandles=client.getColumnHandles(getClientTableHandle(tableHandle));
  final ImmutableMap<String,ColumnMetadata> index=indexColumnMetadata(tableHandle);
  return ImmutableMap.copyOf(Maps.transformEntries(columnHandles,new EntryTransformer<String,ColumnHandle,ColumnHandle>(){
    @Override public ColumnHandle transformEntry(    String columnName,    ColumnHandle columnHandle){
      return wrapClientHandle(columnName,columnHandle,index);
    }
  }
));
}
