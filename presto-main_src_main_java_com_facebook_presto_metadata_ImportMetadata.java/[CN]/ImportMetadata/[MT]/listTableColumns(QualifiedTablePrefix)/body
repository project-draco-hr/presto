{
  checkNotNull(prefix,"prefix is null");
  ImportClient client=importClientManager.getClient(prefix.getCatalogName());
  Iterable<String> databaseNames=prefix.hasSchemaName() ? prefix.getSchemaName().asSet() : getDatabaseNames(client);
  ImmutableList.Builder<TableColumn> list=ImmutableList.builder();
  for (  String databaseName : databaseNames) {
    Iterable<String> tableNames=prefix.hasTableName() ? prefix.getTableName().asSet() : getTableNames(client,databaseName);
    for (    String tblName : tableNames) {
      List<SchemaField> tableSchema=getTableSchema(client,databaseName,tblName);
      Map<String,List<ColumnMetadata>> map=ImmutableMap.of(tblName,convertToMetadata(prefix.getCatalogName(),tableSchema));
      list.addAll(getTableColumns(prefix.getCatalogName(),databaseName,map));
    }
  }
  return list.build();
}
