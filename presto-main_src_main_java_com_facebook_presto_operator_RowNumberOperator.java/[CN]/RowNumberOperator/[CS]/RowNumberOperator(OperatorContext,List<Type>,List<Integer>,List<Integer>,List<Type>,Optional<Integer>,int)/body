{
  this.maxRowsPerPartition=maxRowsPerPartition;
  this.operatorContext=checkNotNull(operatorContext,"operatorContext is null");
  this.outputChannels=Ints.toArray(outputChannels);
  this.partitionRowCount=new LongBigArray(0);
  if (partitionChannels.isEmpty()) {
    this.groupByHash=Optional.absent();
  }
 else {
    this.groupByHash=Optional.of(new GroupByHash(partitionTypes,Ints.toArray(partitionChannels),expectedPositions));
  }
  this.types=toTypes(sourceTypes,outputChannels);
}
