{
  checkNotNull(projection,"projection is null");
  OperatorFactory operatorFactory=createCompiledOperatorFactory(projection);
  Operator operator=operatorFactory.createOperator(createTableScanOperator(SOURCE),session);
  Object directOperatorValue=execute(operator);
  Type expressionType=Type.fromRaw(operator.getTupleInfos().get(0).getTypes().get(0));
  Object recordValue=execute(operatorFactory.createOperator(createTableScanOperator(createRecordProjectOperator()),session));
  assertEquals(recordValue,directOperatorValue);
  ProjectionFunction projectFunction=createCompiledProjectFunction(projection,session);
  Object projectedValue=execute(projectFunction);
  assertEquals(projectedValue,directOperatorValue);
  FilterAndProjectOperator interpretedOperator=createInterpretedOperator(projection,expressionType,session);
  Object interpretedValue=execute(interpretedOperator);
  assertEquals(interpretedValue,directOperatorValue);
  boolean needsBoundValues=parseExpression(projection).accept(new AstVisitor<Boolean,Object>(){
    @Override public Boolean visitInputReference(    InputReference node,    Object context){
      return true;
    }
  }
,null) == Boolean.TRUE;
  if (!needsBoundValues) {
    MaterializedResult result=runner.execute("SELECT " + projection + " FROM dual");
    assertEquals(result.getTupleInfo().getFieldCount(),1);
    assertEquals(result.getMaterializedTuples().size(),1);
    Object queryResult=Iterables.getOnlyElement(result.getMaterializedTuples()).getField(0);
    assertEquals(directOperatorValue,queryResult);
  }
  return directOperatorValue;
}
