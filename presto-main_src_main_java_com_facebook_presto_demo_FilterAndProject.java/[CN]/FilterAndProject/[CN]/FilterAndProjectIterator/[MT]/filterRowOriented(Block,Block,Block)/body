{
  int rows=(int)partitionChunk.getRange().length();
  BitSet bitSet=new BitSet(rows);
  BlockCursor partitionCursor=partitionChunk.cursor();
  BlockCursor startTimeCursor=startTimeChunk.cursor();
  BlockCursor endTimeCursor=endTimeChunk.cursor();
  for (int position=0; position < rows; position++) {
    checkState(partitionCursor.advanceNextPosition());
    checkState(startTimeCursor.advanceNextPosition());
    checkState(endTimeCursor.advanceNextPosition());
    bitSet.set(position,filter(partitionCursor.getSlice(0),startTimeCursor.getLong(0),endTimeCursor.getLong(0)));
  }
  checkState(!partitionCursor.advanceNextPosition());
  checkState(!startTimeCursor.advanceNextPosition());
  checkState(!endTimeCursor.advanceNextPosition());
  return bitSet;
}
