{
  if (isSimpleMagicLiteralComparison(node)) {
    node=normalizeSimpleComparison(node);
    node=convertMagicLiteralComparison(node);
  }
 else   if (isSimpleComparison(node)) {
    node=normalizeSimpleComparison(node);
  }
 else {
    return super.visitComparisonExpression(node,complement);
  }
  Symbol symbol=Symbol.fromQualifiedName(((QualifiedNameReference)node.getLeft()).getName());
  Type type=checkedTypeLookup(symbol);
  Object value=LiteralInterpreter.evaluate(metadata,session,node.getRight());
  if (value instanceof Double && type.equals(BIGINT)) {
    return process(coerceDoubleToLongComparison(node),complement);
  }
  if (value instanceof Long && type.equals(DoubleType.DOUBLE)) {
    value=((Long)value).doubleValue();
  }
  verifyType(type,value);
  return createComparisonExtractionResult(node.getType(),symbol,type,value,complement);
}
