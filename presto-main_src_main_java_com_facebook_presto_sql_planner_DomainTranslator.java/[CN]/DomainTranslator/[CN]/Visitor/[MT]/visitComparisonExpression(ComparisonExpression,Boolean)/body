{
  if (!isSimpleComparison(node)) {
    return super.visitComparisonExpression(node,complement);
  }
  node=normalizeSimpleComparison(node);
  Symbol symbol=Symbol.fromQualifiedName(((QualifiedNameReference)node.getLeft()).getName());
  Type columnType=checkedTypeLookup(symbol);
  ColumnHandle columnHandle=checkedColumnHandleLookup(symbol);
  Object value=LiteralInterpreter.evaluate(metadata,session,node.getRight());
  if (value instanceof Double && columnType.equals(BIGINT)) {
    return process(coerceDoubleToLongComparison(node),complement);
  }
  if (value instanceof Long && columnType.equals(DoubleType.DOUBLE)) {
    value=((Long)value).doubleValue();
  }
  verifyType(columnType,value);
  return createComparisonExtractionResult(node.getType(),columnHandle,columnType,objectToComparable(value),complement);
}
