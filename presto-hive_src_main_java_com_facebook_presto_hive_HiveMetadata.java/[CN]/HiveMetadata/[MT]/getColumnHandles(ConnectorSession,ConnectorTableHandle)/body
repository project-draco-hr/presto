{
  SchemaTableName tableName=schemaTableName(tableHandle);
  Optional<Table> table=metastore.getTable(tableName.getSchemaName(),tableName.getTableName());
  if (!table.isPresent()) {
    throw new TableNotFoundException(tableName);
  }
  ImmutableMap.Builder<String,ColumnHandle> columnHandles=ImmutableMap.builder();
  for (  HiveColumnHandle columnHandle : hiveColumnHandles(typeManager,connectorId,table.get(),false)) {
    columnHandles.put(columnHandle.getName(),columnHandle);
  }
  return columnHandles.build();
}
