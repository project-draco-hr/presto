{
  HiveTableHandle handle=checkType(tableHandle,HiveTableHandle.class,"tableHandle");
  SchemaTableName tableName=schemaTableName(tableHandle);
  if (!allowDropTable) {
    throw new PrestoException(PERMISSION_DENIED,"DROP TABLE is disabled in this Hive catalog");
  }
  try {
    Table table=metastore.getTable(handle.getSchemaName(),handle.getTableName());
    if (!handle.getSession().getUser().equals(table.getOwner())) {
      throw new PrestoException(PERMISSION_DENIED,format("Unable to drop table '%s': owner of the table is different from session user",table));
    }
    metastore.dropTable(handle.getSchemaName(),handle.getTableName());
  }
 catch (  NoSuchObjectException e) {
    throw new TableNotFoundException(tableName);
  }
}
