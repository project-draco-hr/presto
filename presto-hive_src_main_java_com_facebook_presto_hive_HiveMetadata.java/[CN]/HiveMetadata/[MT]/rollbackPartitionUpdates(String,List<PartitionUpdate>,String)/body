{
  for (  PartitionUpdate partitionUpdate : partitionUpdates) {
    Path targetPath=partitionUpdate.getTargetPath();
    Path writePath=partitionUpdate.getWritePath();
    if (!writePath.equals(targetPath)) {
      List<String> notDeletedFiles=deleteFilesFrom(user,writePath,partitionUpdate.getFileNames());
      if (!notDeletedFiles.isEmpty()) {
        log.warn("Error rolling back " + actionName + " temporary data files %s",notDeletedFiles.stream().collect(joining(", ")));
      }
      if (!deleteIfExists(user,writePath)) {
        log.debug("Error deleting " + actionName + " temp data in %s",writePath);
      }
    }
    List<String> notDeletedFiles=deleteFilesFrom(user,targetPath,partitionUpdate.getFileNames());
    if (!notDeletedFiles.isEmpty()) {
      log.error("Error rolling back " + actionName + " data files %s",notDeletedFiles.stream().collect(joining(", ")));
    }
    if (partitionUpdate.isNew()) {
      if (!deleteIfExists(user,targetPath)) {
        log.debug("Cannot delete " + actionName + " directory %s",targetPath);
      }
    }
  }
}
