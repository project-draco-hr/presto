{
  if (!allowRenameTable) {
    throw new PrestoException(PERMISSION_DENIED,"Renaming tables is disabled in this Hive catalog");
  }
  HiveTableHandle handle=checkType(tableHandle,HiveTableHandle.class,"tableHandle");
  SchemaTableName tableName=schemaTableName(tableHandle);
  Optional<Table> source=metastore.getTable(handle.getSchemaName(),handle.getTableName());
  if (!source.isPresent()) {
    throw new TableNotFoundException(tableName);
  }
  Table table=source.get();
  table.setDbName(newTableName.getSchemaName());
  table.setTableName(newTableName.getTableName());
  metastore.alterTable(handle.getSchemaName(),handle.getTableName(),table);
}
