{
  List<String> values=HivePartitionManager.extractPartitionKeyValues(partitionUpdate.getName());
  Partition partition=new Partition();
  partition.setDbName(table.getDbName());
  partition.setTableName(table.getTableName());
  partition.setValues(values);
  if (respectTableFormat) {
    partition.setSd(table.getSd().deepCopy());
    partition.getSd().setLocation(partitionUpdate.getTargetPath());
  }
 else {
    partition.setSd(makeStorageDescriptor(table.getTableName(),defaultStorageFormat,new Path(partitionUpdate.getTargetPath()),table.getSd().getCols()));
  }
  return partition;
}
