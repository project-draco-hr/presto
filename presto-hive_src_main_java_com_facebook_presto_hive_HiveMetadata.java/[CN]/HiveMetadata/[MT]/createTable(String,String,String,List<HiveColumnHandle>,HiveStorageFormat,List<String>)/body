{
  Path targetPath=getTableDefaultLocation(metastore,hdfsEnvironment,schemaName,tableName);
  if (pathExists(hdfsEnvironment,targetPath)) {
    throw new PrestoException(HIVE_PATH_ALREADY_EXISTS,format("Target directory for table '%s.%s' already exists: %s",schemaName,tableName,targetPath));
  }
  createDirectory(hdfsEnvironment,targetPath);
  createTable(schemaName,tableName,tableOwner,columnHandles,hiveStorageFormat,partitionedBy,targetPath);
}
