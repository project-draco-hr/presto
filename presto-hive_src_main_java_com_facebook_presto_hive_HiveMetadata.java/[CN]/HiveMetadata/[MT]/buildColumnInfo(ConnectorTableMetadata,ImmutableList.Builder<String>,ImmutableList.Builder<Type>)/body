{
  for (  ColumnMetadata column : tableMetadata.getColumns()) {
    if (!HiveRecordSink.isTypeSupported(column.getType())) {
      throw new PrestoException(NOT_SUPPORTED,format("Cannot create table with unsupported type: %s",column.getType().getDisplayName()));
    }
    names.add(column.getName());
    types.add(column.getType());
  }
  if (tableMetadata.isSampled()) {
    names.add(SAMPLE_WEIGHT_COLUMN_NAME);
    types.add(BIGINT);
  }
}
