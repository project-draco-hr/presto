{
  for (  PartitionUpdate partitionUpdate : partitionUpdates) {
    String targetPath=partitionUpdate.getTargetPath();
    String writePath=partitionUpdate.getWritePath();
    if (!writePath.equals(targetPath)) {
      List<String> notDeletedFiles=deleteFilesFrom(writePath,partitionUpdate.getFileNames());
      if (!notDeletedFiles.isEmpty()) {
        log.warn("Error rolling back " + actionName + " temporary data files %s",notDeletedFiles.stream().collect(joining(", ")));
      }
      if (!deleteIfExists(writePath)) {
        log.debug("Error deleting " + actionName + " temp data in %s",writePath);
      }
    }
    List<String> notDeletedFiles=deleteFilesFrom(targetPath,partitionUpdate.getFileNames());
    if (!notDeletedFiles.isEmpty()) {
      log.error("Error rolling back " + actionName + " data files %s",notDeletedFiles.stream().collect(joining(", ")));
    }
    if (partitionUpdate.isNew()) {
      if (!deleteIfExists(targetPath)) {
        log.debug("Cannot delete " + actionName + " directory %s",targetPath);
      }
    }
  }
}
