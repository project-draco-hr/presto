{
  QueryInfo queryInfo=finalQueryInfo.get();
  if (queryInfo != null) {
    return queryInfo;
  }
  if (isCanceled()) {
    return null;
  }
  URI statusUri=uriBuilderFrom(queryLocation).build();
  Request.Builder requestBuilder=prepareGet().setUri(statusUri);
  if (forceRefresh) {
    requestBuilder.addHeader(HttpHeaders.CACHE_CONTROL,"no-cache");
  }
  JsonResponse<QueryInfo> response=httpClient.execute(requestBuilder.build(),createFullJsonResponseHandler(queryInfoCodec));
  if (response.getStatusCode() == Status.GONE.getStatusCode()) {
    return null;
  }
  Preconditions.checkState(response.getStatusCode() == Status.OK.getStatusCode(),"Expected response code to be 201, but was %s: %s",response.getStatusCode(),response.getStatusMessage());
  queryInfo=response.getValue();
  if (queryInfo.getState().isDone()) {
    finalQueryInfo.set(queryInfo);
  }
  return queryInfo;
}
