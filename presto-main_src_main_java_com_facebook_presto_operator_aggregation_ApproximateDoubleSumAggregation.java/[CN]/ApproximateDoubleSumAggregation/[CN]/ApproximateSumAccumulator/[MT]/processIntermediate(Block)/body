{
  BlockCursor intermediates=block.cursor();
  for (int position=0; position < block.getPositionCount(); position++) {
    checkState(intermediates.advanceNextPosition(),"failed to advance intermediates cursor");
    Slice slice=intermediates.getSlice();
    long inputCount=slice.getLong(COUNT_OFFSET);
    samples+=slice.getLong(SAMPLES_OFFSET);
    double inputSum=slice.getDouble(SUM_OFFSET);
    double inputVariance=slice.getDouble(VARIANCE_OFFSET);
    if (count > 0 && inputCount > 0) {
      double t=(inputCount / (double)count) * sum - inputSum;
      variance=inputVariance + t * t * count / (double)(inputCount * (count + inputCount));
    }
    sum+=inputSum;
    count+=inputCount;
  }
}
