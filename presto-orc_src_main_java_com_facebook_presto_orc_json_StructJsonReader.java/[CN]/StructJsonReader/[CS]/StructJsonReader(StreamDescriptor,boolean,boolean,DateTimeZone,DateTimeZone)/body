{
  this.streamDescriptor=checkNotNull(streamDescriptor,"stream is null");
  this.writeStackType=writeStackType;
  this.checkForNulls=checkForNulls;
  List<StreamDescriptor> nestedStreams=streamDescriptor.getNestedStreams();
  this.structFieldNames=new String[nestedStreams.size()];
  this.structFields=new JsonReader[nestedStreams.size()];
  for (int i=0; i < nestedStreams.size(); i++) {
    StreamDescriptor nestedStream=nestedStreams.get(i);
    this.structFields[i]=createJsonReader(nestedStream,true,false,hiveStorageTimeZone,sessionTimeZone);
    this.structFieldNames[i]=nestedStream.getFieldName();
  }
  buffer=new DynamicSliceOutput(1024);
}
