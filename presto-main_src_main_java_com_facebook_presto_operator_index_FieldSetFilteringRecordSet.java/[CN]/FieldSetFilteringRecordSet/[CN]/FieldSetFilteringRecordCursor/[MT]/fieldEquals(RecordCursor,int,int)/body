{
  checkArgument(cursor.getType(field1).equals(cursor.getType(field2)),"Should only be comparing fields of the same type");
  if (cursor.isNull(field1) || cursor.isNull(field2)) {
    return false;
  }
  Class<?> javaType=cursor.getType(field1).getJavaType();
  if (javaType == long.class) {
    return cursor.getLong(field1) == cursor.getLong(field2);
  }
 else   if (javaType == double.class) {
    return cursor.getDouble(field1) == cursor.getDouble(field2);
  }
 else   if (javaType == boolean.class) {
    return cursor.getBoolean(field1) == cursor.getBoolean(field2);
  }
 else   if (javaType == Slice.class) {
    return cursor.getSlice(field1).equals(cursor.getSlice(field2));
  }
 else {
    throw new IllegalArgumentException("Unknown java type: " + javaType);
  }
}
