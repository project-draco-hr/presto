{
  GroupedAccumulator partialAggregation=function.createGroupedAggregation(Optional.<Integer>absent(),Optional.<Integer>absent(),confidence,args);
  for (  Page page : pages) {
    partialAggregation.addInput(createGroupByIdBlock(0,page.getPositionCount()),page);
  }
  BlockBuilder partialOut=partialAggregation.getIntermediateType().createBlockBuilder(DEFAULT_MAX_BLOCK_SIZE);
  partialAggregation.evaluateIntermediate(0,partialOut);
  Block partialBlock=partialOut.build();
  GroupedAccumulator finalAggregation=function.createGroupedIntermediateAggregation(confidence);
  GroupedAccumulator emptyAggregation=function.createGroupedAggregation(Optional.<Integer>absent(),Optional.<Integer>absent(),confidence,args);
  BlockBuilder emptyOut=emptyAggregation.getIntermediateType().createBlockBuilder(DEFAULT_MAX_BLOCK_SIZE);
  emptyAggregation.evaluateIntermediate(0,emptyOut);
  Block emptyBlock=emptyOut.build();
  finalAggregation.addIntermediate(createGroupByIdBlock(0,emptyBlock.getPositionCount()),emptyBlock);
  finalAggregation.addIntermediate(createGroupByIdBlock(0,partialBlock.getPositionCount()),partialBlock);
  return getGroupValue(finalAggregation,0);
}
