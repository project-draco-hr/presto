{
  GroupedAccumulator partialAggregation=function.createGroupedAggregation(Optional.<Integer>absent(),args);
  for (  Page page : pages) {
    partialAggregation.addInput(createGroupByIdBlock(0,page.getPositionCount()),page);
  }
  BlockBuilder partialOut=new BlockBuilder(partialAggregation.getIntermediateTupleInfo());
  partialAggregation.evaluateIntermediate(0,partialOut);
  UncompressedBlock partialBlock=partialOut.build();
  GroupedAccumulator finalAggregation=function.createGroupedIntermediateAggregation();
  finalAggregation.addIntermediate(createGroupByIdBlock(0,partialBlock.getPositionCount()),partialBlock);
  return getGroupValue(finalAggregation,0);
}
