{
  Accumulator partialAccumulator=function.createDeterministicAggregation(Optional.<Integer>absent(),sampleWeightChannel,confidence,seed,0);
  for (  Page page : pages) {
    if (page.getPositionCount() > 0) {
      partialAccumulator.addInput(page);
    }
  }
  Block partialBlock=partialAccumulator.evaluateIntermediate();
  Accumulator finalAggregation=function.createDeterministicIntermediateAggregation(confidence,0);
  finalAggregation.addIntermediate(partialBlock);
  Block finalBlock=finalAggregation.evaluateFinal();
  return withinErrorBound(BlockAssertions.toValues(finalBlock).get(0).toString(),expectedValue);
}
