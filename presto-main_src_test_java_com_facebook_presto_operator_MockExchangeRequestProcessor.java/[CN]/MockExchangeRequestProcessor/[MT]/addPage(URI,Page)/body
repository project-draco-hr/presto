{
  checkState(completeByLocation.get(location) != Boolean.TRUE,"Location %s is complete",location);
  BlockingQueue<Page> queue=pagesByLocation.get(location);
  if (queue == null) {
    queue=new LinkedBlockingQueue<>();
    BlockingQueue<Page> existingValue=pagesByLocation.putIfAbsent(location,queue);
    queue=(existingValue != null ? existingValue : queue);
    tokenByLocation.put(location,0L);
  }
  queue.add(page);
}
