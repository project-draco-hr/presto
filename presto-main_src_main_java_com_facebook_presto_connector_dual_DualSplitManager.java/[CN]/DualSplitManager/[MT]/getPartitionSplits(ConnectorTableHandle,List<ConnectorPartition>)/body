{
  checkNotNull(partitions,"partitions is null");
  if (partitions.isEmpty()) {
    return new FixedSplitSource(SYSTEM_DATASOURCE,ImmutableList.<ConnectorSplit>of());
  }
  ConnectorPartition partition=Iterables.getOnlyElement(partitions);
  checkArgument(partition instanceof DualPartition,"Partition must be a dual partition");
  ConnectorSplit split=new DualSplit(nodeManager.getCurrentNode().getHostAndPort());
  return new FixedSplitSource(SYSTEM_DATASOURCE,ImmutableList.of(split));
}
