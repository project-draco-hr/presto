{
  ExecutionStats executionStats=globalExecutionStats(queryInfo.getOutputStage());
  return StatementStats.builder().setState(queryInfo.getState().toString()).setScheduled(isScheduled(queryInfo)).setNodes(globalUniqueNodes(queryInfo.getOutputStage()).size()).setTotalSplits(executionStats.getSplits()).setQueuedSplits(executionStats.getQueuedSplits()).setRunningSplits(executionStats.getRunningSplits()).setCompletedSplits(executionStats.getCompletedSplits()).setUserTimeMillis(executionStats.getSplitUserTime().toMillis()).setCpuTimeMillis(executionStats.getSplitCpuTime().toMillis()).setWallTimeMillis(executionStats.getSplitWallTime().toMillis()).setProcessedRows(executionStats.getCompletedPositionCount()).setProcessedBytes(executionStats.getCompletedDataSize().toBytes()).setRootStage(toStageStats(queryInfo.getOutputStage())).build();
}
