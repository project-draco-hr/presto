{
  ExecutionStats executionStats=globalExecutionStats(queryInfo.getOutputStage());
  return StatementStats.builder().setState(queryInfo.getState().toString()).setDone(queryInfo.getState().isDone()).setScheduled(isScheduled(queryInfo)).setNodes(globalUniqueNodes(queryInfo.getOutputStage()).size()).setTotalSplits(executionStats.getSplits()).setQueuedSplits(executionStats.getQueuedSplits()).setRunningSplits(executionStats.getRunningSplits()).setCompletedSplits(executionStats.getCompletedSplits()).setUserTimeMillis((long)executionStats.getSplitUserTime().toMillis()).setCpuTimeMillis((long)executionStats.getSplitCpuTime().toMillis()).setWallTimeMillis((long)executionStats.getSplitWallTime().toMillis()).setProcessedRows(executionStats.getCompletedPositionCount()).setProcessedBytes(executionStats.getCompletedDataSize().toBytes()).setRootStage(toStageStats(queryInfo.getOutputStage())).build();
}
