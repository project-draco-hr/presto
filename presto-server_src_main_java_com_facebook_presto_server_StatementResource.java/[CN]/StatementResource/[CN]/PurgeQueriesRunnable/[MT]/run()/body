{
  try {
    Set<QueryId> queryIdsSnapshot=ImmutableSet.copyOf(queryIds);
    Set<QueryId> liveQueries=ImmutableSet.copyOf(transform(queryManager.getAllQueryInfo(),queryIdGetter()));
    Set<QueryId> deadQueries=Sets.difference(liveQueries,queryIdsSnapshot);
    for (    QueryId deadQuery : deadQueries) {
      queryIdsSnapshot.remove(deadQuery);
      log.debug("Removed expired query %s",deadQuery);
    }
  }
 catch (  Throwable e) {
    log.warn(e,"Error removing old queries");
  }
}
