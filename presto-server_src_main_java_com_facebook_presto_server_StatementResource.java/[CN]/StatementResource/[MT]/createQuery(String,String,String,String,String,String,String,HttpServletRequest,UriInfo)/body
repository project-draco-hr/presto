{
  assertRequest(!isNullOrEmpty(statement),"SQL statement is empty");
  assertRequest(!isNullOrEmpty(user),"User (%s) is empty",PRESTO_USER);
  assertRequest(!isNullOrEmpty(catalog),"Catalog (%s) is empty",PRESTO_CATALOG);
  assertRequest(!isNullOrEmpty(schema),"Schema (%s) is empty",PRESTO_SCHEMA);
  String remoteUserAddress=requestContext.getRemoteAddr();
  TimeZone timeZone;
  if (timeZoneString == null) {
    timeZone=TimeZone.getDefault();
  }
 else {
    timeZone=TimeZone.getTimeZone(timeZoneString);
  }
  Session session=new Session(user,source,catalog,schema,timeZone,requestContext.getLocale(),remoteUserAddress,userAgent);
  ExchangeClient exchangeClient=exchangeClientSupplier.get();
  Query query=new Query(session,statement,queryManager,exchangeClient);
  queries.put(query.getQueryId(),query);
  return Response.ok(query.getNextResults(uriInfo,new Duration(1,TimeUnit.MILLISECONDS))).build();
}
