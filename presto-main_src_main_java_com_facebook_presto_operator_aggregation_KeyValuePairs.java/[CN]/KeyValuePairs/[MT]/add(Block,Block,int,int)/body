{
  Page page=new Page(key);
  if (!keysHash.contains(keyPosition,page)) {
    int groupId=keysHash.putIfAbsent(keyPosition,page,new Block[]{key});
    keysHash.appendValuesTo(groupId,keyPageBuilder,0);
    if (value.isNull(valuePosition)) {
      valuePageBuilder.getBlockBuilder(0).appendNull();
    }
 else {
      valueType.appendTo(value,valuePosition,valuePageBuilder.getBlockBuilder(0));
    }
  }
}
