{
  BlockBuilder blockBuilder=type.createBlockBuilder(new BlockBuilderStatus());
  try {
    if (obj == null) {
      return blockBuilder.appendNull().build();
    }
 else     if (type.getJavaType() == double.class) {
      type.writeDouble(blockBuilder,((Number)obj).doubleValue());
    }
 else     if (type.getJavaType() == long.class) {
      type.writeLong(blockBuilder,((Number)obj).longValue());
    }
 else     if (type.getJavaType() == Slice.class) {
      if (type instanceof VarcharType) {
        type.writeSlice(blockBuilder,Slices.utf8Slice((String)obj));
      }
 else       if (type instanceof ArrayType || type instanceof MapType || type instanceof RowType) {
        type.writeSlice(blockBuilder,Slices.utf8Slice(OBJECT_MAPPER.writeValueAsString(obj)));
      }
 else {
        type.writeSlice(blockBuilder,(Slice)obj);
      }
    }
 else     if (type.getJavaType() == boolean.class) {
      type.writeBoolean(blockBuilder,(Boolean)obj);
    }
 else {
      throw new IllegalArgumentException("Unsupported type: " + type.getJavaType().getSimpleName());
    }
  }
 catch (  IOException ioe) {
    Throwables.propagate(ioe);
  }
  return blockBuilder.build();
}
