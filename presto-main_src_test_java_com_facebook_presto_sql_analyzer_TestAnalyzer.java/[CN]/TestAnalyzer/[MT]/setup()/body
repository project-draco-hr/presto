{
  TypeManager typeManager=new TypeRegistry();
  MetadataManager metadata=new MetadataManager(new FeaturesConfig().setExperimentalSyntaxEnabled(true),typeManager,new SplitManager(),new BlockEncodingManager(typeManager),new SessionPropertyManager(),new TablePropertyManager());
  metadata.addConnectorMetadata("tpch","tpch",new TestingMetadata());
  metadata.addConnectorMetadata("c2","c2",new TestingMetadata());
  metadata.addConnectorMetadata("c3","c3",new TestingMetadata());
  SchemaTableName table1=new SchemaTableName("s1","t1");
  metadata.createTable(SESSION,"tpch",new TableMetadata("tpch",new ConnectorTableMetadata(table1,ImmutableList.of(new ColumnMetadata("a",BIGINT,false),new ColumnMetadata("b",BIGINT,false),new ColumnMetadata("c",BIGINT,false),new ColumnMetadata("d",BIGINT,false)))));
  SchemaTableName table2=new SchemaTableName("s1","t2");
  metadata.createTable(SESSION,"tpch",new TableMetadata("tpch",new ConnectorTableMetadata(table2,ImmutableList.of(new ColumnMetadata("a",BIGINT,false),new ColumnMetadata("b",BIGINT,false)))));
  SchemaTableName table3=new SchemaTableName("s1","t3");
  metadata.createTable(SESSION,"tpch",new TableMetadata("tpch",new ConnectorTableMetadata(table3,ImmutableList.of(new ColumnMetadata("a",BIGINT,false),new ColumnMetadata("b",BIGINT,false),new ColumnMetadata("x",BIGINT,false,null,true)))));
  SchemaTableName table4=new SchemaTableName("s2","t4");
  metadata.createTable(SESSION,"c2",new TableMetadata("tpch",new ConnectorTableMetadata(table4,ImmutableList.of(new ColumnMetadata("a",BIGINT,false)))));
  SchemaTableName table5=new SchemaTableName("s1","t5");
  metadata.createTable(SESSION,"tpch",new TableMetadata("tpch",new ConnectorTableMetadata(table5,ImmutableList.of(new ColumnMetadata("a",BIGINT,false),new ColumnMetadata("b",BIGINT,false,null,true)))));
  String viewData1=JsonCodec.jsonCodec(ViewDefinition.class).toJson(new ViewDefinition("select a from t1",Optional.of("tpch"),Optional.of("s1"),ImmutableList.of(new ViewColumn("a",BIGINT)),Optional.of("user")));
  metadata.createView(SESSION,new QualifiedTableName("tpch","s1","v1"),viewData1,false);
  String viewData2=JsonCodec.jsonCodec(ViewDefinition.class).toJson(new ViewDefinition("select a from t1",Optional.of("tpch"),Optional.of("s1"),ImmutableList.of(new ViewColumn("a",VARCHAR)),Optional.of("user")));
  metadata.createView(SESSION,new QualifiedTableName("tpch","s1","v2"),viewData2,false);
  String viewData3=JsonCodec.jsonCodec(ViewDefinition.class).toJson(new ViewDefinition("select a from t4",Optional.of("c2"),Optional.of("s2"),ImmutableList.of(new ViewColumn("a",BIGINT)),Optional.of("owner")));
  metadata.createView(SESSION,new QualifiedTableName("c3","s3","v3"),viewData3,false);
  this.metadata=metadata;
  analyzer=createAnalyzer("tpch","s1",true);
  approximateDisabledAnalyzer=createAnalyzer("tpch","s1",false);
}
