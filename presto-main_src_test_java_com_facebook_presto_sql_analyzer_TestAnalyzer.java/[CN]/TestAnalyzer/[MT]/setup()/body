{
  TypeManager typeManager=new TypeRegistry();
  MetadataManager metadata=new MetadataManager(new FeaturesConfig().setExperimentalSyntaxEnabled(true),typeManager,new SplitManager(),new BlockEncodingManager(typeManager),new SessionPropertyManager());
  metadata.addConnectorMetadata("tpch","tpch",new TestingMetadata());
  metadata.addConnectorMetadata("c2","c2",new TestingMetadata());
  metadata.addConnectorMetadata("c3","c3",new TestingMetadata());
  SchemaTableName table1=new SchemaTableName("default","t1");
  metadata.createTable(SESSION,"tpch",new TableMetadata("tpch",new ConnectorTableMetadata(table1,ImmutableList.<ColumnMetadata>of(new ColumnMetadata("a",BIGINT,false),new ColumnMetadata("b",BIGINT,false),new ColumnMetadata("c",BIGINT,false),new ColumnMetadata("d",BIGINT,false)))));
  SchemaTableName table2=new SchemaTableName("default","t2");
  metadata.createTable(SESSION,"tpch",new TableMetadata("tpch",new ConnectorTableMetadata(table2,ImmutableList.<ColumnMetadata>of(new ColumnMetadata("a",BIGINT,false),new ColumnMetadata("b",BIGINT,false)))));
  SchemaTableName table3=new SchemaTableName("default","t3");
  metadata.createTable(SESSION,"tpch",new TableMetadata("tpch",new ConnectorTableMetadata(table3,ImmutableList.<ColumnMetadata>of(new ColumnMetadata("a",BIGINT,false),new ColumnMetadata("b",BIGINT,false),new ColumnMetadata("x",BIGINT,false,null,true)))));
  SchemaTableName table4=new SchemaTableName("s2","t4");
  metadata.createTable(SESSION,"c2",new TableMetadata("tpch",new ConnectorTableMetadata(table4,ImmutableList.<ColumnMetadata>of(new ColumnMetadata("a",BIGINT,false)))));
  SchemaTableName table5=new SchemaTableName("default","t5");
  metadata.createTable(SESSION,"tpch",new TableMetadata("tpch",new ConnectorTableMetadata(table5,ImmutableList.<ColumnMetadata>of(new ColumnMetadata("a",BIGINT,false),new ColumnMetadata("b",BIGINT,false,null,true)))));
  String viewData1=JsonCodec.jsonCodec(ViewDefinition.class).toJson(new ViewDefinition("select a from t1","tpch","default",ImmutableList.of(new ViewColumn("a",BIGINT))));
  metadata.createView(SESSION,new QualifiedTableName("tpch","default","v1"),viewData1,false);
  String viewData2=JsonCodec.jsonCodec(ViewDefinition.class).toJson(new ViewDefinition("select a from t1","tpch","default",ImmutableList.of(new ViewColumn("a",VARCHAR))));
  metadata.createView(SESSION,new QualifiedTableName("tpch","default","v2"),viewData2,false);
  String viewData3=JsonCodec.jsonCodec(ViewDefinition.class).toJson(new ViewDefinition("select a from t4","c2","s2",ImmutableList.of(new ViewColumn("a",BIGINT))));
  metadata.createView(SESSION,new QualifiedTableName("c3","s3","v3"),viewData3,false);
  analyzer=new Analyzer(testSessionBuilder().setCatalog("tpch").setSchema("default").build(),metadata,SQL_PARSER,Optional.empty(),true);
  approximateDisabledAnalyzer=new Analyzer(testSessionBuilder().setCatalog("tpch").setSchema("default").build(),metadata,SQL_PARSER,Optional.empty(),false);
}
