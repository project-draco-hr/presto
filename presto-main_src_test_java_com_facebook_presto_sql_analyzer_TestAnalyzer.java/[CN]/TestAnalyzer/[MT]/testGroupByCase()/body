{
  assertFails(MUST_BE_AGGREGATE_OR_GROUP_BY,"SELECT CASE a WHEN 1 THEN 'a' ELSE 'b' END, count(*) FROM t1");
  assertFails(MUST_BE_AGGREGATE_OR_GROUP_BY,"SELECT CASE 1 WHEN 2 THEN a ELSE 0 END, count(*) FROM t1");
  assertFails(MUST_BE_AGGREGATE_OR_GROUP_BY,"SELECT CASE 1 WHEN 2 THEN 0 ELSE a END, count(*) FROM t1");
  assertFails(MUST_BE_AGGREGATE_OR_GROUP_BY,"SELECT CASE WHEN a = 1 THEN 'a' ELSE 'b' END, count(*) FROM t1");
  assertFails(MUST_BE_AGGREGATE_OR_GROUP_BY,"SELECT CASE WHEN true THEN a ELSE 0 END, count(*) FROM t1");
  assertFails(MUST_BE_AGGREGATE_OR_GROUP_BY,"SELECT CASE WHEN true THEN 0 ELSE a END, count(*) FROM t1");
}
