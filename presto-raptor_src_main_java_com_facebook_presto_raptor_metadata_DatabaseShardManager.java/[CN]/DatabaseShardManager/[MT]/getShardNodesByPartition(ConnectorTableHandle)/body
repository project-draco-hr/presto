{
  long tableId=checkType(tableHandle,RaptorTableHandle.class,"tableHandle").getTableId();
  ImmutableMultimap.Builder<Long,Entry<UUID,String>> map=ImmutableMultimap.builder();
  for (  ShardNode shardNode : dao.getShardNodes(tableId)) {
    map.put(shardNode.getPartitionId(),immutableEntry(shardNode.getShardUuid(),shardNode.getNodeIdentifier()));
  }
  return map.build();
}
