{
  checkNotNull(page,"page is null");
  checkState(!finished,"operator finished");
  List<TupleInfo> tupleInfos=new ArrayList<>();
  List<BlockCursor> cursors=new ArrayList<>();
  for (  Block block : page.getBlocks()) {
    cursors.add(block.cursor());
    tupleInfos.add(block.getTupleInfo());
  }
  while (true) {
    TupleInfo.Builder builder=outputTupleInfo.builder();
    boolean hasResults=false;
    for (    BlockCursor cursor : cursors) {
      if (cursor.advanceNextPosition()) {
        builder.append(cursor.getTuple());
        hasResults=true;
      }
 else {
        checkState(!hasResults,"unaligned cursors");
      }
    }
    if (!hasResults) {
      return;
    }
    tuples.add(builder.build());
  }
}
