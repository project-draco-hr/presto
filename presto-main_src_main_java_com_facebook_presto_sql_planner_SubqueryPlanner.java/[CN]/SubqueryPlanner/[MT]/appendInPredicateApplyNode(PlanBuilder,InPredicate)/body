{
  subPlan=subPlan.appendProjections(ImmutableList.of(inPredicate.getValue()),symbolAllocator,idAllocator);
  checkState(inPredicate.getValueList() instanceof SubqueryExpression);
  RelationPlan valueListRelation=createRelationPlan((SubqueryExpression)inPredicate.getValueList());
  TranslationMap translationMap=subPlan.copyTranslations();
  QualifiedNameReference valueList=getOnlyElement(valueListRelation.getOutputSymbols()).toQualifiedNameReference();
  translationMap.setExpressionAsAlreadyTranslated(valueList);
  translationMap.put(inPredicate,new InPredicate(inPredicate.getValue(),valueList));
  return new PlanBuilder(translationMap,new ApplyNode(idAllocator.getNextId(),subPlan.getRoot(),valueListRelation.getRoot(),ImmutableList.of()),subPlan.getSampleWeight());
}
