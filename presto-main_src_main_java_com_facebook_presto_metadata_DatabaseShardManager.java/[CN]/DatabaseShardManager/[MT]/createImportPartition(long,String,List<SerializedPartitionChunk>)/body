{
  return dbi.inTransaction(new TransactionCallback<List<Long>>(){
    @Override public List<Long> inTransaction(    Handle handle,    TransactionStatus status){
      ShardManagerDao dao=handle.attach(ShardManagerDao.class);
      ImmutableList.Builder<Long> shardIds=ImmutableList.builder();
      long importPartitionId=dao.insertImportPartition(tableId,partitionName);
      for (      SerializedPartitionChunk chunk : partitionChunks) {
        long shardId=dao.insertShard(tableId,false);
        dao.insertImportPartitionChunk(importPartitionId,shardId,chunk.getBytes());
        dao.insertImportPartitionShard(importPartitionId,shardId);
        shardIds.add(shardId);
      }
      return shardIds.build();
    }
  }
);
}
