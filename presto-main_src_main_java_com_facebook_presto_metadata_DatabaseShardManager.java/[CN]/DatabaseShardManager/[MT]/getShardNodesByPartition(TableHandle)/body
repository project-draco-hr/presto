{
  checkNotNull(tableHandle,"tableHandle is null");
  checkState(tableHandle instanceof NativeTableHandle,"tableHandle not a native table");
  final long tableId=((NativeTableHandle)tableHandle).getTableId();
  ImmutableMultimap.Builder<Long,Entry<UUID,String>> map=ImmutableMultimap.builder();
  for (  ShardNode shardNode : dao.getShardNodes(tableId)) {
    map.put(shardNode.getPartitionId(),immutableEntry(shardNode.getShardUuid(),shardNode.getNodeIdentifier()));
  }
  return map.build();
}
