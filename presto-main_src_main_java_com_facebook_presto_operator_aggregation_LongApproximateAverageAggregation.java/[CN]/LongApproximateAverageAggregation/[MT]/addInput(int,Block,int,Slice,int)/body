{
  boolean hasValue=!APPROX_AVG_CONTEXT_INFO.isNull(valueSlice,valueOffset,0);
  long count=hasValue ? APPROX_AVG_CONTEXT_INFO.getLong(valueSlice,valueOffset,0) : 0;
  double mean=APPROX_AVG_CONTEXT_INFO.getDouble(valueSlice,valueOffset,1);
  double m2=APPROX_AVG_CONTEXT_INFO.getDouble(valueSlice,valueOffset,2);
  BlockCursor cursor=block.cursor();
  while (cursor.advanceNextPosition()) {
    if (cursor.isNull(field)) {
      continue;
    }
    hasValue=true;
    count++;
    double x=cursor.getLong(field);
    double delta=x - mean;
    mean+=(delta / count);
    m2+=(delta * (x - mean));
  }
  if (hasValue) {
    APPROX_AVG_CONTEXT_INFO.setNotNull(valueSlice,valueOffset,0);
    APPROX_AVG_CONTEXT_INFO.setLong(valueSlice,valueOffset,0,count);
    APPROX_AVG_CONTEXT_INFO.setDouble(valueSlice,valueOffset,1,mean);
    APPROX_AVG_CONTEXT_INFO.setDouble(valueSlice,valueOffset,2,m2);
  }
}
