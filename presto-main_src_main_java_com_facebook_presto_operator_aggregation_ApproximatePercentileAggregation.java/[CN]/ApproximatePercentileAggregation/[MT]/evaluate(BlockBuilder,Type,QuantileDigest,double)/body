{
  if (digest.getCount() == 0.0) {
    out.appendNull();
  }
 else {
    checkState(percentile != -1.0,"Percentile is missing");
    checkCondition(0 <= percentile && percentile <= 1,INVALID_FUNCTION_ARGUMENT,"Percentile must be between 0 and 1");
    long value=digest.getQuantile(percentile);
    if (parameterType == BIGINT) {
      out.appendLong(value);
    }
 else     if (parameterType == DOUBLE) {
      out.appendDouble(longToDouble(value));
    }
 else {
      throw new IllegalArgumentException("Expected parameter type to be BIGINT or DOUBLE");
    }
  }
}
