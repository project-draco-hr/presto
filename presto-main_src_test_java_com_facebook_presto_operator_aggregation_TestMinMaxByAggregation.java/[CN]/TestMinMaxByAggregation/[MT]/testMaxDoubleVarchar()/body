{
  InternalAggregationFunction function=METADATA.getExactFunction(new Signature("max_by",AGGREGATE,StandardTypes.VARCHAR,StandardTypes.VARCHAR,StandardTypes.DOUBLE)).getAggregationFunction();
  assertAggregation(function,1.0,"a",createStringsBlock("z","a",null),createDoublesBlock(1.0,2.0,null));
  assertAggregation(function,1.0,"hi",createStringsBlock("zz","hi",null,"a"),createDoublesBlock(0.0,1.0,null,-1.0));
}
