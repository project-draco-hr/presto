{
  assertFunction("test_row(1, CAST(NULL AS DOUBLE)).col1",DOUBLE,null);
  assertFunction("test_row(TRUE, CAST(NULL AS BOOLEAN)).col1",BOOLEAN,null);
  assertFunction("test_row(TRUE, CAST(NULL AS ARRAY<INTEGER>)).col1",new ArrayType(INTEGER),null);
  assertFunction("test_row(1.0, CAST(NULL AS VARCHAR)).col1",VARCHAR,null);
  assertFunction("test_row(1, 2).col0",INTEGER,1);
  assertFunction("test_row(1, 'kittens').col1",VARCHAR,"kittens");
  assertFunction("test_row(1, 2).\"col1\"",INTEGER,2);
  assertFunction("array[test_row(1, 2)][1].col1",INTEGER,2);
  assertFunction("test_row(FALSE, ARRAY [1, 2], MAP(ARRAY[1, 3], ARRAY[2.0, 4.0])).col1",new ArrayType(INTEGER),ImmutableList.of(1,2));
  assertFunction("test_row(FALSE, ARRAY [1, 2], MAP(ARRAY[1, 3], ARRAY[2.0, 4.0])).col2",new MapType(INTEGER,DOUBLE),ImmutableMap.of(1,2.0,3,4.0));
  assertFunction("test_row(1.0, ARRAY[test_row(31, 4.1), test_row(32, 4.2)], test_row(3, 4.0)).col1[2].col0",INTEGER,32);
}
