{
  String queryPrefix="SELECT * " + "FROM " + "    (VALUES 1,2,3) t(x) "+ "  JOIN "+ "    (VALUES 1,2,3) t2(y) "+ "  ON ";
  assertQuery(queryPrefix + "(x = (VALUES 1)) = (y = (VALUES 2)) AND (x in (VALUES 2)) = (y in (VALUES 1))","VALUES (1,2), (2,1), (3, 3)");
  assertQuery(queryPrefix + "(x = (VALUES 2)) = (y > (VALUES 0)) AND (x > (VALUES 1)) = (y < (VALUES 3))","VALUES (2,2), (2,1)");
  assertQuery(queryPrefix + "(x = (VALUES 1)) = (y = (VALUES 1)) AND (x = (SELECT 2)) != (y = (SELECT 3))","VALUES (2,2), (3,3)");
}
