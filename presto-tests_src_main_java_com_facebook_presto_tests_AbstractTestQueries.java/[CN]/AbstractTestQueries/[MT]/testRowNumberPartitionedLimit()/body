{
  MaterializedResult actual=computeActual("" + "SELECT orderkey, orderstatus FROM (\n" + "   SELECT row_number() OVER (PARTITION BY orderstatus) rn, orderkey, orderstatus\n"+ "   FROM orders\n"+ ") WHERE rn <= 5\n");
  MaterializedResult all=computeExpected("SELECT orderkey, orderstatus FROM ORDERS",actual.getTypes());
  assertEquals(actual.getMaterializedRows().size(),15);
  assertTrue(all.getMaterializedRows().containsAll(actual.getMaterializedRows()));
  actual=computeActual("" + "SELECT orderkey FROM (\n" + "   SELECT row_number() OVER (PARTITION BY orderstatus) rn, orderkey\n"+ "   FROM orders\n"+ ") WHERE rn <= 5\n");
  all=computeExpected("SELECT orderkey FROM ORDERS",actual.getTypes());
  assertEquals(actual.getMaterializedRows().size(),15);
  assertTrue(all.getMaterializedRows().containsAll(actual.getMaterializedRows()));
}
