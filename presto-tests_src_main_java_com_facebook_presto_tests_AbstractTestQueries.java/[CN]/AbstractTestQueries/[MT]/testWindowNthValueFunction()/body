{
  MaterializedResult actual=computeActual("" + "SELECT * FROM (\n" + "  SELECT orderkey, orderstatus\n"+ "    , nth_value(orderkey + 1000, 2) OVER (PARTITION BY orderstatus ORDER BY orderkey) as lvalue\n"+ "    FROM (SELECT * FROM orders ORDER BY orderkey LIMIT 10) x\n"+ "  ) x\n"+ "ORDER BY orderkey LIMIT 5");
  MaterializedResult expected=resultBuilder(getSession(),BIGINT,VARCHAR,BIGINT).row(1,"O",1002).row(2,"O",1002).row(3,"F",1005).row(4,"O",1002).row(5,"F",1005).build();
  assertEquals(actual,expected);
}
