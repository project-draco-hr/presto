{
  assertQuery("SELECT a.col0, " + "SUM(a.col1[1].col1) OVER(PARTITION BY a.col2.col0), " + "SUM(a.col2.col1) OVER(PARTITION BY a.col2.col0) FROM "+ "(VALUES "+ "(ROW(test_row(1.0, ARRAY[test_row(31, 14.5), test_row(12, 4.2)], test_row(3, 4.0)))), "+ "(ROW(test_row(2.2, ARRAY[test_row(41, 13.1), test_row(32, 4.2)], test_row(6, 6.0)))), "+ "(ROW(test_row(2.2, ARRAY[test_row(41, 17.1), test_row(45, 4.2)], test_row(7, 16.0)))), "+ "(ROW(test_row(2.2, ARRAY[test_row(41, 13.1), test_row(32, 4.2)], test_row(6, 6.0)))), "+ "(ROW(test_row(3.1, ARRAY[test_row(41, 13.1), test_row(32, 4.2)], test_row(6, 6.0))))) t(a) ","SELECT * FROM VALUES (1.0, 14.5, 4.0), (2.2, 39.3, 18.0), (2.2, 39.3, 18.0), (2.2, 17.1, 16.0), (3.1, 39.3, 18.0)");
  assertQuery("SELECT a.col1[1].col0, " + "SUM(a.col0) OVER(PARTITION BY a.col1[1].col0), " + "SUM(a.col1[1].col1) OVER(PARTITION BY a.col1[1].col0), "+ "SUM(a.col2.col1) OVER(PARTITION BY a.col1[1].col0) FROM "+ "(VALUES "+ "(ROW(test_row(1.0, ARRAY[test_row(31, 14.5), test_row(12, 4.2)], test_row(3, 4.0)))), "+ "(ROW(test_row(3.1, ARRAY[test_row(41, 13.1), test_row(32, 4.2)], test_row(6, 6.0)))), "+ "(ROW(test_row(2.2, ARRAY[test_row(31, 14.2), test_row(22, 4.2)], test_row(5, 4.0))))) t(a) ","SELECT * FROM VALUES (31, 3.2, 28.7, 8.0), (31, 3.2, 28.7, 8.0), (41, 3.1, 13.1, 6.0)");
}
