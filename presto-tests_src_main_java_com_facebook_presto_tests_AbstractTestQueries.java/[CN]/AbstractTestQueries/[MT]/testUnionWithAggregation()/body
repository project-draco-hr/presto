{
  assertQuery("SELECT ds, count(*) FROM (" + "   SELECT orderdate ds, orderkey FROM orders " + "   UNION ALL "+ "   SELECT shipdate ds, orderkey FROM lineitem) a "+ "GROUP BY ds");
  assertQuery("SELECT ds, count(*) FROM (" + "   SELECT orderdate ds, orderkey FROM orders " + "   UNION "+ "   SELECT shipdate ds, orderkey FROM lineitem) a "+ "GROUP BY ds");
  assertQuery("SELECT ds, count(DISTINCT orderkey) FROM (" + "   SELECT orderdate ds, orderkey FROM orders " + "   UNION "+ "   SELECT shipdate ds, orderkey FROM lineitem) a "+ "GROUP BY ds");
  assertQuery("SELECT clerk, count(DISTINCT orderstatus) FROM (" + "SELECT * FROM orders WHERE orderkey=0 " + " UNION ALL "+ "SELECT * FROM orders WHERE orderkey<>0) "+ "GROUP BY clerk");
  assertQuery("SELECT count(clerk) FROM (" + "SELECT clerk FROM orders WHERE orderkey=0 " + " UNION ALL "+ "SELECT clerk FROM orders WHERE orderkey<>0) "+ "GROUP BY clerk");
  assertQuery("SELECT count(orderkey), sum(sc) FROM (" + "    SELECT sum(custkey) sc, orderkey FROM (" + "        SELECT custkey,orderkey, orderkey+1 from orders where orderkey=0"+ "        UNION ALL "+ "        SELECT custkey,orderkey,orderkey+1 from orders where orderkey<>0) "+ "    GROUP BY orderkey)");
  assertQuery("SELECT count(orderkey), sum(sc) FROM (\n" + "    SELECT sum(custkey) sc, orderkey FROM (\n" + "        SELECT custkey, orderkey, orderkey+1, orderstatus from orders where orderkey=0\n"+ "        UNION ALL \n"+ "        SELECT custkey, orderkey, orderkey+1, orderstatus from orders where orderkey<>0) \n"+ "    GROUP BY GROUPING SETS ((orderkey, orderstatus), (orderkey)))","SELECT count(orderkey), sum(sc) FROM (\n" + "    SELECT sum(custkey) sc, orderkey FROM (\n" + "        SELECT custkey, orderkey, orderkey+1, orderstatus from orders where orderkey=0\n"+ "        UNION ALL \n"+ "        SELECT custkey, orderkey, orderkey+1, orderstatus from orders where orderkey<>0) \n"+ "    GROUP BY orderkey, orderstatus \n"+ "    \n"+ "    UNION ALL \n"+ "    \n"+ "    SELECT sum(custkey) sc, orderkey FROM (\n"+ "        SELECT custkey, orderkey, orderkey+1, orderstatus from orders where orderkey=0\n"+ "        UNION ALL \n"+ "        SELECT custkey, orderkey, orderkey+1, orderstatus from orders where orderkey<>0) \n"+ "    GROUP BY orderkey)");
}
