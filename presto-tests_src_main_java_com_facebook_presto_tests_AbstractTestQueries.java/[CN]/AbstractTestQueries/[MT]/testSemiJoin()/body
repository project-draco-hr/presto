{
  assertQuery("SELECT linenumber, min(orderkey) " + "FROM lineitem " + "GROUP BY linenumber "+ "HAVING min(orderkey) IN (SELECT orderkey FROM orders WHERE orderkey > 1)");
  assertQuery("SELECT 10 in (SELECT orderkey FROM orders)");
  assertQuery("SELECT * FROM (VALUES (1,1), (2,2), (3, 3)) t(x, y) WHERE (x+y in (VALUES 4, 5)) AND (x*y in (VALUES 4, 5))","VALUES (2,2)");
  assertQuery("" + "SELECT *, o2.custkey\n" + "  IN (\n"+ "    SELECT orderkey\n"+ "    FROM lineitem\n"+ "    WHERE orderkey % 5 = 0)\n"+ "FROM (SELECT * FROM orders WHERE custkey % 256 = 0) o1\n"+ "JOIN (SELECT * FROM orders WHERE custkey % 256 = 0) o2\n"+ "  ON (o1.orderkey IN (SELECT orderkey FROM lineitem WHERE orderkey % 4 = 0)) = (o2.orderkey IN (SELECT orderkey FROM lineitem WHERE orderkey % 4 = 0))\n"+ "WHERE o1.orderkey\n"+ "  IN (\n"+ "    SELECT orderkey\n"+ "    FROM lineitem\n"+ "    WHERE orderkey % 4 = 0)\n"+ "ORDER BY o1.orderkey\n"+ "  IN (\n"+ "    SELECT orderkey\n"+ "    FROM lineitem\n"+ "    WHERE orderkey % 7 = 0)");
  assertQuery("" + "SELECT orderkey\n" + "  IN (\n"+ "    SELECT orderkey\n"+ "    FROM lineitem\n"+ "    WHERE partkey % 4 = 0),\n"+ "  SUM(\n"+ "    CASE\n"+ "      WHEN orderkey\n"+ "        IN (\n"+ "          SELECT orderkey\n"+ "          FROM lineitem\n"+ "          WHERE suppkey % 4 = 0)\n"+ "      THEN 1\n"+ "      ELSE 0\n"+ "      END)\n"+ "FROM orders\n"+ "GROUP BY orderkey\n"+ "  IN (\n"+ "    SELECT orderkey\n"+ "    FROM lineitem\n"+ "    WHERE partkey % 4 = 0)\n"+ "HAVING SUM(\n"+ "  CASE\n"+ "    WHEN orderkey\n"+ "      IN (\n"+ "        SELECT orderkey\n"+ "        FROM lineitem\n"+ "        WHERE suppkey % 4 = 0)\n"+ "      THEN 1\n"+ "      ELSE 0\n"+ "      END) > 1");
}
