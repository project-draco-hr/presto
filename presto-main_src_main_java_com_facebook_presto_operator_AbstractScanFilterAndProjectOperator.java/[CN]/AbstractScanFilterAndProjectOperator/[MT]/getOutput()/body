{
  if (!finishing) {
    if (cursor != null) {
      int rowsProcessed=filterAndProjectRowOriented(cursor,pageBuilder);
      long bytesProcessed=cursor.getCompletedBytes() - completedBytes;
      operatorContext.recordGeneratedInput(new DataSize(bytesProcessed,BYTE),rowsProcessed,cursor.getReadTimeNanos() - readTimeNanos);
      completedBytes+=bytesProcessed;
      readTimeNanos=cursor.getReadTimeNanos();
      if (rowsProcessed == 0) {
        finishing=true;
      }
    }
 else {
      Page output=operator.getOutput();
      if (output != null) {
        filterAndProjectRowOriented(output,pageBuilder);
      }
    }
  }
  if (pageBuilder.isEmpty() || (!finishing && !pageBuilder.isFull())) {
    return null;
  }
  Page page=pageBuilder.build();
  pageBuilder.reset();
  return page;
}
