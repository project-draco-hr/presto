{
  TupleInfo tupleInfo=new TupleInfo(Type.VARIABLE_BINARY);
  UncompressedValueBlock block=new BlockBuilder(0,tupleInfo).append("alice".getBytes(UTF_8)).append("bob".getBytes(UTF_8)).append("charlie".getBytes(UTF_8)).append("dave".getBytes(UTF_8)).build();
  UncompressedBlockStream blockStream=new UncompressedBlockStream(tupleInfo,ImmutableList.of(block));
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ColumnProcessor processor=new UncompressedColumnWriter(Type.VARIABLE_BINARY,0,blockStream.cursor(),out);
  processor.processPositions(Integer.MAX_VALUE);
  processor.finish();
  ImmutableList<UncompressedValueBlock> copiedBlocks=ImmutableList.copyOf(UncompressedBlockSerde.read(Slices.wrappedBuffer(out.toByteArray())));
  assertEquals(copiedBlocks.size(),1);
  ValueBlock copiedBlock=copiedBlocks.get(0);
  assertEquals(copiedBlock.getRange(),block.getRange());
  assertBlockStreamEquals(new UncompressedBlockStream(tupleInfo,copiedBlocks),blockStream);
}
