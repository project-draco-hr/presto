{
  checkArgument(recordSet.getColumnTypes().equals(keyTypes),"Input RecordSet keys do not match expected key type");
  Iterable<RecordSet> outputRecordSets=Iterables.transform(tupleIterable(recordSet),new Function<MaterializedTuple,RecordSet>(){
    @Override public RecordSet apply(    MaterializedTuple key){
      for (      Object value : key.getValues()) {
        if (value == null) {
          throw new IllegalArgumentException("TPCH index does not support null values");
        }
      }
      return lookupKey(key);
    }
  }
);
  return new ConcatRecordSet(outputRecordSets,outputTypes);
}
