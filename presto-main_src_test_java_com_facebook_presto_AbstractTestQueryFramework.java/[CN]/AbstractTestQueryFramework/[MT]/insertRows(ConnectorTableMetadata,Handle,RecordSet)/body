{
  String vars=Joiner.on(',').join(nCopies(tableMetadata.getColumns().size(),"?"));
  String sql=format("INSERT INTO %s VALUES (%s)",tableMetadata.getTable().getTableName(),vars);
  RecordCursor cursor=data.cursor();
  while (true) {
    PreparedBatch batch=handle.prepareBatch(sql);
    for (int row=0; row < 1000; row++) {
      if (!cursor.advanceNextPosition()) {
        batch.execute();
        return;
      }
      PreparedBatchPart part=batch.add();
      for (int column=0; column < tableMetadata.getColumns().size(); column++) {
        Type type=tableMetadata.getColumns().get(column).getType();
        if (BOOLEAN.equals(type)) {
          part.bind(column,cursor.getBoolean(column));
        }
 else         if (BIGINT.equals(type)) {
          part.bind(column,cursor.getLong(column));
        }
 else         if (DOUBLE.equals(type)) {
          part.bind(column,cursor.getDouble(column));
        }
 else         if (VARCHAR.equals(type)) {
          part.bind(column,new String(cursor.getString(column),UTF_8));
        }
      }
    }
    batch.execute();
  }
}
