{
  if (outputIterator == null) {
    outputIterator=selectTopN(source);
  }
  if (!outputIterator.hasNext()) {
    return endOfData();
  }
  pageBuilder.reset();
  while (!pageBuilder.isFull() && outputIterator.hasNext()) {
    KeyAndTuples next=outputIterator.next();
    for (int i=0; i < projections.size(); i++) {
      projections.get(i).project(next.getTuples(),pageBuilder.getBlockBuilder(i));
    }
  }
  Page page=pageBuilder.build();
  return page;
}
