{
  PriorityQueue<KeyAndTuples> globalCandidates=new PriorityQueue<>(n,KeyAndTuples.keyComparator(ordering));
  try (PageIterator pageIterator=source.iterator(operatorStats)){
    while (pageIterator.hasNext()) {
      Page page=pageIterator.next();
      Iterable<KeyAndPosition> keyAndPositions=computePageCandidatePositions(globalCandidates,page);
      mergeWithGlobalCandidates(globalCandidates,page,keyAndPositions);
    }
  }
   ImmutableList.Builder<KeyAndTuples> minSortedGlobalCandidates=ImmutableList.builder();
  while (!globalCandidates.isEmpty()) {
    minSortedGlobalCandidates.add(globalCandidates.remove());
  }
  return minSortedGlobalCandidates.build().reverse().iterator();
}
