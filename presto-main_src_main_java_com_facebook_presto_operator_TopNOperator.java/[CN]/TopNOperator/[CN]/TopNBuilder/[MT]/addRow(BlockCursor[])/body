{
  long sizeDelta=0;
  RandomAccessBlock[] row=getValues(cursors);
  long sampleWeight=1;
  if (sampleWeightChannel.isPresent()) {
    sampleWeight=row[sampleWeightChannel.get()].getLong(0);
    row[sampleWeightChannel.get()]=createBigintBlock(1);
  }
  sizeDelta+=sizeOfRow(row);
  globalCandidates.add(row);
  sizeDelta+=(sampleWeight - 1) * OVERHEAD_PER_VALUE.toBytes();
  for (int i=1; i < sampleWeight; i++) {
    globalCandidates.add(row);
  }
  while (globalCandidates.size() > n) {
    RandomAccessBlock[] previous=globalCandidates.remove();
    if (previous != globalCandidates.peek()) {
      sizeDelta-=sizeOfRow(previous);
    }
 else {
      sizeDelta-=OVERHEAD_PER_VALUE.toBytes();
    }
  }
  return sizeDelta;
}
