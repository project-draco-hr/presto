{
  long sizeDelta=0;
  BlockCursor[] cursors=new BlockCursor[page.getChannelCount()];
  for (int i=0; i < page.getChannelCount(); i++) {
    cursors[i]=page.getBlock(i).cursor();
  }
  for (int i=0; i < page.getPositionCount(); i++) {
    for (    BlockCursor cursor : cursors) {
      checkState(cursor.advanceNextPosition());
    }
    if (globalCandidates.size() < n) {
      sizeDelta+=addRow(cursors);
    }
 else     if (compare(cursors,globalCandidates.peek()) < 0) {
      sizeDelta+=addRow(cursors);
    }
  }
  return sizeDelta;
}
