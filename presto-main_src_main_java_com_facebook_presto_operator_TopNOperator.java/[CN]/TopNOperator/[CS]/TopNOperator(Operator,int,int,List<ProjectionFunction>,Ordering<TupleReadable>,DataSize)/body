{
  checkNotNull(source,"source is null");
  checkArgument(n > 0,"n must be greater than zero");
  checkArgument(keyChannelIndex >= 0,"keyChannelIndex must be at least zero");
  checkNotNull(projections,"projections is null");
  checkArgument(!projections.isEmpty(),"projections is empty");
  checkNotNull(ordering,"ordering is null");
  this.source=source;
  this.n=n;
  this.keyChannelIndex=keyChannelIndex;
  this.projections=ImmutableList.copyOf(projections);
  this.ordering=ordering.reverse();
  this.maxSize=maxSize;
  ImmutableList.Builder<TupleInfo> tupleInfos=ImmutableList.builder();
  for (  ProjectionFunction projection : projections) {
    tupleInfos.add(projection.getTupleInfo());
  }
  this.tupleInfos=tupleInfos.build();
}
