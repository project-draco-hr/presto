{
  TupleDescriptor descriptor=analysis.getTableDescriptor(table);
  ImmutableMap.Builder<String,Slot> attributes=ImmutableMap.builder();
  List<NamedSlot> slots=descriptor.getSlots();
  for (  NamedSlot namedSlot : slots) {
    Slot slot=namedSlot.getSlot();
    String attribute=namedSlot.getAttribute().get();
    attributes.put(attribute,slot);
  }
  QualifiedName tableFullName=Iterables.getFirst(slots,null).getPrefix().get();
  String catalogName=tableFullName.getParts().get(0);
  String schemaName=tableFullName.getParts().get(1);
  String tableName=tableFullName.getParts().get(2);
  return new TableScan(catalogName,schemaName,tableName,attributes.build());
}
