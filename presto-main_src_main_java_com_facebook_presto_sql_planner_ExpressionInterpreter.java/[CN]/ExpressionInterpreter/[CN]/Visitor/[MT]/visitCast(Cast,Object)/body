{
  Object value=process(node.getExpression(),context);
  if (value instanceof Expression) {
    return new Cast((Expression)value,node.getType());
  }
  if (value == null) {
    return null;
  }
  Type type=metadata.getType(node.getType());
  if (type == null) {
    throw new IllegalArgumentException("Unsupported type: " + node.getType());
  }
  FunctionInfo operatorInfo=metadata.getExactOperator(OperatorType.CAST,type,types(node.getExpression()));
  return invoke(session,operatorInfo.getMethodHandle(),ImmutableList.of(value));
}
