{
  Object value=process(node.getExpression(),context);
  if (value == null) {
    return null;
  }
  if (value instanceof Expression) {
    return new Extract(toExpression(value),node.getField());
  }
  long time=(long)value;
switch (node.getField()) {
case CENTURY:
    return UnixTimeFunctions.century(time);
case YEAR:
  return UnixTimeFunctions.year(time);
case QUARTER:
return UnixTimeFunctions.quarter(time);
case MONTH:
return UnixTimeFunctions.month(time);
case WEEK:
return UnixTimeFunctions.week(time);
case DAY:
case DAY_OF_MONTH:
return UnixTimeFunctions.day(time);
case DAY_OF_WEEK:
case DOW:
return UnixTimeFunctions.dayOfWeek(time);
case DAY_OF_YEAR:
case DOY:
return UnixTimeFunctions.dayOfYear(time);
case HOUR:
return UnixTimeFunctions.hour(time);
case MINUTE:
return UnixTimeFunctions.minute(time);
case SECOND:
return UnixTimeFunctions.second(time);
case TIMEZONE_HOUR:
case TIMEZONE_MINUTE:
return 0L;
}
throw new UnsupportedOperationException("not yet implemented: " + node.getField());
}
