{
  Object value=process(node.getValue(),context);
  if (value == null) {
    return null;
  }
  Object min=process(node.getMin(),context);
  if (min == null) {
    return null;
  }
  Object max=process(node.getMax(),context);
  if (max == null) {
    return null;
  }
  if (value instanceof Number && min instanceof Number && max instanceof Number) {
    return ((Number)min).doubleValue() <= ((Number)value).doubleValue() && ((Number)value).doubleValue() <= ((Number)max).doubleValue();
  }
 else   if (value instanceof Slice && min instanceof Slice && max instanceof Slice) {
    return ((Slice)min).compareTo((Slice)value) <= 0 && ((Slice)value).compareTo((Slice)max) <= 0;
  }
  return new BetweenPredicate(toExpression(value,expressionTypes.get(node.getValue())),toExpression(min,expressionTypes.get(node.getMin())),toExpression(max,expressionTypes.get(node.getMax())));
}
