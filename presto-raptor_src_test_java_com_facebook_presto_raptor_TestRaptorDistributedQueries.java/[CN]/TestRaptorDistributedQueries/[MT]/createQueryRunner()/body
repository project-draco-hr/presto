{
  DistributedQueryRunner queryRunner=new DistributedQueryRunner(createSession("tpch"),4);
  queryRunner.installPlugin(new TpchPlugin());
  queryRunner.createCatalog("tpch","tpch");
  queryRunner.installPlugin(new SampledTpchPlugin());
  queryRunner.createCatalog("tpch_sampled","tpch_sampled");
  queryRunner.installPlugin(new RaptorPlugin());
  File baseDir=queryRunner.getCoordinator().getBaseDataDir().toFile();
  Map<String,String> raptorProperties=ImmutableMap.<String,String>builder().put("metadata.db.type","h2").put("metadata.db.filename",new File(baseDir,"db").getAbsolutePath()).put("storage.data-directory",new File(baseDir,"data").getAbsolutePath()).build();
  queryRunner.createCatalog("default","raptor",raptorProperties);
  log.info("Loading data...");
  long startTime=System.nanoTime();
  copyAllTables(queryRunner,"tpch",TpchMetadata.TINY_SCHEMA_NAME,createSession("tpch"));
  copyAllTables(queryRunner,"tpch_sampled",TpchMetadata.TINY_SCHEMA_NAME,createSession(TPCH_SAMPLED_SCHEMA));
  log.info("Loading complete in %s",nanosSince(startTime).toString(SECONDS));
  return queryRunner;
}
