{
  if (!finishing) {
    return null;
  }
  outputConsumed=true;
  QueryInfo queryInfo=queryPerformanceFetcher.getQueryInfo(operatorContext.getDriverContext().getTaskId().getQueryId());
  checkState(queryInfo.getOutputStage().isPresent(),"Output stage is missing");
  String plan=textDistributedPlan(queryInfo.getOutputStage().get().getSubStages(),metadata,operatorContext.getSession());
  BlockBuilder builder=VARCHAR.createBlockBuilder(new BlockBuilderStatus(),1);
  VARCHAR.writeString(builder,plan);
  return new Page(builder.build());
}
