{
  checkNotNull(tupleStreamPosition,"tupleStreamPosition is null");
  checkState(!finished,"already finished");
  if (lastTuple == null) {
    lastTuple=tupleStreamPosition.getTuple();
    if (set.size() < MAX_UNIQUE_COUNT) {
      set.add(lastTuple);
    }
  }
 else   if (!tupleStreamPosition.currentTupleEquals(lastTuple)) {
    runsCount++;
    lastTuple=tupleStreamPosition.getTuple();
    if (set.size() < MAX_UNIQUE_COUNT) {
      set.add(lastTuple);
    }
  }
  minPosition=Math.min(minPosition,tupleStreamPosition.getPosition());
  maxPosition=Math.max(maxPosition,tupleStreamPosition.getCurrentValueEndPosition());
  rowCount+=tupleStreamPosition.getCurrentValueEndPosition() - tupleStreamPosition.getPosition() + 1;
}
