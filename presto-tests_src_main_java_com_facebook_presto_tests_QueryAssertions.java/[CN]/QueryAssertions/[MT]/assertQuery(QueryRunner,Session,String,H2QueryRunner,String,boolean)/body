{
  long start=System.nanoTime();
  MaterializedResult actualResults=actualQueryRunner.execute(session,actual).toJdbcTypes();
  Duration actualTime=nanosSince(start);
  long expectedStart=System.nanoTime();
  MaterializedResult expectedResults=h2QueryRunner.execute(session,expected,actualResults.getTypes());
  log.info("FINISHED in presto: %s, h2: %s, total: %s",actualTime,nanosSince(expectedStart),nanosSince(start));
  List<MaterializedRow> actualRows=actualResults.getMaterializedRows();
  List<MaterializedRow> expectedRows=expectedResults.getMaterializedRows();
  if (ensureOrdering) {
    if (!actualRows.equals(expectedRows)) {
      assertEquals(actualRows,expectedRows);
    }
  }
 else {
    assertEqualsIgnoreOrder(actualRows,expectedRows);
  }
}
