{
  try {
    return retry().stopOnIllegalExceptions().run("getAllDatabases",stats.getGetAllDatabases().wrap(new Callable<List<String>>(){
      @Override public List<String> call() throws Exception {
        try (HiveMetastoreClient client=clientProvider.createMetastoreClient()){
          return client.get_all_databases();
        }
       }
    }
));
  }
 catch (  TException e) {
    throw new PrestoException(HiveErrorCode.HIVE_METASTORE_ERROR,e);
  }
}
