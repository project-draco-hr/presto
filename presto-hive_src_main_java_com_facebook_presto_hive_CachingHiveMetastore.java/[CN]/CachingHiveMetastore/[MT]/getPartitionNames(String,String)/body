{
  return getWithCallable(partitionNamesCache,HiveTableName.table(databaseName,tableName),new Callable<List<String>>(){
    @Override public List<String> call() throws Exception {
      return retry().stopOn(NoSuchObjectException.class).stopOnIllegalExceptions().run("getPartitionNames",new Callable<List<String>>(){
        @Override public List<String> call() throws Exception {
          try (HiveMetastoreClient client=clientProvider.createMetastoreClient()){
            List<String> partitionNames=client.get_partition_names(databaseName,tableName,(short)0);
            if (partitionNames.isEmpty()) {
              getTable(databaseName,tableName);
              return ImmutableList.of(UNPARTITIONED_ID);
            }
            return partitionNames;
          }
         }
      }
);
    }
  }
,NoSuchObjectException.class);
}
