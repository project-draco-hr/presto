{
  return getWithCallable(tableCache,HiveTableName.table(databaseName,tableName),new Callable<Table>(){
    @Override public Table call() throws Exception {
      try (HiveMetastoreClient client=clientProvider.createMetastoreClient()){
        Table table=client.get_table(databaseName,tableName);
        if (table.getTableType().equals(TableType.VIRTUAL_VIEW.toString())) {
          throw new TableNotFoundException(new SchemaTableName(databaseName,tableName),HiveClient.HIVE_VIEWS_NOT_SUPPORTED);
        }
        return table;
      }
     }
  }
,NoSuchObjectException.class);
}
