{
  checkNotNull(page,"page is null");
  checkArgument(page.getChannelCount() == types.size(),"Expected a page with %s columns, but got %s columns",page.getChannelCount(),types.size());
  List<BlockCursor> cursors=new ArrayList<>();
  for (  Block block : page.getBlocks()) {
    cursors.add(block.cursor());
  }
  while (true) {
    List<Object> values=new ArrayList<>(types.size());
    for (    BlockCursor cursor : cursors) {
      if (cursor.advanceNextPosition()) {
        values.add(cursor.getObjectValue(session));
      }
 else {
        checkState(values.isEmpty(),"unaligned cursors");
      }
    }
    if (values.isEmpty()) {
      return this;
    }
    rows.add(new MaterializedRow(DEFAULT_PRECISION,values));
  }
}
