{
  this.operatorContext=checkNotNull(operatorContext,"operatorContext is null");
  checkArgument(n > 0,"n must be greater than zero");
  this.n=n;
  checkArgument(keyChannelIndex >= 0,"keyChannelIndex must be at least zero");
  this.keyChannelIndex=keyChannelIndex;
  this.projections=ImmutableList.copyOf(checkNotNull(projections,"projections is null"));
  checkArgument(!projections.isEmpty(),"projections is empty");
  this.ordering=checkNotNull(ordering,"ordering is null").reverse();
  this.partial=partial;
  this.memoryManager=new TopNMemoryManager(checkNotNull(operatorContext,"operatorContext is null"));
  this.tupleInfos=toTupleInfos(projections);
  this.pageBuilder=new PageBuilder(getTupleInfos());
}
