{
  checkNotNull(split,"split is null");
  checkArgument(split instanceof SystemSplit,"Split must be of type %s, not %s",SystemSplit.class.getName(),split.getClass().getName());
  SchemaTableName tableName=((SystemSplit)split).getTableHandle().getSchemaTableName();
  checkNotNull(columns,"columns is null");
  checkArgument(!columns.isEmpty(),"must provide at least one column");
  SystemTable systemTable=tables.get(tableName);
  checkArgument(systemTable != null,"Table %s does not exist",tableName);
  Map<String,ColumnMetadata> columnsByName=Maps.uniqueIndex(systemTable.getTableMetadata().getColumns(),columnNameGetter());
  ImmutableList.Builder<Integer> userToSystemFieldIndex=ImmutableList.builder();
  for (  ColumnHandle column : columns) {
    checkArgument(column instanceof SystemColumnHandle,"column must be of type %s, not %s",SystemColumnHandle.class.getName(),column.getClass().getName());
    String columnName=((SystemColumnHandle)column).getColumnName();
    ColumnMetadata columnMetadata=columnsByName.get(columnName);
    checkArgument(columnMetadata != null,"Column %s.%s does not exist",tableName,columnName);
    userToSystemFieldIndex.add(columnMetadata.getOrdinalPosition());
  }
  return new RecordProjectOperator(new MappedRecordSet(systemTable,userToSystemFieldIndex.build()));
}
