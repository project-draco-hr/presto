{
  String csv="\"row 1\",row2,\"row3\",100,\"200\",300,4.5";
  CsvKafkaRowDecoder rowDecoder=new CsvKafkaRowDecoder();
  KafkaColumnHandle row1=new KafkaColumnHandle("",0,"row1",VarcharType.VARCHAR,"0",null,null,false,false,false);
  KafkaColumnHandle row2=new KafkaColumnHandle("",1,"row2",VarcharType.VARCHAR,"1",null,null,false,false,false);
  KafkaColumnHandle row3=new KafkaColumnHandle("",2,"row3",VarcharType.VARCHAR,"2",null,null,false,false,false);
  KafkaColumnHandle row4=new KafkaColumnHandle("",3,"row4",BigintType.BIGINT,"3",null,null,false,false,false);
  KafkaColumnHandle row5=new KafkaColumnHandle("",4,"row5",BigintType.BIGINT,"4",null,null,false,false,false);
  KafkaColumnHandle row6=new KafkaColumnHandle("",5,"row6",BigintType.BIGINT,"5",null,null,false,false,false);
  KafkaColumnHandle row7=new KafkaColumnHandle("",6,"row7",DoubleType.DOUBLE,"6",null,null,false,false,false);
  List<KafkaColumnHandle> columns=ImmutableList.of(row1,row2,row3,row4,row5,row6,row7);
  Set<KafkaFieldValueProvider> providers=new HashSet<>();
  boolean corrupt=rowDecoder.decodeRow(csv.getBytes(StandardCharsets.UTF_8),providers,columns,buildMap(columns));
  assertFalse(corrupt);
  assertEquals(providers.size(),columns.size());
  checkValue(providers,row1,"row 1");
  checkValue(providers,row2,"row2");
  checkValue(providers,row3,"row3");
  checkValue(providers,row4,100);
  checkValue(providers,row5,200);
  checkValue(providers,row6,300);
  checkValue(providers,row7,4.5d);
}
