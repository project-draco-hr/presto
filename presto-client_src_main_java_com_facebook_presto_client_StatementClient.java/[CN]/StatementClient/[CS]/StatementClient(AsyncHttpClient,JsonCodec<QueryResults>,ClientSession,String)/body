{
  checkNotNull(httpClient,"httpClient is null");
  checkNotNull(queryResultsCodec,"queryResultsCodec is null");
  checkNotNull(session,"session is null");
  checkNotNull(query,"query is null");
  this.httpClient=httpClient;
  this.responseHandler=createFullJsonResponseHandler(queryResultsCodec);
  this.debug=session.isDebug();
  this.query=query;
  Request request=buildQueryRequest(session,query);
  currentResults.set(httpClient.execute(request,responseHandler).getValue());
}
