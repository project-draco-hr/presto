{
  Request.Builder builder=preparePost().setUri(uriBuilderFrom(session.getServer()).replacePath("/v1/statement").build()).setBodyGenerator(createStaticBodyGenerator(query,UTF_8));
  if (session.getUser() != null) {
    builder.setHeader(PrestoHeaders.PRESTO_USER,session.getUser());
  }
  if (session.getSource() != null) {
    builder.setHeader(PrestoHeaders.PRESTO_SOURCE,session.getSource());
  }
  if (session.getCatalog() != null) {
    builder.setHeader(PrestoHeaders.PRESTO_CATALOG,session.getCatalog());
  }
  if (session.getSchema() != null) {
    builder.setHeader(PrestoHeaders.PRESTO_SCHEMA,session.getSchema());
  }
  builder.setHeader(PrestoHeaders.PRESTO_TIME_ZONE,session.getTimeZoneId());
  builder.setHeader(PrestoHeaders.PRESTO_LANGUAGE,session.getLocale().toLanguageTag());
  builder.setHeader(USER_AGENT,USER_AGENT_VALUE);
  Map<String,String> property=session.getProperties();
  for (  Entry<String,String> entry : property.entrySet()) {
    builder.addHeader(PrestoHeaders.PRESTO_SESSION,entry.getKey() + "=" + entry.getValue());
  }
  builder.setHeader(PrestoHeaders.PRESTO_TRANSACTION_ID,session.getTransactionId() == null ? "NONE" : session.getTransactionId());
  return builder.build();
}
