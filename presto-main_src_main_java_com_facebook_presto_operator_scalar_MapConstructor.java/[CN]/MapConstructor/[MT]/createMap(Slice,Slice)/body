{
  Map<Object,Object> map=new LinkedHashMap<>();
  Object[] keysArray;
  Object[] valuesArray;
  try {
    keysArray=MAPPER.readValue(keys.getInput(),ARRAY_TYPE);
    valuesArray=MAPPER.readValue(values.getInput(),ARRAY_TYPE);
    checkArgument(keysArray.length == valuesArray.length,"Key and value arrays have to be of the same length.");
    for (int i=0; i < keysArray.length; i++) {
      map.put(keysArray[i],valuesArray[i]);
    }
  }
 catch (  IOException e) {
    Throwables.propagate(e);
  }
  return MapType.toStackRepresentation(map);
}
