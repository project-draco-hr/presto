{
  if ((!overwrite) && exists(path)) {
    throw new IOException("File already exists:" + path);
  }
  createDirectories(stagingDirectory.toPath());
  File tempFile=createTempFile(stagingDirectory.toPath(),"presto-s3-",".tmp").toFile();
  String key=keyFromPath(qualifiedPath(path));
  return new FSDataOutputStream(new PrestoS3OutputStream(s3,transferConfig,uri.getHost(),key,tempFile,sseEnabled),statistics);
}
