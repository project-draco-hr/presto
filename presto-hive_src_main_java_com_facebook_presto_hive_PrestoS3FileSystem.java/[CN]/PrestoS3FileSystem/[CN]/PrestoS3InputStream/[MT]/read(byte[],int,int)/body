{
  try {
    int bytesRead=retry().maxAttempts(maxClientRetry).exponentialBackoff(new Duration(1,TimeUnit.SECONDS),maxBackoffTime,2.0).stopOn(InterruptedException.class).run("readStream",new Callable<Integer>(){
      @Override public Integer call() throws Exception {
        openStream();
        try {
          return in.read(buffer,offset,length);
        }
 catch (        Exception e) {
          closeStream();
          throw e;
        }
      }
    }
);
    if (bytesRead != -1) {
      position+=bytesRead;
    }
    return bytesRead;
  }
 catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
    throw Throwables.propagate(e);
  }
catch (  Exception e) {
    Throwables.propagateIfInstanceOf(e,IOException.class);
    throw Throwables.propagate(e);
  }
}
