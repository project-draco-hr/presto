{
  Aggregator aggregator=createAggregator(aggregation(getAggregationFunction(),new Input(0,field)),AggregationNode.Step.SINGLE);
  if (!values.isEmpty()) {
    BlockCursor cursor=createBlock(values,field + 1).cursor();
    while (cursor.advanceNextPosition()) {
      aggregator.addValue(cursor);
    }
  }
  return (long)BlockAssertions.toValues(aggregator.getResult()).get(0).get(0);
}
