{
  HiveConnectorFactory connectorFactory=new HiveConnectorFactory("hive-test",HiveConnector.class.getClassLoader(),null,new TypeRegistry(),new GroupByHashPageIndexerFactory(),new TestingNodeManager(),new ServerInfo("test_id","test_environment","test_version"));
  Map<String,String> config=ImmutableMap.<String,String>builder().put("hive.metastore.uri",metastoreUri).build();
  Connector connector=connectorFactory.create("hive-test",config,new ConnectorContext(){
  }
);
  ConnectorTransactionHandle transaction=connector.beginTransaction(READ_UNCOMMITTED,true);
  assertInstanceOf(connector.getMetadata(transaction),ClassLoaderSafeConnectorMetadata.class);
  assertInstanceOf(connector.getSplitManager(),ClassLoaderSafeConnectorSplitManager.class);
  assertInstanceOf(connector.getPageSourceProvider(),ConnectorPageSourceProvider.class);
  connector.commit(transaction);
}
