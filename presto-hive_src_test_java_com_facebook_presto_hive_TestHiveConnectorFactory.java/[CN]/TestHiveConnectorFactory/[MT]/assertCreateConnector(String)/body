{
  HiveConnectorFactory connectorFactory=new HiveConnectorFactory("hive-test",ImmutableMap.<String,String>builder().put("node.environment","test").put("hive.metastore.uri",metastoreUri).build(),HiveConnector.class.getClassLoader(),null,new TypeRegistry(),new GroupByHashPageIndexerFactory(),new InMemoryNodeManager(),new ServerInfo("test_id","test_environment","test_version"));
  Connector connector=connectorFactory.create("hive-test",ImmutableMap.of(),new ConnectorContext(){
  }
);
  ConnectorTransactionHandle transaction=connector.beginTransaction(READ_UNCOMMITTED,true);
  assertInstanceOf(connector.getMetadata(transaction),ClassLoaderSafeConnectorMetadata.class);
  assertInstanceOf(connector.getSplitManager(),ClassLoaderSafeConnectorSplitManager.class);
  assertInstanceOf(connector.getPageSourceProvider(),ConnectorPageSourceProvider.class);
  connector.commit(transaction);
}
