{
  HiveConnectorFactory connectorFactory=new HiveConnectorFactory("hive-test",ImmutableMap.<String,String>builder().put("node.environment","test").put("hive.metastore.uri",metastoreUri).build(),HiveConnector.class.getClassLoader());
  Connector connector=connectorFactory.create("hive-test",ImmutableMap.<String,String>of());
  assertInstanceOf(connector.getService(ConnectorMetadata.class),ClassLoaderSafeConnectorMetadata.class);
  assertInstanceOf(connector.getService(ConnectorSplitManager.class),ClassLoaderSafeConnectorSplitManager.class);
  assertInstanceOf(connector.getService(ConnectorRecordSetProvider.class),ClassLoaderSafeConnectorRecordSetProvider.class);
  assertInstanceOf(connector.getService(ConnectorHandleResolver.class),ClassLoaderSafeConnectorHandleResolver.class);
}
