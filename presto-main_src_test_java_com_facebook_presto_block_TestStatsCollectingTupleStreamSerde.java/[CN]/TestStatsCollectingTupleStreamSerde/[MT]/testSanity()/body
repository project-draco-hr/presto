{
  StatsCollectingTupleStreamSerde serde=new StatsCollectingTupleStreamSerde(new UncompressedSerde());
  serde.createSerializer().createTupleStreamWriter(sliceOutput).append(tupleStream).finish();
  TupleStream resultTupleStream=serde.createDeserializer().deserialize(Range.ALL,sliceOutput.slice());
  StatsTupleValueSink.Stats stats=serde.createDeserializer().deserializeStats(sliceOutput.slice());
  Blocks.assertTupleStreamEquals(resultTupleStream,tupleStream);
  Assert.assertEquals(stats.getAvgRunLength(),2);
  Assert.assertEquals(stats.getMinPosition(),0);
  Assert.assertEquals(stats.getMaxPosition(),7);
  Assert.assertEquals(stats.getRowCount(),8);
  Assert.assertEquals(stats.getRunsCount(),4);
}
