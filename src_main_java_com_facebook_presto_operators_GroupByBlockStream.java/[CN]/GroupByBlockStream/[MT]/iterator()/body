{
  final Cursor cursor=source.cursor();
  return new AbstractIterator<RunLengthEncodedBlock>(){
    @Override protected RunLengthEncodedBlock computeNext(){
      if (!cursor.hasNextPosition()) {
        endOfData();
        return null;
      }
      cursor.advanceNextValue();
      Tuple key=cursor.getTuple();
      long startPosition=cursor.getPosition();
      while (cursor.hasNextValue() && cursor.nextValueEquals(key)) {
        cursor.advanceNextValue();
      }
      Range range=Range.create(startPosition,cursor.getCurrentValueEndPosition());
      return new RunLengthEncodedBlock(key,range);
    }
  }
;
}
