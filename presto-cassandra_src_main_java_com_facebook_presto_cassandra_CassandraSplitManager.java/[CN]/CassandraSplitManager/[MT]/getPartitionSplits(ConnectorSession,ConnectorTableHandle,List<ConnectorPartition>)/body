{
  checkNotNull(tableHandle,"tableHandle is null");
  CassandraTableHandle cassandraTableHandle=checkType(tableHandle,CassandraTableHandle.class,"tableHandle");
  checkNotNull(partitions,"partitions is null");
  if (partitions.isEmpty()) {
    return new FixedSplitSource(connectorId,ImmutableList.<ConnectorSplit>of());
  }
  if (partitions.size() == 1) {
    ConnectorPartition partition=partitions.get(0);
    CassandraPartition cassandraPartition=checkType(partition,CassandraPartition.class,"partition");
    if (cassandraPartition.isUnpartitioned() || cassandraPartition.isIndexedColumnPredicatePushdown()) {
      CassandraTable table=schemaProvider.getTable(cassandraTableHandle);
      List<ConnectorSplit> splits=getSplitsByTokenRange(table,cassandraPartition.getPartitionId());
      return new FixedSplitSource(connectorId,splits);
    }
  }
  return new FixedSplitSource(connectorId,getSplitsForPartitions(cassandraTableHandle,partitions));
}
