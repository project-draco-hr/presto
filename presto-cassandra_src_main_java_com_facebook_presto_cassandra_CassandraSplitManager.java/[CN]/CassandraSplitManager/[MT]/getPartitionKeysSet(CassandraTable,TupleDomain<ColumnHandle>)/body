{
  ImmutableList.Builder<Set<Comparable<?>>> partitionColumnValues=ImmutableList.builder();
  for (  CassandraColumnHandle columnHandle : table.getPartitionKeyColumns()) {
    Domain domain=tupleDomain.getDomains().get(columnHandle);
    if (domain == null) {
      return ImmutableSet.of();
    }
    if (domain.isNullAllowed()) {
      return ImmutableSet.of();
    }
    ImmutableSet.Builder<Comparable<?>> columnValues=ImmutableSet.builder();
    for (    Range range : domain.getRanges()) {
      if (!range.isSingleValue()) {
        return ImmutableSet.of();
      }
      Comparable<?> value=range.getSingleValue();
      CassandraType valueType=columnHandle.getCassandraType();
      columnValues.add(valueType.getValueForPartitionKey(value));
    }
    partitionColumnValues.add(columnValues.build());
  }
  return Sets.cartesianProduct(partitionColumnValues.build());
}
