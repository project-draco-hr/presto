{
  checkNotNull(tableHandle,"tableHandle is null");
  checkArgument(tableHandle instanceof CassandraTableHandle,"tableHandle is not an instance of CassandraTableHandle");
  CassandraTableHandle cassandraTableHandle=(CassandraTableHandle)tableHandle;
  checkNotNull(partitions,"partitions is null");
  if (partitions.isEmpty()) {
    return new FixedSplitSource(connectorId,ImmutableList.<Split>of());
  }
  if (partitions.size() == 1) {
    Partition partition=partitions.get(0);
    checkArgument(partition instanceof CassandraPartition,"partitions are no CassandraPartitions");
    CassandraPartition cassandraPartition=(CassandraPartition)partition;
    if (cassandraPartition.isUnpartitioned()) {
      CassandraTable table=schemaProvider.getTable(cassandraTableHandle);
      List<Split> splits=getSplitsByTokenRange(table,cassandraPartition.getPartitionId());
      return new FixedSplitSource(connectorId,splits);
    }
  }
  return new FixedSplitSource(connectorId,getSplitsForPartitions(cassandraTableHandle,partitions));
}
