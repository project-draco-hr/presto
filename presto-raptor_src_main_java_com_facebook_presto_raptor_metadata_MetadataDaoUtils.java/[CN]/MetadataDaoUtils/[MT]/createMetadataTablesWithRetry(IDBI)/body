{
  Duration delay=new Duration(10,TimeUnit.SECONDS);
  while (true) {
    try (Handle handle=dbi.open()){
      createMetadataTables(handle.attach(MetadataDao.class));
      return;
    }
 catch (    UnableToObtainConnectionException e) {
      log.warn("Failed to connect to database. Will retry again in %s. Exception: %s",delay,e.getMessage());
      sleep(delay);
    }
  }
}
