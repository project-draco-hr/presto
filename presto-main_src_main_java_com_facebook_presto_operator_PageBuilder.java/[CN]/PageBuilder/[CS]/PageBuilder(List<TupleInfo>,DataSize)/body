{
  if (!tupleInfos.isEmpty()) {
    maxBlockSize=new DataSize((int)(maxSize.toBytes() / tupleInfos.size()),BYTE);
  }
 else {
    maxBlockSize=new DataSize(0,BYTE);
  }
  DataSize initialBlockBufferSize=new DataSize((int)(maxBlockSize.toBytes() * BUFFER_MULTIPLIER),BYTE);
  blockBuilders=new BlockBuilder[tupleInfos.size()];
  for (int i=0; i < blockBuilders.length; i++) {
    blockBuilders[i]=createBlockBuilder(tupleInfos.get(i),maxBlockSize,initialBlockBufferSize);
  }
  this.maxSizeInBytes=checkNotNull(maxSize,"maxSize is null").toBytes();
}
