{
  int bytesPerColumn=0;
  if (!tupleInfos.isEmpty()) {
    bytesPerColumn=(int)(maxSize.toBytes() / tupleInfos.size());
  }
  blockBuilders=new BlockBuilder[tupleInfos.size()];
  for (int i=0; i < blockBuilders.length; i++) {
    blockBuilders[i]=new BlockBuilder(tupleInfos.get(i),bytesPerColumn,new DynamicSliceOutput((int)(bytesPerColumn * 1.5)));
  }
  this.maxSizeInBytes=checkNotNull(maxSize,"maxSize is null").toBytes();
}
