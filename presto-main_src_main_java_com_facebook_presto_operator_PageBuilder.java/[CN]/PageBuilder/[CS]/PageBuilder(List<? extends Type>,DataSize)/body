{
  DataSize maxBlockSize;
  if (!types.isEmpty()) {
    maxBlockSize=new DataSize((int)(maxPageSize.toBytes() / types.size()),BYTE);
  }
 else {
    maxBlockSize=new DataSize(0,BYTE);
  }
  blockBuilderStatus=new BlockBuilderStatus(maxPageSize,maxBlockSize);
  blockBuilders=new BlockBuilder[types.size()];
  for (int i=0; i < blockBuilders.length; i++) {
    blockBuilders[i]=types.get(i).createBlockBuilder(blockBuilderStatus);
  }
}
