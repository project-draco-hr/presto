{
  List<UncompressedValueBlock> values=ImmutableList.<UncompressedValueBlock>builder().add(createBlock(0,"a","b","c","d","e","f","g")).add(createBlock(20,"h","i","j","k","l","m")).add(createBlock(30,"n","o","p","q","r","s")).build();
  UncompressedBlockStream data=new UncompressedBlockStream(new TupleInfo(VARIABLE_BINARY),values);
  Merge merge=new Merge(data,data,data);
  TupleInfo expectedTupleInfo=new TupleInfo(VARIABLE_BINARY,VARIABLE_BINARY,VARIABLE_BINARY);
  BlockBuilder expectedBlock=new BlockBuilder(0,expectedTupleInfo);
  for (int i='a'; i <= 's'; i++) {
    expectedBlock.append(new byte[]{(byte)i});
    expectedBlock.append(new byte[]{(byte)i});
    expectedBlock.append(new byte[]{(byte)i});
  }
  assertBlockStreamEquals(merge,new UncompressedBlockStream(expectedTupleInfo,expectedBlock.build()));
}
