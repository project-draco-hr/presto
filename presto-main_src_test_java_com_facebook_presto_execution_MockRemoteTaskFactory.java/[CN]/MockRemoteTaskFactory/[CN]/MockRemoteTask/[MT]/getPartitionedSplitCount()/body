{
  if (taskStateMachine.getState().isDone()) {
    return 0;
  }
synchronized (this) {
    Collection<Split> partitionedSplits=splits.get(fragment.getPartitionedSource());
    if (partitionedSplits == null) {
      return 0;
    }
    return partitionedSplits.size();
  }
}
