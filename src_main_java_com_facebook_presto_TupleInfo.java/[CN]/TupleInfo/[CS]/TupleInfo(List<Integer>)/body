{
  Preconditions.checkNotNull(lengths,"lengths is null");
  this.lengths=ImmutableList.copyOf(lengths);
  int rowLength=0;
  for (int i=0; i < lengths.size(); i++) {
    int length=lengths.get(i);
    Preconditions.checkArgument(length >= 1,"length %s must be at least 1",i);
    rowLength+=length;
  }
  ImmutableList.Builder<Integer> offsets=ImmutableList.builder();
  int current=0;
  for (  int length : lengths) {
    offsets.add(current);
    current+=length;
  }
  this.offsets=offsets.build();
  this.size=rowLength;
}
