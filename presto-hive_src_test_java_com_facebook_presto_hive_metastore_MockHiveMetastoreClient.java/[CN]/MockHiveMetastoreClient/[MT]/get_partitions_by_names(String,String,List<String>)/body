{
  accessCount.incrementAndGet();
  if (throwException) {
    throw new RuntimeException();
  }
  if (!dbName.equals(TEST_DATABASE) || !tableName.equals(TEST_TABLE) || !ImmutableSet.of(TEST_PARTITION1,TEST_PARTITION2).containsAll(names)) {
    throw new NoSuchObjectException();
  }
  return Lists.transform(names,new Function<String,Partition>(){
    @Override public Partition apply(    String name){
      try {
        return new Partition(ImmutableList.copyOf(Warehouse.getPartValuesFromPartName(name)),TEST_DATABASE,TEST_TABLE,0,0,null,null);
      }
 catch (      MetaException e) {
        throw Throwables.propagate(e);
      }
    }
  }
);
}
