{
  if (!dictionaryOpen && dictionarySize > 0) {
    dictionary=new Slice[dictionarySize];
    dictionaryLength=new int[dictionarySize];
    LongStream lengthStream=dictionaryLengthStreamSource.openStream();
    if (lengthStream == null) {
      throw new OrcCorruptionException("Dictionary is not empty but dictionary length stream is not present");
    }
    lengthStream.nextIntVector(dictionarySize,dictionaryLength);
    ByteArrayStream dictionaryDataStream=dictionaryDataStreamSource.openStream();
    readDictionary(dictionaryDataStream,dictionarySize,dictionaryLength,dictionary);
  }
  dictionaryOpen=true;
  RowGroupDictionaryLengthStream dictionaryLengthStream=rowGroupDictionaryLengthStreamSource.openStream();
  if (dictionaryLengthStream != null) {
    int rowGroupDictionarySize=dictionaryLengthStream.getEntryCount();
    if (rowGroupDictionary.length < rowGroupDictionarySize) {
      rowGroupDictionary=new Slice[rowGroupDictionarySize];
      rowGroupDictionaryLength=new int[rowGroupDictionarySize];
    }
    dictionaryLengthStream.nextIntVector(rowGroupDictionarySize,rowGroupDictionaryLength);
    ByteArrayStream dictionaryDataStream=rowGroupDictionaryDataStreamSource.openStream();
    readDictionary(dictionaryDataStream,rowGroupDictionarySize,rowGroupDictionaryLength,rowGroupDictionary);
  }
  dictionaryOpen=true;
  presentStream=presentStreamSource.openStream();
  inDictionaryStream=inDictionaryStreamSource.openStream();
  dataStream=dataStreamSource.openStream();
  rowGroupOpen=true;
}
