{
  this.inputDriver=inputDriver;
  this.outputDriver=outputDriver;
  this.operatorFactories=ImmutableList.copyOf(requireNonNull(operatorFactories,"operatorFactories is null"));
  checkArgument(!operatorFactories.isEmpty(),"There must be at least one operator");
  this.driverInstances=requireNonNull(driverInstances,"driverInstances is null");
  ImmutableSet.Builder<PlanNodeId> sourceIds=ImmutableSet.builder();
  for (  OperatorFactory operatorFactory : operatorFactories) {
    if (operatorFactory instanceof SourceOperatorFactory) {
      SourceOperatorFactory sourceOperatorFactory=(SourceOperatorFactory)operatorFactory;
      sourceIds.add(sourceOperatorFactory.getSourceId());
    }
  }
  this.sourceIds=sourceIds.build();
}
