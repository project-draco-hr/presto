{
  Slice[] newValues=new Slice[length];
  Map<Slice,Slice> distinctValues=new IdentityHashMap<>();
  for (int i=positionOffset; i < positionOffset + length; i++) {
    Slice slice=values[ids[i]];
    if (slice == null) {
      continue;
    }
    Slice distinct=distinctValues.get(slice);
    if (distinct == null) {
      distinct=Slices.copyOf(slice);
      distinctValues.put(slice,distinct);
    }
    newValues[i]=distinct;
  }
  return newValues;
}
