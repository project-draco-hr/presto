{
  Block expectedBlock=VARCHAR.createBlockBuilder(new BlockBuilderStatus()).append("alice").append("bob").append("charlie").append("dave").build();
  Page expectedPage=new Page(expectedBlock,expectedBlock,expectedBlock);
  DynamicSliceOutput sliceOutput=new DynamicSliceOutput(1024);
  writePages(createTestingBlockEncodingManager(),sliceOutput,expectedPage,expectedPage,expectedPage);
  Iterator<Page> pageIterator=readPages(createTestingBlockEncodingManager(),sliceOutput.slice().getInput());
  assertPageEquals(pageIterator.next(),expectedPage);
  assertPageEquals(pageIterator.next(),expectedPage);
  assertPageEquals(pageIterator.next(),expectedPage);
  assertFalse(pageIterator.hasNext());
}
