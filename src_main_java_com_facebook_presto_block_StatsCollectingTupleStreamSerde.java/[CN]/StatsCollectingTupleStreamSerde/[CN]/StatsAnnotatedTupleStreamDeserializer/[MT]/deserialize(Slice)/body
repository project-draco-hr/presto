{
  checkNotNull(slice,"slice is null");
  int footerLength=slice.getInt(slice.length() - SizeOf.SIZE_OF_INT);
  int footerOffset=slice.length() - footerLength - SizeOf.SIZE_OF_INT;
  try {
    Stats stats=OBJECT_MAPPER.readValue(slice.slice(footerOffset,footerLength).input(),Stats.class);
    return new StatsAnnotatedTupleStream(tupleStreamSerde.createDeserializer().deserialize(slice.slice(0,footerOffset)),stats);
  }
 catch (  IOException e) {
    throw Throwables.propagate(e);
  }
}
