{
  delegate.finish();
  try {
    int startingIndex=sliceOutput.size();
    OBJECT_MAPPER.writeValue(sliceOutput,statsMerger.build());
    int endingIndex=sliceOutput.size();
    checkState(endingIndex > startingIndex);
    sliceOutput.writeInt(endingIndex - startingIndex);
  }
 catch (  IOException e) {
    throw Throwables.propagate(e);
  }
}
