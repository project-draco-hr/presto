{
  List<Page> input=rowPagesBuilder(BIGINT,DOUBLE).row(1,0.1).row(2,0.2).pageBreak().row(-1,-0.1).row(4,0.4).pageBreak().row(5,0.5).row(4,0.41).row(6,0.6).row(5,0.5).pageBreak().build();
  input=appendSampleWeight(input,2);
  TopNOperatorFactory factory=new TopNOperatorFactory(0,ImmutableList.of(BIGINT,DOUBLE,BIGINT),5,ImmutableList.of(0),ImmutableList.of(DESC_NULLS_LAST),Optional.of(input.get(0).getChannelCount() - 1),false);
  Operator operator=factory.createOperator(driverContext);
  MaterializedResult expected=resultBuilder(driverContext.getSession(),BIGINT,DOUBLE,BIGINT).row(6,0.6,2).row(5,0.5,1).row(5,0.5,2).build();
  assertOperatorEquals(operator,input,expected);
}
