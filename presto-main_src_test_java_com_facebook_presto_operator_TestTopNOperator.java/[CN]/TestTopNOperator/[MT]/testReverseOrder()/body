{
  Operator source=createOperator(new Page(BlockAssertions.createLongsBlock(0,1,2),BlockAssertions.createDoublesBlock(0,0.1,0.2)),new Page(BlockAssertions.createLongsBlock(2,-1,4),BlockAssertions.createDoublesBlock(2,-0.1,0.4)),new Page(BlockAssertions.createLongsBlock(4,5,4,6),BlockAssertions.createDoublesBlock(4,0.5,0.41,0.6)));
  TopNOperator actual=new TopNOperator(source,2,0,ImmutableList.of(singleColumn(FIXED_INT_64,0,0),singleColumn(DOUBLE,1,0)),Ordering.from(FieldOrderedTupleComparator.INSTANCE).reverse());
  Operator expected=createOperator(new Page(BlockAssertions.createLongsBlock(0,-1,1),BlockAssertions.createDoublesBlock(0,-0.1,0.1)));
  assertOperatorEqualsUnordered(actual,expected);
}
