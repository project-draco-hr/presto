{
  ImmutableList.Builder<StateField> builder=ImmutableList.builder();
  Set<Class<?>> supportedClasses=ImmutableSet.<Class<?>>of(byte.class,boolean.class,long.class,double.class,Slice.class);
  for (  Method method : clazz.getMethods()) {
    if (method.getName().equals("getEstimatedSize")) {
      continue;
    }
    if (method.getName().startsWith("get")) {
      Class<?> type=method.getReturnType();
      checkArgument(supportedClasses.contains(type),type.getName() + " is not supported");
      String name=method.getName().substring(3);
      builder.add(new StateField(name,type,getInitialValue(method)));
    }
    if (method.getName().startsWith("is")) {
      Class<?> type=method.getReturnType();
      checkArgument(type == boolean.class,"Only boolean is support for 'is' methods");
      String name=method.getName().substring(2);
      builder.add(new StateField(name,type,getInitialValue(method),method.getName()));
    }
  }
  return builder.build();
}
