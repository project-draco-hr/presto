{
  if (operatorStats.isDone()) {
    return endOfData();
  }
  pageBuilder.reset();
  while (!pageBuilder.isFull() && cursor.advanceNextPosition()) {
    for (int column=0; column < super.getChannelCount(); column++) {
      BlockBuilder output=pageBuilder.getBlockBuilder(column);
      if (cursor.isNull(column)) {
        output.appendNull();
      }
 else {
switch (getTupleInfos().get(column).getTypes().get(0)) {
case BOOLEAN:
          output.append(cursor.getBoolean(column));
        break;
case FIXED_INT_64:
      output.append(cursor.getLong(column));
    break;
case DOUBLE:
  output.append(cursor.getDouble(column));
break;
case VARIABLE_BINARY:
output.append(cursor.getString(column));
break;
}
}
}
}
long completedDataSize=cursor.getCompletedBytes();
if (completedDataSize > currentCompletedSize) {
operatorStats.addCompletedDataSize(completedDataSize - currentCompletedSize);
currentCompletedSize=completedDataSize;
}
if (pageBuilder.isEmpty()) {
return endOfData();
}
Page page=pageBuilder.build();
operatorStats.addCompletedPositions(page.getPositionCount());
return page;
}
