{
  if (!rowGroupOpen) {
    openRowGroup();
  }
  if (readOffset > 0) {
    if (presentStream != null) {
      readOffset=presentStream.countBitsSet(readOffset);
    }
    blockReader.skip(readOffset);
  }
  if (presentStream != null) {
    presentStream.getUnsetBits(nextBatchSize,isNullVector);
  }
  BlockBuilder blockBuilder=type.createBlockBuilder(new BlockBuilderStatus(),nextBatchSize);
  for (int i=0; i < nextBatchSize; i++) {
    if (!isNullVector[i]) {
      blockReader.readNextValueInto(blockBuilder,false);
    }
 else {
      blockBuilder.appendNull();
    }
  }
  readOffset=0;
  nextBatchSize=0;
  return blockBuilder.build();
}
