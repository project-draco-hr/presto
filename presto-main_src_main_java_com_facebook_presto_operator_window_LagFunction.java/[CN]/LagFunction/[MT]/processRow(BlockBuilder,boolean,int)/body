{
  if ((offsetChannel >= 0) && pagesIndex.isNull(offsetChannel,currentPosition)) {
    output.appendNull();
  }
 else {
    long offset=(offsetChannel < 0) ? 1 : pagesIndex.getLong(offsetChannel,currentPosition);
    checkCondition(offset >= 0,INVALID_FUNCTION_ARGUMENT,"Offset must be at least 0");
    long valuePosition=currentPosition - offset;
    if ((valuePosition >= partitionStartPosition) && (valuePosition <= currentPosition)) {
      pagesIndex.appendTo(valueChannel,Ints.checkedCast(valuePosition),output);
    }
 else {
      appendDefault(output);
    }
  }
  currentPosition++;
}
