{
  UncompressedBlockStream data=new UncompressedBlockStream(new TupleInfo(VARIABLE_BINARY),ImmutableList.of(createBlock(0,"apple","banana","cherry","date")));
  GroupByOperator groupBy=new GroupByOperator(data);
  Map<String,Range> expected=ImmutableMap.of("apple",Range.create(0,0),"banana",Range.create(1,1),"cherry",Range.create(2,2),"date",Range.create(3,3));
  Map<String,Range> actual=new HashMap<>();
  for (  RunLengthEncodedBlock block : groupBy) {
    Tuple tuple=block.getValue();
    String key=tuple.getSlice(0).toString(UTF_8);
    Range range=block.getRange();
    actual.put(key,range);
  }
  Assert.assertEquals(actual,expected);
}
