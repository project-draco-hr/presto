{
  GroupByOperator groupBy=new GroupByOperator(newGroupColumn());
  Map<String,Range> expected=ImmutableMap.<String,Range>of("apple",Range.create(0,3),"banana",Range.create(4,22),"cherry",Range.create(23,25),"date",Range.create(30,32));
  Map<String,Range> actual=new HashMap<>();
  for (  RunLengthEncodedBlock block : groupBy) {
    Tuple tuple=block.getValue();
    String key=tuple.getSlice(0).toString(UTF_8);
    Range range=block.getRange();
    actual.put(key,range);
  }
  Assert.assertEquals(actual,expected);
}
