{
  checkNotNull(catalogName,"catalogName is null");
  checkNotNull(connectorName,"connectorName is null");
  checkNotNull(properties,"properties is null");
  ConnectorFactory connectorFactory=connectorFactories.get(connectorName);
  checkArgument(connectorFactory != null,"No factory for connector %s",connectorName);
  try (ThreadContextClassLoader ignored=new ThreadContextClassLoader(connectorFactory.getClass().getClassLoader())){
    createConnection(catalogName,connectorFactory,properties);
  }
 }
