{
  checkNotNull(catalogName,"catalogName is null");
  checkNotNull(connectorName,"connectorName is null");
  checkNotNull(properties,"properties is null");
  String connectorId=catalogName;
  checkState(!connectors.containsKey(connectorId),"A connector %s already exists",connectorId);
  ConnectorFactory connectorFactory=connectorFactories.get(connectorName);
  Preconditions.checkArgument(connectorFactory != null,"No factory for connector %s",connectorName);
  Connector connector=connectorFactory.create(connectorId,properties);
  connectors.put(connectorName,connector);
  addConnector(catalogName,connectorId,connector);
}
