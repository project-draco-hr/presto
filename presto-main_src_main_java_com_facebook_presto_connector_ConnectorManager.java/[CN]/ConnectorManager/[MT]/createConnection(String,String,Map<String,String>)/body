{
  checkState(!stopped.get(),"ConnectorManager is stopped");
  requireNonNull(catalogName,"catalogName is null");
  requireNonNull(connectorName,"connectorName is null");
  requireNonNull(properties,"properties is null");
  TransactionalConnectorFactory connectorFactory=connectorFactories.get(connectorName);
  checkArgument(connectorFactory != null,"No factory for connector %s",connectorName);
  try (ThreadContextClassLoader ignored=new ThreadContextClassLoader(connectorFactory.getClass().getClassLoader())){
    createConnection(catalogName,connectorFactory,properties);
  }
 }
