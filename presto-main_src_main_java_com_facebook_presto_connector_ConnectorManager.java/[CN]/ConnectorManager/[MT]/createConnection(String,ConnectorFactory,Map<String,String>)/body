{
  checkState(!stopped.get(),"ConnectorManager is stopped");
  requireNonNull(catalogName,"catalogName is null");
  requireNonNull(properties,"properties is null");
  requireNonNull(connectorFactory,"connectorFactory is null");
  String connectorId=getConnectorId(catalogName);
  checkState(!connectors.containsKey(connectorId),"A connector %s already exists",connectorId);
  Connector connector=connectorFactory.create(connectorId,properties);
  addConnector(catalogName,connectorId,connector);
}
