{
  checkState(!stopped.get(),"ConnectorManager is stopped");
  requireNonNull(catalogName,"catalogName is null");
  requireNonNull(properties,"properties is null");
  requireNonNull(connectorFactory,"connectorFactory is null");
  checkArgument(!catalogs.contains(catalogName),"A catalog already exists for %s",catalogName);
  String connectorId=getConnectorId(catalogName);
  checkState(!connectors.containsKey(connectorId),"A connector %s already exists",connectorId);
  Connector connector=connectorFactory.create(connectorId,properties);
  addCatalogConnector(catalogName,connectorId,connector);
  catalogs.add(catalogName);
}
