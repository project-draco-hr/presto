{
  checkNotNull(outputTypes,"outputTypes is null");
  checkNotNull(keyOutputChannels,"keyOutputChannels is null");
  checkNotNull(keyOutputHashChannel,"keyOutputHashChannel is null");
  checkNotNull(driverContext,"driverContext is null");
  checkNotNull(maxMemoryInBytes,"maxMemoryInBytes is null");
  checkArgument(expectedPositions > 0,"expectedPositions must be greater than zero");
  this.outputTypes=ImmutableList.copyOf(outputTypes);
  this.expectedPositions=expectedPositions;
  this.keyOutputChannels=ImmutableList.copyOf(keyOutputChannels);
  this.keyOutputHashChannel=keyOutputHashChannel;
  this.maxMemoryInBytes=maxMemoryInBytes.toBytes();
  ImmutableList.Builder<Type> missingKeysTypes=ImmutableList.builder();
  ImmutableList.Builder<Integer> missingKeysChannels=ImmutableList.builder();
  for (int i=0; i < keyOutputChannels.size(); i++) {
    Integer keyOutputChannel=keyOutputChannels.get(i);
    missingKeysTypes.add(outputTypes.get(keyOutputChannel));
    missingKeysChannels.add(i);
  }
  this.missingKeysTypes=missingKeysTypes.build();
  this.missingKeysChannels=missingKeysChannels.build();
  boolean cpuTimerEnabled=driverContext.getPipelineContext().getTaskContext().isCpuTimerEnabled();
  this.bogusOperatorContext=new TaskContext(driverContext.getTaskId(),driverContext.getExecutor(),driverContext.getSession(),new DataSize(Long.MAX_VALUE,Unit.BYTE),cpuTimerEnabled).addPipelineContext(true,true).addDriverContext().addOperatorContext(0,"operator");
  this.outputPagesIndex=new PagesIndex(outputTypes,expectedPositions,bogusOperatorContext);
  this.missingKeysIndex=new PagesIndex(missingKeysTypes.build(),expectedPositions,bogusOperatorContext);
  this.missingKeys=missingKeysIndex.createLookupSource(this.missingKeysChannels);
}
