{
  String tableName=getTableName(tableHandle);
  checkArgument(tables.containsKey(tableName),"Table %s does not exist",tableHandle);
  checkArgument(columnHandle instanceof InternalColumnHandle,"columnHandle is not an instance of InternalColumnHandle");
  String columnName=((InternalColumnHandle)columnHandle).getColumnName();
  for (  ColumnMetadata column : tables.get(tableName).getColumns()) {
    if (column.getName().equals(columnName)) {
      return column;
    }
  }
  throw new IllegalArgumentException(String.format("Table %s does not have column %s",tableName,columnName));
}
