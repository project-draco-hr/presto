{
  Preconditions.checkNotNull(block,"block is null");
  checkState(!finished,"already finished");
  if (!initialized) {
    initialized=true;
  }
  BlockCursor cursor=block.cursor();
  while (cursor.advanceNextPosition()) {
    cursor.getTuple().writeTo(buffer);
    tupleCount++;
    if (buffer.size() >= MAX_BLOCK_SIZE) {
      writeBlock();
    }
  }
  return this;
}
