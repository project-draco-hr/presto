{
  Preconditions.checkNotNull(tuple,"tuple is null");
  checkState(!finished,"already finished");
  if (!initialized) {
    initialized=true;
  }
  tuple.writeTo(buffer);
  tupleCount++;
  if (buffer.size() >= MAX_BLOCK_SIZE) {
    writeBlock();
  }
  return this;
}
