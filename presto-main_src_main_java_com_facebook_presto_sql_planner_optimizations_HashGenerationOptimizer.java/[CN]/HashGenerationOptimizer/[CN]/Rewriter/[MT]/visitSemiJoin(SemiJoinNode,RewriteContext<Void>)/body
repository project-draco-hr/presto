{
  PlanNode rewrittenSource=context.rewrite(node.getSource(),null);
  PlanNode rewrittenFilteringSource=context.rewrite(node.getFilteringSource(),null);
  Symbol sourceHashSymbol=symbolAllocator.newHashSymbol();
  Symbol filteringSourceHashSymbol=symbolAllocator.newHashSymbol();
  PlanNode sourceHashProjectNode=getHashProjectNode(idAllocator,rewrittenSource,sourceHashSymbol,ImmutableList.of(node.getSourceJoinSymbol()));
  PlanNode filteringSourceHashProjectNode=getHashProjectNode(idAllocator,rewrittenFilteringSource,filteringSourceHashSymbol,ImmutableList.of(node.getFilteringSourceJoinSymbol()));
  return new SemiJoinNode(idAllocator.getNextId(),sourceHashProjectNode,filteringSourceHashProjectNode,node.getSourceJoinSymbol(),node.getFilteringSourceJoinSymbol(),node.getSemiJoinOutput(),Optional.of(sourceHashSymbol),Optional.of(filteringSourceHashSymbol));
}
