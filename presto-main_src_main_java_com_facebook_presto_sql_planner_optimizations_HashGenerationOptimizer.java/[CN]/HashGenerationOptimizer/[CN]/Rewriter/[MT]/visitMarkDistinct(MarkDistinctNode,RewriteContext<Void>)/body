{
  PlanNode rewrittenSource=context.rewrite(node.getSource(),null);
  Symbol hashSymbol=symbolAllocator.newHashSymbol();
  PlanNode hashProjectNode=getHashProjectNode(idAllocator,rewrittenSource,hashSymbol,node.getDistinctSymbols());
  return new MarkDistinctNode(idAllocator.getNextId(),hashProjectNode,node.getMarkerSymbol(),node.getDistinctSymbols(),Optional.of(hashSymbol));
}
