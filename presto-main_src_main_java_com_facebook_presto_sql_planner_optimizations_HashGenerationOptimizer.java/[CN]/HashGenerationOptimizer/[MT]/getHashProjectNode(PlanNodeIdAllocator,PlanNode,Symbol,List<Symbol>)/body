{
  checkArgument(!partitioningSymbols.isEmpty(),"partitioningSymbols is empty");
  ImmutableMap.Builder<Symbol,Expression> outputSymbols=ImmutableMap.builder();
  for (  Symbol symbol : source.getOutputSymbols()) {
    Expression expression=new QualifiedNameReference(symbol.toQualifiedName());
    outputSymbols.put(symbol,expression);
  }
  Expression hashExpression=getHashExpression(partitioningSymbols);
  outputSymbols.put(hashSymbol,hashExpression);
  return new ProjectNode(idAllocator.getNextId(),source,outputSymbols.build());
}
