{
  checkNotNull(plan,"plan is null");
  checkNotNull(session,"session is null");
  checkNotNull(types,"types is null");
  checkNotNull(symbolAllocator,"symbolAllocator is null");
  checkNotNull(idAllocator,"idAllocator is null");
  if (SystemSessionProperties.isOptimizeHashGenerationEnabled(session,optimizeHashGeneration)) {
    return PlanRewriter.rewriteWith(new Rewriter(idAllocator,symbolAllocator),plan,null);
  }
  return plan;
}
